<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Multiscale analysis reveals that diet-dependent gut plasticity emerges from alterations in both stem cell niche coupling and enterocyte size.</title>

<script src="site_libs/header-attrs-2.9/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Bonfini_eLife_2021</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dduneau/Bonfini_eLife_2021">
    <span class="fa fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Multiscale analysis reveals that diet-dependent gut plasticity emerges from alterations in both stem cell niche coupling and enterocyte size.</h1>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-10-08
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 1
</p>
<p>
<strong>Knit directory:</strong> <code>Bonfini_eLife_2021/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20211008code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20211008)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20211008code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20211008)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongabsolute"> <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> <strong>File paths:</strong> absolute </a>
</p>
</div>
<div id="strongFilepathsstrongabsolute" class="panel-collapse collapse">
<div class="panel-body">
<p>
Using absolute paths to the files within your workflowr project makes it difficult for you and others to run your code on a different machine. Change the absolute path(s) below to the suggested relative path(s) to make your code more reproducible.
</p>
<table class="table table-condensed table-hover">
<thead>
<tr>
<th style="text-align:left;">
absolute
</th>
<th style="text-align:left;">
relative
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/
</td>
<td style="text-align:left;">
data
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/1A.jpg
</td>
<td style="text-align:left;">
data/1A.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/1C.jpg
</td>
<td style="text-align:left;">
data/1C.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/1D.jpg
</td>
<td style="text-align:left;">
data/1D.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_1.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_1.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_1S1.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_1S1.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/1- S2A.jpg
</td>
<td style="text-align:left;">
data/1- S2A.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Plot_Fig1S2B.jpeg
</td>
<td style="text-align:left;">
data/Plot_Fig1S2B.jpeg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_1S2.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_1S2.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/1 - S3.jpg
</td>
<td style="text-align:left;">
data/1 - S3.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_1S3.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_1S3.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Plot_Fig2A.jpeg
</td>
<td style="text-align:left;">
data/Plot_Fig2A.jpeg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Nutri_geo_graph.jpg
</td>
<td style="text-align:left;">
data/Nutri_geo_graph.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_2.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_2.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Plot_Fig2-S1B.jpeg
</td>
<td style="text-align:left;">
data/Plot_Fig2-S1B.jpeg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_2S1.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_2S1.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_2S2.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_2S2.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/3A.jpg
</td>
<td style="text-align:left;">
data/3A.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/3B.jpg
</td>
<td style="text-align:left;">
data/3B.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/3E.jpg
</td>
<td style="text-align:left;">
data/3E.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/3F.jpg
</td>
<td style="text-align:left;">
data/3F.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_3.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_3.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/3 - S1B.jpg
</td>
<td style="text-align:left;">
data/3 - S1B.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/3 - S1D.jpg
</td>
<td style="text-align:left;">
data/3 - S1D.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/3 - S1E.jpg
</td>
<td style="text-align:left;">
data/3 - S1E.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/3 - S1F.jpg
</td>
<td style="text-align:left;">
data/3 - S1F.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/3 - S1G.jpg
</td>
<td style="text-align:left;">
data/3 - S1G.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_3S1.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_3S1.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/4E.jpg
</td>
<td style="text-align:left;">
data/4E.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/4F.jpg
</td>
<td style="text-align:left;">
data/4F.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/4G.jpg
</td>
<td style="text-align:left;">
data/4G.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/4H.jpg
</td>
<td style="text-align:left;">
data/4H.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/4I.jpg
</td>
<td style="text-align:left;">
data/4I.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/4J.jpg
</td>
<td style="text-align:left;">
data/4J.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_4.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_4.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/4 - S1B.jpg
</td>
<td style="text-align:left;">
data/4 - S1B.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Plot_Fig4-S1F.jpeg
</td>
<td style="text-align:left;">
data/Plot_Fig4-S1F.jpeg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_4S1.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_4S1.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/4 - S2A.jpg
</td>
<td style="text-align:left;">
data/4 - S2A.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_4S2.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_4S2.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5C.jpg
</td>
<td style="text-align:left;">
data/5C.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5F.jpg
</td>
<td style="text-align:left;">
data/5F.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5F
</td>
<td style="text-align:left;">
data/5F
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5G.jpg
</td>
<td style="text-align:left;">
data/5G.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5G
</td>
<td style="text-align:left;">
data/5G
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5I.jpg
</td>
<td style="text-align:left;">
data/5I.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5I
</td>
<td style="text-align:left;">
data/5I
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5J.jpg
</td>
<td style="text-align:left;">
data/5J.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5J
</td>
<td style="text-align:left;">
data/5J
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_5.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_5.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_5S1.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_5S1.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5 - S2A.jpg
</td>
<td style="text-align:left;">
data/5 - S2A.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5 - S2A
</td>
<td style="text-align:left;">
data/5 - S2A
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5 - S2B.jpg
</td>
<td style="text-align:left;">
data/5 - S2B.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5 - S2B
</td>
<td style="text-align:left;">
data/5 - S2B
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5 - S2C.jpg
</td>
<td style="text-align:left;">
data/5 - S2C.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5 - S2C
</td>
<td style="text-align:left;">
data/5 - S2C
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5 - S2D.jpg
</td>
<td style="text-align:left;">
data/5 - S2D.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/5 - S2D
</td>
<td style="text-align:left;">
data/5 - S2D
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_5S2.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_5S2.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/6B.jpg
</td>
<td style="text-align:left;">
data/6B.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/6C.jpg
</td>
<td style="text-align:left;">
data/6C.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/6H.jpg
</td>
<td style="text-align:left;">
data/6H.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/6I.jpg
</td>
<td style="text-align:left;">
data/6I.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_6.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_6.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/6 - S1B.jpg
</td>
<td style="text-align:left;">
data/6 - S1B.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/6 - S1C.jpg
</td>
<td style="text-align:left;">
data/6 - S1C.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/6 - S1D.jpg
</td>
<td style="text-align:left;">
data/6 - S1D.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/6 - S1E.jpg
</td>
<td style="text-align:left;">
data/6 - S1E.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_6S1.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_6S1.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/7B.jpg
</td>
<td style="text-align:left;">
data/7B.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/7C.jpg
</td>
<td style="text-align:left;">
data/7C.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/7E.jpg
</td>
<td style="text-align:left;">
data/7E.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/7F.jpg
</td>
<td style="text-align:left;">
data/7F.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/7I.jpg
</td>
<td style="text-align:left;">
data/7I.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_7.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_7.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_7S1.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_7S1.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/7- S2A.jpg
</td>
<td style="text-align:left;">
data/7- S2A.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/7- S2A1.jpg
</td>
<td style="text-align:left;">
data/7- S2A1.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/7- S2B.jpg
</td>
<td style="text-align:left;">
data/7- S2B.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/7- S2B1.jpg
</td>
<td style="text-align:left;">
data/7- S2B1.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_7S2.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_7S2.tiff
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/7 - S3A.jpg
</td>
<td style="text-align:left;">
data/7 - S3A.jpg
</td>
</tr>
<tr>
<td style="text-align:left;">
F:/Dropbox/Github/Bonfini_eLife_2021/data/Figures/Figure_7S3.tiff
</td>
<td style="text-align:left;">
data/Figures/Figure_7S3.tiff
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomdduneauBonfinieLife2021tree2e08f0d92f6ed5aa3da4487267fc3e4c067b8903targetblank2e08f0da"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/dduneau/Bonfini_eLife_2021/tree/2e08f0d92f6ed5aa3da4487267fc3e4c067b8903" target="_blank">2e08f0d</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomdduneauBonfinieLife2021tree2e08f0d92f6ed5aa3da4487267fc3e4c067b8903targetblank2e08f0da" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/dduneau/Bonfini_eLife_2021/tree/2e08f0d92f6ed5aa3da4487267fc3e4c067b8903" target="_blank">2e08f0d</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    data/.Rhistory

Untracked files:
    Untracked:  data/.RDataTmp
    Untracked:  data/.RDataTmp1
    Untracked:  data/.RDataTmp2
    Untracked:  data/.RDataTmp3
    Untracked:  data/.RDataTmp4
    Untracked:  data/.RDataTmp5
    Untracked:  data/.RDataTmp6
    Untracked:  data/.RDataTmp7
    Untracked:  data/1 - S1B.csv
    Untracked:  data/1 - S1C.csv
    Untracked:  data/1 - S1D.csv
    Untracked:  data/1 - S1E.csv
    Untracked:  data/1 - S3.jpg
    Untracked:  data/1- S2A.jpg
    Untracked:  data/1A.jpg
    Untracked:  data/1B.csv
    Untracked:  data/1C.jpg
    Untracked:  data/1D.jpg
    Untracked:  data/1E - 1S1A.csv
    Untracked:  data/1F - G.csv
    Untracked:  data/2 - S1A.csv
    Untracked:  data/2 - S2A.csv
    Untracked:  data/2 - S2B.csv
    Untracked:  data/2 -S1B supplement data.xlsx
    Untracked:  data/2-S1C.csv
    Untracked:  data/2A.csv
    Untracked:  data/2E - calories.csv
    Untracked:  data/2E - table.tif
    Untracked:  data/2E.csv
    Untracked:  data/2F - calories.csv
    Untracked:  data/2F.csv
    Untracked:  data/2G.csv
    Untracked:  data/2S2C.csv
    Untracked:  data/3 - S1A.csv
    Untracked:  data/3 - S1B.jpg
    Untracked:  data/3 - S1C.csv
    Untracked:  data/3 - S1D.jpg
    Untracked:  data/3 - S1E.jpg
    Untracked:  data/3 - S1F.jpg
    Untracked:  data/3 - S1G.jpg
    Untracked:  data/3 - S1H.csv
    Untracked:  data/3A.jpg
    Untracked:  data/3B.jpg
    Untracked:  data/3C.csv
    Untracked:  data/3E.jpg
    Untracked:  data/3F.jpg
    Untracked:  data/3G.csv
    Untracked:  data/3H.csv
    Untracked:  data/4 - S1A.csv
    Untracked:  data/4 - S1B.jpg
    Untracked:  data/4 - S1F.csv
    Untracked:  data/4 - S2A.jpg
    Untracked:  data/4A.csv
    Untracked:  data/4B, 4S1C.csv
    Untracked:  data/4C', 4S1D'.csv
    Untracked:  data/4C, 4S1D.csv
    Untracked:  data/4E.jpg
    Untracked:  data/4F.jpg
    Untracked:  data/4G.jpg
    Untracked:  data/4H.jpg
    Untracked:  data/4I.jpg
    Untracked:  data/4J.jpg
    Untracked:  data/4K.csv
    Untracked:  data/4L, 4S2D.csv
    Untracked:  data/4S2B.csv
    Untracked:  data/4S2C.csv
    Untracked:  data/5 - S1A.csv
    Untracked:  data/5 - S2A'.jpg
    Untracked:  data/5 - S2A.jpg
    Untracked:  data/5 - S2B'.jpg
    Untracked:  data/5 - S2B.jpg
    Untracked:  data/5 - S2C'.jpg
    Untracked:  data/5 - S2C.jpg
    Untracked:  data/5 - S2D'.jpg
    Untracked:  data/5 - S2D.jpg
    Untracked:  data/5 - S2E.csv
    Untracked:  data/5 - S2F.csv
    Untracked:  data/5 - S2G.csv
    Untracked:  data/5-S2.jpg
    Untracked:  data/5B.csv
    Untracked:  data/5C.jpg
    Untracked:  data/5C.xlsx
    Untracked:  data/5D.csv
    Untracked:  data/5E.csv
    Untracked:  data/5F'.jpg
    Untracked:  data/5F.jpg
    Untracked:  data/5G'.jpg
    Untracked:  data/5G.jpg
    Untracked:  data/5H.csv
    Untracked:  data/5I'.jpg
    Untracked:  data/5I.jpg
    Untracked:  data/5J'.jpg
    Untracked:  data/5J.jpg
    Untracked:  data/5K.csv
    Untracked:  data/5L.csv
    Untracked:  data/5M.csv
    Untracked:  data/6 - S1B.jpg
    Untracked:  data/6 - S1C.jpg
    Untracked:  data/6 - S1D.jpg
    Untracked:  data/6 - S1E.jpg
    Untracked:  data/6 - S1F.csv
    Untracked:  data/6A - 7A.csv
    Untracked:  data/6B.jpg
    Untracked:  data/6C.jpg
    Untracked:  data/6D.csv
    Untracked:  data/6E.csv
    Untracked:  data/6F.csv
    Untracked:  data/6G.csv
    Untracked:  data/6H.jpg
    Untracked:  data/6I.jpg
    Untracked:  data/6J.csv
    Untracked:  data/7 - S1A.csv
    Untracked:  data/7 - S2C.csv
    Untracked:  data/7 - S2D.csv
    Untracked:  data/7 - S2E.csv
    Untracked:  data/7 - S3A.jpg
    Untracked:  data/7- S2A.jpg
    Untracked:  data/7- S2A1.jpg
    Untracked:  data/7- S2B.jpg
    Untracked:  data/7- S2B1.jpg
    Untracked:  data/7B.jpg
    Untracked:  data/7C.jpg
    Untracked:  data/7D.csv
    Untracked:  data/7E.jpg
    Untracked:  data/7F.jpg
    Untracked:  data/7G.csv
    Untracked:  data/7H.csv
    Untracked:  data/7I.jpg
    Untracked:  data/7J.csv
    Untracked:  data/7K.csv
    Untracked:  data/7L.csv
    Untracked:  data/DGRP_wolbachia_DFD.csv
    Untracked:  data/GWAS_Response_Gut_Diet.jpg
    Untracked:  data/Plot_Fig1S2B.jpeg
    Untracked:  data/Plot_Fig2-S1B.jpeg
    Untracked:  data/Plot_Fig2A.jpeg
    Untracked:  data/Plot_Fig4-S1F.jpeg
    Untracked:  data/Template TIF.tif
    Untracked:  data/genes_info.csv
    Untracked:  data/gutGrowthDataIndex.csv
    Untracked:  data/image_5C.jpg
    Untracked:  data/normCounts.csv
    Untracked:  data/normCountsMeans_noDay4.csv
    Untracked:  data/readTable.csv
    Untracked:  data/readTableTMP.csv
    Untracked:  data/readTableTPM.csv
    Untracked:  data/stockDecode.csv
    Untracked:  data/weights.csv

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/Bonfini_eLife_2021.Rmd</code>) and HTML (<code>docs/Bonfini_eLife_2021.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/dduneau/Bonfini_eLife_2021/blob/2e08f0d92f6ed5aa3da4487267fc3e4c067b8903/analysis/Bonfini_eLife_2021.Rmd" target="_blank">2e08f0d</a>
</td>
<td>
dduneau
</td>
<td>
2021-10-08
</td>
<td>
Bonfini eLife 2021 project
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/dduneau/Bonfini_eLife_2021/blob/e96cf31d0790bf08a5a17c3f6a4fb11cbc6a30a2/analysis/Bonfini_eLife_2021.Rmd" target="_blank">e96cf31</a>
</td>
<td>
dduneau
</td>
<td>
2021-10-08
</td>
<td>
Update Bonfini_eLife_2021.Rmd
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/dduneau/Bonfini_eLife_2021/ec22c19e1b7db09d9fb5686e5fd350e89c682486/docs/Bonfini_eLife_2021.html" target="_blank">ec22c19</a>
</td>
<td>
dduneau
</td>
<td>
2021-10-08
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/dduneau/Bonfini_eLife_2021/blob/8fa9317a539e279d188a3cf53ac302ea9119ed79/analysis/Bonfini_eLife_2021.Rmd" target="_blank">8fa9317</a>
</td>
<td>
dduneau
</td>
<td>
2021-10-08
</td>
<td>
Bonfini eLife 2021 project
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<hr />
<style>
div.blue { background-color:#6b85ff; border-radius: 5px; padding: 20px;}
div.pastelred { background-color:#ff8b85; border-radius: 5px; padding: 20px;}
</style>
<div id="table-of-contents" class="section level1 unnumbered">
<h1 class="unnumbered">Table of contents</h1>
</div>
<div id="library-data-import-and-reformatting" class="section level1 unnumbered">
<h1 class="unnumbered">Library, Data import and reformatting</h1>
<div id="library" class="section level3 unnumbered">
<h3 class="unnumbered">Library</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotrix)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nparLD)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doBy)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xlsxjars)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xlsx)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phia)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spaMM)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fields)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EBImage)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gplots)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridGraphics)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fields)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(metR)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggh4x)<span class="co">#remotes::install_github(&quot;teunbrand/ggh4x&quot;)</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GenomicRanges)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DESeq2)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coxme)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplotify)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co">#library(base2grob)</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotfunctions)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsignif)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="co">#Function to include factor that are NOT in a list</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;%!in%&#39;</span> <span class="ot">=</span> <span class="cf">function</span>(x,y)<span class="sc">!</span>(<span class="st">&#39;%in%&#39;</span>(x,y))</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Function to Grab graph and display it as a ggplot graph</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>grab_grob <span class="ot">=</span> <span class="cf">function</span>(){</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid.echo</span>()</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid.grab</span>()</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="co">#Function to calculate standard deviaion </span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">sqrt</span>(<span class="fu">var</span>(x,<span class="at">na.rm=</span>T))</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="co">#Function to calculate standard error </span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>se <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">sqrt</span>(<span class="fu">var</span>(x,<span class="at">na.rm=</span>T)<span class="sc">/</span><span class="fu">length</span>(x))</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to graph survival with ggplot and displaying the checkpoints</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>ggplotprep2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, times){</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  <span class="co">#spreading the surfit dataframe into dataframe per day. </span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">condition=</span><span class="fu">rep</span>(<span class="fu">names</span>(x<span class="sc">$</span>strata), x<span class="sc">$</span>strata), <span class="at">time=</span>x<span class="sc">$</span>time, <span class="at">survival=</span>x<span class="sc">$</span>surv, <span class="at">upper=</span>x<span class="sc">$</span>upper, <span class="at">lower=</span>x<span class="sc">$</span>lower)</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># function to add time point 0 </span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  fillup0 <span class="ot">&lt;-</span> <span class="cf">function</span>(s) <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="at">condition=</span>s, <span class="at">time=</span><span class="dv">0</span>, <span class="at">survival=</span><span class="dv">1</span>, <span class="at">upper=</span><span class="dv">1</span>, <span class="at">lower=</span><span class="dv">1</span>), d[d<span class="sc">$</span>condition<span class="sc">==</span>s, ], <span class="at">deparse.level =</span> <span class="dv">0</span>)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># function to determine the missing time points</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  indexes <span class="ot">&lt;-</span> <span class="cf">function</span>(x, time) {</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(x<span class="sc">%in%</span>time) <span class="fu">return</span>(x)</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(time[<span class="fu">which.min</span>(<span class="fu">abs</span>(time[time<span class="sc">&lt;</span>x]<span class="sc">-</span>x))])</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Function to complete the missing time points</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>  fillup <span class="ot">&lt;-</span> <span class="cf">function</span>(s) {</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>    d.temp <span class="ot">&lt;-</span> d[d<span class="sc">$</span>condition<span class="sc">==</span>s, ]</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>    time <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(d.temp<span class="sc">$</span>time)</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    id <span class="ot">&lt;-</span> <span class="fu">sapply</span>(times, indexes, <span class="at">time=</span>time)</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    d.temp <span class="ot">&lt;-</span> d.temp[<span class="fu">match</span>(id, time), ]</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    d.temp<span class="sc">$</span>time <span class="ot">&lt;-</span> times</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(d.temp)</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(times[<span class="dv">1</span>]<span class="sc">==</span><span class="dv">0</span>) d <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&quot;rbind&quot;</span>, <span class="fu">sapply</span>(<span class="fu">names</span>(x<span class="sc">$</span>strata), fillup0, <span class="at">simplify=</span>F))</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&quot;rbind&quot;</span>, <span class="fu">sapply</span>(<span class="fu">names</span>(x<span class="sc">$</span>strata), fillup, <span class="at">simplify=</span>F))</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  clean.name <span class="ot">&lt;-</span> <span class="cf">function</span>(name) <span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">strsplit</span>(<span class="fu">as.character</span>(name), <span class="at">split=</span><span class="st">&quot;=&quot;</span>), <span class="cf">function</span>(x) x[<span class="dv">2</span>]))</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Condition=</span><span class="fu">clean.name</span>(d<span class="sc">$</span>condition), <span class="at">Time=</span><span class="fu">as.numeric</span>(d<span class="sc">$</span>time), <span class="at">Survival=</span><span class="fu">as.numeric</span>(d<span class="sc">$</span>survival), <span class="at">upper=</span><span class="fu">as.numeric</span>(d<span class="sc">$</span>upper), <span class="at">lower=</span><span class="fu">as.numeric</span>(d<span class="sc">$</span>lower))</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(d)</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>}  </span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="co">#function to select colours for GF-style plot (function mapping colors)</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>seeMahPal <span class="ot">&lt;-</span> <span class="cf">function</span>(x, pal){</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>    pal[<span class="fu">round</span>(x)]</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="co">#a function to take x,y,z</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    <span class="co">#and return a GF-style plot with points per diet</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>geomPlotta <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y,z,alf,...){</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">z=</span>z)</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    d.means <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(z <span class="sc">~</span> x <span class="sc">*</span> y, dat, mean)</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>    surf.te <span class="ot">&lt;-</span> <span class="fu">Tps</span>(<span class="fu">cbind</span>(dat<span class="sc">$</span>x, dat<span class="sc">$</span>y), dat<span class="sc">$</span>z, <span class="at">lambda =</span> <span class="dv">0</span>) </span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    experiColours <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">z=</span>d.means<span class="sc">$</span>z, <span class="at">rank=</span><span class="fu">rank</span>(d.means<span class="sc">$</span>z), <span class="at">rnd=</span><span class="fu">round</span>(d.means<span class="sc">$</span>z), <span class="at">rankRnd=</span><span class="fu">rank</span>(<span class="fu">round</span>(d.means<span class="sc">$</span>z)))</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    mahPal <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;turquoise&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;darkred&quot;</span>))(<span class="fu">max</span>(experiColours<span class="sc">$</span>rank)) <span class="co">#Decide colors</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>d.means<span class="sc">$</span>colour <span class="ot">&lt;-</span> <span class="fu">seeMahPal</span>(<span class="at">x=</span>d.means<span class="sc">$</span>z, <span class="at">pal=</span>mahPal)</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a><span class="fu">surface</span>(<span class="fu">predictSurface</span>(surf.te, <span class="at">extrap=</span>F), <span class="at">col=</span><span class="fu">alpha</span>(mahPal, alf), ...)</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(d.means<span class="sc">$</span>x, d.means<span class="sc">$</span>y, <span class="at">bg=</span><span class="fu">seeMahPal</span>(<span class="at">x=</span>experiColours<span class="sc">$</span>rank, <span class="at">pal=</span>mahPal), <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">cex=</span><span class="dv">1</span>, ...)</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>left <span class="ot">=</span> <span class="cf">function</span>(text, num_char) {</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">substr</span>(text, <span class="dv">1</span>, num_char)</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>mid <span class="ot">=</span> <span class="cf">function</span>(text, start_num, num_char) {</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">substr</span>(text, start_num, start_num <span class="sc">+</span> num_char <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>right <span class="ot">=</span> <span class="cf">function</span>(text, num_char) {</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">substr</span>(text, <span class="fu">nchar</span>(text) <span class="sc">-</span> (num_char<span class="dv">-1</span>), <span class="fu">nchar</span>(text))</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="font-size-and-palettes" class="section level3 unnumbered">
<h3 class="unnumbered">Font size and palettes</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>SuperSmallfont<span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>xSmallfont <span class="ot">=</span> <span class="dv">8</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>Smallfont<span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>Mediumfont<span class="ot">=</span> <span class="dv">12</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>Largefont<span class="ot">=</span> <span class="dv">14</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>verylargefont <span class="ot">=</span> <span class="dv">16</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>pointsize<span class="ot">=</span> <span class="fl">0.7</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>linesize<span class="ot">=</span><span class="fl">0.35</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>meansize <span class="ot">=</span> <span class="fl">1.5</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>Margin<span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>fontsizeaxes <span class="ot">=</span> <span class="dv">14</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>fontsizeaxes2 <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>palette_diet_2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;#FFB4B4&quot;</span>, <span class="st">&quot;#C3E6FC&quot;</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>palette_component_3 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;#f4ead0&quot;</span>,<span class="st">&quot;#2d5ad7&quot;</span>,<span class="st">&quot;gold&quot;</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>palette_mean <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;magenta&quot;</span>,<span class="st">&quot;skyblue&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;deeppink&quot;</span>, <span class="st">&quot;gold&quot;</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>cbbPalette_4 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;#BDE6BD&quot;</span>, <span class="st">&quot;#C3E6FC&quot;</span>, <span class="st">&quot;#FFE5E5&quot;</span>, <span class="st">&quot;#E5E5FF&quot;</span>) <span class="co">#Green eclosion, HY, HYtoHS, HStoHY</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>cbbHS_HStoHY <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;#FFB4B4&quot;</span>,<span class="st">&quot;#E5E5FF&quot;</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>cbbHY_HYtoHS <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;#C3E6FC&quot;</span>,<span class="st">&quot;#FFE5E5&quot;</span>)</span></code></pre></div>
<div class="alert alert-warning">
<p>
<strong>Warning:</strong> The above code chunk cached its results, but it won’t be re-run if previous chunks it depends on are updated. If you need to use caching, it is highly recommended to also set <code>knitr::opts_chunk$set(autodep = TRUE)</code> at the top of the file (in a chunk that is not cached). Alternatively, you can customize the option <code>dependson</code> for each individual chunk that is cached. Using either <code>autodep</code> or <code>dependson</code> will remove this warning. See the <a href="https://yihui.name/knitr/options/#cache"
>knitr cache options</a> for more details.
</p>
</div>
</div>
<div id="import-dataset" class="section level3 unnumbered">
<h3 class="unnumbered">Import dataset</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>path.to.data <span class="ot">=</span> <span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/&quot;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(d,path)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>path <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> <span class="fu">list.files</span>(<span class="at">path=</span>path.to.data,<span class="at">pattern=</span><span class="st">&quot;*.csv$&quot;</span>,<span class="at">recursive=</span>T,<span class="at">full.names=</span>T)) {</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  nom <span class="ot">=</span> <span class="fu">gsub</span>(<span class="st">&quot;.*/(.*).csv&quot;</span>,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&quot;</span>,f)    </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(nom,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  path[[nom]] <span class="ot">=</span> <span class="fu">gsub</span>(<span class="st">&quot;(.*)/.*csv&quot;</span>,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">1/&quot;</span>,f)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  d[[nom]] <span class="ot">=</span> <span class="fu">read.table</span>(f,<span class="at">header=</span>T,<span class="at">sep=</span><span class="st">&quot;,&quot;</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="alert alert-warning">
<p>
<strong>Warning:</strong> The above code chunk cached its results, but it won’t be re-run if previous chunks it depends on are updated. If you need to use caching, it is highly recommended to also set <code>knitr::opts_chunk$set(autodep = TRUE)</code> at the top of the file (in a chunk that is not cached). Alternatively, you can customize the option <code>dependson</code> for each individual chunk that is cached. Using either <code>autodep</code> or <code>dependson</code> will remove this warning. See the <a href="https://yihui.name/knitr/options/#cache"
>knitr cache options</a> for more details.
</p>
</div>
</div>
<div id="data-meaning---dgrp-gwas" class="section level3 unnumbered">
<h3 class="unnumbered">Data meaning - DGRP GWAS</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>wolb <span class="ot">=</span> d[[<span class="st">&quot;DGRP_wolbachia_DFD&quot;</span>]]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(wolb) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;dgrp_id&quot;</span>, <span class="st">&quot;wolbachia&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>wolb<span class="sc">$</span>dgrp_id <span class="ot">=</span> <span class="fu">gsub</span>(<span class="st">&quot;line_&quot;</span>, <span class="st">&quot;DGRP-&quot;</span>, wolb<span class="sc">$</span>dgrp_id)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>weight <span class="ot">=</span> d[[<span class="st">&quot;weights&quot;</span>]]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>decode <span class="ot">=</span> d[[<span class="st">&quot;stockDecode&quot;</span>]]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>weight<span class="sc">$</span>mg <span class="ot">=</span> weight<span class="sc">$</span>weightPerFlyGram <span class="sc">*</span> <span class="dv">1000</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>weight<span class="sc">$</span>diet <span class="ot">=</span> <span class="fu">tolower</span>(weight<span class="sc">$</span>diet)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>decode<span class="sc">$</span>shortID <span class="ot">=</span> <span class="fu">as.factor</span>(<span class="fu">as.character</span>(decode<span class="sc">$</span>shortID))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>weight<span class="sc">$</span>stockNumber <span class="ot">=</span> <span class="fu">as.factor</span>(<span class="fu">as.character</span>(weight<span class="sc">$</span>dgrp))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>weight <span class="ot">=</span> <span class="fu">merge</span>(weight, decode, <span class="at">by.x=</span><span class="st">&quot;stockNumber&quot;</span>, <span class="at">by.y=</span><span class="st">&quot;shortID&quot;</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(weight) <span class="ot">=</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(weight))</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>weight <span class="ot">=</span> weight[,<span class="fu">which</span>(<span class="sc">!</span><span class="fu">colnames</span>(weight) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;stockNumber&quot;</span>, <span class="st">&quot;dgrp.x&quot;</span>))]</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(weight)[<span class="fu">which</span>(<span class="fu">colnames</span>(weight) <span class="sc">==</span> <span class="st">&quot;dgrp.y&quot;</span>)] <span class="ot">=</span> <span class="st">&quot;dgrp&quot;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>weight<span class="sc">$</span>dgrp_number <span class="ot">=</span> <span class="fu">substr</span>(<span class="fu">as.character</span>(weight<span class="sc">$</span>dgrp), <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>weight<span class="sc">$</span>dgrpDiet <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">paste</span>(weight<span class="sc">$</span>dgrp_number, weight<span class="sc">$</span>diet, <span class="at">sep=</span><span class="st">&quot;_&quot;</span>))</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>tab_GWAS_gut <span class="ot">=</span> d[[<span class="st">&quot;1F - G&quot;</span>]]</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#edit the data</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">complete.cases</span>(tab_GWAS_gut))</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co">#str(tab_GWAS_gut)</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>tab_GWAS_gut<span class="ot">=</span> <span class="fu">mutate_if</span>(tab_GWAS_gut,is.integer,as.factor)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_GWAS_gut) <span class="ot">=</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(tab_GWAS_gut))</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>tab_GWAS_gut <span class="ot">=</span> tab_GWAS_gut[,<span class="sc">!</span><span class="fu">colnames</span>(tab_GWAS_gut) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;notes&quot;</span>, <span class="st">&quot;image&quot;</span>, <span class="st">&quot;bloomington_id&quot;</span>)]</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co">#remove the samples that subsequently proved crazy</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>tab_GWAS_gut <span class="ot">=</span> <span class="fu">subset</span>(tab_GWAS_gut, anteriorwidth <span class="sc">&lt;</span> <span class="dv">1000</span>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>tab_GWAS_gut <span class="ot">=</span> <span class="fu">subset</span>(tab_GWAS_gut, middlelength <span class="sc">&lt;</span> <span class="dv">1500</span>)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co">#remove lines that don&#39;t appear in both diets</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>dgrpLines <span class="ot">=</span> <span class="fu">levels</span>(tab_GWAS_gut<span class="sc">$</span>dgrp_number)</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>yDat <span class="ot">=</span> <span class="fu">droplevels</span>(<span class="fu">subset</span>(tab_GWAS_gut, diet<span class="sc">==</span><span class="st">&quot;y&quot;</span>))</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>xDat <span class="ot">=</span> <span class="fu">droplevels</span>(<span class="fu">subset</span>(tab_GWAS_gut, diet<span class="sc">==</span><span class="st">&quot;x&quot;</span>))</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dgrpLines)</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>dgrpLines <span class="ot">=</span> dgrpLines[dgrpLines <span class="sc">%in%</span> yDat<span class="sc">$</span>dgrp_number]</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="co">#length(dgrpLines)</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>dgrpLines <span class="ot">=</span> dgrpLines[dgrpLines <span class="sc">%in%</span> xDat<span class="sc">$</span>dgrp_number]</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="co">#length(dgrpLines)</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>tab_GWAS_gut <span class="ot">=</span> <span class="fu">droplevels</span>(<span class="fu">subset</span>(tab_GWAS_gut, dgrp_number <span class="sc">%in%</span> dgrpLines))</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>yDat <span class="ot">=</span> <span class="fu">droplevels</span>(<span class="fu">subset</span>(yDat, dgrp_number <span class="sc">%in%</span> dgrpLines))</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>xDat <span class="ot">=</span> <span class="fu">droplevels</span>(<span class="fu">subset</span>(xDat, dgrp_number <span class="sc">%in%</span> dgrpLines))</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a><span class="co">#link up Wolbachia</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>tab_GWAS_gut <span class="ot">=</span> <span class="fu">merge</span>(tab_GWAS_gut, wolb, <span class="at">by=</span><span class="st">&quot;dgrp_id&quot;</span>)</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>tab_GWAS_gut<span class="ot">=</span> <span class="fu">mutate_if</span>(tab_GWAS_gut,is.character,as.factor)</span></code></pre></div>
<div class="alert alert-warning">
<p>
<strong>Warning:</strong> The above code chunk cached its results, but it won’t be re-run if previous chunks it depends on are updated. If you need to use caching, it is highly recommended to also set <code>knitr::opts_chunk$set(autodep = TRUE)</code> at the top of the file (in a chunk that is not cached). Alternatively, you can customize the option <code>dependson</code> for each individual chunk that is cached. Using either <code>autodep</code> or <code>dependson</code> will remove this warning. See the <a href="https://yihui.name/knitr/options/#cache"
>knitr cache options</a> for more details.
</p>
</div>
</div>
</div>
<div id="figure-1.-diet-composition-affects-size-and-regional-allometry-of-the-midgut" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Figure 1. Diet composition affects size and regional allometry of the midgut</h1>
<div id="figure-1---main" class="section level2" number="1.1">
<h2 number="1.1"><span class="header-section-number">1.1</span> Figure 1 - main</h2>
<div id="figure-1a" class="section level3" number="1.1.1">
<h3 number="1.1.1"><span class="header-section-number">1.1.1</span> Figure 1A</h3>
<div class="blue">
<p><strong>Illustration of general dietary treatment design.</strong> Flies were reared on pre-experiment diet during development. At eclosion, flies were allocated to either HS or HY before midgut dissection at 5 days post eclosion.</p>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>img1A <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/1A.jpg&quot;</span>) </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig1A <span class="ot">=</span> <span class="fu">rasterGrob</span>(img1A)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig1A)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%201A-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-1b" class="section level3" number="1.1.2">
<h3 number="1.1.2"><span class="header-section-number">1.1.2</span> Figure 1B</h3>
<div class="blue">
<p><strong>Nutritional composition</strong> (proteins, carbohydrates, and lipids) of the two isocaloric diets used as a basis for this study as calories per liter of food: enriched in sugars (High sugar, HS) or yeast (High yeast, HY).</p>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>general_info_diet <span class="ot">=</span>d[[<span class="st">&quot;1B&quot;</span>]]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>general_info_diet <span class="ot">=</span> <span class="fu">mutate_if</span>(general_info_diet,is.character,as.factor)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>general_info_diet<span class="sc">$</span>Component <span class="ot">&lt;-</span> <span class="fu">factor</span>(general_info_diet<span class="sc">$</span>Component, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Lipids&quot;</span>,<span class="st">&quot;Proteins&quot;</span>,<span class="st">&quot;Carbohydrates&quot;</span>))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Lipids&quot;</span>,<span class="st">&quot;Proteins&quot;</span>,<span class="st">&quot;Carbohydrates&quot;</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>Labels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Lipids&quot;</span>,<span class="st">&quot;Proteins&quot;</span>,<span class="st">&quot;Carbohydrates&quot;</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>Plot_Fig1B<span class="ot">=</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(general_info_diet,<span class="fu">aes</span>(<span class="at">x=</span>Diet,<span class="at">y=</span>Calories.contributed))<span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>Component),<span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">width=</span>.<span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values=</span>palette_component_3,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>Labels)<span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>),</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Calories/L of food&quot;</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">650</span>,<span class="at">by=</span><span class="dv">200</span>),<span class="dv">696</span>))<span class="sc">+</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span>  <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(),</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(),</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="sc">-</span><span class="fl">0.3</span>),</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.margin=</span><span class="fu">margin</span>(<span class="at">t=</span><span class="sc">-</span><span class="fl">0.9</span>, <span class="at">r=</span><span class="sc">-</span><span class="dv">0</span>, <span class="at">b=</span><span class="sc">-</span><span class="dv">0</span>, <span class="at">l=</span><span class="sc">-</span><span class="dv">0</span>, <span class="at">unit=</span><span class="st">&quot;cm&quot;</span>),</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>xSmallfont),</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>,</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;transparent&quot;</span>))<span class="sc">+</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>Plot_Fig1B</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%201B-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-1c-d" class="section level3" number="1.1.3">
<h3 number="1.1.3"><span class="header-section-number">1.1.3</span> Figure 1C-D</h3>
<div class="blue">
<p>Canton S (Cs) flies fed on HS diet (C, first image) have shorter midguts than flies on HY (D, Second image). <em>Complete graphical annotation can be found in manuscript figures</em></p>
</div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%201C-1.png" width="768" style="display: block; margin: auto;" /></p>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%201D-1.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-1e" class="section level3" number="1.1.4">
<h3 number="1.1.4"><span class="header-section-number">1.1.4</span> Figure 1E</h3>
<div class="blue">
<p>Quantification of midgut length for HS vs HY at 5 days post eclosion.</p>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Length_HSHY <span class="ot">=</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;1E - 1S1A&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),<span class="sc">~</span>.<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Total_Length_mm=</span>Total.L,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">Total_width_mm=</span>Total.W,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">Day_of_treatment=</span>Day)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  Length_HSHY<span class="sc">%&gt;%</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>Averages <span class="ot">&lt;-</span> <span class="fu">summarise</span>(<span class="fu">group_by</span>(Length_HSHY, Diet), <span class="at">mean =</span> <span class="fu">mean</span>(Total_Length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Length_HSHY)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98954, p-value = 0.9657</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> Length_HSHY) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 0.64174, df = 1, p-value = 0.4231</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Length_HSHY) </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we make a tab with the results</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="st">&quot;HS vs HY&quot;</span>),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(Length_HSHY<span class="sc">$</span>Repeat),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">format</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:left;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS vs HY
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
1.45
</td>
<td style="text-align:left;">
0.266
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span> <span class="fu">max</span>(Length_HSHY<span class="sc">$</span>Total_Length_mm)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>Plot_Fig1E<span class="ot">=</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Length_HSHY, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">50</span>) <span class="sc">+</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">2.3</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">annotation =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,tab_stat<span class="sc">$</span>Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">y_position =</span> <span class="fl">7.3</span>, <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">tip_length =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.02</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>palette_diet_2)<span class="sc">+</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>),</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span>),</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>),</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">7</span>,<span class="at">by=</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">2</span>,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a><span class="co">#+</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a> <span class="co"># annotate(&quot;segment&quot;, x = 1, xend = 2, y = 7.2, yend = 7.2,</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>  <span class="co">#colour = &quot;black&quot;, size =1.5)</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>Plot_Fig1E</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%201E-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-1f" class="section level3" number="1.1.5">
<h3 number="1.1.5"><span class="header-section-number">1.1.5</span> Figure 1F</h3>
<div class="blue">
<p><strong>Midgut length response to diet is strongly variable across the DGRP</strong>, with HY being generally longer than HS (i.e. the ratio length on HY/length on HS is between 1 and 1.4).</p>
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tab_GWAS_gut_mean <span class="ot">=</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  tab_GWAS_gut<span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dgrp_number,diet)<span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_gut_length=</span><span class="fu">mean</span>(totallength,<span class="at">na.rm=</span>T))<span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(diet,mean_gut_length)<span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Mean_length_HS=</span>x,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Mean_length_HY=</span>y)<span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio =</span> Mean_length_HY<span class="sc">/</span>Mean_length_HS)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>tab_GWAS_gut_se <span class="ot">=</span> </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  tab_GWAS_gut<span class="sc">%&gt;%</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dgrp_number,diet)<span class="sc">%&gt;%</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">se_gut_length =</span> <span class="fu">se</span>(totallength))<span class="sc">%&gt;%</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(diet,se_gut_length)<span class="sc">%&gt;%</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">SE_length_HS=</span>x,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">SE_length_HY=</span>y)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>tab_GWAS_gut_mean<span class="ot">=</span> <span class="fu">left_join</span>(tab_GWAS_gut_mean,tab_GWAS_gut_se)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>colors<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span><span class="ot">=</span><span class="st">&quot;#FFB4B4&quot;</span>,<span class="st">&quot;HY&quot;</span><span class="ot">=</span><span class="st">&quot;#C3E6FC&quot;</span>,<span class="st">&quot;Ratio&quot;</span><span class="ot">=</span><span class="st">&quot;black&quot;</span>) </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>plot_ratio_DGRP<span class="ot">=</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tab_GWAS_gut_mean,<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(dgrp_number,Ratio))) <span class="sc">+</span> </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>Mean_length_HS<span class="sc">/</span><span class="dv">1000</span>,<span class="at">colour=</span><span class="st">&quot;HS&quot;</span>),<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">size=</span><span class="fl">0.7</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (Mean_length_HS<span class="sc">+</span> SE_length_HS)<span class="sc">/</span><span class="dv">1000</span> , <span class="at">ymin =</span> (Mean_length_HS <span class="sc">-</span> SE_length_HS)<span class="sc">/</span><span class="dv">1000</span> ,<span class="at">colour=</span><span class="st">&quot;HS&quot;</span>),<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">show.legend=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>Mean_length_HY<span class="sc">/</span><span class="dv">1000</span>,<span class="at">colour=</span><span class="st">&quot;HY&quot;</span>),<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">size=</span><span class="fl">0.7</span>,<span class="at">shape=</span><span class="dv">16</span>)<span class="sc">+</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> (Mean_length_HY<span class="sc">+</span> SE_length_HY)<span class="sc">/</span><span class="dv">1000</span> , <span class="at">ymin =</span> (Mean_length_HY <span class="sc">-</span> SE_length_HY)<span class="sc">/</span><span class="dv">1000</span> ,<span class="at">colour=</span><span class="st">&quot;HY&quot;</span>),<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">show.legend=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>Ratio<span class="sc">*</span><span class="fl">3.9</span>,<span class="at">colour=</span><span class="st">&quot;Ratio&quot;</span>),<span class="at">shape=</span><span class="dv">17</span>,<span class="at">size=</span><span class="fl">0.7</span>)<span class="sc">+</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fl">3.9</span>,<span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)</span><span class="sc">\n</span><span class="st"> [mean \u00B1 se]&quot;</span>,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="fl">7.2</span>),</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="fl">3.9</span>, <span class="at">name =</span> <span class="st">&quot;Ratio (HY/HS)&quot;</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.8</span>,<span class="fl">1.8</span>,<span class="fl">0.2</span>)))<span class="sc">+</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;DGRP lines&quot;</span>,<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.03</span>,<span class="fl">0.03</span>))<span class="sc">+</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors )<span class="sc">+</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>        (<span class="at">panel.border =</span> <span class="fu">element_blank</span>()),</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>, </span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.98</span>),</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont),</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))<span class="sc">+</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>plot_ratio_DGRP</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%201F-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>list_lines <span class="ot">=</span> <span class="fu">unique</span>(tab_GWAS_gut<span class="sc">$</span>dgrp_id)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>Tab <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> list_lines){</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  tmp<span class="ot">=</span> <span class="fu">subset</span>(tab_GWAS_gut,dgrp_id<span class="sc">==</span>i)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>sample_size<span class="ot">=</span> tmp <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(diet)<span class="sc">%&gt;%</span><span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>())</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>test<span class="ot">=</span> <span class="fu">t.test</span>(totallength<span class="sc">~</span>diet ,<span class="at">data=</span>tmp)  </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>Tab <span class="ot">=</span> <span class="fu">rbind</span>(Tab, <span class="fu">c</span>(i,test<span class="sc">$</span>parameter,test<span class="sc">$</span>statistic,test<span class="sc">$</span>p.value,test<span class="sc">$</span>estimate,sample_size[<span class="dv">1</span>,<span class="dv">2</span>],sample_size[<span class="dv">2</span>,<span class="dv">2</span>]))</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Tab)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Line&quot;</span>,<span class="st">&quot;df&quot;</span>,<span class="st">&quot;t&quot;</span>,<span class="st">&quot;Pvalue&quot;</span>,<span class="st">&quot;Mean_HS&quot;</span>,<span class="st">&quot;Mean_HY&quot;</span>,<span class="st">&quot;Sample_size_HS&quot;</span>,<span class="st">&quot;Sample_size_HY&quot;</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>Tab <span class="ot">=</span> <span class="fu">as.data.frame</span>(Tab)<span class="sc">%&gt;%</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pvalue=</span><span class="fu">as.numeric</span>(Pvalue),</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">Mean_HS =</span><span class="fu">as.numeric</span>(Mean_HS),</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">Mean_HY =</span><span class="fu">as.numeric</span>(Mean_HY),</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">Difference =</span> Mean_HY<span class="sc">-</span>Mean_HS )</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>Tab<span class="sc">$</span>Pv_adjust <span class="ot">=</span> <span class="fu">p.adjust</span>(Tab<span class="sc">$</span>Pvalue,<span class="at">method =</span> <span class="st">&quot;BH&quot;</span>) <span class="co"># Here I control </span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(Tab<span class="sc">$</span>Pv_adjust<span class="sc">&gt;</span><span class="fl">0.05</span>))</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 56 lines have no significant difference in size between diets</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(Tab<span class="sc">$</span>Pv_adjust<span class="sc">&lt;=</span><span class="fl">0.05</span>))</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co">#132 lines have a significant difference in size between diets</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>Tab_sign <span class="ot">=</span> <span class="fu">subset</span>(Tab,Pv_adjust<span class="sc">&lt;=</span><span class="fl">0.05</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(Tab_sign<span class="sc">$</span>Difference<span class="sc">&lt;=</span><span class="dv">0</span>))</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 line was significantly smaller on HY</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(Tab_sign<span class="sc">$</span>Difference<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 132 lines (i.e. all of those that were different) were significantly larger on HY</span></span></code></pre></div>
</div>
<div id="figure-1g" class="section level3" number="1.1.6">
<h3 number="1.1.6"><span class="header-section-number">1.1.6</span> Figure 1G</h3>
<div class="blue">
<p><strong>Midgut re-sizing is allometric between regions of the midgut.</strong> Posterior midguts of flies fed HY exhibit a greater increase than anterior regions.</p>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>tab_GWAS_gut<span class="ot">=</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  tab_GWAS_gut<span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">allometry=</span>posteriorlength<span class="sc">/</span>anteriorlength)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>tab_GWAS_gut_allometry_mean<span class="ot">=</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  tab_GWAS_gut<span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(diet,dgrp_number)<span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_allometry=</span><span class="fu">mean</span>(allometry,<span class="at">na.rm=</span>T))</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  tab_GWAS_gut_allometry_mean<span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(diet)<span class="sc">%&gt;%</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(mean_allometry <span class="sc">~</span>  diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> dgrp_number) , <span class="at">data =</span> tab_GWAS_gut_allometry_mean)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.9809, p-value = 7.05e-05</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(mean_allometry <span class="sc">~</span> diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> dgrp_number) , <span class="at">data =</span> tab_GWAS_gut_allometry_mean) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  mean_allometry ~ diet + (1/dgrp_number)
BP = 0.051149, df = 1, p-value = 0.8211</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(mean_allometry <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> dgrp_number), <span class="at">data =</span> tab_GWAS_gut_allometry_mean) </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we make a tab with the results</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY&quot;</span>)),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="dv">1</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;mean_allometry ~  diet + (1 | dgrp_number)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
mean_allometry ~ diet + (1 | dgrp_number)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS vs HY
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
128.95
</td>
<td style="text-align:left;">
0.861
</td>
<td style="text-align:left;">
0.101
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>Plot_Fig1G<span class="ot">=</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_GWAS_gut_allometry_mean, <span class="fu">aes</span>(diet,mean_allometry, <span class="at">group=</span>dgrp_number,<span class="at">color=</span>diet)) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size=</span><span class="fl">0.3</span>,<span class="at">color=</span><span class="fu">grey</span>(<span class="fl">0.65</span>))<span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape=</span><span class="dv">16</span>,<span class="at">size=</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Posterior / anterior length&quot;</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">1.4</span>),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="fu">c</span>(<span class="fu">seq</span>(<span class="fl">0.5</span>,<span class="fl">1.4</span>,<span class="at">by=</span><span class="fl">0.1</span>))))<span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>palette_diet_2)<span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label=</span><span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,tab_stat<span class="sc">$</span>Pvalue,<span class="at">sep=</span><span class="st">&quot;&quot;</span>), <span class="at">x=</span> <span class="fl">1.5</span>, <span class="at">y=</span><span class="fl">1.4</span>,<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),<span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;yellow&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">23</span>) <span class="sc">+</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">geom=</span><span class="st">&quot;line&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),<span class="at">size=</span><span class="dv">1</span>,<span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont),</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont),</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>())</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>Plot_Fig1G</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%201G-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>##Export Figure 1</p>
</div>
</div>
<div id="figure-1---figure-supplement-1" class="section level2" number="1.2">
<h2 number="1.2"><span class="header-section-number">1.2</span> Figure 1 - figure supplement 1</h2>
<div id="figure-1s1a" class="section level3" number="1.2.1">
<h3 number="1.2.1"><span class="header-section-number">1.2.1</span> Figure 1S1A</h3>
<div class="blue">
<p>Canton S (Cs) flies fed HS diet have narrower midguts than those fed HY diet. Width was measured in three point along the gut (Region 2, 3 and 4, as visible in the yellow annotation in Figure 1C,D) and the sum of these three measurement was used as proxy for midgut width. Measurements are from the same guts as in Figure 1E</p>
</div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>Length_HSHY <span class="ot">=</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;1E - 1S1A&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),<span class="sc">~</span>.<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Total_Length_mm=</span>Total.L,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Total_width_mm=</span>Total.W,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Day_of_treatment=</span>Day)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  Length_HSHY<span class="sc">%&gt;%</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_width_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Length_HSHY)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.95797, p-value = 0.1335</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_width_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> Length_HSHY) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_width_mm) ~ Diet + (1/Repeat)
BP = 0.17388, df = 1, p-value = 0.6767</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_width_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Length_HSHY) </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we make a tab with the results</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY&quot;</span>)),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Length_HSHY<span class="sc">$</span>Repeat),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_width_mm) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_width_mm) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS vs HY
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
55.48
</td>
<td style="text-align:left;">
-0.754
</td>
<td style="text-align:left;">
0.374
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(Length_HSHY<span class="sc">$</span>Total_width_mm)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>Plot_Fig1S1A<span class="ot">=</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Length_HSHY, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_width_mm))<span class="sc">+</span> </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">50</span>) <span class="sc">+</span> </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">0.25</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">annotation =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,tab_stat<span class="sc">$</span>Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">y_position =</span> <span class="fl">0.93</span>, <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">tip_length =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.02</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>palette_diet_2)<span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>),</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut width (mm)&quot;</span>,</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.2</span>,<span class="dv">1</span>),</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="fl">0.2</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>,<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="fu">aes</span>(<span class="at">group=</span>Repeat)) <span class="sc">+</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>,<span class="fu">aes</span>(<span class="at">group=</span>Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>palette_mean)<span class="sc">+</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>Plot_Fig1S1A</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%201S1A-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-1s1b" class="section level3" number="1.2.2">
<h3 number="1.2.2"><span class="header-section-number">1.2.2</span> Figure 1S1B</h3>
<div class="blue">
<p>Length of midguts on HY diet is similar to standard diets used in the field (Bloomington [Bl] cornmeal and Bl molasses).</p>
</div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>tab_stddiets_rev <span class="ot">=</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;1 - S1B&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm =</span>Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sugar=</span><span class="fu">fct_relevel</span>(Diet,<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>, <span class="st">&quot;BL Cornmeal&quot;</span>, <span class="st">&quot;BL Molasses&quot;</span>))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  tab_stddiets_rev<span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>((Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_stddiets_rev)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96479, p-value = 0.00686</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>((Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tab_stddiets_rev) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  (Total_Length_mm) ~ Diet + (1/Repeat)
BP = 1.7773, df = 3, p-value = 0.6199</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>((Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_stddiets_rev) </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we make a tab with the results</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Anova diets&quot;</span>)),</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_stddiets_rev<span class="sc">$</span>Repeat),</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;(Total_Length_mm) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
(Total_Length_mm) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Anova diets
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
53.44
</td>
<td style="text-align:left;">
5.07
</td>
<td style="text-align:left;">
0.435
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">lmer</span>(Total_Length_mm <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_stddiets_rev)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>multcomp <span class="ot">=</span> <span class="fu">glht</span>(mod.gen, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Diet=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">cld</span>(multcomp)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>letter_position <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span>tab_stddiets_rev,Total_Length_mm <span class="sc">~</span> Diet, max)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span>  <span class="fu">as.data.frame</span>(tmp<span class="sc">$</span>mcletters<span class="sc">$</span>Letters)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>tab_letter<span class="sc">$</span>Diet<span class="ot">=</span><span class="fu">rownames</span>(tab_letter)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_letter)[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">&quot;Letter&quot;</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span> <span class="fu">left_join</span>(tab_letter,letter_position)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>, <span class="st">&quot;BL Cornmeal&quot;</span>, <span class="st">&quot;BL Molasses&quot;</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>Labels <span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>, <span class="st">&quot;Bl cornmeal&quot;</span>, <span class="st">&quot;Bl molasses&quot;</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;#FFB4B4&quot;</span>,<span class="st">&quot;#C3E6FC&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(tab_stddiets_rev<span class="sc">$</span>Total_Length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>Plot_Fig1S1B<span class="ot">=</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_stddiets_rev, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">35</span>) <span class="sc">+</span> </span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">1.8</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_stat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> <span class="fl">7.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,<span class="fu">format</span>(Pvalue,<span class="at">digits=</span><span class="dv">2</span>))),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_letter, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm<span class="fl">+0.6</span>, <span class="at">label =</span> Letter),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits,</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>cbbPalette)<span class="sc">+</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span>Limits,</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span>Labels)<span class="sc">+</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">1.6</span>,<span class="dv">8</span>),</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">7</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>Plot_Fig1S1B</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%201S1B-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-1s1c" class="section level3" number="1.2.3">
<h3 number="1.2.3"><span class="header-section-number">1.2.3</span> Figure 1S1C</h3>
<div class="blue">
<p><strong>Un-mated females and mated males have lower response to diet compared to mated female flies.</strong> Statistics: comparison of the interaction between diet and mating status/sex. <em>Full annotation on figure present in manuscript</em></p>
</div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>tab_MUmM_rev <span class="ot">=</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;1 - S1C&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm=</span>Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment=</span><span class="fu">fct_relevel</span>(Treatment,<span class="fu">c</span>(<span class="st">&quot;Mated females&quot;</span>,<span class="st">&quot;Un-mated females&quot;</span>,<span class="st">&quot;Males&quot;</span>)))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  tab_MUmM_rev<span class="sc">%&gt;%</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Treatment)<span class="sc">%&gt;%</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Un-mated</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_MUmM_rev, Treatment<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Mated females&quot;</span>,<span class="st">&quot;Un-mated females&quot;</span>))</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>((Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">*</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98312, p-value = 0.2426</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>((Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  (Total_Length_mm) ~ Diet + Treatment + (1/Repeat)
BP = 0.27838, df = 2, p-value = 0.8701</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>((Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Treatment =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Mated vs Un-mated females&quot;</span>)),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">1</span>,<span class="at">scientific=</span>F)))</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>tab_stat_Un_mated<span class="ot">=</span>tab_stat</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Male</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_MUmM_rev, Treatment<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Mated females&quot;</span>,<span class="st">&quot;Males&quot;</span>))</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">*</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.97901, p-value = 0.115</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + Treatment + (1/Repeat)
BP = 6.2807, df = 2, p-value = 0.04327</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Treatment =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Mated vs Males&quot;</span>)),</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">1</span>,<span class="at">scientific=</span>F)))</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>tab_stat_Male<span class="ot">=</span>tab_stat</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_Male,tab_stat_Un_mated)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.009</span>, <span class="st">&quot;*&quot;</span>, <span class="co">#changed to 0.009 because Un-mated is exactle 0.01</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + Treatment + Diet : Treatment + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + Treatment + Diet : Treatment + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mated vs Males
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
23.35
</td>
<td style="text-align:left;">
1.46
</td>
<td style="text-align:left;">
0.229
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1e-06
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Mated vs Un-mated females
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6.57
</td>
<td style="text-align:left;">
4.35
</td>
<td style="text-align:left;">
1.11
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1e-02
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
</tbody>
</table></li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>Treatment <span class="ot">=</span> <span class="fu">as.factor</span>(tab_stat<span class="sc">$</span>Treatment)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>tab</span></code></pre></div>
<pre><code>Error in eval(expr, envir, enclos): objet &#39;tab&#39; introuvable</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>tab_stat_1S1C<span class="ot">=</span>tab_stat</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>Plot_Fig1S1C<span class="ot">=</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_MUmM_rev, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">1.7</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Treatment)<span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>palette_diet_2)<span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">1.5</span>,<span class="dv">8</span>),</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">6</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>Plot_Fig1S1C</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%201S1C-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-1s1d" class="section level3" number="1.2.4">
<h3 number="1.2.4"><span class="header-section-number">1.2.4</span> Figure 1S1D</h3>
<div class="blue">
<p><strong>Feeding assay shows higher dietary intake on HS than on HY diet.</strong> Absorbance measured after 1 day of assay, each day along a 5-day period from eclosion, for a total of 5 times per condition/repeat</p>
</div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>Tab_absorbance <span class="ot">=</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;1 - S1D&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Diet=</span>Food)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  Tab_absorbance<span class="sc">%&gt;%</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(Absorbance <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Tab_absorbance)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.91089, p-value = 0.01567</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(Absorbance <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> Tab_absorbance) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  Absorbance ~ Diet + (1/Repeat)
BP = 5.6989, df = 1, p-value = 0.01698</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(Absorbance <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Tab_absorbance) </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we make a tab with the results</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY&quot;</span>)),</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Tab_absorbance<span class="sc">$</span>Repeat),</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;Absorbance ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Absorbance ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS vs HY
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
30.71
</td>
<td style="text-align:left;">
0.404
</td>
<td style="text-align:left;">
-0.256
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Plot</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(Tab_absorbance<span class="sc">$</span>Absorbance)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>Plot_Fig1S1D<span class="ot">=</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Tab_absorbance, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Absorbance))<span class="sc">+</span> </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">0.02</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">annotation =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,tab_stat<span class="sc">$</span>Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">y_position =</span> <span class="fl">0.58</span>, <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">tip_length =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.02</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits,</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>palette_diet_2)<span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>),</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Absorbance&quot;</span>,</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="at">by=</span><span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>,<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="fu">aes</span>(<span class="at">group=</span>Repeat)) <span class="sc">+</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>,<span class="fu">aes</span>(<span class="at">group=</span>Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>palette_mean)<span class="sc">+</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))</span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a>Plot_Fig1S1D</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%201S1D-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-1s1e" class="section level3" number="1.2.5">
<h3 number="1.2.5"><span class="header-section-number">1.2.5</span> Figure 1S1E</h3>
<div class="blue">
<p><strong>Microbes are not required for the difference in size observed between HS and HY fed flies.</strong> Germ-free flies exhibit similar diet-induced increase in size as conventionally reared flies at both 7- and 14-days post eclosion (statistics: comparison of the interaction between diets and conv. reared/germ free treatment). Of note, at 7-days post eclosion we observed longer guts in germ free flies compared to conventionally reared flies (significant on HS diet). This difference was lost at 14-days post eclosion (Post hoc Tukey test from GLMM summarized by letter at the bottom of chart). <em>Full statistical annotation on figure present in manuscript</em></p>
</div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>Length_HSHY_germfree <span class="ot">=</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;1 - S1E&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),<span class="sc">~</span>.<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Total_Length_mm=</span>Total.L,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Day_of_treatment=</span>Day)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  Length_HSHY_germfree<span class="sc">%&gt;%</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Treatment, Day_of_treatment)<span class="sc">%&gt;%</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="sc">$</span>Sample_size <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Sample_size<span class="sc">$</span>Sample_size)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats Day 7 interaction</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>Length_HSHY_germfree_Day7 <span class="ot">=</span> <span class="fu">subset</span>(Length_HSHY_germfree, Day_of_treatment <span class="sc">==</span> <span class="st">&quot;7&quot;</span>)</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Treatment <span class="sc">+</span> Diet <span class="sc">:</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Length_HSHY_germfree_Day7)</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98828, p-value = 0.5513</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet  <span class="sc">+</span> Treatment <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> Length_HSHY_germfree_Day7) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + Treatment + (1/Repeat)
BP = 5.3166, df = 2, p-value = 0.07007</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Length_HSHY_germfree_Day7) </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we make a tab with the results</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>tab_stat7 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Response to diet Day7&quot;</span>)),</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">as.numeric</span>(<span class="fu">nlevels</span>(Length_HSHY_germfree_Day7<span class="sc">$</span>Repeat)),</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">4</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>tab_stat7<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat7<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat7<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat7<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat7<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat7<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>tab_stat7<span class="sc">%&gt;%</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Response to diet Day7&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + Treatment + Diet : Treatment + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + Treatment + Diet : Treatment + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Response to diet Day7
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Response to diet Day7
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:left;">
1.35
</td>
<td style="text-align:left;">
-0.015
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.7
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>tab_stat_int_GF7<span class="ot">=</span>tab_stat7</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats Day 14 interaction</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>Length_HSHY_germfree_Day14 <span class="ot">=</span> <span class="fu">subset</span>(Length_HSHY_germfree, Day_of_treatment <span class="sc">==</span> <span class="st">&quot;14&quot;</span>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Treatment <span class="sc">+</span> Diet <span class="sc">:</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Length_HSHY_germfree_Day14)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98625, p-value = 0.4111</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet  <span class="sc">+</span> Treatment <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> Length_HSHY_germfree_Day14) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + Treatment + (1/Repeat)
BP = 0.62752, df = 2, p-value = 0.7307</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Length_HSHY_germfree_Day14) </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we make a tab with the results</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>tab_stat14 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Response to diet Day14&quot;</span>)),</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">as.numeric</span>(<span class="fu">nlevels</span>(Length_HSHY_germfree_Day14<span class="sc">$</span>Repeat)),</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">4</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>tab_stat14<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat14<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat14<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat14<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat14<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat14<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>tab_stat14<span class="sc">%&gt;%</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Response to diet Day14&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + Treatment + Diet : Treatment + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + Treatment + Diet : Treatment + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Response to diet Day14
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Response to diet Day14
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3.75
</td>
<td style="text-align:left;">
1.29
</td>
<td style="text-align:left;">
-0.0976
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.053
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>tab_stat_int_GF14<span class="ot">=</span>tab_stat14</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Model including all samples and Post HOC test</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>Length_HSHY_germfree<span class="sc">$</span>Treat_Diet_Day <span class="ot">=</span> <span class="fu">as.factor</span>(<span class="fu">paste</span>(Length_HSHY_germfree<span class="sc">$</span>Treatment, Length_HSHY_germfree<span class="sc">$</span>Diet, Length_HSHY_germfree<span class="sc">$</span>Day_of_treatment, <span class="at">sep=</span><span class="st">&quot;_&quot;</span>))</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">lmer</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Treat_Diet_Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Length_HSHY_germfree)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.99294, p-value = 0.4774</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Treat_Diet_Day <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span> Repeat), <span class="at">data =</span> Length_HSHY_germfree)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Treat_Diet_Day + (1/Repeat)
BP = 16.062, df = 7, p-value = 0.02455</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>multcomp <span class="ot">=</span> <span class="fu">glht</span>(mod.gen, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Treat_Diet_Day=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">cld</span>(multcomp)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>letter_position <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span>Length_HSHY_germfree,Total_Length_mm <span class="sc">~</span> Treat_Diet_Day, min)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span>  <span class="fu">as.data.frame</span>(tmp<span class="sc">$</span>mcletters<span class="sc">$</span>Letters)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>tab_letter<span class="sc">$</span>Treat_Diet_Day<span class="ot">=</span><span class="fu">rownames</span>(tab_letter)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_letter)[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">&quot;Letter&quot;</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span> <span class="fu">left_join</span>(tab_letter,letter_position)</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>tab_letter<span class="sc">$</span>Treat_Diet_Day<span class="ot">=</span> <span class="fu">as.factor</span>(tab_letter<span class="sc">$</span>Treat_Diet_Day)</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>tab_letter<span class="sc">$</span>Day_of_treatment <span class="ot">=</span> <span class="fu">as.factor</span>(<span class="fu">mid</span>(tab_letter<span class="sc">$</span>Treat_Diet_Day,<span class="dv">7</span>, <span class="dv">2</span>))</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>tab_letter<span class="sc">$</span>Diet <span class="ot">=</span> <span class="fu">as.factor</span>(<span class="fu">mid</span>(tab_letter<span class="sc">$</span>Treat_Diet_Day, <span class="dv">4</span>,<span class="dv">2</span>))</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>tab_letter<span class="sc">$</span>Treatment <span class="ot">=</span> <span class="fu">as.factor</span>(<span class="fu">left</span>(tab_letter<span class="sc">$</span>Treat_Diet_Day, <span class="dv">2</span>))</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>)</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span> <span class="fu">max</span>(Length_HSHY_germfree<span class="sc">$</span>Total_Length_mm)</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>Treatment.status <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Conv. reared&quot;</span>, <span class="st">&quot;Germ free&quot;</span>)</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Treatment.status) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;CR&quot;</span>, <span class="st">&quot;GF&quot;</span>)</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>Plot_Fig1S1E<span class="ot">=</span></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Length_HSHY_germfree, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_letter, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm<span class="fl">-0.4</span>, <span class="at">label =</span> Letter),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Day_of_treatment<span class="sc">~</span>Treatment,<span class="at">labeller=</span><span class="fu">labeller</span>(<span class="at">Treatment=</span>Treatment.status), <span class="at">nrow =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">1.35</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits,</span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>palette_diet_2)<span class="sc">+</span></span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>),</span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">8</span>),</span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>,<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="fu">aes</span>(<span class="at">group=</span>Repeat)) <span class="sc">+</span></span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>,<span class="fu">aes</span>(<span class="at">group=</span>Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">geom=</span><span class="st">&quot;line&quot;</span>,<span class="fu">aes</span>(<span class="at">group=</span>Repeat))<span class="sc">+</span></span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>palette_mean)<span class="sc">+</span></span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb65-54"><a href="#cb65-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb65-55"><a href="#cb65-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb65-56"><a href="#cb65-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb65-57"><a href="#cb65-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb65-58"><a href="#cb65-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb65-59"><a href="#cb65-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb65-60"><a href="#cb65-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb65-61"><a href="#cb65-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb65-62"><a href="#cb65-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb65-63"><a href="#cb65-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb65-64"><a href="#cb65-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb65-65"><a href="#cb65-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb65-66"><a href="#cb65-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb65-67"><a href="#cb65-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb65-68"><a href="#cb65-68" aria-hidden="true" tabindex="-1"></a>Plot_Fig1S1E</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%201S1E-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>##Export Figure S1</p>
</div>
</div>
<div id="figure-1---figure-supplement-2" class="section level2" number="1.3">
<h2 number="1.3"><span class="header-section-number">1.3</span> Figure 1 - figure supplement 2</h2>
<div id="figure-1s2a" class="section level3" number="1.3.1">
<h3 number="1.3.1"><span class="header-section-number">1.3.1</span> Figure 1S2A</h3>
<div class="blue">
<p><strong>Scheme depicting regional organization of the gut.</strong> The gut comprises three main anatomical regions: foregut (comprising the crop), midgut and hindgut. The midgut itself can be divided in anterior (blue), middle (green) and posterior (purple). Additional subregions have been described (Buchon et al., 2013; Marianes and Spradling, 2013).</p>
</div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a> img1S2A <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/1- S2A.jpg&quot;</span>) </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a> gob_imageFig1S2A <span class="ot">=</span> <span class="fu">rasterGrob</span>(img1S2A)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">grid.draw</span>(gob_imageFig1S2A)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%201S2A-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-1s2b" class="section level3" number="1.3.2">
<h3 number="1.3.2"><span class="header-section-number">1.3.2</span> Figure 1S2B</h3>
<div class="blue">
<p>All regions of the midgut (x-axis) respond variably to diet composition, but the response of the posterior midgut length more closely reflects the response of the total midgut length. Red lines represent linear regression and black dashed lines are the lines of equivalence.</p>
</div>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>tab_GWAS_gut<span class="sc">$</span>dgrpDiet <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">paste</span>(tab_GWAS_gut<span class="sc">$</span>dgrp_id, tab_GWAS_gut<span class="sc">$</span>diet), <span class="at">ordered=</span>T)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>meansMat <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="fu">as.matrix</span>(tab_GWAS_gut[,<span class="fu">c</span>(<span class="st">&quot;anteriorlength&quot;</span>, <span class="st">&quot;middlelength&quot;</span>, <span class="st">&quot;posteriorlength&quot;</span>,  <span class="st">&quot;totallength&quot;</span>)]) <span class="sc">~</span> diet <span class="sc">*</span> dgrp_id, tab_GWAS_gut, mean)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(meansMat) <span class="ot">=</span> <span class="fu">paste</span>(meansMat<span class="sc">$</span>dgrp_id, meansMat<span class="sc">$</span>diet, <span class="at">sep=</span><span class="st">&quot;_&quot;</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(meansMat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;diet&quot;</span>,<span class="st">&quot;dgrp_id&quot;</span>, <span class="st">&quot;Anterior Length&quot;</span>, <span class="st">&quot;Middle Length&quot;</span>, <span class="st">&quot;Posterior Length&quot;</span>, <span class="st">&quot;Total Length&quot;</span>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>meansMatX <span class="ot">=</span> <span class="fu">subset</span>(meansMat, diet<span class="sc">==</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>meansMatY <span class="ot">=</span> <span class="fu">subset</span>(meansMat, diet<span class="sc">==</span><span class="st">&quot;y&quot;</span>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(meansMatX<span class="sc">$</span>dgrp_id <span class="sc">==</span> meansMatY<span class="sc">$</span>dgrp_id)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>meansMatX <span class="ot">=</span> meansMatX[,<span class="sc">!</span><span class="fu">colnames</span>(meansMatX) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;dgrp_id&quot;</span>, <span class="st">&quot;diet&quot;</span>)]</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>meansMatY <span class="ot">=</span> meansMatY[,<span class="sc">!</span><span class="fu">colnames</span>(meansMatY) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;dgrp_id&quot;</span>, <span class="st">&quot;diet&quot;</span>)]</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>meansMatY<span class="ot">=</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>meansMatY <span class="sc">%&gt;%</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">str_to_sentence</span>(<span class="fu">names</span>(.)))</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>meansMatX<span class="ot">=</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>meansMatX <span class="sc">%&gt;%</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">str_to_sentence</span>(<span class="fu">names</span>(.)))</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>RIs <span class="ot">&lt;-</span> meansMatY <span class="sc">/</span> meansMatX</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>RIs <span class="ot">&lt;-</span> RIs[,<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;width&quot;</span>, <span class="fu">colnames</span>(RIs))]</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>plotRegress <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y, datRange, textCex, ...){</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>    regn <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">xlim=</span>datRange, <span class="at">ylim=</span>datRange, ...)</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">alpha</span>(<span class="dv">1</span>, <span class="fl">0.5</span>), <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">a=</span><span class="fu">coef</span>(regn)[<span class="dv">1</span>], <span class="at">b=</span><span class="fu">coef</span>(regn)[<span class="dv">2</span>],<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>    val<span class="ot">=</span><span class="fu">round</span>(<span class="fu">summary</span>(regn)<span class="sc">$</span>adj.r.squared, <span class="dv">1</span>)</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="at">y=</span><span class="fu">max</span>(datRange), <span class="at">x=</span><span class="fu">min</span>(datRange), </span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="fu">bquote</span>(R<span class="sc">^</span><span class="dv">2</span> <span class="sc">~</span><span class="st">&quot;=&quot;</span><span class="sc">~</span> .(val)), <span class="at">adj=</span><span class="dv">0</span>, <span class="at">cex=</span>textCex)</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="at">y=</span><span class="fu">max</span>(datRange) <span class="sc">-</span> (<span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">diff</span>(<span class="fu">range</span>(RIs))), <span class="at">x=</span><span class="fu">min</span>(datRange), </span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="fu">paste</span>(<span class="st">&quot;p =&quot;</span>, <span class="fu">signif</span>(<span class="fu">summary</span>(regn)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">4</span>], <span class="dv">2</span>)), <span class="at">adj=</span><span class="dv">0</span>, <span class="at">cex=</span>textCex)</span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="at">y=</span><span class="fu">max</span>(datRange) <span class="sc">-</span> (<span class="fl">0.2</span> <span class="sc">*</span> <span class="fu">diff</span>(<span class="fu">range</span>(RIs))), <span class="at">x=</span><span class="fu">min</span>(datRange), </span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="fu">paste</span>(<span class="st">&quot;y = &quot;</span>, <span class="fu">signif</span>(<span class="fu">coef</span>(regn)[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&quot;x&quot;</span>, <span class="st">&quot; + &quot;</span>, <span class="fu">signif</span>(<span class="fu">coef</span>(regn)[<span class="dv">1</span>], <span class="dv">2</span>), <span class="at">sep=</span><span class="st">&quot;&quot;</span>), <span class="at">adj=</span><span class="dv">0</span>, <span class="at">cex=</span>textCex)</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="at">filename =</span>  <span class="st">&quot;Plot_Fig1S2B.jpeg&quot;</span>,</span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">res =</span> <span class="dv">300</span>,</span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span> )</span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a> <span class="fu">par</span>(<span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">cex.main=</span><span class="fl">1.4</span>, <span class="at">cex.lab=</span><span class="fl">1.4</span>, <span class="at">cex.axis=</span><span class="fl">1.4</span>)</span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a> <span class="fu">plotRegress</span>(<span class="at">x=</span>RIs[,i], <span class="at">y=</span>RIs[,<span class="dv">4</span>], <span class="at">xlab=</span><span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">&quot;Anterior&quot;</span>, <span class="st">&quot;Middle&quot;</span>, <span class="st">&quot;Posterior&quot;</span>)[i], <span class="st">&quot;HY length / HS length&quot;</span>), <span class="at">ylab=</span><span class="st">&quot;Total HY length / HS length&quot;</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">0.75</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">datRange=</span><span class="fu">range</span>(RIs), <span class="at">las=</span><span class="dv">1</span>, <span class="at">asp =</span><span class="dv">1</span>, <span class="at">textCex=</span><span class="fl">1.4</span>)</span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a> } </span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a> img1S2B <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/Plot_Fig1S2B.jpeg&quot;</span>) </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a> gob_imageFig1S2B <span class="ot">=</span> <span class="fu">rasterGrob</span>(img1S2B)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">grid.draw</span>(gob_imageFig1S2B)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%201S2B-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>##Export Figure 1S2</p>
</div>
</div>
<div id="figure-1---figure-supplement-3" class="section level2" number="1.4">
<h2 number="1.4"><span class="header-section-number">1.4</span> Figure 1 - figure supplement 3</h2>
<div id="figure-1s3a" class="section level3" number="1.4.1">
<h3 number="1.4.1"><span class="header-section-number">1.4.1</span> Figure 1S3A</h3>
<div class="blue">
<p>Variation in impact of diet on midgut length in the DGRP maps to genes with functions connected to epithelial turnover. The Manhattan plot summarizes the p-value per chromosomal locus (grey bars) associated with GWAS analysis. Highlighted genes have been selected based on their statistical significance, their function, and the effect of the genetic variation (e.g. non-synonymous mutation, etc.).</p>
</div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>img1S3A <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/1 - S3.jpg&quot;</span>) </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig1S3A <span class="ot">=</span> <span class="fu">rasterGrob</span>(img1S3A)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig1S3A)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%201S3A-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>##Export Figure</p>
</div>
</div>
</div>
<div id="figure-2.-sugar-antagonizes-yeast-induced-increase-of-midgut-length" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Figure 2. Sugar antagonizes yeast-induced increase of midgut length</h1>
<div id="figure-2---main" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Figure 2 - main</h2>
<div id="figure-2a" class="section level3" number="2.1.1">
<h3 number="2.1.1"><span class="header-section-number">2.1.1</span> Figure 2A</h3>
<div class="blue">
<p><strong>Midgut length is maximized at specific points in diet space.</strong> Adult flies were maintained for 5 days from eclosion on one of 28 diets based on different caloric concentration and yeast to sucrose ratios (see figure 1-figure supplement 1A for scheme on diets used and sample size). The list of recipes can be found in Table1. The figure shows contours of a thin-plate spline (Generalized Additive Model) of length (mm, coded by colors) as a function of yeast and sucrose in diet. Colored dots represent mean of samples in a particular diet.</p>
</div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>tab_nutri_geo <span class="ot">=</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;2A&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Total.Lmm =</span> Total.L <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>tab_nutri_geo<span class="sc">$</span>YSdiet <span class="ot">&lt;-</span> <span class="fu">with</span>(tab_nutri_geo, (Yeast.in.Diet)<span class="sc">/</span>(Sucrose.in.Diet))</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    tab_nutri_geo<span class="sc">$</span>YSingested <span class="ot">&lt;-</span> <span class="fu">with</span>(tab_nutri_geo, (Yeast.ingested)<span class="sc">/</span>(Sucrose.ingested))</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="at">filename =</span>  <span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/Plot_Fig2A.jpeg&quot;</span>,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">res =</span> <span class="dv">600</span>,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span> )</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex=</span><span class="dv">1</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">4.5</span>, <span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(tab_nutri_geo, <span class="fu">geomPlotta</span>(<span class="at">x =</span> Sucrose.in.Diet, <span class="at">y =</span> Yeast.in.Diet, <span class="at">z =</span> Total.Lmm, <span class="at">alf =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">300</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">300</span>), <span class="at">xlab =</span> <span class="st">&quot;Sucrose in diet (g/L)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Yeast in diet (g/L)&quot;</span>, <span class="at">frame.plot=</span> <span class="cn">FALSE</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">cex.axis =</span><span class="dv">1</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">labcex=</span><span class="dv">1</span>, <span class="at">asp=</span><span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>img2A <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/Plot_Fig2A.jpeg&quot;</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig2A <span class="ot">=</span> <span class="fu">rasterGrob</span>(img2A)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig2A)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%202A-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-2b" class="section level3" number="2.1.2">
<h3 number="2.1.2"><span class="header-section-number">2.1.2</span> Figure 2B</h3>
<div class="blue">
<p>Plot show an increase in midgut length with increased amount of yeast ingested.</p>
</div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>tab_nutri_geo <span class="ot">=</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;2A&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Total.Lmm =</span> Total.L <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>tab_nutri_geo<span class="sc">$</span>title1 <span class="ot">&lt;-</span> <span class="st">&quot;Midgut length vs yeast ingested&quot;</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>graph2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tab_nutri_geo, <span class="fu">aes</span>(<span class="at">x=</span>Yeast.ingested, <span class="at">y=</span>Total.Lmm))</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>Plot_Fig2B<span class="ot">=</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  graph2 <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>,<span class="at">shape=</span><span class="dv">16</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">span=</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;Yeast ingested (g/L x absorbance)&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>Plot_Fig2B</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%202B-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-2c" class="section level3" number="2.1.3">
<h3 number="2.1.3"><span class="header-section-number">2.1.3</span> Figure 2C</h3>
<div class="blue">
<p>Plots show a decrease in midgut length with increased amount of sucrose ingested.</p>
</div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>tab_nutri_geo <span class="ot">=</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;2A&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Total.Lmm =</span> Total.L <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>graph3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tab_nutri_geo, <span class="fu">aes</span>(<span class="at">x=</span>Sucrose.ingested, <span class="at">y=</span>Total.Lmm))</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>Plot_Fig2C<span class="ot">=</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  graph3 <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>,<span class="at">shape=</span><span class="dv">16</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">span=</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;Sucrose ingested (g/L x absorbance)&quot;</span>) <span class="sc">+</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>Plot_Fig2C</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%202C-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-2d" class="section level3" number="2.1.4">
<h3 number="2.1.4"><span class="header-section-number">2.1.4</span> Figure 2D</h3>
<div class="blue">
<p>Plot show an increase in midgut length with ratio of yeast to sucrose ingested.</p>
</div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>tab_nutri_geo <span class="ot">=</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;2A&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Total.Lmm =</span> Total.L <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>graph4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tab_nutri_geo, <span class="fu">aes</span>(<span class="at">x=</span>(Yeast.ingested<span class="sc">/</span>Sucrose.ingested), <span class="at">y=</span>Total.Lmm))</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>Plot_Fig2D<span class="ot">=</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>graph4 <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>,<span class="at">shape=</span><span class="dv">16</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">span=</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;green&quot;</span>)<span class="sc">+</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;Y:S ingested&quot;</span>) <span class="sc">+</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>Plot_Fig2D</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%202D-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-2e" class="section level3" number="2.1.5">
<h3 number="2.1.5"><span class="header-section-number">2.1.5</span> Figure 2E</h3>
<div class="blue">
<p><strong>Several nutrients from yeast (proteins, lipids, vitamins/minerals) are required to increase midgut length.</strong> Nutrients from yeast (proteins, amino acids, lipids, cholesterol, vitamins/minerals) were added against a base diet of only the amount of sucrose found in HY and devoid of yeast. Letters above violin plots represent grouping by statistical differences (Post hoc Tukey on GLMM). Bars beneath the main plot describe caloric content provided by the different components. <em>Proper label annotation (in line with the chart) can be found in manuscript figures</em></p>
</div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>tab_lenght_complement <span class="ot">=</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;2E&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Diet=</span>Food,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">Total_Length_mm =</span> Total.Lmm)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>tab_lenght_complement<span class="sc">$</span>Diet <span class="ot">=</span> <span class="fu">factor</span>(tab_lenght_complement<span class="sc">$</span>Diet, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;S74Y0 (A)&quot;</span>,</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;A+Cas2&quot;</span>,</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;A+Cas4&quot;</span>,</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;A+AA&quot;</span>,</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;A+AA2&quot;</span>,</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;A+L4&quot;</span>,</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;A+Ch0.4&quot;</span>,</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;A+L2+Ch0.2&quot;</span>,</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;A+L4+Ch0.4&quot;</span>,</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;A+V2&quot;</span>,</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;A+V4&quot;</span>,</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;A+C4+L4+Ch0.4&quot;</span>,</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;A+C4+L4+Ch0.4+V2&quot;</span>,</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;HY&quot;</span>)) <span class="co">#Order Diets</span></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>  tab_lenght_complement<span class="sc">%&gt;%</span></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_lenght_complement)</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.99393, p-value = 0.1361</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tab_lenght_complement) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 41.593, df = 14, p-value = 0.0001434</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_lenght_complement) </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we make a tab with the results</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Anova diets&quot;</span>)),</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_lenght_complement<span class="sc">$</span>Repeat),</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Anova diets
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
313.48
</td>
<td style="text-align:left;">
1.45
</td>
<td style="text-align:left;">
-0.0461
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">lmer</span>(Total_Length_mm <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_lenght_complement)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>multcomp <span class="ot">=</span> <span class="fu">glht</span>(mod.gen, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Diet=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">cld</span>(multcomp)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>letter_position <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span>tab_lenght_complement,Total_Length_mm <span class="sc">~</span> Diet, max)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span>  <span class="fu">as.data.frame</span>(tmp<span class="sc">$</span>mcletters<span class="sc">$</span>Letters)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>tab_letter<span class="sc">$</span>Diet<span class="ot">=</span><span class="fu">rownames</span>(tab_letter)</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_letter)[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">&quot;Letter&quot;</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span> <span class="fu">left_join</span>(tab_letter,letter_position)</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>Limits<span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;S74Y0 (A)&quot;</span>, <span class="st">&quot;A+Cas2&quot;</span>, <span class="st">&quot;A+Cas4&quot;</span>, <span class="st">&quot;A+AA&quot;</span>, <span class="st">&quot;A+AA2&quot;</span>, <span class="st">&quot;A+L4&quot;</span>, <span class="st">&quot;A+Ch0.4&quot;</span>, <span class="st">&quot;A+L2+Ch0.2&quot;</span>, <span class="st">&quot;A+L4+Ch0.4&quot;</span>, <span class="st">&quot;A+V2&quot;</span>, <span class="st">&quot;A+V4&quot;</span>, <span class="st">&quot;A+C4+L4+Ch0.4&quot;</span>,<span class="st">&quot;A+C4+L4+Ch0.4+V2&quot;</span>, <span class="st">&quot;HY&quot;</span>)</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;#FFB4B4&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#C3E6FC&quot;</span>) </span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(tab_lenght_complement<span class="sc">$</span>Total_Length_mm, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>Plot_Fig2E<span class="ot">=</span></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_lenght_complement, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z <span class="sc">/</span> <span class="dv">60</span>) <span class="sc">+</span> </span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">2.2</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_letter, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm<span class="fl">+0.4</span>, <span class="at">label =</span> Letter),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_stat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">7.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,Pvalue)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits,</span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>cbbPalette)<span class="sc">+</span></span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span>Limits)<span class="sc">+</span></span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span>),</span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">3</span>,<span class="dv">7</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-42"><a href="#cb80-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb80-43"><a href="#cb80-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb80-44"><a href="#cb80-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb80-45"><a href="#cb80-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb80-46"><a href="#cb80-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb80-47"><a href="#cb80-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-48"><a href="#cb80-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb80-49"><a href="#cb80-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb80-50"><a href="#cb80-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb80-51"><a href="#cb80-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb80-52"><a href="#cb80-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb80-53"><a href="#cb80-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb80-54"><a href="#cb80-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb80-55"><a href="#cb80-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb80-56"><a href="#cb80-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb80-57"><a href="#cb80-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb80-58"><a href="#cb80-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))</span>
<span id="cb80-59"><a href="#cb80-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-60"><a href="#cb80-60" aria-hidden="true" tabindex="-1"></a>tab_component_calories<span class="ot">=</span> <span class="fu">mutate_if</span>(d[[<span class="st">&quot;2E - calories&quot;</span>]],is.character,as.factor)</span>
<span id="cb80-61"><a href="#cb80-61" aria-hidden="true" tabindex="-1"></a>tab_component_calories<span class="sc">$</span>Component <span class="ot">&lt;-</span> <span class="fu">factor</span>(tab_component_calories<span class="sc">$</span>Component, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Lipids&quot;</span>, <span class="st">&quot;Proteins&quot;</span>, <span class="st">&quot;Carbohydrates&quot;</span>))</span>
<span id="cb80-62"><a href="#cb80-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-63"><a href="#cb80-63" aria-hidden="true" tabindex="-1"></a>Limits_2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Lipids&quot;</span>,<span class="st">&quot;Proteins&quot;</span>,<span class="st">&quot;Carbohydrates&quot;</span>)</span>
<span id="cb80-64"><a href="#cb80-64" aria-hidden="true" tabindex="-1"></a>Labels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Lipids&quot;</span>,<span class="st">&quot;Proteins&quot;</span>,<span class="st">&quot;Carbohydrates&quot;</span>)</span>
<span id="cb80-65"><a href="#cb80-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-66"><a href="#cb80-66" aria-hidden="true" tabindex="-1"></a>Plot_Fig2E_bis<span class="ot">=</span></span>
<span id="cb80-67"><a href="#cb80-67" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tab_component_calories,<span class="fu">aes</span>(<span class="at">x=</span>Diet,<span class="at">y=</span>Calories.contributed))<span class="sc">+</span></span>
<span id="cb80-68"><a href="#cb80-68" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>Component),<span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">width=</span>.<span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb80-69"><a href="#cb80-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits_2,</span>
<span id="cb80-70"><a href="#cb80-70" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values=</span>palette_component_3,</span>
<span id="cb80-71"><a href="#cb80-71" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>Labels)<span class="sc">+</span></span>
<span id="cb80-72"><a href="#cb80-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb80-73"><a href="#cb80-73" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span>Limits)<span class="sc">+</span></span>
<span id="cb80-74"><a href="#cb80-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="st">&quot;Calories&quot;</span>,</span>
<span id="cb80-75"><a href="#cb80-75" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1400</span>,<span class="at">by=</span><span class="dv">300</span>)))<span class="sc">+</span></span>
<span id="cb80-76"><a href="#cb80-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-77"><a href="#cb80-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span>  <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb80-78"><a href="#cb80-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb80-79"><a href="#cb80-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb80-80"><a href="#cb80-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb80-81"><a href="#cb80-81" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(),</span>
<span id="cb80-82"><a href="#cb80-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-83"><a href="#cb80-83" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb80-84"><a href="#cb80-84" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-85"><a href="#cb80-85" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb80-86"><a href="#cb80-86" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>, </span>
<span id="cb80-87"><a href="#cb80-87" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb80-88"><a href="#cb80-88" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb80-89"><a href="#cb80-89" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.margin=</span><span class="fu">margin</span>(<span class="at">t=</span><span class="fl">0.1</span>, <span class="at">r=</span><span class="fl">0.2</span>, <span class="at">b=</span><span class="fl">0.1</span>, <span class="at">l=</span><span class="dv">0</span>, <span class="at">unit=</span><span class="st">&quot;cm&quot;</span>),</span>
<span id="cb80-90"><a href="#cb80-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb80-91"><a href="#cb80-91" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb80-92"><a href="#cb80-92" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont),</span>
<span id="cb80-93"><a href="#cb80-93" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb80-94"><a href="#cb80-94" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb80-95"><a href="#cb80-95" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb80-96"><a href="#cb80-96" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Mediumfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb80-97"><a href="#cb80-97" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Mediumfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb80-98"><a href="#cb80-98" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb80-99"><a href="#cb80-99" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>,</span>
<span id="cb80-100"><a href="#cb80-100" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;transparent&quot;</span>))<span class="sc">+</span></span>
<span id="cb80-101"><a href="#cb80-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb80-102"><a href="#cb80-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-103"><a href="#cb80-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-104"><a href="#cb80-104" aria-hidden="true" tabindex="-1"></a>plot_2E <span class="ot">=</span> <span class="fu">grid.arrange</span>(Plot_Fig2E,</span>
<span id="cb80-105"><a href="#cb80-105" aria-hidden="true" tabindex="-1"></a>                       Plot_Fig2E_bis<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>),</span>
<span id="cb80-106"><a href="#cb80-106" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">grid.text</span>(<span class="st">&quot;HS&quot;</span>,<span class="at">x=</span><span class="fl">0.15</span>, <span class="at">y=</span><span class="fl">0.2</span>, <span class="at">just=</span><span class="st">&quot;left&quot;</span>,<span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize=</span>Smallfont,<span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)),</span>
<span id="cb80-107"><a href="#cb80-107" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">grid.text</span>(<span class="st">&quot;HY&quot;</span>,<span class="at">x=</span><span class="fl">0.95</span>, <span class="at">y=</span><span class="dv">1</span>, <span class="at">just=</span><span class="st">&quot;left&quot;</span>,<span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize=</span>Smallfont,<span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)),</span>
<span id="cb80-108"><a href="#cb80-108" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">grid.text</span>(<span class="st">&quot;Sucrose in HY completed with:&quot;</span>,<span class="at">x=</span><span class="fl">0.21</span>, <span class="at">y=</span><span class="fl">0.9</span>,<span class="at">just=</span><span class="st">&quot;left&quot;</span>,<span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize=</span>Smallfont,<span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)),</span>
<span id="cb80-109"><a href="#cb80-109" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">grid.text</span>(<span class="st">&quot;Casein       x0  x2  x4                                            x4 x4&quot;</span>, <span class="at">x=</span><span class="fl">0.02</span>, <span class="at">y=</span><span class="fl">0.52</span>,<span class="at">just=</span><span class="st">&quot;left&quot;</span>,<span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize=</span>Smallfont,<span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)),</span>
<span id="cb80-110"><a href="#cb80-110" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">grid.text</span>(<span class="st">&quot;AAs            x0            x1 x2&quot;</span>, <span class="at">x=</span><span class="fl">0.02</span>, <span class="at">y=</span><span class="fl">0.51</span>,<span class="at">just=</span><span class="st">&quot;left&quot;</span>,<span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize=</span>Smallfont,<span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)),</span>
<span id="cb80-111"><a href="#cb80-111" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb80-112"><a href="#cb80-112" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">grid.text</span>(<span class="st">&quot;Lard           x0                       x4       x2 x4            x4  x4&quot;</span>, <span class="at">x=</span><span class="fl">0.02</span>, <span class="at">y=</span><span class="fl">0.50</span>,<span class="at">just=</span><span class="st">&quot;left&quot;</span>,<span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize=</span>Smallfont,<span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)),</span>
<span id="cb80-113"><a href="#cb80-113" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">grid.text</span>(<span class="st">&quot;Chol.          x0                            x1  x1 x1            x1  x1&quot;</span>, <span class="at">x=</span><span class="fl">0.02</span>, <span class="at">y=</span><span class="fl">0.49</span>,<span class="at">just=</span><span class="st">&quot;left&quot;</span>,<span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize=</span>Smallfont,<span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)),</span>
<span id="cb80-114"><a href="#cb80-114" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb80-115"><a href="#cb80-115" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">grid.text</span>(<span class="st">&quot;Vit.             x0                                            x2  x4       x2&quot;</span>, <span class="at">x=</span><span class="fl">0.02</span>, <span class="at">y=</span><span class="fl">0.48</span>,<span class="at">just=</span><span class="st">&quot;left&quot;</span>,<span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize=</span>Smallfont,<span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)),</span>
<span id="cb80-116"><a href="#cb80-116" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb80-117"><a href="#cb80-117" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="fl">0.2</span>,<span class="fl">0.15</span>, <span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.2</span>))</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%202E-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-2f" class="section level3" number="2.1.6">
<h3 number="2.1.6"><span class="header-section-number">2.1.6</span> Figure 2F</h3>
<div class="blue">
<p><strong>Midgut size is antagonized by sugar, but not other added calories.</strong> Diet with only lipids, isocaloric with HS and HY diets, results in midguts of lengths comparable to those on HS diet. Substitution of sucrose from HS diet with isocaloric lipids (Lipids HS) results in midguts as long as those on HY. Midguts of flies reared on a diet substituting sucrose in HY diet with lipids (Lipids HY) are also similar in length to those of flies fed HY. Letters above violin plots represent grouping by statistical differences (Post hoc Tukey on GLMM). Bottom part of the chart (bar graph) describes caloric content provided by the different components.</p>
</div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>tab_lipids <span class="ot">=</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;2F&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm =</span>Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Diet=</span>Food)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  tab_lipids<span class="sc">%&gt;%</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_lipids)</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98586, p-value = 0.2715</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tab_lipids) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 6.0006, df = 4, p-value = 0.1991</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_lipids) </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we make a tab with the results</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Anova diets&quot;</span>)),</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_lipids<span class="sc">$</span>Repeat),</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Anova diets
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
112.99
</td>
<td style="text-align:left;">
1.59
</td>
<td style="text-align:left;">
0.224
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">lmer</span>(Total_Length_mm <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_lipids)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>multcomp <span class="ot">=</span> <span class="fu">glht</span>(mod.gen, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Diet=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">cld</span>(multcomp)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>letter_position <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span>tab_lipids,Total_Length_mm <span class="sc">~</span> Diet, max)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span>  <span class="fu">as.data.frame</span>(tmp<span class="sc">$</span>mcletters<span class="sc">$</span>Letters)</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>tab_letter<span class="sc">$</span>Diet<span class="ot">=</span><span class="fu">rownames</span>(tab_letter)</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_letter)[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">&quot;Letter&quot;</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span> <span class="fu">left_join</span>(tab_letter,letter_position)</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Lard Only&quot;</span>,<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HS Lard sub&quot;</span>,<span class="st">&quot;HY Lard sub&quot;</span>,<span class="st">&quot;HY&quot;</span>)</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>Labels <span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Yeast:Lipid 0:1&quot;</span>,<span class="st">&quot;Yeast:Sugar 1:14 (HS)&quot;</span>,<span class="st">&quot;Yeast:Lipid 1:14&quot;</span>,<span class="st">&quot;Yeast:Lipid 1:0.7&quot;</span>,<span class="st">&quot;Yeast:Sugar 1:0.7 (HY)&quot;</span>)</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#FFB4B4&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#C3E6FC&quot;</span>)</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(tab_lipids<span class="sc">$</span>Total_Length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>Plot_Fig2F<span class="ot">=</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_lipids, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">60</span>) <span class="sc">+</span> </span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">2.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_stat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.7</span>, <span class="at">y =</span> <span class="fl">7.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,<span class="fu">format</span>(Pvalue,<span class="at">digits=</span><span class="dv">2</span>))),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_letter, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm<span class="fl">+0.4</span>, <span class="at">label =</span> Letter),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits,</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>cbbPalette)<span class="sc">+</span></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span>Limits,</span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span>Labels)<span class="sc">+</span></span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">8.2</span>),</span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb86-43"><a href="#cb86-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb86-44"><a href="#cb86-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb86-45"><a href="#cb86-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb86-46"><a href="#cb86-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb86-47"><a href="#cb86-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb86-48"><a href="#cb86-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb86-49"><a href="#cb86-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb86-50"><a href="#cb86-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb86-51"><a href="#cb86-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb86-52"><a href="#cb86-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb86-53"><a href="#cb86-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb86-54"><a href="#cb86-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb86-55"><a href="#cb86-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))</span>
<span id="cb86-56"><a href="#cb86-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-57"><a href="#cb86-57" aria-hidden="true" tabindex="-1"></a>tab_component_calories_2F<span class="ot">=</span> <span class="fu">mutate_if</span>(d[[<span class="st">&quot;2F - calories&quot;</span>]],is.character,as.factor)</span>
<span id="cb86-58"><a href="#cb86-58" aria-hidden="true" tabindex="-1"></a>Limits_1 <span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Lard Only&quot;</span>,<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HS Lard&quot;</span>,<span class="st">&quot;HY Lard&quot;</span>,<span class="st">&quot;HY&quot;</span>)</span>
<span id="cb86-59"><a href="#cb86-59" aria-hidden="true" tabindex="-1"></a>Labels_1 <span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Yeast:Lipid 0:1&quot;</span>,<span class="st">&quot;Yeast:Sugar 1:14 (HS)&quot;</span>,<span class="st">&quot;Yeast:Lipid 1:14&quot;</span>,<span class="st">&quot;Yeast:Lipid 1:0.7&quot;</span>,<span class="st">&quot;Yeast:Sugar 1:0.7 (HY)&quot;</span>)</span>
<span id="cb86-60"><a href="#cb86-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-61"><a href="#cb86-61" aria-hidden="true" tabindex="-1"></a>tab_component_calories_2F<span class="sc">$</span>Component <span class="ot">&lt;-</span> <span class="fu">factor</span>(tab_component_calories_2F<span class="sc">$</span>Component, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Lipids&quot;</span>, <span class="st">&quot;Proteins&quot;</span>, <span class="st">&quot;Carbohydrates&quot;</span>))</span>
<span id="cb86-62"><a href="#cb86-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-63"><a href="#cb86-63" aria-hidden="true" tabindex="-1"></a>Limits_2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Lipids&quot;</span>,<span class="st">&quot;Proteins&quot;</span>,<span class="st">&quot;Carbohydrates&quot;</span>)</span>
<span id="cb86-64"><a href="#cb86-64" aria-hidden="true" tabindex="-1"></a>Labels_2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Lipids&quot;</span>,<span class="st">&quot;Proteins&quot;</span>,<span class="st">&quot;Carbohydrates&quot;</span>)</span>
<span id="cb86-65"><a href="#cb86-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-66"><a href="#cb86-66" aria-hidden="true" tabindex="-1"></a>Plot_Fig2F_bis<span class="ot">=</span></span>
<span id="cb86-67"><a href="#cb86-67" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tab_component_calories_2F,<span class="fu">aes</span>(<span class="at">x=</span>Diet,<span class="at">y=</span>Calories.contributed))<span class="sc">+</span></span>
<span id="cb86-68"><a href="#cb86-68" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>Component),<span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">width=</span>.<span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb86-69"><a href="#cb86-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb86-70"><a href="#cb86-70" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span>Limits_1,</span>
<span id="cb86-71"><a href="#cb86-71" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span>Labels_1)<span class="sc">+</span></span>
<span id="cb86-72"><a href="#cb86-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="st">&quot;Calories&quot;</span>,</span>
<span id="cb86-73"><a href="#cb86-73" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">600</span>,<span class="at">by=</span><span class="dv">200</span>)))<span class="sc">+</span></span>
<span id="cb86-74"><a href="#cb86-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits_2,</span>
<span id="cb86-75"><a href="#cb86-75" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values=</span>palette_component_3,</span>
<span id="cb86-76"><a href="#cb86-76" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>Labels_2)<span class="sc">+</span></span>
<span id="cb86-77"><a href="#cb86-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb86-78"><a href="#cb86-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span>  <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb86-79"><a href="#cb86-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb86-80"><a href="#cb86-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb86-81"><a href="#cb86-81" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb86-82"><a href="#cb86-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(),</span>
<span id="cb86-83"><a href="#cb86-83" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">45</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb86-84"><a href="#cb86-84" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb86-85"><a href="#cb86-85" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb86-86"><a href="#cb86-86" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb86-87"><a href="#cb86-87" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>, </span>
<span id="cb86-88"><a href="#cb86-88" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb86-89"><a href="#cb86-89" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb86-90"><a href="#cb86-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb86-91"><a href="#cb86-91" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb86-92"><a href="#cb86-92" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.margin=</span><span class="fu">margin</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">r=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">0</span>, <span class="at">l=</span><span class="dv">0</span>, <span class="at">unit=</span><span class="st">&quot;cm&quot;</span>),</span>
<span id="cb86-93"><a href="#cb86-93" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb86-94"><a href="#cb86-94" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb86-95"><a href="#cb86-95" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont),</span>
<span id="cb86-96"><a href="#cb86-96" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb86-97"><a href="#cb86-97" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Mediumfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb86-98"><a href="#cb86-98" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Mediumfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb86-99"><a href="#cb86-99" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb86-100"><a href="#cb86-100" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>,</span>
<span id="cb86-101"><a href="#cb86-101" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;transparent&quot;</span>))<span class="sc">+</span></span>
<span id="cb86-102"><a href="#cb86-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb86-103"><a href="#cb86-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-104"><a href="#cb86-104" aria-hidden="true" tabindex="-1"></a>g_legend<span class="ot">=</span><span class="cf">function</span>(a.gplot){</span>
<span id="cb86-105"><a href="#cb86-105" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">=</span> <span class="fu">ggplot_gtable</span>(<span class="fu">ggplot_build</span>(a.gplot))</span>
<span id="cb86-106"><a href="#cb86-106" aria-hidden="true" tabindex="-1"></a>  leg <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">sapply</span>(tmp<span class="sc">$</span>grobs, <span class="cf">function</span>(x) x<span class="sc">$</span>name) <span class="sc">==</span> <span class="st">&quot;guide-box&quot;</span>)</span>
<span id="cb86-107"><a href="#cb86-107" aria-hidden="true" tabindex="-1"></a>  legend <span class="ot">=</span> tmp<span class="sc">$</span>grobs[[leg]]</span>
<span id="cb86-108"><a href="#cb86-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(legend)}</span>
<span id="cb86-109"><a href="#cb86-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-110"><a href="#cb86-110" aria-hidden="true" tabindex="-1"></a>mylegend<span class="ot">=</span><span class="fu">g_legend</span>(Plot_Fig2F_bis)</span>
<span id="cb86-111"><a href="#cb86-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-112"><a href="#cb86-112" aria-hidden="true" tabindex="-1"></a>plot_2F <span class="ot">=</span> <span class="fu">grid.arrange</span>(Plot_Fig2F,</span>
<span id="cb86-113"><a href="#cb86-113" aria-hidden="true" tabindex="-1"></a>                       Plot_Fig2F_bis<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>),</span>
<span id="cb86-114"><a href="#cb86-114" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%202F-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-2g" class="section level3" number="2.1.7">
<h3 number="2.1.7"><span class="header-section-number">2.1.7</span> Figure 2G</h3>
<div class="blue">
<p><strong>Antagonism by sugar of yeast-induced growth is not specific to sucrose.</strong> Statistical comparisons were performed with HS vs HY for each sugar.</p>
</div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>tab_sugars <span class="ot">=</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;2G&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm =</span>Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_Treatment=</span>Day)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>tab_sugars<span class="sc">$</span>Sugar <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;Sucrose&quot;</span>,<span class="st">&quot;Fructose&quot;</span>,<span class="st">&quot;Glucose&quot;</span>,<span class="st">&quot;Maltose&quot;</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Sucrose&quot;</span>, <span class="st">&quot;Glucose&quot;</span>, <span class="st">&quot;Fructose&quot;</span>, <span class="st">&quot;Maltose&quot;</span>))</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  tab_sugars<span class="sc">%&gt;%</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Sugar)<span class="sc">%&gt;%</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Sucrose:</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_sugars,Sugar<span class="sc">==</span><span class="st">&quot;Sucrose&quot;</span>))</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98398, p-value = 0.9186</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_sugars,Sugar<span class="sc">==</span><span class="st">&quot;Sucrose&quot;</span>)) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 0.52599, df = 1, p-value = 0.4683</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_sugars,Sugar<span class="sc">==</span><span class="st">&quot;Sucrose&quot;</span>)) </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY sucrose&quot;</span>)),</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_lipids<span class="sc">$</span>Repeat),</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>tab_stat_sucrose <span class="ot">=</span>tab_stat</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Glucose:</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_sugars,Sugar<span class="sc">==</span><span class="st">&quot;Glucose&quot;</span>))</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.94939, p-value = 0.1628</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_sugars,Sugar<span class="sc">==</span><span class="st">&quot;Glucose&quot;</span>)) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 0.92415, df = 1, p-value = 0.3364</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_sugars,Sugar<span class="sc">==</span><span class="st">&quot;Glucose&quot;</span>)) </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY glucose&quot;</span>)),</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_lipids<span class="sc">$</span>Repeat),</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>tab_stat_Glucose<span class="ot">=</span>tab_stat</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Fructose:</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_sugars,Sugar<span class="sc">==</span><span class="st">&quot;Fructose&quot;</span>))</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96101, p-value = 0.3101</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_sugars,Sugar<span class="sc">==</span><span class="st">&quot;Fructose&quot;</span>)) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 0.80035, df = 1, p-value = 0.371</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_sugars,Sugar<span class="sc">==</span><span class="st">&quot;Fructose&quot;</span>)) </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY fructose&quot;</span>)),</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_lipids<span class="sc">$</span>Repeat),</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>tab_stat_Fructose <span class="ot">=</span> tab_stat</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Maltose:</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_sugars,Sugar<span class="sc">==</span><span class="st">&quot;Maltose&quot;</span>))</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.94774, p-value = 0.1352</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_sugars,Sugar<span class="sc">==</span><span class="st">&quot;Maltose&quot;</span>)) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 0.080366, df = 1, p-value = 0.7768</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_sugars,Sugar<span class="sc">==</span><span class="st">&quot;Maltose&quot;</span>)) </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY maltose&quot;</span>)),</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_lipids<span class="sc">$</span>Repeat),</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>tab_stat_Maltose<span class="ot">=</span> tab_stat</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">rbind</span>(tab_stat_sucrose,tab_stat_Glucose,tab_stat_Fructose,tab_stat_Maltose)</span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>Sugar <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Sucrose&quot;</span>,<span class="st">&quot;Glucose&quot;</span>,<span class="st">&quot;Fructose&quot;</span>,<span class="st">&quot;Maltose&quot;</span>)</span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>Sugar <span class="ot">=</span><span class="fu">as.factor</span>(tab_stat<span class="sc">$</span>Sugar)</span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>,<span class="st">&quot;Sugar&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
<th style="text-align:left;">
Sugar
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS vs HY sucrose
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
42.83
</td>
<td style="text-align:left;">
1.56
</td>
<td style="text-align:left;">
0.333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:left;">
***
</td>
<td style="text-align:left;">
Sucrose
</td>
</tr>
<tr>
<td style="text-align:left;">
HS vs HY glucose
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
16.16
</td>
<td style="text-align:left;">
1.6
</td>
<td style="text-align:left;">
0.218
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5.8e-05
</td>
<td style="text-align:left;">
***
</td>
<td style="text-align:left;">
Glucose
</td>
</tr>
<tr>
<td style="text-align:left;">
HS vs HY fructose
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
39.14
</td>
<td style="text-align:left;">
1.53
</td>
<td style="text-align:left;">
0.32
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:left;">
***
</td>
<td style="text-align:left;">
Fructose
</td>
</tr>
<tr>
<td style="text-align:left;">
HS vs HY maltose
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
20.75
</td>
<td style="text-align:left;">
1.54
</td>
<td style="text-align:left;">
0.244
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5.2e-06
</td>
<td style="text-align:left;">
***
</td>
<td style="text-align:left;">
Maltose
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>Labels<span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(tab_sugars<span class="sc">$</span>Total_Length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>Plot_Fig2G<span class="ot">=</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_sugars, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z <span class="sc">/</span> <span class="dv">60</span>) <span class="sc">+</span> </span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">2.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">data =</span> tab_stat,<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">annotations =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">y_position =</span> <span class="fl">8.5</span>), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">manual =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Sugar)<span class="sc">+</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits,</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>palette_diet_2)<span class="sc">+</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span>Limits,</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span>Labels)<span class="sc">+</span></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">9</span>),</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb104-34"><a href="#cb104-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb104-35"><a href="#cb104-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb104-36"><a href="#cb104-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb104-37"><a href="#cb104-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb104-38"><a href="#cb104-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb104-39"><a href="#cb104-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb104-40"><a href="#cb104-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb104-41"><a href="#cb104-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb104-42"><a href="#cb104-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb104-43"><a href="#cb104-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb104-44"><a href="#cb104-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb104-45"><a href="#cb104-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb104-46"><a href="#cb104-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb104-47"><a href="#cb104-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb104-48"><a href="#cb104-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-49"><a href="#cb104-49" aria-hidden="true" tabindex="-1"></a>Plot_Fig2G</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%202G-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>##Export Figure 2</p>
</div>
</div>
<div id="figure-2---figure-supplement-1" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> Figure 2 - figure supplement 1</h2>
<div id="figure-2s1a" class="section level3" number="2.2.1">
<h3 number="2.2.1"><span class="header-section-number">2.2.1</span> Figure 2S1A</h3>
<div class="blue">
<p>Set of diets utilized for the nutritional geometry experiment. Numbers on dots denote sample sizes for figure 2A (pool of three independent biological replicates). We utilized 28 different diets, varying either caloric content or the yeast to sucrose ratio. The complete list of recipes can be found in Table 1. <em>Complete numbers can be found in manuscript figure</em></p>
</div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>tab_nutri_geo_design <span class="ot">=</span> </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;2 - S1A&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Yeast.in.Diet=</span>Yeast,</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Sucrose.in.Diet=</span>Sugar)</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>tab_raw_2A <span class="ot">=</span> </span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;2A&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Conc =</span> <span class="fu">paste</span>(<span class="fu">round</span>(Sucrose.in.Diet,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">&quot;x&quot;</span>,<span class="fu">round</span>(Yeast.in.Diet,<span class="at">digits=</span><span class="dv">2</span>),<span class="at">sep=</span><span class="st">&quot;&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Yeast.in.Diet,Sucrose.in.Diet)<span class="sc">%&gt;%</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>tab_nutri_geo_design <span class="ot">=</span> <span class="fu">left_join</span>(tab_nutri_geo_design,tab_raw_2A)</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>Plot_Fig2S1A<span class="ot">=</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_nutri_geo_design, <span class="fu">aes</span>(<span class="at">x =</span> Sucrose.in.Diet, <span class="at">y =</span> Yeast.in.Diet,<span class="at">label=</span>Sample_size))<span class="sc">+</span> </span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>Calories), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;Sucrose in diet (g/L)&quot;</span>,</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">300</span>),</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">300</span>,<span class="at">by=</span><span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Yeast in diet (g/L)&quot;</span>,</span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">300</span>),</span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">300</span>,<span class="at">by=</span><span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span><span class="fu">subset</span>(tab_nutri_geo_design,Yeast.in.Diet<span class="sc">&gt;=</span><span class="dv">30</span> <span class="sc">|</span> Sucrose.in.Diet<span class="sc">&gt;=</span><span class="dv">30</span>),<span class="at">color=</span><span class="st">&quot;white&quot;</span>,<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">13</span>)) <span class="sc">+</span></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">linetype=</span><span class="dv">3</span>),</span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>, </span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb105-44"><a href="#cb105-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb105-45"><a href="#cb105-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb105-46"><a href="#cb105-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb105-47"><a href="#cb105-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb105-48"><a href="#cb105-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb105-49"><a href="#cb105-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb105-50"><a href="#cb105-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)<span class="sc">+</span></span>
<span id="cb105-51"><a href="#cb105-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">size=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb105-52"><a href="#cb105-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-53"><a href="#cb105-53" aria-hidden="true" tabindex="-1"></a>Plot_Fig2S1A</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%202S1A-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="blue">
<p>HS and HY diet compared to standard diets used for Drosophila</p>
</div>
</div>
<div id="figure-2s1b" class="section level3" number="2.2.2">
<h3 number="2.2.2"><span class="header-section-number">2.2.2</span> Figure 2S1B</h3>
<div class="blue">
<p>FD&amp;C1 blue transit assay (feeding assay) showing amount of food defecated, and by inference ingested, in the nutritional geometry experiment. The scale maps color to units. The graph indicates compensatory feeding at lower nutrient densities, especially low yeast. These data were used to calculate the total amount of yeast and sucrose ingested on each diet in Figure 2-supplemental figure 1C.</p>
</div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>tab_geom_fecal <span class="ot">=</span> </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;2 - S1B&quot;</span>]]</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="at">filename =</span> <span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/Plot_Fig2-S1B.jpeg&quot;</span>,</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">res =</span> <span class="dv">600</span>,</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span> )</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex=</span><span class="dv">1</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(tab_geom_fecal, <span class="fu">geomPlotta</span>(<span class="at">x =</span> Sucrose.in.Diet, <span class="at">y =</span> Yeast.in.Diet, <span class="at">z =</span> (Absorbance<span class="sc">*</span><span class="dv">10</span>), <span class="at">alf =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">300</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">300</span>), <span class="at">xlab =</span> <span class="st">&quot;Sucrose in diet (g/L)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Yeast in diet (g/L)&quot;</span>, <span class="at">frame.plot=</span> <span class="cn">FALSE</span>, <span class="at">cex.lab=</span><span class="dv">1</span>, <span class="at">cex.axis =</span><span class="dv">1</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">labcex=</span><span class="dv">1</span>, <span class="at">asp=</span><span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>img2S1B <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/Plot_Fig2-S1B.jpeg&quot;</span>) </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig2S1B <span class="ot">=</span> <span class="fu">rasterGrob</span>(img2S1B)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig2S1B)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%202S1B-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-2s1c" class="section level3" number="2.2.3">
<h3 number="2.2.3"><span class="header-section-number">2.2.3</span> Figure 2S1C</h3>
<div class="blue">
<p>Yeast and sucrose have mutually antagonistic impacts on midgut length. Plots show midgut length as a function of sucrose or yeast ingested (g/L x Absorbance from Figure 2-supplemental figure 1B), or their ratio multiplied by ingestion per diet.</p>
</div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>tab_nutri_geo <span class="ot">=</span> </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;2A&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Total.Lmm =</span> Total.L <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>tab_nutri_geo2 <span class="ot">&lt;-</span> tab_nutri_geo <span class="sc">%&gt;%</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(concatenate) <span class="sc">%&gt;%</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Calories.ingested =</span> <span class="fu">mean</span>(Calories.ingested),</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">Midgut.length =</span> <span class="fu">mean</span>(Total.Lmm),</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">Yeast.ingested =</span> <span class="fu">mean</span>(Yeast.ingested),</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">Sucrose.ingested =</span> <span class="fu">mean</span>(Sucrose.ingested))</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tab_nutri_geo2, <span class="fu">aes</span>(<span class="at">x=</span>Sucrose.ingested, <span class="at">y=</span>Yeast.ingested))</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>Plot_Fig2S1C<span class="ot">=</span></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>  graph <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>Calories.ingested, <span class="at">fill=</span>Midgut.length), <span class="at">stroke=</span><span class="fl">1.5</span>, <span class="at">shape=</span><span class="dv">21</span>,  <span class="at">color=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;Sucrose ingested (g/L x Absorbance)&quot;</span>,</span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">160</span>),</span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">160</span>,<span class="at">by=</span><span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Yeast ingested (g/L x Absorbance)&quot;</span>,</span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">50</span>),</span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="at">by=</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">linetype=</span><span class="dv">3</span>),</span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb108-33"><a href="#cb108-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb108-34"><a href="#cb108-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb108-35"><a href="#cb108-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb108-36"><a href="#cb108-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb108-37"><a href="#cb108-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>, </span>
<span id="cb108-38"><a href="#cb108-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb108-39"><a href="#cb108-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.79</span>,<span class="fl">0.79</span>),</span>
<span id="cb108-40"><a href="#cb108-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb108-41"><a href="#cb108-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb108-42"><a href="#cb108-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb108-43"><a href="#cb108-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb108-44"><a href="#cb108-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb108-45"><a href="#cb108-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb108-46"><a href="#cb108-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb108-47"><a href="#cb108-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb108-48"><a href="#cb108-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)<span class="sc">+</span></span>
<span id="cb108-49"><a href="#cb108-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Midgut length (mm)&quot;</span>, <span class="at">size =</span> <span class="st">&quot;Calories ingested&quot;</span>)</span>
<span id="cb108-50"><a href="#cb108-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-51"><a href="#cb108-51" aria-hidden="true" tabindex="-1"></a>Plot_Fig2S1C</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%202S1C-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>##Export Figure 2S1</p>
</div>
</div>
<div id="figure-2---figure-supplement-2" class="section level2" number="2.3">
<h2 number="2.3"><span class="header-section-number">2.3</span> Figure 2 - figure supplement 2</h2>
<div id="figure-2s2a" class="section level3" number="2.3.1">
<h3 number="2.3.1"><span class="header-section-number">2.3.1</span> Figure 2S2A</h3>
<div class="blue">
<p><strong>Food texture does not explain the differential effects of HS and HY diets on midgut length.</strong> Addition of inulin (inu), pectin (pect), cellulose (cell), and all previous fibers mixed (AF) or pectin + cellulose (PC) to HS does not increase midgut length. Addition of fibers to HY (HY + AF) and HY + pectin + cellulose (HY + PC2) does not affect midgut length.</p>
</div>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>tab_fiber <span class="ot">=</span> </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;2 - S2A&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm =</span> Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Diet=</span>Food)</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>tab_fiber<span class="sc">$</span>Diet <span class="ot">=</span> <span class="fu">factor</span>(tab_fiber<span class="sc">$</span>Diet, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HS + Inu&quot;</span>, <span class="st">&quot;HS + Pect&quot;</span>, <span class="st">&quot;HS + Pect2&quot;</span>, <span class="st">&quot;HS + Cell&quot;</span>, <span class="st">&quot;HS + Cell2&quot;</span>, <span class="st">&quot;HS + AF&quot;</span>, <span class="st">&quot;HS + PC2&quot;</span>, <span class="st">&quot;HY + AF&quot;</span>, <span class="st">&quot;HY + PC2&quot;</span>, <span class="st">&quot;HY&quot;</span>)) </span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>  tab_fiber<span class="sc">%&gt;%</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_fiber)</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.9942, p-value = 0.4463</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tab_fiber) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 7.5012, df = 10, p-value = 0.6774</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_fiber) </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we make a tab with the results</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Any difference&quot;</span>)),</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_fiber<span class="sc">$</span>Repeat),</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Any difference
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
122.76
</td>
<td style="text-align:left;">
1.55
</td>
<td style="text-align:left;">
-0.0361
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">lmer</span>(Total_Length_mm <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_fiber)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>multcomp <span class="ot">=</span> <span class="fu">glht</span>(mod.gen, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Diet=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">cld</span>(multcomp)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>letter_position <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span><span class="fu">subset</span>(tab_fiber,<span class="sc">!</span><span class="fu">is.na</span>(Total_Length_mm)),Total_Length_mm <span class="sc">~</span> Diet, max)</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span>  <span class="fu">as.data.frame</span>(tmp<span class="sc">$</span>mcletters<span class="sc">$</span>Letters)</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>tab_letter<span class="sc">$</span>Diet<span class="ot">=</span><span class="fu">rownames</span>(tab_letter)</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_letter)[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">&quot;Letter&quot;</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span> <span class="fu">left_join</span>(tab_letter,letter_position)</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>Limits<span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HS + Inu&quot;</span>, <span class="st">&quot;HS + Pect&quot;</span>, <span class="st">&quot;HS + Pect2&quot;</span>, <span class="st">&quot;HS + Cell&quot;</span>, <span class="st">&quot;HS + Cell2&quot;</span>, <span class="st">&quot;HS + AF&quot;</span>, <span class="st">&quot;HS + PC2&quot;</span>, <span class="st">&quot;HY + AF&quot;</span>, <span class="st">&quot;HY + PC2&quot;</span>, <span class="st">&quot;HY&quot;</span>)</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;#FFB4B4&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>,<span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#f6efe5&quot;</span>, <span class="st">&quot;#C3E6FC&quot;</span>)</span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(tab_fiber<span class="sc">$</span>Total_Length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>Plot_Fig2S2A<span class="ot">=</span></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_fiber, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">60</span>) <span class="sc">+</span> </span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">2.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_letter, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm<span class="fl">+0.4</span>, <span class="at">label =</span> Letter),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_stat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">7.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,<span class="fu">format</span>(Pvalue,<span class="at">digits=</span><span class="dv">2</span>))),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits,</span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>cbbPalette)<span class="sc">+</span></span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span>Limits)<span class="sc">+</span></span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span>),</span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb114-34"><a href="#cb114-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb114-35"><a href="#cb114-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb114-36"><a href="#cb114-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb114-37"><a href="#cb114-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb114-38"><a href="#cb114-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb114-39"><a href="#cb114-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb114-40"><a href="#cb114-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb114-41"><a href="#cb114-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb114-42"><a href="#cb114-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb114-43"><a href="#cb114-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb114-44"><a href="#cb114-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb114-45"><a href="#cb114-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">45</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb114-46"><a href="#cb114-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb114-47"><a href="#cb114-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb114-48"><a href="#cb114-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb114-49"><a href="#cb114-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb114-50"><a href="#cb114-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb114-51"><a href="#cb114-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb114-52"><a href="#cb114-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb114-53"><a href="#cb114-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb114-54"><a href="#cb114-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb114-55"><a href="#cb114-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb114-56"><a href="#cb114-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))</span>
<span id="cb114-57"><a href="#cb114-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-58"><a href="#cb114-58" aria-hidden="true" tabindex="-1"></a>Plot_Fig2S2A</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%202S2A-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-2s2b" class="section level3" number="2.3.2">
<h3 number="2.3.2"><span class="header-section-number">2.3.2</span> Figure 2S2B</h3>
<div class="blue">
<p><strong>Changes in food texture due to variation in agar concentration can affect midgut length but do not explain the effect of the diet treatment.</strong> Changes in agar concentration do not change midgut length on HS. Either increasing or decreasing agar concentration reduces midgut length on HY.</p>
</div>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>tab_agar <span class="ot">=</span>  </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;2 - S2B&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm =</span> Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Diet=</span>Food)</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(tab_agar<span class="sc">$</span>Diet)[<span class="fu">levels</span>(tab_agar<span class="sc">$</span>Diet)<span class="sc">==</span><span class="st">&quot;HS&quot;</span>] <span class="ot">=</span><span class="st">&quot;HS (original, 1.5%)&quot;</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(tab_agar<span class="sc">$</span>Diet)[<span class="fu">levels</span>(tab_agar<span class="sc">$</span>Diet)<span class="sc">==</span><span class="st">&quot;HY&quot;</span>] <span class="ot">=</span><span class="st">&quot;HY (original, 1.5%)&quot;</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>  tab_agar<span class="sc">%&gt;%</span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_agar)</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.99568, p-value = 0.4148</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tab_agar) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 5.8743, df = 7, p-value = 0.5545</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_agar) </span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we make a tab with the results</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Any difference&quot;</span>)),</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_agar<span class="sc">$</span>Repeat),</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Any difference
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
201.35
</td>
<td style="text-align:left;">
1.49
</td>
<td style="text-align:left;">
-5.9e-05
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">lmer</span>(Total_Length_mm <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_agar)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>multcomp <span class="ot">=</span> <span class="fu">glht</span>(mod.gen, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Diet=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">cld</span>(multcomp)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>letter_position <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span><span class="fu">subset</span>(tab_agar,<span class="sc">!</span><span class="fu">is.na</span>(Total_Length_mm)),Total_Length_mm <span class="sc">~</span> Diet, max)</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span>  <span class="fu">as.data.frame</span>(tmp<span class="sc">$</span>mcletters<span class="sc">$</span>Letters)</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>tab_letter<span class="sc">$</span>Diet<span class="ot">=</span><span class="fu">rownames</span>(tab_letter)</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_letter)[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">&quot;Letter&quot;</span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span> <span class="fu">left_join</span>(tab_letter,letter_position)</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>Limits<span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS Agar 0.5%&quot;</span>, <span class="st">&quot;HS Agar 1%&quot;</span>, <span class="st">&quot;HS (original, 1.5%)&quot;</span>, <span class="st">&quot;HS Agar 3%&quot;</span>, <span class="st">&quot;HY Agar 0.5%&quot;</span>, <span class="st">&quot;HY Agar 1%&quot;</span>, <span class="st">&quot;HY (original, 1.5%)&quot;</span>, <span class="st">&quot;HY Agar 3%&quot;</span>)</span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;#FFB4B4&quot;</span>, <span class="st">&quot;#FFB4B4&quot;</span>, <span class="st">&quot;#FFB4B4&quot;</span>, <span class="st">&quot;#FFB4B4&quot;</span>, <span class="st">&quot;#C3E6FC&quot;</span>, <span class="st">&quot;#C3E6FC&quot;</span>, <span class="st">&quot;#C3E6FC&quot;</span>, <span class="st">&quot;#C3E6FC&quot;</span>)</span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(tab_agar<span class="sc">$</span>Total_Length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>Plot_Fig2S2B<span class="ot">=</span></span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_agar, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">60</span>) <span class="sc">+</span> </span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">2.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_letter, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm<span class="fl">+0.4</span>, <span class="at">label =</span> Letter),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_stat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">7.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,Pvalue)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits,</span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>cbbPalette)<span class="sc">+</span></span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span>Limits)<span class="sc">+</span></span>
<span id="cb120-31"><a href="#cb120-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb120-32"><a href="#cb120-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span>),</span>
<span id="cb120-33"><a href="#cb120-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb120-34"><a href="#cb120-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb120-35"><a href="#cb120-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb120-36"><a href="#cb120-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb120-37"><a href="#cb120-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb120-38"><a href="#cb120-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb120-39"><a href="#cb120-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb120-40"><a href="#cb120-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb120-41"><a href="#cb120-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb120-42"><a href="#cb120-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb120-43"><a href="#cb120-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb120-44"><a href="#cb120-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb120-45"><a href="#cb120-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">34</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb120-46"><a href="#cb120-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb120-47"><a href="#cb120-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb120-48"><a href="#cb120-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb120-49"><a href="#cb120-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb120-50"><a href="#cb120-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb120-51"><a href="#cb120-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb120-52"><a href="#cb120-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb120-53"><a href="#cb120-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb120-54"><a href="#cb120-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb120-55"><a href="#cb120-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb120-56"><a href="#cb120-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))</span>
<span id="cb120-57"><a href="#cb120-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-58"><a href="#cb120-58" aria-hidden="true" tabindex="-1"></a>Plot_Fig2S2B</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%202S2B-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-2s2c" class="section level3" number="2.3.3">
<h3 number="2.3.3"><span class="header-section-number">2.3.3</span> Figure 2S2C</h3>
<div class="blue">
<p>Sorbitol, a nutritious but not palatable sugar, has increased size on HY compared to HS, while Arabinose, a palatable but not nutritious sugar, results in death of flies before reaching dissection day on HS, and decreased size of midguts on HY diet. Statistical analysis is HS vs HY for each sugar.</p>
</div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>tab_xtrsugars_rev <span class="ot">=</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;2S2C&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm =</span>Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_Treatment=</span>Day)<span class="sc">%&gt;%</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sugar=</span><span class="fu">fct_relevel</span>(Sugar,<span class="st">&quot;Sucrose&quot;</span>,<span class="st">&quot;Sorbitol&quot;</span>, <span class="st">&quot;Arabinose&quot;</span>))</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a><span class="co">#tab_xtrsugars_rev$Sugar = factor(c(&quot;Sucrose&quot;,&quot;Sorbitol&quot;,&quot;Arabinose&quot;), levels = c(&quot;Sucrose&quot;, &quot;Sorbitol&quot;, &quot;Arabinose&quot;))</span></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>  tab_xtrsugars_rev<span class="sc">%&gt;%</span></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Sugar)<span class="sc">%&gt;%</span></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Sucrose:</span></span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>((Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_xtrsugars_rev,Sugar<span class="sc">==</span><span class="st">&quot;Sucrose&quot;</span>))</span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96327, p-value = 0.07213</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>((Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_xtrsugars_rev,Sugar<span class="sc">==</span><span class="st">&quot;Sucrose&quot;</span>)) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  (Total_Length_mm) ~ Diet + (1/Repeat)
BP = 0.77017, df = 1, p-value = 0.3802</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>((Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_xtrsugars_rev,Sugar<span class="sc">==</span><span class="st">&quot;Sucrose&quot;</span>)) </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY Sucrose&quot;</span>)),</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_lipids<span class="sc">$</span>Repeat),</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>tab_stat_sucrose <span class="ot">=</span>tab_stat</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Sorbitol:</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>((Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_xtrsugars_rev,Sugar<span class="sc">==</span><span class="st">&quot;Sorbitol&quot;</span>))</span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.97561, p-value = 0.3359</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>((Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_xtrsugars_rev,Sugar<span class="sc">==</span><span class="st">&quot;Sorbitol&quot;</span>)) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  (Total_Length_mm) ~ Diet + (1/Repeat)
BP = 0.129, df = 1, p-value = 0.7195</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>((Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> <span class="fu">subset</span>(tab_xtrsugars_rev,Sugar<span class="sc">==</span><span class="st">&quot;Sorbitol&quot;</span>)) </span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY Sorbitol&quot;</span>)),</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_lipids<span class="sc">$</span>Repeat),</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>tab_stat_Sorbitol<span class="ot">=</span>tab_stat</span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">rbind</span>(tab_stat_sucrose,tab_stat_Sorbitol)</span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>Sugar <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Sucrose&quot;</span>,<span class="st">&quot;Sorbitol&quot;</span>)</span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>Sugar<span class="ot">=</span><span class="fu">as.factor</span>(tab_stat<span class="sc">$</span>Sugar)</span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>,<span class="st">&quot;Sugar&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
<th style="text-align:left;">
Sugar
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS vs HY Sucrose
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
31.6
</td>
<td style="text-align:left;">
4.19
</td>
<td style="text-align:left;">
1.18
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:left;">
***
</td>
<td style="text-align:left;">
Sucrose
</td>
</tr>
<tr>
<td style="text-align:left;">
HS vs HY Sorbitol
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
22.7
</td>
<td style="text-align:left;">
4.41
</td>
<td style="text-align:left;">
0.913
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.9e-06
</td>
<td style="text-align:left;">
***
</td>
<td style="text-align:left;">
Sorbitol
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>Labels<span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(tab_xtrsugars_rev<span class="sc">$</span>Total_Length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>Plot_Fig2S2C<span class="ot">=</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_xtrsugars_rev, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z <span class="sc">/</span> <span class="dv">60</span>) <span class="sc">+</span> </span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Sugar)<span class="sc">+</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">1.8</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_signif</span>(<span class="at">data =</span> tab_stat,<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">annotations =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">y_position =</span> <span class="fl">7.4</span>), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">manual =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits,</span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>palette_diet_2)<span class="sc">+</span></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span>Limits,</span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span>Labels)<span class="sc">+</span></span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">1.7</span>,<span class="fl">7.5</span>),</span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb130-28"><a href="#cb130-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb130-29"><a href="#cb130-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb130-30"><a href="#cb130-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb130-31"><a href="#cb130-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb130-32"><a href="#cb130-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb130-33"><a href="#cb130-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb130-34"><a href="#cb130-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb130-35"><a href="#cb130-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb130-36"><a href="#cb130-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb130-37"><a href="#cb130-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb130-38"><a href="#cb130-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb130-39"><a href="#cb130-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb130-40"><a href="#cb130-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb130-41"><a href="#cb130-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb130-42"><a href="#cb130-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb130-43"><a href="#cb130-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb130-44"><a href="#cb130-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb130-45"><a href="#cb130-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb130-46"><a href="#cb130-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb130-47"><a href="#cb130-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb130-48"><a href="#cb130-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-49"><a href="#cb130-49" aria-hidden="true" tabindex="-1"></a>Plot_Fig2S2C</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure2S2C%20-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>##Export Figure 2S2</p>
</div>
</div>
</div>
<div id="figure-3.-diet-composition-affects-both-cell-number-and-enterocyte-size-in-the-midgut" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Figure 3. Diet composition affects both cell number and enterocyte size in the midgut</h1>
<div id="figure-3---main" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Figure 3 - main</h2>
<div id="figure-3a---b" class="section level3" number="3.1.1">
<h3 number="3.1.1"><span class="header-section-number">3.1.1</span> Figure 3A - B</h3>
<div class="blue">
<p>Representative pictures of midguts from flies kept on HS (A) or HY (B) diet. Green arrows indicate intestinal stem cells (ISCs), marked only by GFP (green), red arrows mark enteroblasts (EBs), marked by GFP and GBE Su(H)-lacZ (red), and white arrow indicate enteroendocrine (EE) cells, marked with anti-Prospero antibody (white). All nuclei are stained with DAPI (blue). <em>Complete graphical annotation can be found in manuscript figures</em></p>
</div>
<div class="row">
<div class="col-md-6">
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%203A-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%203B-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="figure-3c" class="section level3" number="3.1.2">
<h3 number="3.1.2"><span class="header-section-number">3.1.2</span> Figure 3C</h3>
<div class="blue">
<p>Quantification of total cell numbers in the posterior midgut (R4) for HS and HY</p>
</div>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>Tab_cellnumber <span class="ot">=</span> </span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;3C&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Diet,Line,Day,Repeat,GutNumber,Region),as.factor))<span class="sc">%&gt;%</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(ISC.AL,EB.AL,EE.AL,EC.AL),round,<span class="dv">0</span>))</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="do">#### ISC</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(ISC.AL) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Tab_cellnumber)</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96619, p-value = 0.01821</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(ISC.AL) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> Tab_cellnumber) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(ISC.AL) ~ Diet + (1/Repeat)
BP = 0.95685, df = 1, p-value = 0.328</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(ISC.AL) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Tab_cellnumber)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY ISC&quot;</span>)),</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cell_type =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;ISC.AL&quot;</span>)),</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Tab_cellnumber<span class="sc">$</span>Repeat),</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>tab_stat_ISC<span class="ot">=</span>tab_stat</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a><span class="do">#### EB</span></span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(EB.AL) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> Tab_cellnumber)</span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98307, p-value = 0.2856</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(EB.AL) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> Tab_cellnumber) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(EB.AL) ~ Diet + (1/Repeat)
BP = 0.067845, df = 1, p-value = 0.7945</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(EB.AL) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Tab_cellnumber) </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY EB&quot;</span>)),</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Cell_type =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;EB.AL&quot;</span>)),</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Tab_cellnumber<span class="sc">$</span>Repeat),</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>tab_stat_EB<span class="ot">=</span>tab_stat</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a><span class="do">#### EC</span></span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(EC.AL) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Tab_cellnumber)</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98161, p-value = 0.2211</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(EC.AL) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> Tab_cellnumber) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(EC.AL) ~ Diet + (1/Repeat)
BP = 1.7873, df = 1, p-value = 0.1813</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(EC.AL) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Tab_cellnumber) </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>test</span></code></pre></div>
<pre><code>     chi2_LR df      p_value
p_v 37.74043  1 8.081226e-10</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY EC&quot;</span>)),</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cell_type =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;EC.AL&quot;</span>)),</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Tab_cellnumber<span class="sc">$</span>Repeat),</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>tab_stat_EC<span class="ot">=</span>tab_stat</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a><span class="do">#### EE</span></span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(EE.AL) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Tab_cellnumber)</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.97566, p-value = 0.08254</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(EE.AL) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> Tab_cellnumber) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(EE.AL) ~ Diet + (1/Repeat)
BP = 3.8518, df = 1, p-value = 0.04969</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(EE.AL) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Tab_cellnumber) </span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY EE&quot;</span>)),</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Cell_type =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;EE.AL&quot;</span>)),</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Tab_cellnumber<span class="sc">$</span>Repeat),</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>tab_stat_EE<span class="ot">=</span>tab_stat</span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_ISC,tab_stat_EB,tab_stat_EC,tab_stat_EE)</span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Cell type&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Cell number) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Cell number) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:left;">
Cell type
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS vs HY ISC
</td>
<td style="text-align:left;">
ISC.AL
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
16.77
</td>
<td style="text-align:left;">
6.25
</td>
<td style="text-align:left;">
0.425
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4.2e-05
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
HS vs HY EB
</td>
<td style="text-align:left;">
EB.AL
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
7.94
</td>
<td style="text-align:left;">
5.34
</td>
<td style="text-align:left;">
0.39
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4.8e-03
</td>
<td style="text-align:left;">
**
</td>
</tr>
<tr>
<td style="text-align:left;">
HS vs HY EC
</td>
<td style="text-align:left;">
EC.AL
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
37.74
</td>
<td style="text-align:left;">
7.62
</td>
<td style="text-align:left;">
0.374
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
HS vs HY EE
</td>
<td style="text-align:left;">
EE.AL
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
14.78
</td>
<td style="text-align:left;">
5.16
</td>
<td style="text-align:left;">
0.505
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.2e-04
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>Tab_cellnumber_gather<span class="ot">=</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>  Tab_cellnumber <span class="sc">%&gt;%</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Diet,Line,Day,Repeat,GutNumber,Region,EB.AL,ISC.AL,EE.AL,EC.AL)<span class="sc">%&gt;%</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(key, value, <span class="sc">-</span><span class="fu">c</span>(Diet,Line,Day,Repeat,GutNumber,Region)) <span class="sc">%&gt;%</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Cell_type =</span> key,</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">Cell_number =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)</span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(Tab_cellnumber_gather,<span class="sc">!</span><span class="fu">is.na</span>(Day))<span class="sc">%&gt;%</span></span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Cell_type)<span class="sc">%&gt;%</span></span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>(),</span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">max=</span><span class="fu">max</span>(Cell_number,<span class="at">na.rm=</span>T))</span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">=</span><span class="fu">subset</span>(Sample_size,Diet<span class="sc">==</span><span class="st">&quot;HY&quot;</span>)</span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> </span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tab_stat,tmp)</span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-22"><a href="#cb150-22" aria-hidden="true" tabindex="-1"></a>Treatment.status <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;ISC&quot;</span>, <span class="st">&quot;EB&quot;</span>,<span class="st">&quot;EC&quot;</span>,<span class="st">&quot;EE&quot;</span>)</span>
<span id="cb150-23"><a href="#cb150-23" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Treatment.status) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;ISC.AL&quot;</span>, <span class="st">&quot;EB.AL&quot;</span>,<span class="st">&quot;EC.AL&quot;</span>,<span class="st">&quot;EE.AL&quot;</span>)</span>
<span id="cb150-24"><a href="#cb150-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-25"><a href="#cb150-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-26"><a href="#cb150-26" aria-hidden="true" tabindex="-1"></a>Plot_Fig3C<span class="ot">=</span></span>
<span id="cb150-27"><a href="#cb150-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Tab_cellnumber_gather, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Cell_number<span class="sc">/</span><span class="dv">100</span><span class="sc">*</span><span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb150-28"><a href="#cb150-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb150-29"><a href="#cb150-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>) <span class="sc">+</span> </span>
<span id="cb150-30"><a href="#cb150-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>Cell_type,<span class="at">scale=</span><span class="st">&quot;free_y&quot;</span>,<span class="at">labeller=</span><span class="fu">labeller</span>(<span class="at">Cell_type=</span>Treatment.status))<span class="sc">+</span></span>
<span id="cb150-31"><a href="#cb150-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_blank</span>(<span class="at">data=</span>tab_stat, <span class="fu">aes</span>(<span class="at">y =</span> max<span class="sc">/</span><span class="dv">100</span><span class="sc">*</span><span class="fl">2.5</span>))<span class="sc">+</span></span>
<span id="cb150-32"><a href="#cb150-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">data =</span> tab_stat, <span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">annotations =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">y_position =</span> max<span class="sc">/</span><span class="dv">100</span><span class="sc">*</span><span class="fl">2.2</span>,), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">manual =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb150-33"><a href="#cb150-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits,</span>
<span id="cb150-34"><a href="#cb150-34" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>palette_diet_2)<span class="sc">+</span></span>
<span id="cb150-35"><a href="#cb150-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb150-36"><a href="#cb150-36" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>),</span>
<span id="cb150-37"><a href="#cb150-37" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS (n = 46)&quot;</span>, <span class="st">&quot;HY (n = 55)&quot;</span>))<span class="sc">+</span></span>
<span id="cb150-38"><a href="#cb150-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Cell number in posterior midgut (x&quot;</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))<span class="sc">+</span></span>
<span id="cb150-39"><a href="#cb150-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb150-40"><a href="#cb150-40" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb150-41"><a href="#cb150-41" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb150-42"><a href="#cb150-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb150-43"><a href="#cb150-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb150-44"><a href="#cb150-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb150-45"><a href="#cb150-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb150-46"><a href="#cb150-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb150-47"><a href="#cb150-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb150-48"><a href="#cb150-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb150-49"><a href="#cb150-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb150-50"><a href="#cb150-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb150-51"><a href="#cb150-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb150-52"><a href="#cb150-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb150-53"><a href="#cb150-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb150-54"><a href="#cb150-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb150-55"><a href="#cb150-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb150-56"><a href="#cb150-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb150-57"><a href="#cb150-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb150-58"><a href="#cb150-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb150-59"><a href="#cb150-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb150-60"><a href="#cb150-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb150-61"><a href="#cb150-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb150-62"><a href="#cb150-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb150-63"><a href="#cb150-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb150-64"><a href="#cb150-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb150-65"><a href="#cb150-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb150-66"><a href="#cb150-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb150-67"><a href="#cb150-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-68"><a href="#cb150-68" aria-hidden="true" tabindex="-1"></a>Plot_Fig3C</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%203C-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-3d" class="section level3" number="3.1.3">
<h3 number="3.1.3"><span class="header-section-number">3.1.3</span> Figure 3D</h3>
<div class="blue">
<p>HS and HY diets do not affect the relative proportion of cell types in the midgut (error is standard error of the mean).</p>
</div>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>tab_prop_cell_type <span class="ot">=</span> </span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;3C&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Diet, Line, Day, Repeat, GutNumber, Region <span class="sc">|</span> <span class="fu">ends_with</span>(<span class="st">&quot;.AL&quot;</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;ESG&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span> </span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()<span class="sc">%&gt;%</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(ISC.AL,EB.AL,EE.AL,EC.AL),round,<span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_cell=</span>ISC.AL<span class="sc">+</span>EB.AL<span class="sc">+</span>EE.AL<span class="sc">+</span>EC.AL,</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">proportion_ISC=</span>ISC.AL<span class="sc">/</span>Total_cell<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">proportion_EB=</span>EB.AL<span class="sc">/</span>Total_cell<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">proportion_EE=</span>EE.AL<span class="sc">/</span>Total_cell<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">proportion_EC=</span>EC.AL<span class="sc">/</span>Total_cell<span class="sc">*</span><span class="dv">100</span>)<span class="sc">%&gt;%</span></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Diet, Line, Day, Repeat, GutNumber, Region <span class="sc">|</span> <span class="fu">starts_with</span>(<span class="st">&quot;proportion&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(key, value, <span class="sc">-!</span><span class="fu">starts_with</span>(<span class="st">&quot;proportion&quot;</span>) )<span class="sc">%&gt;%</span></span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Cell_type =</span> key,</span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">Cell_proportion =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span></span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Cell_type)<span class="sc">%&gt;%</span></span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_proportion=</span><span class="fu">mean</span>(Cell_proportion, <span class="at">na.rm=</span>T),</span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_proportion=</span><span class="fu">se</span>(Cell_proportion)) <span class="sc">%&gt;%</span></span>
<span id="cb151-20"><a href="#cb151-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">as.data.frame</span>()</span>
<span id="cb151-21"><a href="#cb151-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-22"><a href="#cb151-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(tab_prop_cell_type<span class="sc">$</span>se_proportion)){</span>
<span id="cb151-23"><a href="#cb151-23" aria-hidden="true" tabindex="-1"></a>    tab_prop_cell_type<span class="sc">$</span>se_proportionGraphPlus[i] <span class="ot">=</span> tab_prop_cell_type<span class="sc">$</span>mean_proportion[i]<span class="sc">+</span>tab_prop_cell_type<span class="sc">$</span>se_proportion[i]</span>
<span id="cb151-24"><a href="#cb151-24" aria-hidden="true" tabindex="-1"></a>    tab_prop_cell_type<span class="sc">$</span>se_proportionGraphMinus[i] <span class="ot">=</span> tab_prop_cell_type<span class="sc">$</span>mean_proportion[i]<span class="sc">-</span>tab_prop_cell_type<span class="sc">$</span>se_proportion[i]</span>
<span id="cb151-25"><a href="#cb151-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb151-26"><a href="#cb151-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-27"><a href="#cb151-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(tab_prop_cell_type<span class="sc">$</span>se_proportion)){</span>
<span id="cb151-28"><a href="#cb151-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(tab_prop_cell_type<span class="sc">$</span>Cell_type[i]<span class="sc">==</span><span class="st">&quot;proportion_EB&quot;</span>){</span>
<span id="cb151-29"><a href="#cb151-29" aria-hidden="true" tabindex="-1"></a>    tab_prop_cell_type<span class="sc">$</span>se_proportionGraphPlus[i] <span class="ot">=</span> tab_prop_cell_type<span class="sc">$</span>mean_proportion[i]<span class="sc">+</span>tab_prop_cell_type<span class="sc">$</span>se_proportion[i]</span>
<span id="cb151-30"><a href="#cb151-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb151-31"><a href="#cb151-31" aria-hidden="true" tabindex="-1"></a>    tab_prop_cell_type<span class="sc">$</span>se_proportionGraphMinus[i] <span class="ot">=</span> tab_prop_cell_type<span class="sc">$</span>mean_proportion[i]<span class="sc">-</span>tab_prop_cell_type<span class="sc">$</span>se_proportion[i]</span>
<span id="cb151-32"><a href="#cb151-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb151-33"><a href="#cb151-33" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb151-34"><a href="#cb151-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(tab_prop_cell_type<span class="sc">$</span>Cell_type[i]<span class="sc">==</span><span class="st">&quot;proportion_EC&quot;</span>){</span>
<span id="cb151-35"><a href="#cb151-35" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb151-36"><a href="#cb151-36" aria-hidden="true" tabindex="-1"></a>      tab_prop_cell_type<span class="sc">$</span>se_proportionGraphPlus[i] <span class="ot">=</span> tab_prop_cell_type<span class="sc">$</span>mean_proportion[i<span class="dv">-1</span>]<span class="sc">+</span>tab_prop_cell_type<span class="sc">$</span>mean_proportion[i]<span class="sc">+</span>tab_prop_cell_type<span class="sc">$</span>se_proportion[i]</span>
<span id="cb151-37"><a href="#cb151-37" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb151-38"><a href="#cb151-38" aria-hidden="true" tabindex="-1"></a>      tab_prop_cell_type<span class="sc">$</span>se_proportionGraphMinus[i] <span class="ot">=</span> tab_prop_cell_type<span class="sc">$</span>mean_proportion[i<span class="dv">-1</span>]<span class="sc">+</span>tab_prop_cell_type<span class="sc">$</span>mean_proportion[i]<span class="sc">+-</span>tab_prop_cell_type<span class="sc">$</span>se_proportion[i]</span>
<span id="cb151-39"><a href="#cb151-39" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb151-40"><a href="#cb151-40" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb151-41"><a href="#cb151-41" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(tab_prop_cell_type<span class="sc">$</span>Cell_type[i]<span class="sc">==</span><span class="st">&quot;proportion_EE&quot;</span>){</span>
<span id="cb151-42"><a href="#cb151-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb151-43"><a href="#cb151-43" aria-hidden="true" tabindex="-1"></a>        tab_prop_cell_type<span class="sc">$</span>se_proportionGraphPlus[i] <span class="ot">=</span>tab_prop_cell_type<span class="sc">$</span>mean_proportion[i<span class="dv">-1</span>]<span class="sc">+</span> tab_prop_cell_type<span class="sc">$</span>mean_proportion[i<span class="dv">-2</span>]<span class="sc">+</span>tab_prop_cell_type<span class="sc">$</span>mean_proportion[i]<span class="sc">+</span>tab_prop_cell_type<span class="sc">$</span>se_proportion[i]</span>
<span id="cb151-44"><a href="#cb151-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb151-45"><a href="#cb151-45" aria-hidden="true" tabindex="-1"></a>        tab_prop_cell_type<span class="sc">$</span>se_proportionGraphMinus[i] <span class="ot">=</span>tab_prop_cell_type<span class="sc">$</span>mean_proportion[i<span class="dv">-1</span>]<span class="sc">+</span> tab_prop_cell_type<span class="sc">$</span>mean_proportion[i<span class="dv">-2</span>]<span class="sc">+</span>tab_prop_cell_type<span class="sc">$</span>mean_proportion[i]<span class="sc">-</span>tab_prop_cell_type<span class="sc">$</span>se_proportion[i]</span>
<span id="cb151-46"><a href="#cb151-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb151-47"><a href="#cb151-47" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb151-48"><a href="#cb151-48" aria-hidden="true" tabindex="-1"></a>        tab_prop_cell_type<span class="sc">$</span>se_proportionGraphPlus[i] <span class="ot">=</span>tab_prop_cell_type<span class="sc">$</span>mean_proportion[i<span class="dv">-1</span>]<span class="sc">+</span>tab_prop_cell_type<span class="sc">$</span>mean_proportion[i<span class="dv">-2</span>]<span class="sc">+</span> tab_prop_cell_type<span class="sc">$</span>mean_proportion[i<span class="dv">-3</span>]<span class="sc">+</span>tab_prop_cell_type<span class="sc">$</span>mean_proportion[i]<span class="sc">+</span>tab_prop_cell_type<span class="sc">$</span>se_proportion[i]</span>
<span id="cb151-49"><a href="#cb151-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb151-50"><a href="#cb151-50" aria-hidden="true" tabindex="-1"></a>        tab_prop_cell_type<span class="sc">$</span>se_proportionGraphMinus[i] <span class="ot">=</span>tab_prop_cell_type<span class="sc">$</span>mean_proportion[i<span class="dv">-1</span>]<span class="sc">+</span>tab_prop_cell_type<span class="sc">$</span>mean_proportion[i<span class="dv">-2</span>]<span class="sc">+</span> tab_prop_cell_type<span class="sc">$</span>mean_proportion[i<span class="dv">-3</span>]<span class="sc">+</span>tab_prop_cell_type<span class="sc">$</span>mean_proportion[i]<span class="sc">-</span>tab_prop_cell_type<span class="sc">$</span>se_proportion[i]</span>
<span id="cb151-51"><a href="#cb151-51" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb151-52"><a href="#cb151-52" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb151-53"><a href="#cb151-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb151-54"><a href="#cb151-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb151-55"><a href="#cb151-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-56"><a href="#cb151-56" aria-hidden="true" tabindex="-1"></a>tab_prop_cell_type<span class="sc">$</span>Cell_type <span class="ot">=</span><span class="fu">factor</span>(tab_prop_cell_type<span class="sc">$</span>Cell_type,<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;proportion_ISC&quot;</span>,<span class="st">&quot;proportion_EE&quot;</span>,<span class="st">&quot;proportion_EC&quot;</span>,<span class="st">&quot;proportion_EB&quot;</span>))</span>
<span id="cb151-57"><a href="#cb151-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-58"><a href="#cb151-58" aria-hidden="true" tabindex="-1"></a>Plot_Fig3D <span class="ot">=</span></span>
<span id="cb151-59"><a href="#cb151-59" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tab_prop_cell_type, <span class="fu">aes</span>(<span class="at">x=</span>Diet, <span class="at">y=</span>mean_proportion))<span class="sc">+</span> </span>
<span id="cb151-60"><a href="#cb151-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>Cell_type),<span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">width=</span>.<span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb151-61"><a href="#cb151-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span> se_proportionGraphMinus, <span class="at">ymax=</span> se_proportionGraphPlus),<span class="at">width=</span><span class="fl">0.25</span>)<span class="sc">+</span></span>
<span id="cb151-62"><a href="#cb151-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;Cell types&quot;</span>, </span>
<span id="cb151-63"><a href="#cb151-63" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#1fd511&quot;</span>,<span class="st">&quot;#ffffff&quot;</span>, <span class="st">&quot;#5869d5&quot;</span>,<span class="st">&quot;#fe0000&quot;</span>),</span>
<span id="cb151-64"><a href="#cb151-64" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;ISC&quot;</span>, <span class="st">&quot;EE&quot;</span>, <span class="st">&quot;EC&quot;</span>,<span class="st">&quot;EB&quot;</span>))<span class="sc">+</span></span>
<span id="cb151-65"><a href="#cb151-65" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Proportion of cells (% \u00B1se)&quot;</span>,</span>
<span id="cb151-66"><a href="#cb151-66" aria-hidden="true" tabindex="-1"></a>                      <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">101</span>),</span>
<span id="cb151-67"><a href="#cb151-67" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="at">by=</span><span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb151-68"><a href="#cb151-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb151-69"><a href="#cb151-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb151-70"><a href="#cb151-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb151-71"><a href="#cb151-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb151-72"><a href="#cb151-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.1</span> ), </span>
<span id="cb151-73"><a href="#cb151-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb151-74"><a href="#cb151-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb151-75"><a href="#cb151-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb151-76"><a href="#cb151-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb151-77"><a href="#cb151-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb151-78"><a href="#cb151-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb151-79"><a href="#cb151-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb151-80"><a href="#cb151-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb151-81"><a href="#cb151-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb151-82"><a href="#cb151-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb151-83"><a href="#cb151-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb151-84"><a href="#cb151-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb151-85"><a href="#cb151-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb151-86"><a href="#cb151-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb151-87"><a href="#cb151-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont),</span>
<span id="cb151-88"><a href="#cb151-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb151-89"><a href="#cb151-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb151-90"><a href="#cb151-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb151-91"><a href="#cb151-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb151-92"><a href="#cb151-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb151-93"><a href="#cb151-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-94"><a href="#cb151-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-95"><a href="#cb151-95" aria-hidden="true" tabindex="-1"></a>Plot_Fig3D</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%203D-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-3e---f" class="section level3" number="3.1.4">
<h3 number="3.1.4"><span class="header-section-number">3.1.4</span> Figure 3E - F</h3>
<div class="blue">
<p><strong>Diet affects enterocyte size</strong>. Representative picture of midguts stained with anti-Mesh antibody on HS (D, left) vs HY (E, right) diet. <em>Complete graphical annotation can be found in manuscript figures</em></p>
</div>
<div class="row">
<div class="col-md-6">
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%203E-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%203F-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="figure-3g" class="section level3" number="3.1.5">
<h3 number="3.1.5"><span class="header-section-number">3.1.5</span> Figure 3G</h3>
<div class="blue">
<p>Quantification of EC size of individuals on HS or HY diet for 5 days confirms an increase in cell size on HY diet.</p>
</div>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>tab_cell_area <span class="ot">=</span> </span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;3G&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>  tab_cell_area<span class="sc">%&gt;%</span></span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Area) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Repeat),<span class="at">data =</span>tab_cell_area)</span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.99873, p-value = 0.5532</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Area) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span>Repeat),<span class="at">data =</span>tab_cell_area)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Area) ~ Diet + (1/Repeat)
BP = 14.735, df = 1, p-value = 0.0001237</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Area) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Repeat),<span class="at">data =</span>tab_cell_area)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY&quot;</span>)),</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_cell_area<span class="sc">$</span>Repeat),</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb156-13"><a href="#cb156-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb156-14"><a href="#cb156-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb156-15"><a href="#cb156-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-16"><a href="#cb156-16" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb156-17"><a href="#cb156-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Cell area) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb156-18"><a href="#cb156-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Cell area) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS vs HY
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
842.09
</td>
<td style="text-align:left;">
4.8
</td>
<td style="text-align:left;">
0.796
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(tab_cell_area<span class="sc">$</span>Area<span class="sc">/</span><span class="dv">1000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>Plot_Fig3G<span class="ot">=</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_cell_area, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Area<span class="sc">/</span><span class="dv">1000</span>))<span class="sc">+</span> </span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">140</span>) <span class="sc">+</span> </span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.01</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_text(data = tab_stat, mapping = aes(x = 1.5, y = 0.62, label = paste(&quot;p=&quot;,format(Pvalue,digits=3))),size=3)+</span></span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_signif</span>(<span class="at">annotation =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,tab_stat<span class="sc">$</span>Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">y_position =</span> <span class="fl">0.86</span>, <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">tip_length =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.02</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>),</span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span> palette_diet_2 )<span class="sc">+</span></span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>),</span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;EC area (10&quot;</span><span class="sc">^</span><span class="dv">3</span>, <span class="st">&quot;mm&quot;</span><span class="sc">^</span><span class="dv">2</span>,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb157-18"><a href="#cb157-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.01</span>,<span class="fl">0.9</span>),</span>
<span id="cb157-19"><a href="#cb157-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.8</span>,<span class="at">by=</span><span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb157-20"><a href="#cb157-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb157-21"><a href="#cb157-21" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb157-22"><a href="#cb157-22" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb157-23"><a href="#cb157-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb157-24"><a href="#cb157-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb157-25"><a href="#cb157-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb157-26"><a href="#cb157-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb157-27"><a href="#cb157-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb157-28"><a href="#cb157-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb157-29"><a href="#cb157-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb157-30"><a href="#cb157-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb157-31"><a href="#cb157-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb157-32"><a href="#cb157-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb157-33"><a href="#cb157-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb157-34"><a href="#cb157-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb157-35"><a href="#cb157-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb157-36"><a href="#cb157-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb157-37"><a href="#cb157-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb157-38"><a href="#cb157-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb157-39"><a href="#cb157-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb157-40"><a href="#cb157-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb157-41"><a href="#cb157-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb157-42"><a href="#cb157-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb157-43"><a href="#cb157-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))</span>
<span id="cb157-44"><a href="#cb157-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-45"><a href="#cb157-45" aria-hidden="true" tabindex="-1"></a>Plot_Fig3G</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%203G-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>##Export Figure 3</p>
</div>
</div>
<div id="figure-3---figure-supplement-1" class="section level2" number="3.2">
<h2 number="3.2"><span class="header-section-number">3.2</span> Figure 3 - figure supplement 1</h2>
<div id="figure-3s1a" class="section level3" number="3.2.1">
<h3 number="3.2.1"><span class="header-section-number">3.2.1</span> Figure 3S1A</h3>
<div class="blue">
<p>ECs are more densely packed on HS diet than on HY diet.</p>
</div>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>tab_ECarea <span class="ot">=</span> </span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;3C&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Diet, Line, Day, Repeat, GutNumber, Region,EC.A)<span class="sc">%&gt;%</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span> </span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span> </span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">EC_density=</span>EC.A)<span class="sc">%&gt;%</span> </span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EC_density_mm=</span>EC_density<span class="sc">*</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>  tab_ECarea<span class="sc">%&gt;%</span></span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(EC_density_mm <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_ECarea)</span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98248, p-value = 0.2538</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(EC_density_mm <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tab_ECarea) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  EC_density_mm ~ Diet + (1/Repeat)
BP = 0.027933, df = 1, p-value = 0.8673</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(EC_density_mm <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_ECarea) </span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we make a tab with the results</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY&quot;</span>)),</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_ECarea<span class="sc">$</span>Repeat),</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;EC density ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
EC density ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS vs HY
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
20.79
</td>
<td style="text-align:left;">
5.98
</td>
<td style="text-align:left;">
-1.18
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5.1e-06
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>Limits<span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">max</span>(tab_ECarea<span class="sc">$</span>EC_density_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>Plot_Fig3S1A <span class="ot">=</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tab_ECarea, <span class="fu">aes</span>(<span class="at">x=</span>Diet, <span class="at">y=</span>EC_density_mm))<span class="sc">+</span> </span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">60</span>) <span class="sc">+</span> </span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">1.8</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_signif</span>(<span class="at">annotation =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,tab_stat<span class="sc">$</span>Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">y_position =</span> <span class="dv">9</span>, <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">tip_length =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.02</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits,</span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>palette_diet_2)<span class="sc">+</span></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>),</span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;EC density (per &quot;</span>,mm<span class="sc">^</span><span class="dv">2</span>,<span class="st">&quot;)&quot;</span>)),</span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">1.5</span>,<span class="fl">9.5</span>),</span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb163-22"><a href="#cb163-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb163-23"><a href="#cb163-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb163-24"><a href="#cb163-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb163-25"><a href="#cb163-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb163-26"><a href="#cb163-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb163-27"><a href="#cb163-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb163-28"><a href="#cb163-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb163-29"><a href="#cb163-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb163-30"><a href="#cb163-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb163-31"><a href="#cb163-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb163-32"><a href="#cb163-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb163-33"><a href="#cb163-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb163-34"><a href="#cb163-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb163-35"><a href="#cb163-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb163-36"><a href="#cb163-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb163-37"><a href="#cb163-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb163-38"><a href="#cb163-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb163-39"><a href="#cb163-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb163-40"><a href="#cb163-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb163-41"><a href="#cb163-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb163-42"><a href="#cb163-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))</span>
<span id="cb163-43"><a href="#cb163-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-44"><a href="#cb163-44" aria-hidden="true" tabindex="-1"></a>Plot_Fig3S1A</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%203S1A-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-3s1b" class="section level3" number="3.2.2">
<h3 number="3.2.2"><span class="header-section-number">3.2.2</span> Figure 3S1B</h3>
<div class="blue">
<p>Scheme illustrating area measurements. Top view in this scheme is as in pictures shown in figure 3 D, E. 3D side view show side view with Mesh showing measured surface.</p>
</div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%203S1B-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-3s1c" class="section level3" number="3.2.3">
<h3 number="3.2.3"><span class="header-section-number">3.2.3</span> Figure 3S1C</h3>
<div class="blue">
<p><strong>Diet affects enterocyte size.</strong> Quantification of EC height of MyoTS&gt;GFP on HS or HY diet demonstrates an increase in cell height on HY diet.</p>
</div>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>tab_ECheight <span class="ot">=</span> </span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;3 - S1C&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">select</span>(Diet, Repeat, GutNumber, Region, Height)<span class="sc">%&gt;%</span></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span> </span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span> </span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">EC_height=</span>Height)<span class="sc">%&gt;%</span> </span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>tab_ECheight<span class="sc">$</span>EC_height <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(tab_ECheight<span class="sc">$</span>EC_height)</span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>  tab_ECheight<span class="sc">%&gt;%</span></span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>((EC_height) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_ECheight)</span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98665, p-value = 1.551e-06</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(EC_height <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tab_ECheight) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  EC_height ~ Diet + (1/Repeat)
BP = 40.813, df = 1, p-value = 1.676e-10</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(EC_height <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_ECheight) </span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we make a tab with the results</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY&quot;</span>)),</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_ECheight<span class="sc">$</span>Repeat),</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;EC height ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
EC height ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS vs HY
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
494.51
</td>
<td style="text-align:left;">
7.09
</td>
<td style="text-align:left;">
5.03
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>Limits<span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">max</span>(tab_ECheight<span class="sc">$</span>EC_height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>Plot_Fig3S1C <span class="ot">=</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_ECheight, <span class="fu">aes</span>(<span class="at">x=</span>Diet, <span class="at">y=</span>EC_height))<span class="sc">+</span> </span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">150</span>) <span class="sc">+</span> </span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_signif</span>(<span class="at">annotation =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,tab_stat<span class="sc">$</span>Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">y_position =</span> <span class="dv">23</span>, <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">tip_length =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.02</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits,</span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>palette_diet_2)<span class="sc">+</span></span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>),</span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb169-17"><a href="#cb169-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;EC height (&quot;</span>, mu, <span class="st">&quot;m)&quot;</span>)),</span>
<span id="cb169-18"><a href="#cb169-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">25</span>),</span>
<span id="cb169-19"><a href="#cb169-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">25</span>,<span class="at">by=</span><span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb169-20"><a href="#cb169-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb169-21"><a href="#cb169-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb169-22"><a href="#cb169-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb169-23"><a href="#cb169-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb169-24"><a href="#cb169-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb169-25"><a href="#cb169-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb169-26"><a href="#cb169-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb169-27"><a href="#cb169-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb169-28"><a href="#cb169-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb169-29"><a href="#cb169-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb169-30"><a href="#cb169-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb169-31"><a href="#cb169-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb169-32"><a href="#cb169-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb169-33"><a href="#cb169-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb169-34"><a href="#cb169-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb169-35"><a href="#cb169-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb169-36"><a href="#cb169-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb169-37"><a href="#cb169-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb169-38"><a href="#cb169-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb169-39"><a href="#cb169-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb169-40"><a href="#cb169-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb169-41"><a href="#cb169-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb169-42"><a href="#cb169-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb169-43"><a href="#cb169-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))</span>
<span id="cb169-44"><a href="#cb169-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-45"><a href="#cb169-45" aria-hidden="true" tabindex="-1"></a>Plot_Fig3S1C</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%203S1C-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-3s1d" class="section level3" number="3.2.4">
<h3 number="3.2.4"><span class="header-section-number">3.2.4</span> Figure 3S1D</h3>
<div class="blue">
<p>Representative density plot from FACS for HS diet <em>Complete annotation found in manuscript’s figures</em></p>
</div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%203S1D-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-3s1e" class="section level3" number="3.2.5">
<h3 number="3.2.5"><span class="header-section-number">3.2.5</span> Figure 3S1E</h3>
<div class="blue">
<p>Representative density plot from FACS for HY diet <em>Complete annotation found in manuscript’s figures</em></p>
</div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%203S1E-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-3s1f" class="section level3" number="3.2.6">
<h3 number="3.2.6"><span class="header-section-number">3.2.6</span> Figure 3S1F</h3>
<div class="blue">
<p>Representative frequency plot from FACS for HS diet. <em>Complete annotation found in manuscript’s figures</em></p>
</div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%203S1F-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-3s1g" class="section level3" number="3.2.7">
<h3 number="3.2.7"><span class="header-section-number">3.2.7</span> Figure 3S1G</h3>
<div class="blue">
<p>Representative frequency plot from FACS for HY diet<em>Complete annotation found in manuscript’s figures</em></p>
</div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%203S1G-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-3s1h" class="section level3" number="3.2.8">
<h3 number="3.2.8"><span class="header-section-number">3.2.8</span> Figure 3S1H</h3>
<div class="blue">
<p><strong>Ploidy of midguts on either HS or HY diets is largely unchanged.</strong> Stacked bar plot from 7 repeats, each of 25 midguts</p>
</div>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>tab_ploidy_rev <span class="ot">=</span> </span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;3 - S1H&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet, Ploidy)<span class="sc">%&gt;%</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_Percentage=</span><span class="fu">mean</span>(Percentage,<span class="at">na.rm=</span>T),</span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_Percentage=</span><span class="fu">sd</span>(Percentage))<span class="sc">%&gt;%</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group=</span><span class="fu">paste</span>(Diet, Ploidy,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ploidy=</span><span class="fu">fct_relevel</span>(Ploidy,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;4&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;16&quot;</span>, <span class="st">&quot;32&quot;</span>, <span class="st">&quot;64&quot;</span>, <span class="st">&quot;64+&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a>    tab_ploidy_rev<span class="sc">%&gt;%</span></span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb170-18"><a href="#cb170-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb170-19"><a href="#cb170-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-20"><a href="#cb170-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-21"><a href="#cb170-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-22"><a href="#cb170-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Creation of dataset with right position for error bar</span></span>
<span id="cb170-23"><a href="#cb170-23" aria-hidden="true" tabindex="-1"></a><span class="do">##HS</span></span>
<span id="cb170-24"><a href="#cb170-24" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_ploidy_rev , Diet<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>))</span>
<span id="cb170-25"><a href="#cb170-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-26"><a href="#cb170-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-27"><a href="#cb170-27" aria-hidden="true" tabindex="-1"></a>tmp1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(tmp, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(group , sd_Percentage, Diet))</span>
<span id="cb170-28"><a href="#cb170-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-29"><a href="#cb170-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-30"><a href="#cb170-30" aria-hidden="true" tabindex="-1"></a>tmpw1 <span class="ot">&lt;-</span><span class="fu">spread</span>(tmp1, Ploidy, mean_Percentage)</span>
<span id="cb170-31"><a href="#cb170-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-32"><a href="#cb170-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-33"><a href="#cb170-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-34"><a href="#cb170-34" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2.p</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2</span><span class="st">`</span></span>
<span id="cb170-35"><a href="#cb170-35" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.p</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4</span><span class="st">`</span></span>
<span id="cb170-36"><a href="#cb170-36" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.p</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8</span><span class="st">`</span></span>
<span id="cb170-37"><a href="#cb170-37" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.p</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16</span><span class="st">`</span></span>
<span id="cb170-38"><a href="#cb170-38" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.p</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32</span><span class="st">`</span></span>
<span id="cb170-39"><a href="#cb170-39" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.p</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64</span><span class="st">`</span></span>
<span id="cb170-40"><a href="#cb170-40" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+.p</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+</span><span class="st">`</span></span>
<span id="cb170-41"><a href="#cb170-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-42"><a href="#cb170-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-43"><a href="#cb170-43" aria-hidden="true" tabindex="-1"></a>tmp2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(tmp, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(group , mean_Percentage, Diet))</span>
<span id="cb170-44"><a href="#cb170-44" aria-hidden="true" tabindex="-1"></a>tmpw2 <span class="ot">&lt;-</span><span class="fu">spread</span>(tmp2, Ploidy, sd_Percentage)</span>
<span id="cb170-45"><a href="#cb170-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-46"><a href="#cb170-46" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2.se</span><span class="st">`</span> <span class="ot">=</span> tmpw2<span class="sc">$</span><span class="st">`</span><span class="at">2</span><span class="st">`</span></span>
<span id="cb170-47"><a href="#cb170-47" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.se</span><span class="st">`</span> <span class="ot">=</span> tmpw2<span class="sc">$</span><span class="st">`</span><span class="at">4</span><span class="st">`</span></span>
<span id="cb170-48"><a href="#cb170-48" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.se</span><span class="st">`</span> <span class="ot">=</span> tmpw2<span class="sc">$</span><span class="st">`</span><span class="at">8</span><span class="st">`</span></span>
<span id="cb170-49"><a href="#cb170-49" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.se</span><span class="st">`</span> <span class="ot">=</span> tmpw2<span class="sc">$</span><span class="st">`</span><span class="at">16</span><span class="st">`</span></span>
<span id="cb170-50"><a href="#cb170-50" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.se</span><span class="st">`</span> <span class="ot">=</span> tmpw2<span class="sc">$</span><span class="st">`</span><span class="at">32</span><span class="st">`</span></span>
<span id="cb170-51"><a href="#cb170-51" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.se</span><span class="st">`</span> <span class="ot">=</span> tmpw2<span class="sc">$</span><span class="st">`</span><span class="at">64</span><span class="st">`</span></span>
<span id="cb170-52"><a href="#cb170-52" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+.se</span><span class="st">`</span> <span class="ot">=</span> tmpw2<span class="sc">$</span><span class="st">`</span><span class="at">64+</span><span class="st">`</span></span>
<span id="cb170-53"><a href="#cb170-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-54"><a href="#cb170-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-55"><a href="#cb170-55" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2.se+</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2.se</span><span class="st">`</span></span>
<span id="cb170-56"><a href="#cb170-56" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.se+</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.se</span><span class="st">`</span></span>
<span id="cb170-57"><a href="#cb170-57" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.se+</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.se</span><span class="st">`</span></span>
<span id="cb170-58"><a href="#cb170-58" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.se+</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.se</span><span class="st">`</span></span>
<span id="cb170-59"><a href="#cb170-59" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.se+</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.se</span><span class="st">`</span></span>
<span id="cb170-60"><a href="#cb170-60" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.se+</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.se</span><span class="st">`</span></span>
<span id="cb170-61"><a href="#cb170-61" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+.se+</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+.se</span><span class="st">`</span></span>
<span id="cb170-62"><a href="#cb170-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-63"><a href="#cb170-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-64"><a href="#cb170-64" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2.se-</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="sc">-</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2.se</span><span class="st">`</span></span>
<span id="cb170-65"><a href="#cb170-65" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.se-</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.p</span><span class="st">`</span> <span class="sc">-</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.se</span><span class="st">`</span></span>
<span id="cb170-66"><a href="#cb170-66" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.se-</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.p</span><span class="st">`</span> <span class="sc">-</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.se</span><span class="st">`</span></span>
<span id="cb170-67"><a href="#cb170-67" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.se-</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.p</span><span class="st">`</span> <span class="sc">-</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.se</span><span class="st">`</span></span>
<span id="cb170-68"><a href="#cb170-68" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.se-</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.p</span><span class="st">`</span> <span class="sc">-</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.se</span><span class="st">`</span></span>
<span id="cb170-69"><a href="#cb170-69" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.se-</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.p</span><span class="st">`</span> <span class="sc">-</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.se</span><span class="st">`</span></span>
<span id="cb170-70"><a href="#cb170-70" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+.se-</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+.p</span><span class="st">`</span> <span class="sc">-</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+.se</span><span class="st">`</span></span>
<span id="cb170-71"><a href="#cb170-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-72"><a href="#cb170-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-73"><a href="#cb170-73" aria-hidden="true" tabindex="-1"></a>tmpl <span class="ot">&lt;-</span> <span class="fu">reshape</span>(<span class="at">data=</span>tmpw1, </span>
<span id="cb170-74"><a href="#cb170-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">varying =</span> <span class="fu">list</span>(<span class="at">Ploidy =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>), <span class="at">Position =</span> <span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">14</span>), <span class="at">se =</span> <span class="fu">c</span>(<span class="dv">15</span><span class="sc">:</span><span class="dv">21</span>), <span class="at">seplus =</span> <span class="fu">c</span>(<span class="dv">22</span><span class="sc">:</span><span class="dv">28</span>), <span class="at">seminus =</span> <span class="fu">c</span>(<span class="dv">29</span><span class="sc">:</span><span class="dv">35</span>)),</span>
<span id="cb170-75"><a href="#cb170-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>,</span>
<span id="cb170-76"><a href="#cb170-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">v.names =</span> <span class="fu">c</span>(<span class="st">&quot;Percentage&quot;</span>, <span class="st">&quot;Position&quot;</span>, <span class="st">&quot;se&quot;</span>, <span class="st">&quot;seplus&quot;</span>, <span class="st">&quot;seminus&quot;</span>),</span>
<span id="cb170-77"><a href="#cb170-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb170-78"><a href="#cb170-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-79"><a href="#cb170-79" aria-hidden="true" tabindex="-1"></a>tmpl<span class="sc">$</span>Ploidy <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;2&quot;</span>,<span class="st">&quot;4&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;16&quot;</span>, <span class="st">&quot;32&quot;</span>, <span class="st">&quot;64&quot;</span>, <span class="st">&quot;64+&quot;</span>)</span>
<span id="cb170-80"><a href="#cb170-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-81"><a href="#cb170-81" aria-hidden="true" tabindex="-1"></a>tmpl<span class="sc">$</span>Diet <span class="ot">=</span> <span class="st">&quot;HS&quot;</span></span>
<span id="cb170-82"><a href="#cb170-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-83"><a href="#cb170-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-84"><a href="#cb170-84" aria-hidden="true" tabindex="-1"></a>tmpl <span class="ot">&lt;-</span> <span class="fu">subset</span>(tmpl, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(time , id))</span>
<span id="cb170-85"><a href="#cb170-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-86"><a href="#cb170-86" aria-hidden="true" tabindex="-1"></a>tmpl_HS <span class="ot">&lt;-</span> tmpl</span>
<span id="cb170-87"><a href="#cb170-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-88"><a href="#cb170-88" aria-hidden="true" tabindex="-1"></a><span class="do">##HY</span></span>
<span id="cb170-89"><a href="#cb170-89" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_ploidy_rev , Diet<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>))</span>
<span id="cb170-90"><a href="#cb170-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-91"><a href="#cb170-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-92"><a href="#cb170-92" aria-hidden="true" tabindex="-1"></a>tmp1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(tmp, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(group , sd_Percentage, Diet))</span>
<span id="cb170-93"><a href="#cb170-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-94"><a href="#cb170-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-95"><a href="#cb170-95" aria-hidden="true" tabindex="-1"></a>tmpw1 <span class="ot">&lt;-</span><span class="fu">spread</span>(tmp1, Ploidy, mean_Percentage)</span>
<span id="cb170-96"><a href="#cb170-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-97"><a href="#cb170-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-98"><a href="#cb170-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-99"><a href="#cb170-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-100"><a href="#cb170-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-101"><a href="#cb170-101" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2.p</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2</span><span class="st">`</span></span>
<span id="cb170-102"><a href="#cb170-102" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.p</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4</span><span class="st">`</span></span>
<span id="cb170-103"><a href="#cb170-103" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.p</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8</span><span class="st">`</span></span>
<span id="cb170-104"><a href="#cb170-104" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.p</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16</span><span class="st">`</span></span>
<span id="cb170-105"><a href="#cb170-105" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.p</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32</span><span class="st">`</span></span>
<span id="cb170-106"><a href="#cb170-106" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.p</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64</span><span class="st">`</span></span>
<span id="cb170-107"><a href="#cb170-107" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+.p</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+</span><span class="st">`</span></span>
<span id="cb170-108"><a href="#cb170-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-109"><a href="#cb170-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-110"><a href="#cb170-110" aria-hidden="true" tabindex="-1"></a>tmp2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(tmp, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(group , mean_Percentage, Diet))</span>
<span id="cb170-111"><a href="#cb170-111" aria-hidden="true" tabindex="-1"></a>tmpw2 <span class="ot">&lt;-</span><span class="fu">spread</span>(tmp2, Ploidy, sd_Percentage)</span>
<span id="cb170-112"><a href="#cb170-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-113"><a href="#cb170-113" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2.se</span><span class="st">`</span> <span class="ot">=</span> tmpw2<span class="sc">$</span><span class="st">`</span><span class="at">2</span><span class="st">`</span></span>
<span id="cb170-114"><a href="#cb170-114" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.se</span><span class="st">`</span> <span class="ot">=</span> tmpw2<span class="sc">$</span><span class="st">`</span><span class="at">4</span><span class="st">`</span></span>
<span id="cb170-115"><a href="#cb170-115" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.se</span><span class="st">`</span> <span class="ot">=</span> tmpw2<span class="sc">$</span><span class="st">`</span><span class="at">8</span><span class="st">`</span></span>
<span id="cb170-116"><a href="#cb170-116" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.se</span><span class="st">`</span> <span class="ot">=</span> tmpw2<span class="sc">$</span><span class="st">`</span><span class="at">16</span><span class="st">`</span></span>
<span id="cb170-117"><a href="#cb170-117" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.se</span><span class="st">`</span> <span class="ot">=</span> tmpw2<span class="sc">$</span><span class="st">`</span><span class="at">32</span><span class="st">`</span></span>
<span id="cb170-118"><a href="#cb170-118" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.se</span><span class="st">`</span> <span class="ot">=</span> tmpw2<span class="sc">$</span><span class="st">`</span><span class="at">64</span><span class="st">`</span></span>
<span id="cb170-119"><a href="#cb170-119" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+.se</span><span class="st">`</span> <span class="ot">=</span> tmpw2<span class="sc">$</span><span class="st">`</span><span class="at">64+</span><span class="st">`</span></span>
<span id="cb170-120"><a href="#cb170-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-121"><a href="#cb170-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-122"><a href="#cb170-122" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2.se+</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2.se</span><span class="st">`</span></span>
<span id="cb170-123"><a href="#cb170-123" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.se+</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.se</span><span class="st">`</span></span>
<span id="cb170-124"><a href="#cb170-124" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.se+</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.se</span><span class="st">`</span></span>
<span id="cb170-125"><a href="#cb170-125" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.se+</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.se</span><span class="st">`</span></span>
<span id="cb170-126"><a href="#cb170-126" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.se+</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.se</span><span class="st">`</span></span>
<span id="cb170-127"><a href="#cb170-127" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.se+</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.se</span><span class="st">`</span></span>
<span id="cb170-128"><a href="#cb170-128" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+.se+</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+.p</span><span class="st">`</span> <span class="sc">+</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+.se</span><span class="st">`</span></span>
<span id="cb170-129"><a href="#cb170-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-130"><a href="#cb170-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-131"><a href="#cb170-131" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2.se-</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="sc">-</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">2.se</span><span class="st">`</span></span>
<span id="cb170-132"><a href="#cb170-132" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.se-</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.p</span><span class="st">`</span> <span class="sc">-</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">4.se</span><span class="st">`</span></span>
<span id="cb170-133"><a href="#cb170-133" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.se-</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.p</span><span class="st">`</span> <span class="sc">-</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">8.se</span><span class="st">`</span></span>
<span id="cb170-134"><a href="#cb170-134" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.se-</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.p</span><span class="st">`</span> <span class="sc">-</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">16.se</span><span class="st">`</span></span>
<span id="cb170-135"><a href="#cb170-135" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.se-</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.p</span><span class="st">`</span> <span class="sc">-</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">32.se</span><span class="st">`</span></span>
<span id="cb170-136"><a href="#cb170-136" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.se-</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.p</span><span class="st">`</span> <span class="sc">-</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64.se</span><span class="st">`</span></span>
<span id="cb170-137"><a href="#cb170-137" aria-hidden="true" tabindex="-1"></a>tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+.se-</span><span class="st">`</span> <span class="ot">=</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+.p</span><span class="st">`</span> <span class="sc">-</span> tmpw1<span class="sc">$</span><span class="st">`</span><span class="at">64+.se</span><span class="st">`</span></span>
<span id="cb170-138"><a href="#cb170-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-139"><a href="#cb170-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-140"><a href="#cb170-140" aria-hidden="true" tabindex="-1"></a>tmpl <span class="ot">&lt;-</span> <span class="fu">reshape</span>(<span class="at">data=</span>tmpw1, </span>
<span id="cb170-141"><a href="#cb170-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">varying =</span> <span class="fu">list</span>(<span class="at">Ploidy =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>), <span class="at">Position =</span> <span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">14</span>), <span class="at">se =</span> <span class="fu">c</span>(<span class="dv">15</span><span class="sc">:</span><span class="dv">21</span>), <span class="at">seplus =</span> <span class="fu">c</span>(<span class="dv">22</span><span class="sc">:</span><span class="dv">28</span>), <span class="at">seminus =</span> <span class="fu">c</span>(<span class="dv">29</span><span class="sc">:</span><span class="dv">35</span>)),</span>
<span id="cb170-142"><a href="#cb170-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>,</span>
<span id="cb170-143"><a href="#cb170-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">v.names =</span> <span class="fu">c</span>(<span class="st">&quot;Percentage&quot;</span>, <span class="st">&quot;Position&quot;</span>, <span class="st">&quot;se&quot;</span>, <span class="st">&quot;seplus&quot;</span>, <span class="st">&quot;seminus&quot;</span>),</span>
<span id="cb170-144"><a href="#cb170-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb170-145"><a href="#cb170-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-146"><a href="#cb170-146" aria-hidden="true" tabindex="-1"></a>tmpl<span class="sc">$</span>Ploidy <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;2&quot;</span>,<span class="st">&quot;4&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;16&quot;</span>, <span class="st">&quot;32&quot;</span>, <span class="st">&quot;64&quot;</span>, <span class="st">&quot;64+&quot;</span>)</span>
<span id="cb170-147"><a href="#cb170-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-148"><a href="#cb170-148" aria-hidden="true" tabindex="-1"></a>tmpl<span class="sc">$</span>Diet <span class="ot">=</span> <span class="st">&quot;HY&quot;</span></span>
<span id="cb170-149"><a href="#cb170-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-150"><a href="#cb170-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-151"><a href="#cb170-151" aria-hidden="true" tabindex="-1"></a>tmpl <span class="ot">&lt;-</span> <span class="fu">subset</span>(tmpl, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(time , id))</span>
<span id="cb170-152"><a href="#cb170-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-153"><a href="#cb170-153" aria-hidden="true" tabindex="-1"></a>tmpl_HY <span class="ot">&lt;-</span> tmpl</span>
<span id="cb170-154"><a href="#cb170-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-155"><a href="#cb170-155" aria-hidden="true" tabindex="-1"></a><span class="co">#Bind, rename and reorcer</span></span>
<span id="cb170-156"><a href="#cb170-156" aria-hidden="true" tabindex="-1"></a>tab_ploidy <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tmpl_HS, tmpl_HY)</span>
<span id="cb170-157"><a href="#cb170-157" aria-hidden="true" tabindex="-1"></a>tab_ploidy<span class="sc">$</span>Ploidy <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(tab_ploidy<span class="sc">$</span>Ploidy)</span>
<span id="cb170-158"><a href="#cb170-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-159"><a href="#cb170-159" aria-hidden="true" tabindex="-1"></a>tab_ploidy<span class="sc">$</span>Ploidy <span class="ot">&lt;-</span><span class="fu">factor</span>(tab_ploidy<span class="sc">$</span>Ploidy, <span class="at">levels =</span><span class="fu">c</span>(<span class="st">&quot;64+&quot;</span>,<span class="st">&quot;64&quot;</span>, <span class="st">&quot;32&quot;</span>, <span class="st">&quot;16&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;2&quot;</span>))</span>
<span id="cb170-160"><a href="#cb170-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-161"><a href="#cb170-161" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot</span></span>
<span id="cb170-162"><a href="#cb170-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-163"><a href="#cb170-163" aria-hidden="true" tabindex="-1"></a>                                  </span>
<span id="cb170-164"><a href="#cb170-164" aria-hidden="true" tabindex="-1"></a>Plot_Fig3S1H <span class="ot">=</span></span>
<span id="cb170-165"><a href="#cb170-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_ploidy, <span class="fu">aes</span>(<span class="at">x=</span>Diet, <span class="at">y=</span>Percentage))<span class="sc">+</span> </span>
<span id="cb170-166"><a href="#cb170-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>Ploidy),<span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">width=</span>.<span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb170-167"><a href="#cb170-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span> seminus, <span class="at">ymax=</span> seplus),<span class="at">width=</span><span class="fl">0.25</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb170-168"><a href="#cb170-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb170-169"><a href="#cb170-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;Ploidy&quot;</span>, </span>
<span id="cb170-170"><a href="#cb170-170" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#0052A2&quot;</span>,<span class="st">&quot;#1A63AB&quot;</span>, <span class="st">&quot;#3375B5&quot;</span>, <span class="st">&quot;#6697C7&quot;</span>, <span class="st">&quot;#99BADA&quot;</span>, <span class="st">&quot;#CCDCEC&quot;</span>, <span class="st">&quot;#E6EEF6&quot;</span>),</span>
<span id="cb170-171"><a href="#cb170-171" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;64+n&quot;</span>, <span class="st">&quot;64n&quot;</span>, <span class="st">&quot;32n&quot;</span>, <span class="st">&quot;16n&quot;</span>, <span class="st">&quot;8n&quot;</span>, <span class="st">&quot;4n&quot;</span>, <span class="st">&quot;2n&quot;</span>))<span class="sc">+</span></span>
<span id="cb170-172"><a href="#cb170-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Percentage of ploidy (mean \u00B1sd)&quot;</span>,</span>
<span id="cb170-173"><a href="#cb170-173" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">90</span>),</span>
<span id="cb170-174"><a href="#cb170-174" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">80</span>,<span class="at">by=</span><span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb170-175"><a href="#cb170-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb170-176"><a href="#cb170-176" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb170-177"><a href="#cb170-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb170-178"><a href="#cb170-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb170-179"><a href="#cb170-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb170-180"><a href="#cb170-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb170-181"><a href="#cb170-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb170-182"><a href="#cb170-182" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb170-183"><a href="#cb170-183" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb170-184"><a href="#cb170-184" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb170-185"><a href="#cb170-185" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb170-186"><a href="#cb170-186" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb170-187"><a href="#cb170-187" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>, </span>
<span id="cb170-188"><a href="#cb170-188" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb170-189"><a href="#cb170-189" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb170-190"><a href="#cb170-190" aria-hidden="true" tabindex="-1"></a>    <span class="co">#legend.key.height = unit(0.6, &quot;cm&quot;),</span></span>
<span id="cb170-191"><a href="#cb170-191" aria-hidden="true" tabindex="-1"></a>    <span class="co">#legend.key.width= unit(0.4, &quot;cm&quot;),</span></span>
<span id="cb170-192"><a href="#cb170-192" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb170-193"><a href="#cb170-193" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb170-194"><a href="#cb170-194" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont),</span>
<span id="cb170-195"><a href="#cb170-195" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb170-196"><a href="#cb170-196" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb170-197"><a href="#cb170-197" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">4</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb170-198"><a href="#cb170-198" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb170-199"><a href="#cb170-199" aria-hidden="true" tabindex="-1"></a>    <span class="co">#strip.background = element_rect(fill=NA, colour=&quot;black&quot;),</span></span>
<span id="cb170-200"><a href="#cb170-200" aria-hidden="true" tabindex="-1"></a>    <span class="co">#strip.placement=&quot;outside&quot;)</span></span>
<span id="cb170-201"><a href="#cb170-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-202"><a href="#cb170-202" aria-hidden="true" tabindex="-1"></a>Plot_Fig3S1H</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%203S1H-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>##Export Figure 3S1</p>
</div>
</div>
</div>
<div id="figure-4.-shifts-in-diet-composition-lead-to-plastic-midgut-resizing-and-changes-in-absolute-and-relative-cell-loss-and-gain" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Figure 4. Shifts in diet composition lead to plastic midgut resizing and changes in absolute and relative cell loss and gain</h1>
<div id="figure-4---main" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Figure 4 - main</h2>
<div id="figure-4a" class="section level3" number="4.1.1">
<h3 number="4.1.1"><span class="header-section-number">4.1.1</span> Figure 4A</h3>
<div class="blue">
<p>Midguts can respond plastically to changes in isocaloric diets. Midgut length increases from eclosion on HY for 7 days, then decreases when switched to HS for additional 7 days but can re-increase size upon a further 7 days HY feeding. Letters above violin plots represent grouping by statistical differences (Post hoc Tukey on GLMM).</p>
</div>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>Length_plasticity_time <span class="ot">=</span> </span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;4A&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),<span class="sc">~</span>.<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Total_Length_mm=</span>Total.L,</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Day_of_treatment=</span>Day)</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>  Length_plasticity_time<span class="sc">%&gt;%</span></span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Length_plasticity_time)</span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.99167, p-value = 0.7868</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> Length_plasticity_time) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 12.435, df = 3, p-value = 0.006032</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Length_plasticity_time) </span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Anova diets&quot;</span>)),</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Length_plasticity_time<span class="sc">$</span>Repeat),</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb175-17"><a href="#cb175-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb175-18"><a href="#cb175-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Anova diets
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
106.66
</td>
<td style="text-align:left;">
1.22
</td>
<td style="text-align:left;">
0.553
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">lmer</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> Length_plasticity_time)</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>multcomp <span class="ot">=</span> <span class="fu">glht</span>(mod.gen, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Diet=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">cld</span>(multcomp)</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>letter_position <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span>Length_plasticity_time,Total_Length_mm <span class="sc">~</span>  Diet, max)</span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span>  <span class="fu">as.data.frame</span>(tmp<span class="sc">$</span>mcletters<span class="sc">$</span>Letters)</span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>tab_letter<span class="sc">$</span>Diet<span class="ot">=</span><span class="fu">rownames</span>(tab_letter)</span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_letter)[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">&quot;Letter&quot;</span></span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span> <span class="fu">left_join</span>(tab_letter,letter_position)</span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb176-14"><a href="#cb176-14" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Eclosion&quot;</span>,<span class="st">&quot;HY&quot;</span>,<span class="st">&quot;HYtoHS&quot;</span>, <span class="st">&quot;HYtoHStoHY&quot;</span>)</span>
<span id="cb176-15"><a href="#cb176-15" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(Length_plasticity_time<span class="sc">$</span>Total_Length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb176-16"><a href="#cb176-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-17"><a href="#cb176-17" aria-hidden="true" tabindex="-1"></a>Plot_Fig4A<span class="ot">=</span></span>
<span id="cb176-18"><a href="#cb176-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Length_plasticity_time, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb176-19"><a href="#cb176-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb176-20"><a href="#cb176-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">60</span>) <span class="sc">+</span> </span>
<span id="cb176-21"><a href="#cb176-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb176-22"><a href="#cb176-22" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_text</span>(<span class="at">data =</span> tab_letter, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm<span class="fl">+0.4</span>, <span class="at">label =</span> Letter),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb176-23"><a href="#cb176-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_stat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> <span class="fl">7.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,<span class="fu">format</span>(Pvalue,<span class="at">digits=</span><span class="dv">2</span>))),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb176-24"><a href="#cb176-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span>Limits,</span>
<span id="cb176-25"><a href="#cb176-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>cbbPalette_4)<span class="sc">+</span></span>
<span id="cb176-26"><a href="#cb176-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb176-27"><a href="#cb176-27" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span>Limits,</span>
<span id="cb176-28"><a href="#cb176-28" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Eclosion&quot;</span>,<span class="st">&quot;HY&quot;</span>,<span class="st">&quot;HY to HS&quot;</span>, <span class="st">&quot;HY to HS to HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb176-29"><a href="#cb176-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb176-30"><a href="#cb176-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">1.3</span>,<span class="fl">8.2</span>),</span>
<span id="cb176-31"><a href="#cb176-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>),</span>
<span id="cb176-32"><a href="#cb176-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">7</span>,<span class="at">by=</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb176-33"><a href="#cb176-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb176-34"><a href="#cb176-34" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb176-35"><a href="#cb176-35" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb176-36"><a href="#cb176-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb176-37"><a href="#cb176-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb176-38"><a href="#cb176-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb176-39"><a href="#cb176-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb176-40"><a href="#cb176-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb176-41"><a href="#cb176-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb176-42"><a href="#cb176-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb176-43"><a href="#cb176-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb176-44"><a href="#cb176-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb176-45"><a href="#cb176-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb176-46"><a href="#cb176-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb176-47"><a href="#cb176-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb176-48"><a href="#cb176-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb176-49"><a href="#cb176-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb176-50"><a href="#cb176-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb176-51"><a href="#cb176-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb176-52"><a href="#cb176-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb176-53"><a href="#cb176-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb176-54"><a href="#cb176-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb176-55"><a href="#cb176-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb176-56"><a href="#cb176-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb176-57"><a href="#cb176-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb176-58"><a href="#cb176-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb176-59"><a href="#cb176-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb176-60"><a href="#cb176-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-61"><a href="#cb176-61" aria-hidden="true" tabindex="-1"></a>Plot_Fig4A</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204A-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-4b" class="section level3" number="4.1.2">
<h3 number="4.1.2"><span class="header-section-number">4.1.2</span> Figure 4B</h3>
<div class="blue">
<p>Mitotically active cells visualized by phospho-Histone H3 (pH3) immunostaining are more numerous on HY diet than on HS diet. pH3+ cells gradually increase over time on HY, but not HS diet. Letters above violin plots represent grouping by statistical differences (Post hoc Tukey on GLMM).</p>
</div>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>Length_Diet_time <span class="ot">=</span> </span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;4B, 4S1C&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">ends_with</span>(<span class="st">&quot;.L&quot;</span>)),<span class="sc">~</span>.<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group=</span><span class="fu">paste</span>(Diet, Day,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Total_Length_mm=</span>Total.L,</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">PH3_positive_cell=</span>Total.PH3,</span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Day_of_treatment=</span>Day)</span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a>  Length_Diet_time<span class="sc">%&gt;%</span></span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Day_of_treatment)<span class="sc">%&gt;%</span></span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-17"><a href="#cb177-17" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(PH3_positive_cell <span class="sc">~</span>  group <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_Diet_time,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell)))</span>
<span id="cb177-18"><a href="#cb177-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.97954, p-value = 0.01115</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(PH3_positive_cell <span class="sc">~</span>  group <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_Diet_time,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell)))</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  PH3_positive_cell ~ group + (1/Repeat)
BP = 41.055, df = 7, p-value = 7.901e-07</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(PH3_positive_cell <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_Diet_time,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell)))</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Any difference&quot;</span>)),</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Length_Diet_time<span class="sc">$</span>Repeat),</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;PH3_positive_cell ~  group + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
PH3_positive_cell ~ group + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Any difference
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
248.1
</td>
<td style="text-align:left;">
11.4
</td>
<td style="text-align:left;">
3.98
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>Diet<span class="ot">=</span><span class="st">&quot;HS&quot;</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">lmer</span>(PH3_positive_cell <span class="sc">~</span>  group <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span><span class="fu">subset</span>(Length_Diet_time,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell)))</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>multcomp <span class="ot">=</span> <span class="fu">glht</span>(mod.gen, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">group=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">cld</span>(multcomp)</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>letter_position <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span><span class="fu">subset</span>(Length_Diet_time,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell)),PH3_positive_cell <span class="sc">~</span>  group, max)</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span>  <span class="fu">as.data.frame</span>(tmp<span class="sc">$</span>mcletters<span class="sc">$</span>Letters)</span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>tab_letter<span class="sc">$</span>group<span class="ot">=</span><span class="fu">rownames</span>(tab_letter)</span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_letter)[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">&quot;Letter&quot;</span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span> <span class="fu">left_join</span>(tab_letter,letter_position)</span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span> <span class="fu">separate</span>(tab_letter,group, <span class="fu">c</span>(<span class="st">&quot;Diet&quot;</span>, <span class="st">&quot;Day_of_treatment&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="at">remove=</span><span class="cn">FALSE</span>)</span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;7&quot;</span>,<span class="st">&quot;14&quot;</span>,<span class="st">&quot;21&quot;</span>, <span class="st">&quot;28&quot;</span>)</span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(Length_Diet_time<span class="sc">$</span>PH3_positive_cell, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a>Plot_Fig4B<span class="ot">=</span></span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Length_Diet_time, <span class="fu">aes</span>(<span class="at">x =</span> Day_of_treatment, <span class="at">y =</span> PH3_positive_cell))<span class="sc">+</span> </span>
<span id="cb182-22"><a href="#cb182-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb182-23"><a href="#cb182-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb182-24"><a href="#cb182-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Diet)<span class="sc">+</span></span>
<span id="cb182-25"><a href="#cb182-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day_of_treatment, <span class="at">y =</span> <span class="sc">-</span><span class="dv">8</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb182-26"><a href="#cb182-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_letter, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day_of_treatment, <span class="at">y =</span> PH3_positive_cell<span class="sc">+</span><span class="dv">10</span>, <span class="at">label =</span> Letter),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb182-27"><a href="#cb182-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_stat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">130</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,<span class="fu">format</span>(Pvalue,<span class="at">digits=</span><span class="dv">2</span>))),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb182-28"><a href="#cb182-28" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb182-29"><a href="#cb182-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span>palette_diet_2)<span class="sc">+</span></span>
<span id="cb182-30"><a href="#cb182-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb182-31"><a href="#cb182-31" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span>Limits,</span>
<span id="cb182-32"><a href="#cb182-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;7 days&quot;</span>,<span class="st">&quot;14 days&quot;</span>, <span class="st">&quot;21 days&quot;</span>, <span class="st">&quot;28 days&quot;</span>))<span class="sc">+</span></span>
<span id="cb182-33"><a href="#cb182-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;pH3&quot;</span> <span class="sc">^</span> <span class="st">&quot;+&quot;</span>, <span class="st">&quot; cells&quot;</span>)),</span>
<span id="cb182-34"><a href="#cb182-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">140</span>),</span>
<span id="cb182-35"><a href="#cb182-35" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">140</span>,<span class="at">by=</span><span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb182-36"><a href="#cb182-36" aria-hidden="true" tabindex="-1"></a>     <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb182-37"><a href="#cb182-37" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb182-38"><a href="#cb182-38" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb182-39"><a href="#cb182-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb182-40"><a href="#cb182-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb182-41"><a href="#cb182-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb182-42"><a href="#cb182-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb182-43"><a href="#cb182-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb182-44"><a href="#cb182-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb182-45"><a href="#cb182-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb182-46"><a href="#cb182-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb182-47"><a href="#cb182-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb182-48"><a href="#cb182-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb182-49"><a href="#cb182-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb182-50"><a href="#cb182-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb182-51"><a href="#cb182-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb182-52"><a href="#cb182-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb182-53"><a href="#cb182-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb182-54"><a href="#cb182-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb182-55"><a href="#cb182-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb182-56"><a href="#cb182-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb182-57"><a href="#cb182-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb182-58"><a href="#cb182-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb182-59"><a href="#cb182-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb182-60"><a href="#cb182-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb182-61"><a href="#cb182-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb182-62"><a href="#cb182-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb182-63"><a href="#cb182-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-64"><a href="#cb182-64" aria-hidden="true" tabindex="-1"></a>Plot_Fig4B</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204B-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-4c" class="section level3" number="4.1.3">
<h3 number="4.1.3"><span class="header-section-number">4.1.3</span> Figure 4C</h3>
<div class="blue">
<p>Shifting between diets impacts pH3+ cell number in growth (HS to HY) experiments. Statistical comparisons are vs pre-shift measurement.</p>
</div>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>Length_Growth_PH3 <span class="ot">=</span> </span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;4C, 4S1D&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">ends_with</span>(<span class="st">&quot;.L&quot;</span>)),<span class="sc">~</span>.<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Total_Length_mm=</span>Total.L,</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">PH3_positive_cell=</span>Total.PH3,</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Day_of_treatment=</span>Day)<span class="sc">%&gt;%</span></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dday=</span><span class="fu">fct_relevel</span>(Dday,<span class="st">&quot;Shift Day 7&quot;</span>,<span class="st">&quot;Shift Day 14&quot;</span>,<span class="st">&quot;Shift Day 21&quot;</span>))</span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a>  Length_Growth_PH3<span class="sc">%&gt;%</span></span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Dday)<span class="sc">%&gt;%</span></span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb183-17"><a href="#cb183-17" aria-hidden="true" tabindex="-1"></a><span class="do">###Day 7</span></span>
<span id="cb183-18"><a href="#cb183-18" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_Growth_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 7&quot;</span>))</span>
<span id="cb183-19"><a href="#cb183-19" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.97011, p-value = 0.2797</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_Growth_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 7&quot;</span>))</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell) ~ Diet + (1/Repeat)
BP = 1.8138, df = 1, p-value = 0.1781</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_Growth_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 7&quot;</span>))</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS Day 7 vs HS to HY Day 14&quot;</span>)),</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Shift Day 7&quot;</span>)),</span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Length_Growth_PH3<span class="sc">$</span>Repeat),</span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>tab_stat_7<span class="ot">=</span>tab_stat</span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 14</span></span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_Growth_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 14&quot;</span>))</span>
<span id="cb187-17"><a href="#cb187-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.95426, p-value = 0.1063</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_Growth_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 14&quot;</span>))</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell) ~ Diet + (1/Repeat)
BP = 0.20868, df = 1, p-value = 0.6478</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_Growth_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 14&quot;</span>))</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS Day 14 vs HS to HY Day 21&quot;</span>)),</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Shift Day 14&quot;</span>)),</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Length_Growth_PH3<span class="sc">$</span>Repeat),</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>tab_stat_14<span class="ot">=</span>tab_stat</span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 21</span></span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_Growth_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 21&quot;</span>))</span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.93625, p-value = 0.005926</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_Growth_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 21&quot;</span>))</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell) ~ Diet + (1/Repeat)
BP = 1.3963, df = 1, p-value = 0.2373</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_Growth_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 21&quot;</span>))</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS Day 21 vs HS to HY Day 28&quot;</span>)),</span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Shift Day 21&quot;</span>)),</span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Length_Growth_PH3<span class="sc">$</span>Repeat),</span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb195-12"><a href="#cb195-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb195-13"><a href="#cb195-13" aria-hidden="true" tabindex="-1"></a>tab_stat_21 <span class="ot">=</span> tab_stat</span>
<span id="cb195-14"><a href="#cb195-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-15"><a href="#cb195-15" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_7,tab_stat_14,tab_stat_21)</span>
<span id="cb195-16"><a href="#cb195-16" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb195-17"><a href="#cb195-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb195-18"><a href="#cb195-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb195-19"><a href="#cb195-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-20"><a href="#cb195-20" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb195-21"><a href="#cb195-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(PH3_positive_cell) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb195-22"><a href="#cb195-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(PH3_positive_cell) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS Day 7 vs HS to HY Day 14
</td>
<td style="text-align:left;">
Shift Day 7
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
28.80
</td>
<td style="text-align:left;">
2.07
</td>
<td style="text-align:left;">
1.38
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1e-07
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
HS Day 14 vs HS to HY Day 21
</td>
<td style="text-align:left;">
Shift Day 14
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
24.15
</td>
<td style="text-align:left;">
2.26
</td>
<td style="text-align:left;">
1.12
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9e-07
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
HS Day 21 vs HS to HY Day 28
</td>
<td style="text-align:left;">
Shift Day 21
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
45.01
</td>
<td style="text-align:left;">
2.57
</td>
<td style="text-align:left;">
1.29
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0e+00
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>  tab_stat <span class="sc">%&gt;%</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Dday=</span>Variable)<span class="sc">%&gt;%</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dday=</span><span class="fu">fct_relevel</span>(Dday,<span class="st">&quot;Shift Day 7&quot;</span>,<span class="st">&quot;Shift Day 14&quot;</span>,<span class="st">&quot;Shift Day 21&quot;</span>))</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HStoHY&quot;</span>)</span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">max</span>(Length_Growth_PH3<span class="sc">$</span>PH3_positive_cell, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>Plot_Fig4C<span class="ot">=</span></span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Length_Growth_PH3, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> PH3_positive_cell))<span class="sc">+</span> </span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Dday)<span class="sc">+</span></span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_signif</span>(<span class="at">data =</span> tab_stat, <span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">annotations =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">y_position =</span> <span class="dv">132</span>,), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">manual =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb196-18"><a href="#cb196-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-19"><a href="#cb196-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HStoHY&quot;</span>),</span>
<span id="cb196-20"><a href="#cb196-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>cbbHS_HStoHY)<span class="sc">+</span></span>
<span id="cb196-21"><a href="#cb196-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb196-22"><a href="#cb196-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span>Limits,</span>
<span id="cb196-23"><a href="#cb196-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HS to HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb196-24"><a href="#cb196-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;pH3&quot;</span> <span class="sc">^</span> <span class="st">&quot;+&quot;</span>, <span class="st">&quot; cells&quot;</span>)),</span>
<span id="cb196-25"><a href="#cb196-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>,<span class="dv">136</span>),</span>
<span id="cb196-26"><a href="#cb196-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">120</span>,<span class="at">by=</span><span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb196-27"><a href="#cb196-27" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb196-28"><a href="#cb196-28" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb196-29"><a href="#cb196-29" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb196-30"><a href="#cb196-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb196-31"><a href="#cb196-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb196-32"><a href="#cb196-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb196-33"><a href="#cb196-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb196-34"><a href="#cb196-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb196-35"><a href="#cb196-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb196-36"><a href="#cb196-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb196-37"><a href="#cb196-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb196-38"><a href="#cb196-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb196-39"><a href="#cb196-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb196-40"><a href="#cb196-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb196-41"><a href="#cb196-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb196-42"><a href="#cb196-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb196-43"><a href="#cb196-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb196-44"><a href="#cb196-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb196-45"><a href="#cb196-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb196-46"><a href="#cb196-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb196-47"><a href="#cb196-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb196-48"><a href="#cb196-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb196-49"><a href="#cb196-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb196-50"><a href="#cb196-50" aria-hidden="true" tabindex="-1"></a>            <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb196-51"><a href="#cb196-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb196-52"><a href="#cb196-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb196-53"><a href="#cb196-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb196-54"><a href="#cb196-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-55"><a href="#cb196-55" aria-hidden="true" tabindex="-1"></a>Plot_Fig4C</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204C-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-4d" class="section level3" number="4.1.4">
<h3 number="4.1.4"><span class="header-section-number">4.1.4</span> Figure 4D</h3>
<div class="blue">
<p>Shifting between diets impacts pH3+ cell number in shrinkage (HY to HS) experiments. Statistical comparisons are vs pre-shift measurement.</p>
</div>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>Length_shrinkage_PH3 <span class="ot">=</span> </span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;4C&#39;, 4S1D&#39;&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">ends_with</span>(<span class="st">&quot;.L&quot;</span>)),<span class="sc">~</span>.<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Total_Length_mm=</span>Total.L,</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">PH3_positive_cell=</span>Total.PH3,</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Day_of_treatment=</span>Day)<span class="sc">%&gt;%</span></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dday=</span><span class="fu">fct_relevel</span>(Dday,<span class="st">&quot;Shift Day 7&quot;</span>,<span class="st">&quot;Shift Day 14&quot;</span>,<span class="st">&quot;Shift Day 21&quot;</span>))</span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a>  Length_shrinkage_PH3<span class="sc">%&gt;%</span></span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Dday)<span class="sc">%&gt;%</span></span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true" tabindex="-1"></a><span class="do">###Day 7</span></span>
<span id="cb197-18"><a href="#cb197-18" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_shrinkage_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 7&quot;</span>))</span>
<span id="cb197-19"><a href="#cb197-19" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96318, p-value = 0.1917</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_shrinkage_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 7&quot;</span>))</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell) ~ Diet + (1/Repeat)
BP = 1.9935, df = 1, p-value = 0.158</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_shrinkage_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 7&quot;</span>))</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_shrinkage <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS Day 7 vs HS to HY Day 14&quot;</span>)),</span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Shift Day 7&quot;</span>)),</span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Length_shrinkage_PH3<span class="sc">$</span>Repeat),</span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_shrinkage,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">1</span>,<span class="at">scientific=</span>F)))</span>
<span id="cb201-13"><a href="#cb201-13" aria-hidden="true" tabindex="-1"></a>tab_stat_7<span class="ot">=</span>tab_stat</span>
<span id="cb201-14"><a href="#cb201-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-15"><a href="#cb201-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 14</span></span>
<span id="cb201-16"><a href="#cb201-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_shrinkage_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 14&quot;</span>))</span>
<span id="cb201-17"><a href="#cb201-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.88271, p-value = 0.0008579</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_shrinkage_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 14&quot;</span>))</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell) ~ Diet + (1/Repeat)
BP = 0.31605, df = 1, p-value = 0.574</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_shrinkage_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 14&quot;</span>))</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_shrinkage <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS Day 14 vs HS to HY Day 21&quot;</span>)),</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Shift Day 14&quot;</span>)),</span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Length_shrinkage_PH3<span class="sc">$</span>Repeat),</span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_shrinkage,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">1</span>)))</span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a>tab_stat_14<span class="ot">=</span>tab_stat</span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-15"><a href="#cb205-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 21</span></span>
<span id="cb205-16"><a href="#cb205-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_shrinkage_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 21&quot;</span>))</span>
<span id="cb205-17"><a href="#cb205-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.97516, p-value = 0.3966</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_shrinkage_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 21&quot;</span>))</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell) ~ Diet + (1/Repeat)
BP = 0.66778, df = 1, p-value = 0.4138</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(Length_shrinkage_PH3,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 21&quot;</span>))</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_shrinkage <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS Day 21 vs HS to HY Day 28&quot;</span>)),</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Shift Day 21&quot;</span>)),</span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Length_shrinkage_PH3<span class="sc">$</span>Repeat),</span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_shrinkage,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb209-13"><a href="#cb209-13" aria-hidden="true" tabindex="-1"></a>tab_stat_21 <span class="ot">=</span> tab_stat</span>
<span id="cb209-14"><a href="#cb209-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-15"><a href="#cb209-15" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_7,tab_stat_14,tab_stat_21)</span>
<span id="cb209-16"><a href="#cb209-16" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb209-17"><a href="#cb209-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb209-18"><a href="#cb209-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb209-19"><a href="#cb209-19" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb209-20"><a href="#cb209-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(PH3_positive_cell) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb209-21"><a href="#cb209-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(PH3_positive_cell) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS Day 7 vs HS to HY Day 14
</td>
<td style="text-align:left;">
Shift Day 7
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.93
</td>
<td style="text-align:left;">
3.56
</td>
<td style="text-align:left;">
-0.25
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.0e-01
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
HS Day 14 vs HS to HY Day 21
</td>
<td style="text-align:left;">
Shift Day 14
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
13.65
</td>
<td style="text-align:left;">
3.98
</td>
<td style="text-align:left;">
-0.74
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.0e-04
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
HS Day 21 vs HS to HY Day 28
</td>
<td style="text-align:left;">
Shift Day 21
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
20.21
</td>
<td style="text-align:left;">
4.18
</td>
<td style="text-align:left;">
-0.59
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6.9e-06
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>  tab_stat <span class="sc">%&gt;%</span></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Dday=</span>Variable)<span class="sc">%&gt;%</span></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dday=</span><span class="fu">fct_relevel</span>(Dday,<span class="st">&quot;Shift Day 7&quot;</span>,<span class="st">&quot;Shift Day 14&quot;</span>,<span class="st">&quot;Shift Day 21&quot;</span>))</span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>,<span class="st">&quot;HYtoHS&quot;</span>)</span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(Length_shrinkage_PH3<span class="sc">$</span>PH3_positive_cell, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a>Plot_Fig4D<span class="ot">=</span></span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Length_shrinkage_PH3, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> PH3_positive_cell))<span class="sc">+</span> </span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Dday)<span class="sc">+</span></span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb210-17"><a href="#cb210-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_signif</span>(<span class="at">data =</span> tab_stat, <span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">annotations =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">y_position =</span> <span class="dv">132</span>,), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">manual =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb210-18"><a href="#cb210-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-19"><a href="#cb210-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>,<span class="st">&quot;HYtoHS&quot;</span>),</span>
<span id="cb210-20"><a href="#cb210-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>cbbHY_HYtoHS)<span class="sc">+</span></span>
<span id="cb210-21"><a href="#cb210-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb210-22"><a href="#cb210-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span>Limits,</span>
<span id="cb210-23"><a href="#cb210-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>,<span class="st">&quot;HY to HS&quot;</span>))<span class="sc">+</span></span>
<span id="cb210-24"><a href="#cb210-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;pH3&quot;</span> <span class="sc">^</span> <span class="st">&quot;+&quot;</span>, <span class="st">&quot; cells&quot;</span>)),</span>
<span id="cb210-25"><a href="#cb210-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>,<span class="dv">136</span>),</span>
<span id="cb210-26"><a href="#cb210-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">120</span>,<span class="at">by=</span><span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb210-27"><a href="#cb210-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb210-28"><a href="#cb210-28" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb210-29"><a href="#cb210-29" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb210-30"><a href="#cb210-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb210-31"><a href="#cb210-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb210-32"><a href="#cb210-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb210-33"><a href="#cb210-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb210-34"><a href="#cb210-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb210-35"><a href="#cb210-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb210-36"><a href="#cb210-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb210-37"><a href="#cb210-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb210-38"><a href="#cb210-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb210-39"><a href="#cb210-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb210-40"><a href="#cb210-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb210-41"><a href="#cb210-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb210-42"><a href="#cb210-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb210-43"><a href="#cb210-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb210-44"><a href="#cb210-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb210-45"><a href="#cb210-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb210-46"><a href="#cb210-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb210-47"><a href="#cb210-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb210-48"><a href="#cb210-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb210-49"><a href="#cb210-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb210-50"><a href="#cb210-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb210-51"><a href="#cb210-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb210-52"><a href="#cb210-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb210-53"><a href="#cb210-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb210-54"><a href="#cb210-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-55"><a href="#cb210-55" aria-hidden="true" tabindex="-1"></a>Plot_Fig4D</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204D-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-4e-f" class="section level3" number="4.1.5">
<h3 number="4.1.5"><span class="header-section-number">4.1.5</span> Figure 4E-F</h3>
<div class="blue">
<p>Clonal assay with EsgF/O system illustrates increased number of marked cells on HY (F) vs HS (E) diets 5 days post-eclosion in region 4 of the midgut. GFP, in green, marks all cells made since the EsgF/O system was activated. <em>Complete graphical annotation can be found in manuscript figures</em></p>
</div>
<div class="row">
<div class="col-md-6">
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204E-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204F-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="figure-4g-h-i-j" class="section level3" number="4.1.6">
<h3 number="4.1.6"><span class="header-section-number">4.1.6</span> Figure 4G-H-I-J</h3>
<div class="blue">
<p><strong>Cell loss assay enables analysis of the impact of diet composition on replacement ratio and rate.</strong> Description of experimental design is found in materials and methods and illustrated in figure 4–figure supplement 1H. In brief, this assay allows us to mark ECs and EBs at the start of the experiment and to count their numbers 14 days after shifting dietary conditions recapitulating growth and shrinkage of the midgut, thus estimating cell gain and cell loss in these conditions. Representative pictures for the cell loss assay in growing conditions (G, H, top row) and shrinkage conditions (I, J, bottom row). <em>Complete graphical annotation can be found in manuscript figures</em></p>
</div>
<div class="row">
<div class="col-md-6">
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204G-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204H-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
</div>
<div class="row">
<div class="col-md-6">
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204I-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204J-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="figure-4k" class="section level3" number="4.1.7">
<h3 number="4.1.7"><span class="header-section-number">4.1.7</span> Figure 4K</h3>
<div class="blue">
<p>In red 5966GS&gt; His-RFP, marking EB and EC. Number of ECs in the posterior midgut, both marked (Red, old ECs) and unmarked (Blue, new ECs) by RFP, error bars are SE from 3 repeats.</p>
</div>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>tab_prop_cell_RFP <span class="ot">=</span> </span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;4K&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Post.Dapi.Number =</span> (Post.Dapi.Number)<span class="sc">*</span><span class="dv">2</span>)<span class="sc">%&gt;%</span></span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Post.RFP.Number =</span> (Post.RFP.Number)<span class="sc">*</span><span class="dv">2</span>)<span class="sc">%&gt;%</span></span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Post.NonRFP.Number =</span> (Post.Dapi.Number <span class="sc">-</span> Post.RFP.Number))<span class="sc">%&gt;%</span></span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Day, Diet, Diet1, Experiment)<span class="sc">%&gt;%</span></span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_RFP_positive=</span><span class="fu">mean</span>(Post.RFP.Number,<span class="at">na.rm=</span>T),</span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_RFP_positive=</span><span class="fu">se</span>(Post.RFP.Number),</span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_RFP_negative=</span><span class="fu">mean</span>(Post.NonRFP.Number,<span class="at">na.rm=</span>T),</span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_RFP_negative=</span><span class="fu">se</span>(Post.NonRFP.Number))<span class="sc">%&gt;%</span></span>
<span id="cb211-13"><a href="#cb211-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group=</span><span class="fu">paste</span>(Diet1,Experiment,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb211-14"><a href="#cb211-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb211-15"><a href="#cb211-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-16"><a href="#cb211-16" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(tab_prop_cell_RFP)</span>
<span id="cb211-17"><a href="#cb211-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Experiment)){</span>
<span id="cb211-18"><a href="#cb211-18" aria-hidden="true" tabindex="-1"></a>    tab_prop_cell_RFP<span class="sc">$</span>se_proportionGraphPlus_pos[i] <span class="ot">=</span> mean_RFP_positive[i]<span class="sc">+</span>se_RFP_positive[i]</span>
<span id="cb211-19"><a href="#cb211-19" aria-hidden="true" tabindex="-1"></a>    tab_prop_cell_RFP<span class="sc">$</span>se_proportionGraphMinus_pos[i] <span class="ot">=</span> mean_RFP_positive[i]<span class="sc">-</span>se_RFP_positive[i]</span>
<span id="cb211-20"><a href="#cb211-20" aria-hidden="true" tabindex="-1"></a>    tab_prop_cell_RFP<span class="sc">$</span>se_proportionGraphPlus_neg[i] <span class="ot">=</span> mean_RFP_positive[i]<span class="sc">+</span>mean_RFP_negative[i]<span class="sc">+</span>se_RFP_negative[i]</span>
<span id="cb211-21"><a href="#cb211-21" aria-hidden="true" tabindex="-1"></a>    tab_prop_cell_RFP<span class="sc">$</span>se_proportionGraphMinus_neg[i] <span class="ot">=</span> mean_RFP_positive[i]<span class="sc">+</span>mean_RFP_negative[i]<span class="sc">-</span>se_RFP_negative[i]</span>
<span id="cb211-22"><a href="#cb211-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb211-23"><a href="#cb211-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-24"><a href="#cb211-24" aria-hidden="true" tabindex="-1"></a>tmp1 <span class="ot">=</span> tab_prop_cell_RFP[,<span class="fu">c</span>(<span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Diet&quot;</span>, <span class="st">&quot;Diet1&quot;</span>, <span class="st">&quot;Experiment&quot;</span>,<span class="st">&quot;mean_RFP_positive&quot;</span>, <span class="st">&quot;se_RFP_positive&quot;</span>,<span class="st">&quot;se_proportionGraphPlus_pos&quot;</span>, <span class="st">&quot;se_proportionGraphMinus_pos&quot;</span>)]</span>
<span id="cb211-25"><a href="#cb211-25" aria-hidden="true" tabindex="-1"></a>tmp1<span class="sc">$</span>RFP<span class="ot">=</span><span class="st">&quot;Positive&quot;</span></span>
<span id="cb211-26"><a href="#cb211-26" aria-hidden="true" tabindex="-1"></a>tmp1<span class="ot">=</span>dplyr<span class="sc">::</span><span class="fu">rename</span>(tmp1,<span class="at">mean_RFP =</span> mean_RFP_positive,</span>
<span id="cb211-27"><a href="#cb211-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_RFP =</span> se_RFP_positive,</span>
<span id="cb211-28"><a href="#cb211-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_proportionGraphPlus =</span>se_proportionGraphPlus_pos,</span>
<span id="cb211-29"><a href="#cb211-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_proportionGraphMinus=</span> se_proportionGraphMinus_pos)</span>
<span id="cb211-30"><a href="#cb211-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-31"><a href="#cb211-31" aria-hidden="true" tabindex="-1"></a>tmp2 <span class="ot">=</span> tab_prop_cell_RFP[,<span class="fu">c</span>(<span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Diet&quot;</span>, <span class="st">&quot;Diet1&quot;</span>, <span class="st">&quot;Experiment&quot;</span>,<span class="st">&quot;mean_RFP_negative&quot;</span>, <span class="st">&quot;se_RFP_negative&quot;</span>, <span class="st">&quot;se_proportionGraphMinus_neg&quot;</span> ,<span class="st">&quot;se_proportionGraphPlus_neg&quot;</span>)]</span>
<span id="cb211-32"><a href="#cb211-32" aria-hidden="true" tabindex="-1"></a>tmp2<span class="sc">$</span>RFP<span class="ot">=</span><span class="st">&quot;Negative&quot;</span></span>
<span id="cb211-33"><a href="#cb211-33" aria-hidden="true" tabindex="-1"></a>tmp2<span class="ot">=</span>dplyr<span class="sc">::</span><span class="fu">rename</span>(tmp2,<span class="at">mean_RFP =</span> mean_RFP_negative, </span>
<span id="cb211-34"><a href="#cb211-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_RFP =</span> se_RFP_negative,</span>
<span id="cb211-35"><a href="#cb211-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_proportionGraphPlus =</span>se_proportionGraphPlus_neg,</span>
<span id="cb211-36"><a href="#cb211-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_proportionGraphMinus=</span> se_proportionGraphMinus_neg)</span>
<span id="cb211-37"><a href="#cb211-37" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb211-38"><a href="#cb211-38" aria-hidden="true" tabindex="-1"></a>tab_prop_cell_RFP <span class="ot">=</span> <span class="fu">rbind</span>(tmp1,tmp2)</span>
<span id="cb211-39"><a href="#cb211-39" aria-hidden="true" tabindex="-1"></a>tab_prop_cell_RFP <span class="ot">=</span> </span>
<span id="cb211-40"><a href="#cb211-40" aria-hidden="true" tabindex="-1"></a>  tab_prop_cell_RFP<span class="sc">%&gt;%</span></span>
<span id="cb211-41"><a href="#cb211-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric,round,<span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb211-42"><a href="#cb211-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)</span>
<span id="cb211-43"><a href="#cb211-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-44"><a href="#cb211-44" aria-hidden="true" tabindex="-1"></a><span class="co">#tab_prop_cell_RFP$Experiment = as.factor(ifelse(tab_prop_cell_RFP$Day==&quot;0&quot; &amp; tab_prop_cell_RFP$Diet1==&quot;HS&quot;,&quot;HS&quot;,</span></span>
<span id="cb211-45"><a href="#cb211-45" aria-hidden="true" tabindex="-1"></a>                                      <span class="co">#ifelse(tab_prop_cell_RFP$Day==&quot;0&quot; &amp; tab_prop_cell_RFP$Diet1==&quot;HY&quot;,&quot;HY&quot;, </span></span>
<span id="cb211-46"><a href="#cb211-46" aria-hidden="true" tabindex="-1"></a>                                            <span class="co"># as.character(tab_prop_cell_RFP$Experiment))))</span></span>
<span id="cb211-47"><a href="#cb211-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-48"><a href="#cb211-48" aria-hidden="true" tabindex="-1"></a><span class="co">#tab_prop_cell_RFP=</span></span>
<span id="cb211-49"><a href="#cb211-49" aria-hidden="true" tabindex="-1"></a>  <span class="co">#tab_prop_cell_RFP%&gt;%</span></span>
<span id="cb211-50"><a href="#cb211-50" aria-hidden="true" tabindex="-1"></a>  <span class="co">#as.data.frame()%&gt;%</span></span>
<span id="cb211-51"><a href="#cb211-51" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(Diet1=fct_relevel(Diet1,&quot;HS&quot;, &quot;HStoHS&quot; , &quot;HStoHY&quot;, &quot;HY&quot;, &quot;HYtoHS&quot;, &quot;HYtoHY&quot;),</span></span>
<span id="cb211-52"><a href="#cb211-52" aria-hidden="true" tabindex="-1"></a>         <span class="co">#Experiment=fct_relevel(Experiment, &quot;HS&quot;, &quot;Growth&quot;, &quot;HY&quot;, &quot;Shrinkage&quot;))</span></span>
<span id="cb211-53"><a href="#cb211-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-54"><a href="#cb211-54" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(tab_prop_cell_RFP<span class="sc">$</span>Diet1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HS to HS&quot;</span> , <span class="st">&quot;HS to HY&quot;</span>, <span class="st">&quot;HY&quot;</span>, <span class="st">&quot;HY to HS&quot;</span>, <span class="st">&quot;HY to HY&quot;</span>)</span>
<span id="cb211-55"><a href="#cb211-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-56"><a href="#cb211-56" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb211-57"><a href="#cb211-57" aria-hidden="true" tabindex="-1"></a>    d[[<span class="st">&quot;4K&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb211-58"><a href="#cb211-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb211-59"><a href="#cb211-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb211-60"><a href="#cb211-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet1)<span class="sc">%&gt;%</span></span>
<span id="cb211-61"><a href="#cb211-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb211-62"><a href="#cb211-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-63"><a href="#cb211-63" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="sc">$</span>Experiment <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;G&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;S&quot;</span>)</span>
<span id="cb211-64"><a href="#cb211-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-65"><a href="#cb211-65" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(Sample_size<span class="sc">$</span>Diet1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HS to HS&quot;</span> , <span class="st">&quot;HS to HY&quot;</span>, <span class="st">&quot;HY&quot;</span>, <span class="st">&quot;HY to HS&quot;</span>, <span class="st">&quot;HY to HY&quot;</span>)</span>
<span id="cb211-66"><a href="#cb211-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-67"><a href="#cb211-67" aria-hidden="true" tabindex="-1"></a>                                  </span>
<span id="cb211-68"><a href="#cb211-68" aria-hidden="true" tabindex="-1"></a>Plot_Fig4K <span class="ot">=</span></span>
<span id="cb211-69"><a href="#cb211-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_prop_cell_RFP, <span class="fu">aes</span>(<span class="at">x=</span>Diet1, <span class="at">y=</span>mean_RFP))<span class="sc">+</span> </span>
<span id="cb211-70"><a href="#cb211-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>RFP),<span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">width=</span>.<span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb211-71"><a href="#cb211-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span> se_proportionGraphMinus, <span class="at">ymax=</span> se_proportionGraphPlus),<span class="at">width=</span><span class="fl">0.25</span>)<span class="sc">+</span></span>
<span id="cb211-72"><a href="#cb211-72" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet1, <span class="at">y =</span> <span class="dv">200</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb211-73"><a href="#cb211-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>Experiment,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)<span class="sc">+</span></span>
<span id="cb211-74"><a href="#cb211-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;RFP labelling&quot;</span>, </span>
<span id="cb211-75"><a href="#cb211-75" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#3a5ecc&quot;</span>,<span class="st">&quot;#cc0000&quot;</span>),</span>
<span id="cb211-76"><a href="#cb211-76" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Negative&quot;</span>, <span class="st">&quot;Positive&quot;</span>))<span class="sc">+</span></span>
<span id="cb211-77"><a href="#cb211-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Number of cells (mean \u00B1se)&quot;</span>,</span>
<span id="cb211-78"><a href="#cb211-78" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5800</span>),</span>
<span id="cb211-79"><a href="#cb211-79" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5000</span>,<span class="at">by=</span><span class="dv">500</span>))<span class="sc">+</span></span>
<span id="cb211-80"><a href="#cb211-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb211-81"><a href="#cb211-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb211-82"><a href="#cb211-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb211-83"><a href="#cb211-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb211-84"><a href="#cb211-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb211-85"><a href="#cb211-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb211-86"><a href="#cb211-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb211-87"><a href="#cb211-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb211-88"><a href="#cb211-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb211-89"><a href="#cb211-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb211-90"><a href="#cb211-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb211-91"><a href="#cb211-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb211-92"><a href="#cb211-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb211-93"><a href="#cb211-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb211-94"><a href="#cb211-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.87</span>),</span>
<span id="cb211-95"><a href="#cb211-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb211-96"><a href="#cb211-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb211-97"><a href="#cb211-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb211-98"><a href="#cb211-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb211-99"><a href="#cb211-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont),</span>
<span id="cb211-100"><a href="#cb211-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb211-101"><a href="#cb211-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>())</span>
<span id="cb211-102"><a href="#cb211-102" aria-hidden="true" tabindex="-1"></a>    <span class="co">#strip.background = element_rect(fill=NA, colour=&quot;black&quot;),</span></span>
<span id="cb211-103"><a href="#cb211-103" aria-hidden="true" tabindex="-1"></a>    <span class="co">#strip.placement=&quot;outside&quot;)</span></span>
<span id="cb211-104"><a href="#cb211-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-105"><a href="#cb211-105" aria-hidden="true" tabindex="-1"></a>Plot_Fig4K</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204K-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-4l" class="section level3" number="4.1.8">
<h3 number="4.1.8"><span class="header-section-number">4.1.8</span> Figure 4L</h3>
<div class="blue">
<p>Data shown as rate relative to experiment start (cell /initial EC/ day). Number on bar in red is ratio of EC gained/EC lost (see materials and methods for formula).</p>
</div>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>tab_relative_cell_rate <span class="ot">=</span> </span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;4L, 4S2D&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">&quot;X&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()<span class="sc">%&gt;%</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet1, Experiment, Experiment2, GL)<span class="sc">%&gt;%</span></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_RelativeRate=</span><span class="fu">mean</span>(RelativeRate,<span class="at">na.rm=</span>T),</span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_RelativeRate=</span><span class="fu">se</span>(RelativeRate))<span class="sc">%&gt;%</span></span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">group=</span><span class="fu">paste</span>(Diet1,Experiment,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true" tabindex="-1"></a>tab_relative_cell_rate_ratio <span class="ot">=</span> </span>
<span id="cb212-18"><a href="#cb212-18" aria-hidden="true" tabindex="-1"></a>  tab_relative_cell_rate<span class="sc">%&gt;%</span></span>
<span id="cb212-19"><a href="#cb212-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet1,Experiment2)<span class="sc">%&gt;%</span></span>
<span id="cb212-20"><a href="#cb212-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Ratio =</span> <span class="fu">round</span>(mean_RelativeRate[GL <span class="sc">==</span> <span class="st">&quot;Gain&quot;</span>] <span class="sc">/</span> (<span class="sc">-</span>mean_RelativeRate[GL <span class="sc">==</span> <span class="st">&quot;Loss&quot;</span>]),<span class="dv">2</span>))<span class="sc">%&gt;%</span></span>
<span id="cb212-21"><a href="#cb212-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GL=</span><span class="st">&quot;Loss&quot;</span>)</span>
<span id="cb212-22"><a href="#cb212-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-23"><a href="#cb212-23" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(tab_relative_cell_rate<span class="sc">$</span>Diet1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HS to HS&quot;</span> , <span class="st">&quot;HS to HY&quot;</span>, <span class="st">&quot;HY to HS&quot;</span>, <span class="st">&quot;HY to HY&quot;</span>)</span>
<span id="cb212-24"><a href="#cb212-24" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(tab_relative_cell_rate_ratio<span class="sc">$</span>Diet1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HS to HS&quot;</span> , <span class="st">&quot;HS to HY&quot;</span>, <span class="st">&quot;HY to HS&quot;</span>, <span class="st">&quot;HY to HY&quot;</span>)</span>
<span id="cb212-25"><a href="#cb212-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-26"><a href="#cb212-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-27"><a href="#cb212-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-28"><a href="#cb212-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-29"><a href="#cb212-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-30"><a href="#cb212-30" aria-hidden="true" tabindex="-1"></a>Plot_Fig4L <span class="ot">=</span></span>
<span id="cb212-31"><a href="#cb212-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_relative_cell_rate, <span class="fu">aes</span>(<span class="at">x =</span> Diet1, <span class="at">y =</span> mean_RelativeRate, <span class="at">fill =</span> GL))<span class="sc">+</span> </span>
<span id="cb212-32"><a href="#cb212-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>GL),<span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">width=</span>.<span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb212-33"><a href="#cb212-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb212-34"><a href="#cb212-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span>tab_relative_cell_rate_ratio,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>Diet1,<span class="at">y=</span><span class="sc">-</span><span class="fl">0.01</span>,<span class="at">label=</span>Ratio), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb212-35"><a href="#cb212-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Experiment2,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)<span class="sc">+</span></span>
<span id="cb212-36"><a href="#cb212-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-37"><a href="#cb212-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;Enterocyte&quot;</span>, </span>
<span id="cb212-38"><a href="#cb212-38" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;palegreen&quot;</span>, <span class="st">&quot;moccasin&quot;</span>),</span>
<span id="cb212-39"><a href="#cb212-39" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Gain&quot;</span>, <span class="st">&quot;Loss&quot;</span>))<span class="sc">+</span></span>
<span id="cb212-40"><a href="#cb212-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Cell rate (cell/ initialEC/ day)&quot;</span>,</span>
<span id="cb212-41"><a href="#cb212-41" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.11</span>,<span class="fl">0.11</span>),</span>
<span id="cb212-42"><a href="#cb212-42" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="at">by=</span><span class="fl">0.05</span>))<span class="sc">+</span></span>
<span id="cb212-43"><a href="#cb212-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb212-44"><a href="#cb212-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb212-45"><a href="#cb212-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb212-46"><a href="#cb212-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb212-47"><a href="#cb212-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb212-48"><a href="#cb212-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb212-49"><a href="#cb212-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb212-50"><a href="#cb212-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb212-51"><a href="#cb212-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb212-52"><a href="#cb212-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb212-53"><a href="#cb212-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb212-54"><a href="#cb212-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb212-55"><a href="#cb212-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb212-56"><a href="#cb212-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb212-57"><a href="#cb212-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.18</span>,<span class="fl">0.83</span>),</span>
<span id="cb212-58"><a href="#cb212-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb212-59"><a href="#cb212-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb212-60"><a href="#cb212-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb212-61"><a href="#cb212-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb212-62"><a href="#cb212-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont),</span>
<span id="cb212-63"><a href="#cb212-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb212-64"><a href="#cb212-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb212-65"><a href="#cb212-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb212-66"><a href="#cb212-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb212-67"><a href="#cb212-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb212-68"><a href="#cb212-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-69"><a href="#cb212-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-70"><a href="#cb212-70" aria-hidden="true" tabindex="-1"></a>Plot_Fig4L</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204L-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>##Export Figure 4</p>
</div>
</div>
<div id="figure-4---supplementary-1" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Figure 4 - supplementary 1</h2>
<div id="figure-4s1a" class="section level3" number="4.2.1">
<h3 number="4.2.1"><span class="header-section-number">4.2.1</span> Figure 4S1A</h3>
<div class="blue">
<p>Midgut length increases progressively on HY, but not on HS. Statistics compare HS vs HY for each day, *** = p&lt;0.01.</p>
</div>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>Length_dayseclosion <span class="ot">=</span> </span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;4 - S1A&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">&quot;X&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),<span class="sc">~</span>.<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Total_Length_mm=</span>Total.Length)<span class="sc">%&gt;%</span></span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group=</span><span class="fu">paste</span>(TreatCol,Day,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>))</span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a>  Length_dayseclosion<span class="sc">%&gt;%</span></span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Day,TreatCol)<span class="sc">%&gt;%</span></span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb213-14"><a href="#cb213-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Diet=</span>TreatCol)</span>
<span id="cb213-15"><a href="#cb213-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-16"><a href="#cb213-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Stats4S1A</span></span>
<span id="cb213-17"><a href="#cb213-17" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb213-18"><a href="#cb213-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-19"><a href="#cb213-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 1</span></span>
<span id="cb213-20"><a href="#cb213-20" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosion, Day <span class="sc">==</span> <span class="st">&quot;1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb213-21"><a href="#cb213-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb213-22"><a href="#cb213-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-23"><a href="#cb213-23" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb213-24"><a href="#cb213-24" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.97708, p-value = 0.614</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 0.1261, df = 1, p-value = 0.7225</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> (mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]] <span class="sc">-</span> mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="st">&quot;1&quot;</span>),</span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a>tab_stat_day_1 <span class="ot">=</span> tab_stat</span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 2</span></span>
<span id="cb217-15"><a href="#cb217-15" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosion, Day <span class="sc">==</span> <span class="st">&quot;2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb217-16"><a href="#cb217-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb217-17"><a href="#cb217-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-18"><a href="#cb217-18" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb217-19"><a href="#cb217-19" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.99417, p-value = 0.9992</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 1.0007, df = 1, p-value = 0.3171</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> (mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]] <span class="sc">-</span> mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="st">&quot;2&quot;</span>),</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb221-12"><a href="#cb221-12" aria-hidden="true" tabindex="-1"></a>tab_stat_day_2 <span class="ot">=</span> tab_stat</span>
<span id="cb221-13"><a href="#cb221-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-14"><a href="#cb221-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 3</span></span>
<span id="cb221-15"><a href="#cb221-15" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosion, Day <span class="sc">==</span> <span class="st">&quot;3&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb221-16"><a href="#cb221-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb221-17"><a href="#cb221-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-18"><a href="#cb221-18" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb221-19"><a href="#cb221-19" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98604, p-value = 0.8874</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 4.4343, df = 1, p-value = 0.03522</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> (mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]] <span class="sc">-</span> mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="st">&quot;3&quot;</span>),</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a>tab_stat_day_3 <span class="ot">=</span> tab_stat</span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 4</span></span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosion, Day <span class="sc">==</span> <span class="st">&quot;4&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb225-17"><a href="#cb225-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb225-18"><a href="#cb225-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-19"><a href="#cb225-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb225-20"><a href="#cb225-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98212, p-value = 0.7675</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 2.4272, df = 1, p-value = 0.1192</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> (mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]] <span class="sc">-</span> mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;4&quot;</span>)),</span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a>tab_stat_day_4 <span class="ot">=</span> tab_stat</span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 5</span></span>
<span id="cb229-16"><a href="#cb229-16" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosion, Day <span class="sc">==</span> <span class="st">&quot;5&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb229-17"><a href="#cb229-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb229-18"><a href="#cb229-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-19"><a href="#cb229-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb229-20"><a href="#cb229-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98337, p-value = 0.8115</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 0.17809, df = 1, p-value = 0.673</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> (mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]] <span class="sc">-</span> mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="st">&quot;5&quot;</span>),</span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb233-11"><a href="#cb233-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb233-12"><a href="#cb233-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-13"><a href="#cb233-13" aria-hidden="true" tabindex="-1"></a>tab_stat_day_5 <span class="ot">=</span> tab_stat</span>
<span id="cb233-14"><a href="#cb233-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-15"><a href="#cb233-15" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">rbind</span>(tab_stat_day_1, tab_stat_day_2, tab_stat_day_3, tab_stat_day_4, tab_stat_day_5)</span>
<span id="cb233-16"><a href="#cb233-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-17"><a href="#cb233-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>padj <span class="ot">=</span> <span class="fu">p.adjust</span>(tab_stat<span class="sc">$</span>Pvalue, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb233-18"><a href="#cb233-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-19"><a href="#cb233-19" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb233-20"><a href="#cb233-20" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb233-21"><a href="#cb233-21" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb233-22"><a href="#cb233-22" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb233-23"><a href="#cb233-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparisons diet within days&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;p-value adjusted&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb233-24"><a href="#cb233-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb233-25"><a href="#cb233-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparisons diet within days
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:right;">
p-value adjusted
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
12.43
</td>
<td style="text-align:left;">
1.58
</td>
<td style="text-align:left;">
0.095
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4.2e-04
</td>
<td style="text-align:right;">
4.20e-04
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
23.56
</td>
<td style="text-align:left;">
1.59
</td>
<td style="text-align:left;">
0.167
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.2e-06
</td>
<td style="text-align:right;">
2.00e-06
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
13.67
</td>
<td style="text-align:left;">
1.64
</td>
<td style="text-align:left;">
0.122
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.2e-04
</td>
<td style="text-align:right;">
2.75e-04
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
45.37
</td>
<td style="text-align:left;">
1.52
</td>
<td style="text-align:left;">
0.271
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
30.29
</td>
<td style="text-align:left;">
1.57
</td>
<td style="text-align:left;">
0.244
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:right;">
1.00e-07
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>    tab_stat <span class="sc">%&gt;%</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day =</span> Variable) <span class="sc">%&gt;%</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>Diet <span class="ot">=</span> <span class="st">&quot;HY&quot;</span></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>letter_position <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data =</span> Length_dayseclosion, Total_Length_mm <span class="sc">~</span> Day, max)</span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>tab_stat1 <span class="ot">=</span> <span class="fu">left_join</span>(tab_stat, letter_position)</span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Stats vs eclosion for HS</span></span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true" tabindex="-1"></a>Length_dayseclosionHS <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosion, Diet <span class="sc">==</span> <span class="st">&quot;0&quot;</span> <span class="sc">|</span> Diet <span class="sc">==</span> <span class="st">&quot;HS&quot;</span>)</span>
<span id="cb234-14"><a href="#cb234-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 1</span></span>
<span id="cb234-15"><a href="#cb234-15" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosionHS, Day <span class="sc">==</span> <span class="st">&quot;0&quot;</span> <span class="sc">|</span> Day <span class="sc">==</span> <span class="st">&quot;1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb234-16"><a href="#cb234-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb234-17"><a href="#cb234-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-18"><a href="#cb234-18" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb234-19"><a href="#cb234-19" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.99072, p-value = 0.9926</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Day + (1/Repeat)
BP = 1.1212, df = 1, p-value = 0.2897</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> (mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]] <span class="sc">-</span> mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;1&quot;</span>)),</span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb238-10"><a href="#cb238-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb238-11"><a href="#cb238-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb238-12"><a href="#cb238-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-13"><a href="#cb238-13" aria-hidden="true" tabindex="-1"></a>tab_stat_day_0vs1 <span class="ot">=</span> tab_stat</span>
<span id="cb238-14"><a href="#cb238-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-15"><a href="#cb238-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 2</span></span>
<span id="cb238-16"><a href="#cb238-16" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosionHS, Day <span class="sc">==</span> <span class="st">&quot;0&quot;</span> <span class="sc">|</span> Day <span class="sc">==</span> <span class="st">&quot;2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb238-17"><a href="#cb238-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb238-18"><a href="#cb238-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-19"><a href="#cb238-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb238-20"><a href="#cb238-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96616, p-value = 0.4006</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Day + (1/Repeat)
BP = 0.15716, df = 1, p-value = 0.6918</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> (mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]] <span class="sc">-</span> mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;2&quot;</span>)),</span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb242-11"><a href="#cb242-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb242-12"><a href="#cb242-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-13"><a href="#cb242-13" aria-hidden="true" tabindex="-1"></a>tab_stat_day_0vs2 <span class="ot">=</span> tab_stat</span>
<span id="cb242-14"><a href="#cb242-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-15"><a href="#cb242-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 3</span></span>
<span id="cb242-16"><a href="#cb242-16" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosionHS, Day <span class="sc">==</span> <span class="st">&quot;0&quot;</span> <span class="sc">|</span> Day <span class="sc">==</span> <span class="st">&quot;3&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb242-17"><a href="#cb242-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb242-18"><a href="#cb242-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-19"><a href="#cb242-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb242-20"><a href="#cb242-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98717, p-value = 0.9438</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Day + (1/Repeat)
BP = 0.11255, df = 1, p-value = 0.7373</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> (mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]] <span class="sc">-</span> mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;3&quot;</span>)),</span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb246-7"><a href="#cb246-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb246-8"><a href="#cb246-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb246-9"><a href="#cb246-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb246-10"><a href="#cb246-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb246-11"><a href="#cb246-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb246-12"><a href="#cb246-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-13"><a href="#cb246-13" aria-hidden="true" tabindex="-1"></a>tab_stat_day_0vs3 <span class="ot">=</span> tab_stat</span>
<span id="cb246-14"><a href="#cb246-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-15"><a href="#cb246-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 4</span></span>
<span id="cb246-16"><a href="#cb246-16" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosionHS, Day <span class="sc">==</span> <span class="st">&quot;0&quot;</span> <span class="sc">|</span> Day <span class="sc">==</span> <span class="st">&quot;4&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb246-17"><a href="#cb246-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb246-18"><a href="#cb246-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-19"><a href="#cb246-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb246-20"><a href="#cb246-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98443, p-value = 0.8899</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Day + (1/Repeat)
BP = 2.049, df = 1, p-value = 0.1523</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> (mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]] <span class="sc">-</span> mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;4&quot;</span>)),</span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb250-8"><a href="#cb250-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb250-9"><a href="#cb250-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb250-10"><a href="#cb250-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb250-11"><a href="#cb250-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb250-12"><a href="#cb250-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-13"><a href="#cb250-13" aria-hidden="true" tabindex="-1"></a>tab_stat_day_0vs4 <span class="ot">=</span> tab_stat</span>
<span id="cb250-14"><a href="#cb250-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-15"><a href="#cb250-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 5</span></span>
<span id="cb250-16"><a href="#cb250-16" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosionHS, Day <span class="sc">==</span> <span class="st">&quot;0&quot;</span> <span class="sc">|</span> Day <span class="sc">==</span> <span class="st">&quot;5&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb250-17"><a href="#cb250-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb250-18"><a href="#cb250-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-19"><a href="#cb250-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb250-20"><a href="#cb250-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.97527, p-value = 0.5856</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Day + (1/Repeat)
BP = 0.010695, df = 1, p-value = 0.9176</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> (mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]] <span class="sc">-</span> mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;5&quot;</span>)),</span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-13"><a href="#cb254-13" aria-hidden="true" tabindex="-1"></a>tab_stat_day_0vs5 <span class="ot">=</span> tab_stat</span>
<span id="cb254-14"><a href="#cb254-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-15"><a href="#cb254-15" aria-hidden="true" tabindex="-1"></a>tab_statHSeclosion <span class="ot">=</span> <span class="fu">rbind</span>(tab_stat_day_0vs1, tab_stat_day_0vs2, tab_stat_day_0vs3, tab_stat_day_0vs4, tab_stat_day_0vs5)</span>
<span id="cb254-16"><a href="#cb254-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-17"><a href="#cb254-17" aria-hidden="true" tabindex="-1"></a>tab_statHSeclosion<span class="sc">$</span>padj <span class="ot">=</span> <span class="fu">p.adjust</span>(tab_statHSeclosion<span class="sc">$</span>Pvalue, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb254-18"><a href="#cb254-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-19"><a href="#cb254-19" aria-hidden="true" tabindex="-1"></a>tab_statHSeclosion<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_statHSeclosion<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">&quot;ns&quot;</span>,</span>
<span id="cb254-20"><a href="#cb254-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(tab_statHSeclosion<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_statHSeclosion<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb254-21"><a href="#cb254-21" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(tab_statHSeclosion<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_statHSeclosion<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb254-22"><a href="#cb254-22" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(tab_statHSeclosion<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>))))</span>
<span id="cb254-23"><a href="#cb254-23" aria-hidden="true" tabindex="-1"></a>tab_statHSeclosion<span class="sc">%&gt;%</span></span>
<span id="cb254-24"><a href="#cb254-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison to eclosion on HS&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;p-value adjusted&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb254-25"><a href="#cb254-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Day + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb254-26"><a href="#cb254-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Day + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison to eclosion on HS
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:right;">
p-value adjusted
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.28
</td>
<td style="text-align:left;">
1.54
</td>
<td style="text-align:left;">
0.0399
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.260
</td>
<td style="text-align:right;">
0.4333333
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.34
</td>
<td style="text-align:left;">
1.55
</td>
<td style="text-align:left;">
0.0447
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.250
</td>
<td style="text-align:right;">
0.4333333
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4.80
</td>
<td style="text-align:left;">
1.55
</td>
<td style="text-align:left;">
0.0868
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:right;">
0.1400000
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:left;">
1.54
</td>
<td style="text-align:left;">
-0.0244
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.440
</td>
<td style="text-align:right;">
0.4400000
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:left;">
1.54
</td>
<td style="text-align:left;">
0.0319
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.390
</td>
<td style="text-align:right;">
0.4400000
</td>
<td style="text-align:left;">
ns
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>tab_statHSeclosion <span class="ot">=</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>    tab_statHSeclosion <span class="sc">%&gt;%</span></span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day =</span> Variable) <span class="sc">%&gt;%</span></span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>tab_statHSeclosion<span class="sc">$</span>Diet <span class="ot">=</span> <span class="st">&quot;HS&quot;</span></span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a>letter_position <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data =</span> Length_dayseclosion, Total_Length_mm <span class="sc">~</span> Day, max)</span>
<span id="cb255-8"><a href="#cb255-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-9"><a href="#cb255-9" aria-hidden="true" tabindex="-1"></a>tab_statHSeclosion <span class="ot">=</span> <span class="fu">left_join</span>(tab_statHSeclosion, letter_position)</span>
<span id="cb255-10"><a href="#cb255-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-11"><a href="#cb255-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Stats vs eclosion for HY</span></span>
<span id="cb255-12"><a href="#cb255-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-13"><a href="#cb255-13" aria-hidden="true" tabindex="-1"></a>Length_dayseclosionHS <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosion, Diet <span class="sc">==</span> <span class="st">&quot;0&quot;</span> <span class="sc">|</span> Diet <span class="sc">==</span> <span class="st">&quot;HY&quot;</span>)</span>
<span id="cb255-14"><a href="#cb255-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 1</span></span>
<span id="cb255-15"><a href="#cb255-15" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosionHS, Day <span class="sc">==</span> <span class="st">&quot;0&quot;</span> <span class="sc">|</span> Day <span class="sc">==</span> <span class="st">&quot;1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb255-16"><a href="#cb255-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb255-17"><a href="#cb255-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-18"><a href="#cb255-18" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb255-19"><a href="#cb255-19" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96951, p-value = 0.4124</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Day + (1/Repeat)
BP = 1.8328, df = 1, p-value = 0.1758</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> (mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]] <span class="sc">-</span> mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;1&quot;</span>)),</span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb259-7"><a href="#cb259-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb259-8"><a href="#cb259-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb259-9"><a href="#cb259-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb259-10"><a href="#cb259-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb259-11"><a href="#cb259-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb259-12"><a href="#cb259-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-13"><a href="#cb259-13" aria-hidden="true" tabindex="-1"></a>tab_stat_day_0vs1 <span class="ot">=</span> tab_stat</span>
<span id="cb259-14"><a href="#cb259-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-15"><a href="#cb259-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 2</span></span>
<span id="cb259-16"><a href="#cb259-16" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosionHS, Day <span class="sc">==</span> <span class="st">&quot;0&quot;</span> <span class="sc">|</span> Day <span class="sc">==</span> <span class="st">&quot;2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb259-17"><a href="#cb259-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb259-18"><a href="#cb259-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-19"><a href="#cb259-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb259-20"><a href="#cb259-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98822, p-value = 0.9615</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Day + (1/Repeat)
BP = 1.6976, df = 1, p-value = 0.1926</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> (mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]] <span class="sc">-</span> mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;2&quot;</span>)),</span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb263-9"><a href="#cb263-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb263-10"><a href="#cb263-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb263-11"><a href="#cb263-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb263-12"><a href="#cb263-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-13"><a href="#cb263-13" aria-hidden="true" tabindex="-1"></a>tab_stat_day_0vs2 <span class="ot">=</span> tab_stat</span>
<span id="cb263-14"><a href="#cb263-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-15"><a href="#cb263-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 3</span></span>
<span id="cb263-16"><a href="#cb263-16" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosionHS, Day <span class="sc">==</span> <span class="st">&quot;0&quot;</span> <span class="sc">|</span> Day <span class="sc">==</span> <span class="st">&quot;3&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb263-17"><a href="#cb263-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb263-18"><a href="#cb263-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-19"><a href="#cb263-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb263-20"><a href="#cb263-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98545, p-value = 0.9144</code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Day + (1/Repeat)
BP = 3.1177, df = 1, p-value = 0.07745</code></pre>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> (mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]] <span class="sc">-</span> mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;3&quot;</span>)),</span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb267-10"><a href="#cb267-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb267-11"><a href="#cb267-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb267-12"><a href="#cb267-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-13"><a href="#cb267-13" aria-hidden="true" tabindex="-1"></a>tab_stat_day_0vs3 <span class="ot">=</span> tab_stat</span>
<span id="cb267-14"><a href="#cb267-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-15"><a href="#cb267-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 4</span></span>
<span id="cb267-16"><a href="#cb267-16" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosionHS, Day <span class="sc">==</span> <span class="st">&quot;0&quot;</span> <span class="sc">|</span> Day <span class="sc">==</span> <span class="st">&quot;4&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb267-17"><a href="#cb267-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb267-18"><a href="#cb267-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-19"><a href="#cb267-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb267-20"><a href="#cb267-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.97795, p-value = 0.6915</code></pre>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Day + (1/Repeat)
BP = 0.026163, df = 1, p-value = 0.8715</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> (mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]] <span class="sc">-</span> mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;4&quot;</span>)),</span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb271-10"><a href="#cb271-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb271-11"><a href="#cb271-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb271-12"><a href="#cb271-12" aria-hidden="true" tabindex="-1"></a>tab_stat_day_0vs4 <span class="ot">=</span> tab_stat</span>
<span id="cb271-13"><a href="#cb271-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-14"><a href="#cb271-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-15"><a href="#cb271-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Day 5</span></span>
<span id="cb271-16"><a href="#cb271-16" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Length_dayseclosionHS, Day <span class="sc">==</span> <span class="st">&quot;0&quot;</span> <span class="sc">|</span> Day <span class="sc">==</span> <span class="st">&quot;5&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb271-17"><a href="#cb271-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb271-18"><a href="#cb271-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-19"><a href="#cb271-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb271-20"><a href="#cb271-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98099, p-value = 0.8035</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Day + (1/Repeat)
BP = 0.21338, df = 1, p-value = 0.6441</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> (mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]] <span class="sc">-</span> mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;5&quot;</span>)),</span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb275-9"><a href="#cb275-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb275-10"><a href="#cb275-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb275-11"><a href="#cb275-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb275-12"><a href="#cb275-12" aria-hidden="true" tabindex="-1"></a>tab_stat_day_0vs5 <span class="ot">=</span> tab_stat</span>
<span id="cb275-13"><a href="#cb275-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-14"><a href="#cb275-14" aria-hidden="true" tabindex="-1"></a>tab_statHYeclosion <span class="ot">=</span> <span class="fu">rbind</span>(tab_stat_day_0vs1, tab_stat_day_0vs2, tab_stat_day_0vs3, tab_stat_day_0vs4, tab_stat_day_0vs5)</span>
<span id="cb275-15"><a href="#cb275-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-16"><a href="#cb275-16" aria-hidden="true" tabindex="-1"></a>tab_statHYeclosion<span class="sc">$</span>padj <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">p.adjust</span>(tab_statHYeclosion<span class="sc">$</span>Pvalue, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>))</span>
<span id="cb275-17"><a href="#cb275-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-18"><a href="#cb275-18" aria-hidden="true" tabindex="-1"></a>tab_statHYeclosion<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_statHYeclosion<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">&quot;ns&quot;</span>,</span>
<span id="cb275-19"><a href="#cb275-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(tab_statHYeclosion<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_statHYeclosion<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb275-20"><a href="#cb275-20" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(tab_statHYeclosion<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_statHYeclosion<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb275-21"><a href="#cb275-21" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(tab_statHYeclosion<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>))))</span>
<span id="cb275-22"><a href="#cb275-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-23"><a href="#cb275-23" aria-hidden="true" tabindex="-1"></a>tab_statHYeclosion<span class="sc">%&gt;%</span></span>
<span id="cb275-24"><a href="#cb275-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison to eclosion on HY&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;p-value adjusted&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb275-25"><a href="#cb275-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Day + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb275-26"><a href="#cb275-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Day + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison to eclosion on HY
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:right;">
p-value adjusted
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
15.38
</td>
<td style="text-align:left;">
1.53
</td>
<td style="text-align:left;">
0.141
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8.8e-05
</td>
<td style="text-align:right;">
8.8e-05
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
28.64
</td>
<td style="text-align:left;">
1.55
</td>
<td style="text-align:left;">
0.209
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.0e-07
</td>
<td style="text-align:right;">
2.0e-07
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
29.67
</td>
<td style="text-align:left;">
1.55
</td>
<td style="text-align:left;">
0.209
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.0e-07
</td>
<td style="text-align:right;">
2.0e-07
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
27.96
</td>
<td style="text-align:left;">
1.55
</td>
<td style="text-align:left;">
0.24
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.0e-07
</td>
<td style="text-align:right;">
2.0e-07
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
28.06
</td>
<td style="text-align:left;">
1.55
</td>
<td style="text-align:left;">
0.263
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.0e-07
</td>
<td style="text-align:right;">
2.0e-07
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>tab_statHYeclosion <span class="ot">=</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>    tab_statHYeclosion <span class="sc">%&gt;%</span></span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day =</span> Variable) <span class="sc">%&gt;%</span></span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">as.factor</span>(Day))</span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a>tab_statHYeclosion<span class="sc">$</span>Diet <span class="ot">=</span> <span class="st">&quot;HY&quot;</span></span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-7"><a href="#cb276-7" aria-hidden="true" tabindex="-1"></a>letter_position <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data =</span> Length_dayseclosion, Total_Length_mm <span class="sc">~</span> Day, max)</span>
<span id="cb276-8"><a href="#cb276-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-9"><a href="#cb276-9" aria-hidden="true" tabindex="-1"></a>tab_statHYeclosion <span class="ot">=</span> <span class="fu">left_join</span>(tab_statHYeclosion, letter_position)</span>
<span id="cb276-10"><a href="#cb276-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-11"><a href="#cb276-11" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb276-12"><a href="#cb276-12" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(Length_dayseclosion<span class="sc">$</span>Total_Length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb276-13"><a href="#cb276-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-14"><a href="#cb276-14" aria-hidden="true" tabindex="-1"></a>Plot_Fig4S1A<span class="ot">=</span></span>
<span id="cb276-15"><a href="#cb276-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Length_dayseclosion, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb276-16"><a href="#cb276-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb276-17"><a href="#cb276-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">60</span>) <span class="sc">+</span> </span>
<span id="cb276-18"><a href="#cb276-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Diet,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>,<span class="at">space=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb276-19"><a href="#cb276-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> <span class="fl">2.3</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb276-20"><a href="#cb276-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_stat1, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span>Day, <span class="at">y =</span> <span class="fl">7.5</span>, <span class="at">label =</span> sig),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb276-21"><a href="#cb276-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_statHSeclosion, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span>Day, <span class="at">y =</span> <span class="fl">3.5</span>, <span class="at">label =</span> sig),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb276-22"><a href="#cb276-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_statHYeclosion, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span>Day, <span class="at">y =</span> <span class="fl">3.5</span>, <span class="at">label =</span> sig),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb276-23"><a href="#cb276-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb276-24"><a href="#cb276-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb276-25"><a href="#cb276-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;0&quot;</span>,<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb276-26"><a href="#cb276-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span> <span class="fu">c</span>(<span class="st">&quot;#cfe7cf&quot;</span>,<span class="st">&quot;#FFB4B4&quot;</span>, <span class="st">&quot;#C3E6FC&quot;</span>))<span class="sc">+</span></span>
<span id="cb276-27"><a href="#cb276-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;Days post eclosion&quot;</span>)<span class="sc">+</span></span>
<span id="cb276-28"><a href="#cb276-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb276-29"><a href="#cb276-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">8.2</span>),</span>
<span id="cb276-30"><a href="#cb276-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb276-31"><a href="#cb276-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb276-32"><a href="#cb276-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb276-33"><a href="#cb276-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb276-34"><a href="#cb276-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb276-35"><a href="#cb276-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb276-36"><a href="#cb276-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb276-37"><a href="#cb276-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb276-38"><a href="#cb276-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb276-39"><a href="#cb276-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb276-40"><a href="#cb276-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb276-41"><a href="#cb276-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb276-42"><a href="#cb276-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb276-43"><a href="#cb276-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb276-44"><a href="#cb276-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb276-45"><a href="#cb276-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb276-46"><a href="#cb276-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb276-47"><a href="#cb276-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb276-48"><a href="#cb276-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb276-49"><a href="#cb276-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb276-50"><a href="#cb276-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb276-51"><a href="#cb276-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb276-52"><a href="#cb276-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb276-53"><a href="#cb276-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb276-54"><a href="#cb276-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb276-55"><a href="#cb276-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb276-56"><a href="#cb276-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb276-57"><a href="#cb276-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb276-58"><a href="#cb276-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-59"><a href="#cb276-59" aria-hidden="true" tabindex="-1"></a>Plot_Fig4S1A</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204S1A-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-4s1b" class="section level3" number="4.2.2">
<h3 number="4.2.2"><span class="header-section-number">4.2.2</span> Figure 4S1B</h3>
<div class="blue">
<p>Scheme for Figure 4 B, C, D and Figure 4 supplement 1C, D, E. At eclosion, flies were allocated to either HS or HY diet. 7-, 14- and 21-days post eclosion flies were either kept on the same diet or shifted on the opposite diet for 7 days (HS to HY or HY to HS). Flies were dissected every 7 days, up until day 28.</p>
</div>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>img4S1B <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/4 - S1B.jpg&quot;</span>) </span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig4S1B <span class="ot">=</span> <span class="fu">rasterGrob</span>(img4S1B)</span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig4S1B)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204S1B-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-4s1c" class="section level3" number="4.2.3">
<h3 number="4.2.3"><span class="header-section-number">4.2.3</span> Figure 4S1C</h3>
<div class="blue">
<p>HS diet does not postpone post-eclosion development, but rather induces continual midgut shrinkage over 28 days of feeding. Letters above violin plots represent grouping by statistical differences (Post hoc Tukey on GLMM).</p>
</div>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>Length_longshift <span class="ot">=</span> </span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;4B, 4S1C&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Total.PH3)<span class="sc">%&gt;%</span></span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm =</span> Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_treatment=</span>Day)</span>
<span id="cb278-8"><a href="#cb278-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-9"><a href="#cb278-9" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb278-10"><a href="#cb278-10" aria-hidden="true" tabindex="-1"></a>  Length_longshift<span class="sc">%&gt;%</span></span>
<span id="cb278-11"><a href="#cb278-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Day_of_treatment,Diet)<span class="sc">%&gt;%</span></span>
<span id="cb278-12"><a href="#cb278-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb278-13"><a href="#cb278-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-14"><a href="#cb278-14" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb278-15"><a href="#cb278-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-16"><a href="#cb278-16" aria-hidden="true" tabindex="-1"></a><span class="co">#HS</span></span>
<span id="cb278-17"><a href="#cb278-17" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">=</span> <span class="fu">subset</span>(Length_longshift, Diet<span class="sc">==</span><span class="st">&quot;HS&quot;</span>)</span>
<span id="cb278-18"><a href="#cb278-18" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Day_of_treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb278-19"><a href="#cb278-19" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98712, p-value = 0.5309</code></pre>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day_of_treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Day_of_treatment + (1/Repeat)
BP = 4.1872, df = 3, p-value = 0.2419</code></pre>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Diet =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS&quot;</span>)),</span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb282-10"><a href="#cb282-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb282-11"><a href="#cb282-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb282-12"><a href="#cb282-12" aria-hidden="true" tabindex="-1"></a>tab_stat_HS<span class="ot">=</span> tab_stat</span>
<span id="cb282-13"><a href="#cb282-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-14"><a href="#cb282-14" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">lmer</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Day_of_treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb282-15"><a href="#cb282-15" aria-hidden="true" tabindex="-1"></a>multcomp <span class="ot">=</span> <span class="fu">glht</span>(mod.gen, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Day_of_treatment=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb282-16"><a href="#cb282-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-17"><a href="#cb282-17" aria-hidden="true" tabindex="-1"></a>Comp_HS <span class="ot">=</span> <span class="fu">cld</span>(multcomp)</span>
<span id="cb282-18"><a href="#cb282-18" aria-hidden="true" tabindex="-1"></a>letter_position_HS <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span>tmp,Total_Length_mm <span class="sc">~</span>  Day_of_treatment, max)</span>
<span id="cb282-19"><a href="#cb282-19" aria-hidden="true" tabindex="-1"></a>letter_position_HS<span class="sc">$</span>Diet<span class="ot">=</span><span class="st">&quot;HS&quot;</span></span>
<span id="cb282-20"><a href="#cb282-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-21"><a href="#cb282-21" aria-hidden="true" tabindex="-1"></a><span class="co">#HY</span></span>
<span id="cb282-22"><a href="#cb282-22" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">=</span> <span class="fu">subset</span>(Length_longshift, Diet<span class="sc">==</span><span class="st">&quot;HY&quot;</span>)</span>
<span id="cb282-23"><a href="#cb282-23" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Day_of_treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb282-24"><a href="#cb282-24" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98536, p-value = 0.3654</code></pre>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Day_of_treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Day_of_treatment + (1/Repeat)
BP = 3.2143, df = 3, p-value = 0.3598</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Diet =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HY&quot;</span>)),</span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb286-9"><a href="#cb286-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb286-10"><a href="#cb286-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb286-11"><a href="#cb286-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb286-12"><a href="#cb286-12" aria-hidden="true" tabindex="-1"></a>tab_stat_HY <span class="ot">=</span>tab_stat</span>
<span id="cb286-13"><a href="#cb286-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-14"><a href="#cb286-14" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">lmer</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Day_of_treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb286-15"><a href="#cb286-15" aria-hidden="true" tabindex="-1"></a>multcomp <span class="ot">=</span> <span class="fu">glht</span>(mod.gen, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Day_of_treatment=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb286-16"><a href="#cb286-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-17"><a href="#cb286-17" aria-hidden="true" tabindex="-1"></a>Comp_HY <span class="ot">=</span> <span class="fu">cld</span>(multcomp)</span>
<span id="cb286-18"><a href="#cb286-18" aria-hidden="true" tabindex="-1"></a>letter_position_HY <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span>tmp,Total_Length_mm <span class="sc">~</span>  Day_of_treatment, max)</span>
<span id="cb286-19"><a href="#cb286-19" aria-hidden="true" tabindex="-1"></a>letter_position_HY<span class="sc">$</span>Diet<span class="ot">=</span><span class="st">&quot;HY&quot;</span></span>
<span id="cb286-20"><a href="#cb286-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-21"><a href="#cb286-21" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">rbind</span>(tab_stat_HS,tab_stat_HY)</span>
<span id="cb286-22"><a href="#cb286-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-23"><a href="#cb286-23" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb286-24"><a href="#cb286-24" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb286-25"><a href="#cb286-25" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb286-26"><a href="#cb286-26" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb286-27"><a href="#cb286-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Any difference&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb286-28"><a href="#cb286-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Day + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb286-29"><a href="#cb286-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Day + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Any difference
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
31.86
</td>
<td style="text-align:left;">
1.43
</td>
<td style="text-align:left;">
-0.185
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
HY
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
12.49
</td>
<td style="text-align:left;">
1.81
</td>
<td style="text-align:left;">
0.0575
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.00041
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>letter_position <span class="ot">=</span> <span class="fu">rbind</span>(letter_position_HS,letter_position_HY)</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a>tab_letter_HS <span class="ot">=</span>  <span class="fu">as.data.frame</span>(Comp_HS<span class="sc">$</span>mcletters<span class="sc">$</span>Letters)</span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a>tab_letter_HS<span class="sc">$</span>Diet <span class="ot">=</span> <span class="st">&quot;HS&quot;</span></span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a>tab_letter_HS<span class="sc">$</span>Day_of_treatment<span class="ot">=</span><span class="fu">rownames</span>(tab_letter_HS)</span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_letter_HS)[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">&quot;Letter&quot;</span></span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-8"><a href="#cb287-8" aria-hidden="true" tabindex="-1"></a>tab_letter_HY <span class="ot">=</span>  <span class="fu">as.data.frame</span>(Comp_HY<span class="sc">$</span>mcletters<span class="sc">$</span>Letters)</span>
<span id="cb287-9"><a href="#cb287-9" aria-hidden="true" tabindex="-1"></a>tab_letter_HY<span class="sc">$</span>Day_of_treatment<span class="ot">=</span><span class="fu">rownames</span>(tab_letter_HY)</span>
<span id="cb287-10"><a href="#cb287-10" aria-hidden="true" tabindex="-1"></a>tab_letter_HY<span class="sc">$</span>Diet <span class="ot">=</span> <span class="st">&quot;HY&quot;</span></span>
<span id="cb287-11"><a href="#cb287-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_letter_HY)[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">&quot;Letter&quot;</span></span>
<span id="cb287-12"><a href="#cb287-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-13"><a href="#cb287-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-14"><a href="#cb287-14" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span> <span class="fu">rbind</span>(tab_letter_HS,tab_letter_HY)</span>
<span id="cb287-15"><a href="#cb287-15" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span> <span class="fu">left_join</span>(tab_letter,letter_position)</span>
<span id="cb287-16"><a href="#cb287-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-17"><a href="#cb287-17" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb287-18"><a href="#cb287-18" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">max</span>(Length_longshift<span class="sc">$</span>Total_Length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb287-19"><a href="#cb287-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-20"><a href="#cb287-20" aria-hidden="true" tabindex="-1"></a>Plot_Fig4S1C<span class="ot">=</span></span>
<span id="cb287-21"><a href="#cb287-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Length_longshift, <span class="fu">aes</span>(<span class="at">x =</span> Day_of_treatment, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb287-22"><a href="#cb287-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb287-23"><a href="#cb287-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb287-24"><a href="#cb287-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Diet,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>,<span class="at">space=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb287-25"><a href="#cb287-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day_of_treatment, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb287-26"><a href="#cb287-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_letter, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day_of_treatment, <span class="at">y =</span> Total_Length_mm<span class="fl">+0.4</span>, <span class="at">label =</span> Letter),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb287-27"><a href="#cb287-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_stat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">9.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,<span class="fu">format</span>(Pvalue,<span class="at">digits=</span><span class="dv">2</span>))),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb287-28"><a href="#cb287-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;0&quot;</span>,<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb287-29"><a href="#cb287-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span> <span class="fu">c</span>(<span class="st">&quot;#cfe7cf&quot;</span>,<span class="st">&quot;#FFB4B4&quot;</span>, <span class="st">&quot;#C3E6FC&quot;</span>))<span class="sc">+</span></span>
<span id="cb287-30"><a href="#cb287-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;Days post eclosion&quot;</span>)<span class="sc">+</span></span>
<span id="cb287-31"><a href="#cb287-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb287-32"><a href="#cb287-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">1.5</span>,<span class="fl">9.5</span>),</span>
<span id="cb287-33"><a href="#cb287-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">3</span>,<span class="dv">9</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb287-34"><a href="#cb287-34" aria-hidden="true" tabindex="-1"></a>     <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb287-35"><a href="#cb287-35" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb287-36"><a href="#cb287-36" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb287-37"><a href="#cb287-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb287-38"><a href="#cb287-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb287-39"><a href="#cb287-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb287-40"><a href="#cb287-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb287-41"><a href="#cb287-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb287-42"><a href="#cb287-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb287-43"><a href="#cb287-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb287-44"><a href="#cb287-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb287-45"><a href="#cb287-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb287-46"><a href="#cb287-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb287-47"><a href="#cb287-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb287-48"><a href="#cb287-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb287-49"><a href="#cb287-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb287-50"><a href="#cb287-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb287-51"><a href="#cb287-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb287-52"><a href="#cb287-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb287-53"><a href="#cb287-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb287-54"><a href="#cb287-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb287-55"><a href="#cb287-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb287-56"><a href="#cb287-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb287-57"><a href="#cb287-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb287-58"><a href="#cb287-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb287-59"><a href="#cb287-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb287-60"><a href="#cb287-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb287-61"><a href="#cb287-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-62"><a href="#cb287-62" aria-hidden="true" tabindex="-1"></a>Plot_Fig4S1C</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204S1C-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-4s1d" class="section level3" number="4.2.4">
<h3 number="4.2.4"><span class="header-section-number">4.2.4</span> Figure 4S1D</h3>
<div class="blue">
<p>Midgut size is a plastic, diet-dependent trait. Midguts of flies shifted between HS or HY can reversibly grow throughout 21 days. Statistical comparison is vs pre-shift measurement.</p>
</div>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>Length_shift_growth <span class="ot">=</span> </span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;4C, 4S1D&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Total.PH3)<span class="sc">%&gt;%</span></span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm =</span> Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb288-6"><a href="#cb288-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb288-7"><a href="#cb288-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_treatment=</span>Day)<span class="sc">%&gt;%</span></span>
<span id="cb288-8"><a href="#cb288-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb288-9"><a href="#cb288-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dday=</span><span class="fu">fct_relevel</span>(Dday,<span class="st">&quot;Shift Day 7&quot;</span>,<span class="st">&quot;Shift Day 14&quot;</span>,<span class="st">&quot;Shift Day 21&quot;</span>))</span>
<span id="cb288-10"><a href="#cb288-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb288-11"><a href="#cb288-11" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb288-12"><a href="#cb288-12" aria-hidden="true" tabindex="-1"></a>  Length_shift_growth<span class="sc">%&gt;%</span></span>
<span id="cb288-13"><a href="#cb288-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Dday,Diet)<span class="sc">%&gt;%</span></span>
<span id="cb288-14"><a href="#cb288-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb288-15"><a href="#cb288-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-16"><a href="#cb288-16" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb288-17"><a href="#cb288-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Day 7</span></span>
<span id="cb288-18"><a href="#cb288-18" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">=</span> <span class="fu">subset</span>(Length_shift_growth,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 7&quot;</span>)</span>
<span id="cb288-19"><a href="#cb288-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb288-20"><a href="#cb288-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98038, p-value = 0.6352</code></pre>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 0.59118, df = 1, p-value = 0.442</code></pre>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-5"><a href="#cb292-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>((<span class="st">&quot;HS Day 7 vs HS to HY Day 14&quot;</span>))),</span>
<span id="cb292-6"><a href="#cb292-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Dday =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Shift Day 7&quot;</span>)),</span>
<span id="cb292-7"><a href="#cb292-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb292-8"><a href="#cb292-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb292-9"><a href="#cb292-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb292-10"><a href="#cb292-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb292-11"><a href="#cb292-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb292-12"><a href="#cb292-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb292-13"><a href="#cb292-13" aria-hidden="true" tabindex="-1"></a>tab_stat_7 <span class="ot">=</span> tab_stat</span>
<span id="cb292-14"><a href="#cb292-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-15"><a href="#cb292-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Day 14</span></span>
<span id="cb292-16"><a href="#cb292-16" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">=</span> <span class="fu">subset</span>(Length_shift_growth,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 14&quot;</span>)</span>
<span id="cb292-17"><a href="#cb292-17" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb292-18"><a href="#cb292-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.95853, p-value = 0.1396</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 5.1346, df = 1, p-value = 0.02345</code></pre>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>((<span class="st">&quot;HS Day 14 vs HS to HY Day 21&quot;</span>))),</span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Dday =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Shift Day 14&quot;</span>)),</span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb296-12"><a href="#cb296-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb296-13"><a href="#cb296-13" aria-hidden="true" tabindex="-1"></a>tab_stat_14 <span class="ot">=</span> tab_stat</span>
<span id="cb296-14"><a href="#cb296-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-15"><a href="#cb296-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Day 21</span></span>
<span id="cb296-16"><a href="#cb296-16" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">=</span> <span class="fu">subset</span>(Length_shift_growth,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 21&quot;</span>)</span>
<span id="cb296-17"><a href="#cb296-17" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb296-18"><a href="#cb296-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.97628, p-value = 0.346</code></pre>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 0.19389, df = 1, p-value = 0.6597</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-5"><a href="#cb300-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>((<span class="st">&quot;HS Day 21 vs HS to HY Day 28&quot;</span>))),</span>
<span id="cb300-6"><a href="#cb300-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Dday =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Shift Day 21&quot;</span>)),</span>
<span id="cb300-7"><a href="#cb300-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb300-8"><a href="#cb300-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb300-9"><a href="#cb300-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb300-10"><a href="#cb300-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb300-11"><a href="#cb300-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb300-12"><a href="#cb300-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb300-13"><a href="#cb300-13" aria-hidden="true" tabindex="-1"></a>tab_stat_21 <span class="ot">=</span> tab_stat</span>
<span id="cb300-14"><a href="#cb300-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-15"><a href="#cb300-15" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_7,tab_stat_14,tab_stat_21)</span>
<span id="cb300-16"><a href="#cb300-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-17"><a href="#cb300-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb300-18"><a href="#cb300-18" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb300-19"><a href="#cb300-19" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb300-20"><a href="#cb300-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-21"><a href="#cb300-21" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb300-22"><a href="#cb300-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Shift day&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb300-23"><a href="#cb300-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:left;">
Shift day
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS Day 7 vs HS to HY Day 14
</td>
<td style="text-align:left;">
Shift Day 7
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
47.53
</td>
<td style="text-align:left;">
1.43
</td>
<td style="text-align:left;">
0.284
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
HS Day 14 vs HS to HY Day 21
</td>
<td style="text-align:left;">
Shift Day 14
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
51.25
</td>
<td style="text-align:left;">
1.24
</td>
<td style="text-align:left;">
0.412
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
HS Day 21 vs HS to HY Day 28
</td>
<td style="text-align:left;">
Shift Day 21
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
54.31
</td>
<td style="text-align:left;">
1.19
</td>
<td style="text-align:left;">
0.497
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>  tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dday=</span><span class="fu">fct_relevel</span>(Dday,<span class="st">&quot;Shift Day 7&quot;</span>,<span class="st">&quot;Shift Day 14&quot;</span>,<span class="st">&quot;Shift Day 21&quot;</span>))</span>
<span id="cb301-6"><a href="#cb301-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-7"><a href="#cb301-7" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb301-8"><a href="#cb301-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-9"><a href="#cb301-9" aria-hidden="true" tabindex="-1"></a>Treatment.status <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Shift</span><span class="sc">\n</span><span class="st">Day 7&quot;</span>,<span class="st">&quot;Shift</span><span class="sc">\n</span><span class="st">Day 14&quot;</span>,<span class="st">&quot;Shift</span><span class="sc">\n</span><span class="st">Day 21&quot;</span>)</span>
<span id="cb301-10"><a href="#cb301-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Treatment.status) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Shift Day 7&quot;</span>, <span class="st">&quot;Shift Day 14&quot;</span>,<span class="st">&quot;Shift Day 21&quot;</span>)</span>
<span id="cb301-11"><a href="#cb301-11" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">max</span>(Length_shift_growth<span class="sc">$</span>Total_Length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-12"><a href="#cb301-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-13"><a href="#cb301-13" aria-hidden="true" tabindex="-1"></a>Plot_Fig4S1D<span class="ot">=</span></span>
<span id="cb301-14"><a href="#cb301-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Length_shift_growth, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb301-15"><a href="#cb301-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb301-16"><a href="#cb301-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">60</span>) <span class="sc">+</span> </span>
<span id="cb301-17"><a href="#cb301-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Dday,<span class="at">labeller=</span><span class="fu">labeller</span>(<span class="at">Dday=</span>Treatment.status) )<span class="sc">+</span></span>
<span id="cb301-18"><a href="#cb301-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">1.6</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb301-19"><a href="#cb301-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_signif</span>(<span class="at">data =</span> tab_stat, <span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">annotations =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">y_position =</span> <span class="dv">9</span>), <span class="at">textsize =</span> <span class="fl">2.5</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">manual =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb301-20"><a href="#cb301-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-21"><a href="#cb301-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HStoHY&quot;</span>),</span>
<span id="cb301-22"><a href="#cb301-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>cbbHS_HStoHY)<span class="sc">+</span></span>
<span id="cb301-23"><a href="#cb301-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb301-24"><a href="#cb301-24" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HStoHY&quot;</span>),</span>
<span id="cb301-25"><a href="#cb301-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HS to HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb301-26"><a href="#cb301-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb301-27"><a href="#cb301-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">1.5</span>,<span class="fl">9.5</span>),</span>
<span id="cb301-28"><a href="#cb301-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb301-29"><a href="#cb301-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">shape =</span> <span class="dv">18</span>,<span class="fu">aes</span>(<span class="at">group=</span>Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb301-30"><a href="#cb301-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb301-31"><a href="#cb301-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb301-32"><a href="#cb301-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb301-33"><a href="#cb301-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb301-34"><a href="#cb301-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb301-35"><a href="#cb301-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb301-36"><a href="#cb301-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb301-37"><a href="#cb301-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb301-38"><a href="#cb301-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb301-39"><a href="#cb301-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb301-40"><a href="#cb301-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb301-41"><a href="#cb301-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb301-42"><a href="#cb301-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb301-43"><a href="#cb301-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb301-44"><a href="#cb301-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb301-45"><a href="#cb301-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb301-46"><a href="#cb301-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb301-47"><a href="#cb301-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb301-48"><a href="#cb301-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb301-49"><a href="#cb301-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb301-50"><a href="#cb301-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb301-51"><a href="#cb301-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb301-52"><a href="#cb301-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb301-53"><a href="#cb301-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb301-54"><a href="#cb301-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb301-55"><a href="#cb301-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb301-56"><a href="#cb301-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb301-57"><a href="#cb301-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-58"><a href="#cb301-58" aria-hidden="true" tabindex="-1"></a>Plot_Fig4S1D</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204S1D-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-4s1e" class="section level3" number="4.2.5">
<h3 number="4.2.5"><span class="header-section-number">4.2.5</span> Figure 4S1E</h3>
<div class="blue">
<p>Midgut size is a plastic, diet-dependent trait. Midguts of flies shifted between HS or HY can reversibly shrink throughout 21 days. Statistical comparison is vs pre-shift measurement.</p>
</div>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a>Length_shift_Shrink <span class="ot">=</span> </span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;4C&#39;, 4S1D&#39;&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Total.PH3)<span class="sc">%&gt;%</span></span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm =</span> Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb302-6"><a href="#cb302-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb302-7"><a href="#cb302-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_treatment=</span>Day)<span class="sc">%&gt;%</span></span>
<span id="cb302-8"><a href="#cb302-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb302-9"><a href="#cb302-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dday=</span><span class="fu">fct_relevel</span>(Dday,<span class="st">&quot;Shift Day 7&quot;</span>,<span class="st">&quot;Shift Day 14&quot;</span>,<span class="st">&quot;Shift Day 21&quot;</span>))</span>
<span id="cb302-10"><a href="#cb302-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb302-11"><a href="#cb302-11" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb302-12"><a href="#cb302-12" aria-hidden="true" tabindex="-1"></a>  Length_shift_Shrink<span class="sc">%&gt;%</span></span>
<span id="cb302-13"><a href="#cb302-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Dday,Diet)<span class="sc">%&gt;%</span></span>
<span id="cb302-14"><a href="#cb302-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb302-15"><a href="#cb302-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-16"><a href="#cb302-16" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb302-17"><a href="#cb302-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Day 7</span></span>
<span id="cb302-18"><a href="#cb302-18" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">=</span> <span class="fu">subset</span>(Length_shift_Shrink,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 7&quot;</span>)</span>
<span id="cb302-19"><a href="#cb302-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb302-20"><a href="#cb302-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96958, p-value = 0.2925</code></pre>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 0.0069323, df = 1, p-value = 0.9336</code></pre>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>((<span class="st">&quot;HS Day 7 vs HS to HY Day 14&quot;</span>))),</span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Dday =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Shift Day 7&quot;</span>)),</span>
<span id="cb306-7"><a href="#cb306-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb306-8"><a href="#cb306-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb306-9"><a href="#cb306-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb306-10"><a href="#cb306-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb306-11"><a href="#cb306-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb306-12"><a href="#cb306-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb306-13"><a href="#cb306-13" aria-hidden="true" tabindex="-1"></a>tab_stat_7 <span class="ot">=</span> tab_stat</span>
<span id="cb306-14"><a href="#cb306-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-15"><a href="#cb306-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Day 14</span></span>
<span id="cb306-16"><a href="#cb306-16" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">=</span> <span class="fu">subset</span>(Length_shift_Shrink,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 14&quot;</span>)</span>
<span id="cb306-17"><a href="#cb306-17" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb306-18"><a href="#cb306-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.9797, p-value = 0.6218</code></pre>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 2.953, df = 1, p-value = 0.08572</code></pre>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>((<span class="st">&quot;HS Day 14 vs HS to HY Day 21&quot;</span>))),</span>
<span id="cb310-6"><a href="#cb310-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Dday =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Shift Day 14&quot;</span>)),</span>
<span id="cb310-7"><a href="#cb310-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb310-8"><a href="#cb310-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb310-9"><a href="#cb310-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb310-10"><a href="#cb310-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb310-11"><a href="#cb310-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb310-12"><a href="#cb310-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb310-13"><a href="#cb310-13" aria-hidden="true" tabindex="-1"></a>tab_stat_14 <span class="ot">=</span> tab_stat</span>
<span id="cb310-14"><a href="#cb310-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-15"><a href="#cb310-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Day 21</span></span>
<span id="cb310-16"><a href="#cb310-16" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">=</span> <span class="fu">subset</span>(Length_shift_Shrink,Dday<span class="sc">==</span><span class="st">&quot;Shift Day 21&quot;</span>)</span>
<span id="cb310-17"><a href="#cb310-17" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb310-18"><a href="#cb310-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.9841, p-value = 0.7537</code></pre>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + (1/Repeat)
BP = 0.11454, df = 1, p-value = 0.735</code></pre>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tmp)</span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>((<span class="st">&quot;HS Day 21 vs HS to HY Day 28&quot;</span>))),</span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Dday =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Shift Day 21&quot;</span>)),</span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb314-9"><a href="#cb314-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb314-10"><a href="#cb314-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb314-11"><a href="#cb314-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb314-12"><a href="#cb314-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb314-13"><a href="#cb314-13" aria-hidden="true" tabindex="-1"></a>tab_stat_21 <span class="ot">=</span> tab_stat</span>
<span id="cb314-14"><a href="#cb314-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-15"><a href="#cb314-15" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_7,tab_stat_14,tab_stat_21)</span>
<span id="cb314-16"><a href="#cb314-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-17"><a href="#cb314-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb314-18"><a href="#cb314-18" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb314-19"><a href="#cb314-19" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb314-20"><a href="#cb314-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-21"><a href="#cb314-21" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb314-22"><a href="#cb314-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>,<span class="st">&quot;Shift day&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total length) ~ Day + Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb314-23"><a href="#cb314-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total length) ~ Day + Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:left;">
Shift day
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS Day 7 vs HS to HY Day 14
</td>
<td style="text-align:left;">
Shift Day 7
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
43.00
</td>
<td style="text-align:left;">
1.8
</td>
<td style="text-align:left;">
-0.349
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
HS Day 14 vs HS to HY Day 21
</td>
<td style="text-align:left;">
Shift Day 14
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
38.48
</td>
<td style="text-align:left;">
1.86
</td>
<td style="text-align:left;">
-0.366
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
HS Day 21 vs HS to HY Day 28
</td>
<td style="text-align:left;">
Shift Day 21
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
21.89
</td>
<td style="text-align:left;">
1.8
</td>
<td style="text-align:left;">
-0.251
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.9e-06
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>  tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb315-5"><a href="#cb315-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dday=</span><span class="fu">fct_relevel</span>(Dday,<span class="st">&quot;Shift Day 7&quot;</span>,<span class="st">&quot;Shift Day 14&quot;</span>,<span class="st">&quot;Shift Day 21&quot;</span>))</span>
<span id="cb315-6"><a href="#cb315-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-7"><a href="#cb315-7" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb315-8"><a href="#cb315-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-9"><a href="#cb315-9" aria-hidden="true" tabindex="-1"></a>Treatment.status <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Shift</span><span class="sc">\n</span><span class="st">Day 7&quot;</span>,<span class="st">&quot;Shift</span><span class="sc">\n</span><span class="st">Day 14&quot;</span>,<span class="st">&quot;Shift</span><span class="sc">\n</span><span class="st">Day 21&quot;</span>)</span>
<span id="cb315-10"><a href="#cb315-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Treatment.status) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Shift Day 7&quot;</span>, <span class="st">&quot;Shift Day 14&quot;</span>,<span class="st">&quot;Shift Day 21&quot;</span>)</span>
<span id="cb315-11"><a href="#cb315-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-12"><a href="#cb315-12" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">max</span>(Length_shift_Shrink<span class="sc">$</span>Total_Length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb315-13"><a href="#cb315-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-14"><a href="#cb315-14" aria-hidden="true" tabindex="-1"></a>Plot_Fig4S1E<span class="ot">=</span></span>
<span id="cb315-15"><a href="#cb315-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Length_shift_Shrink, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb315-16"><a href="#cb315-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb315-17"><a href="#cb315-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb315-18"><a href="#cb315-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Dday,<span class="at">labeller=</span><span class="fu">labeller</span>(<span class="at">Dday=</span>Treatment.status) )<span class="sc">+</span></span>
<span id="cb315-19"><a href="#cb315-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">1.6</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb315-20"><a href="#cb315-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_signif</span>(<span class="at">data =</span> tab_stat, <span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">annotations =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">y_position =</span> <span class="dv">9</span>), <span class="at">textsize =</span> <span class="fl">2.5</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">manual =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb315-21"><a href="#cb315-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-22"><a href="#cb315-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>,<span class="st">&quot;HYtoHS&quot;</span>),</span>
<span id="cb315-23"><a href="#cb315-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>cbbHY_HYtoHS)<span class="sc">+</span></span>
<span id="cb315-24"><a href="#cb315-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb315-25"><a href="#cb315-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>,<span class="st">&quot;HYtoHS&quot;</span>),</span>
<span id="cb315-26"><a href="#cb315-26" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>,<span class="st">&quot;HY to HS&quot;</span>))<span class="sc">+</span></span>
<span id="cb315-27"><a href="#cb315-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb315-28"><a href="#cb315-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">1.5</span>,<span class="fl">9.5</span>),</span>
<span id="cb315-29"><a href="#cb315-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb315-30"><a href="#cb315-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">shape =</span> <span class="dv">18</span>,<span class="fu">aes</span>(<span class="at">group=</span>Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb315-31"><a href="#cb315-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb315-32"><a href="#cb315-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb315-33"><a href="#cb315-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb315-34"><a href="#cb315-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb315-35"><a href="#cb315-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb315-36"><a href="#cb315-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb315-37"><a href="#cb315-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb315-38"><a href="#cb315-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb315-39"><a href="#cb315-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb315-40"><a href="#cb315-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb315-41"><a href="#cb315-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb315-42"><a href="#cb315-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb315-43"><a href="#cb315-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb315-44"><a href="#cb315-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb315-45"><a href="#cb315-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb315-46"><a href="#cb315-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb315-47"><a href="#cb315-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb315-48"><a href="#cb315-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb315-49"><a href="#cb315-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb315-50"><a href="#cb315-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb315-51"><a href="#cb315-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb315-52"><a href="#cb315-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb315-53"><a href="#cb315-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb315-54"><a href="#cb315-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb315-55"><a href="#cb315-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb315-56"><a href="#cb315-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb315-57"><a href="#cb315-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb315-58"><a href="#cb315-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-59"><a href="#cb315-59" aria-hidden="true" tabindex="-1"></a>Plot_Fig4S1E</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204S1E-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-4s1f" class="section level3" number="4.2.6">
<h3 number="4.2.6"><span class="header-section-number">4.2.6</span> Figure 4S1F</h3>
<div class="blue">
<p>ISC proliferation is promoted by yeast and antagonized by sugar. Cell proliferation (pH3 stain) is impeded by dietary sucrose, and increased by yeast, similar to total midgut length (Figure 2A). Plots showing counts of pH3+ cells as a function of ingested yeast and sucrose.</p>
</div>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a>tab_nutri_geo_PH3 <span class="ot">=</span> </span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;4 - S1F&quot;</span>]]</span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="at">filename =</span>  <span class="st">&quot;Plot_Fig4-S1F.jpeg&quot;</span>,</span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">res =</span> <span class="dv">600</span>,</span>
<span id="cb316-6"><a href="#cb316-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">units =</span> <span class="st">&#39;in&#39;</span> )</span>
<span id="cb316-7"><a href="#cb316-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex=</span><span class="dv">1</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">4.5</span>, <span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb316-8"><a href="#cb316-8" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(tab_nutri_geo_PH3, <span class="fu">geomPlotta</span>(<span class="at">x =</span> Sucrose.in.Diet, <span class="at">y =</span> Yeast.in.Diet, <span class="at">z =</span> Ph3.Total, <span class="at">alf =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">300</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">300</span>), <span class="at">xlab =</span> <span class="st">&quot;Sucrose in diet (g/L)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Yeast in diet (g/L)&quot;</span>, <span class="at">frame.plot=</span> <span class="cn">FALSE</span>, <span class="at">cex.lab=</span><span class="fl">1.2</span>, <span class="at">cex.axis =</span><span class="dv">1</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">labcex=</span><span class="dv">1</span>, <span class="at">asp=</span><span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>img4S1F <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/Plot_Fig4-S1F.jpeg&quot;</span>) </span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig4S1F <span class="ot">=</span> <span class="fu">rasterGrob</span>(img4S1F)</span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig4S1F)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204S1F-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-4s1g" class="section level3" number="4.2.7">
<h3 number="4.2.7"><span class="header-section-number">4.2.7</span> Figure 4S1G</h3>
<div class="blue">
<p>Plots showing pH3+ cell counts increase with dietary yeast, with an optimum around HY diet. Increasing sucrose reduces counts of pH3+ cells.</p>
</div>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a>tab_nutri_geo_PH3 <span class="ot">=</span> </span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;4 - S1F&quot;</span>]]</span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a>tab_nutri_geo_PH32 <span class="ot">&lt;-</span> tab_nutri_geo_PH3 <span class="sc">%&gt;%</span></span>
<span id="cb318-5"><a href="#cb318-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(concatenate) <span class="sc">%&gt;%</span></span>
<span id="cb318-6"><a href="#cb318-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Calories.ingested =</span> <span class="fu">mean</span>(Calories.ingested),</span>
<span id="cb318-7"><a href="#cb318-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">Ph3.Total =</span> <span class="fu">mean</span>(Ph3.Total),</span>
<span id="cb318-8"><a href="#cb318-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">Yeast.ingested =</span> <span class="fu">mean</span>(Yeast.ingested),</span>
<span id="cb318-9"><a href="#cb318-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">Sucrose.ingested =</span> <span class="fu">mean</span>(Sucrose.ingested))</span>
<span id="cb318-10"><a href="#cb318-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-11"><a href="#cb318-11" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tab_nutri_geo_PH32, <span class="fu">aes</span>(<span class="at">x=</span>Sucrose.ingested, <span class="at">y=</span>Yeast.ingested))</span>
<span id="cb318-12"><a href="#cb318-12" aria-hidden="true" tabindex="-1"></a>Plot_Fig4S1G<span class="ot">=</span></span>
<span id="cb318-13"><a href="#cb318-13" aria-hidden="true" tabindex="-1"></a> graph <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>Calories.ingested, <span class="at">fill=</span>Ph3.Total), <span class="at">stroke=</span><span class="dv">1</span>, <span class="at">shape=</span><span class="dv">21</span>,  <span class="at">color=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb318-14"><a href="#cb318-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb318-15"><a href="#cb318-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb318-16"><a href="#cb318-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb318-17"><a href="#cb318-17" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_continuous</span>(<span class="st">&quot;Sucrose ingested (g/L x Absorbance)&quot;</span>,</span>
<span id="cb318-18"><a href="#cb318-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">160</span>),</span>
<span id="cb318-19"><a href="#cb318-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">160</span>,<span class="at">by=</span><span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb318-20"><a href="#cb318-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Yeast ingested (g/L x Absorbance)&quot;</span>,</span>
<span id="cb318-21"><a href="#cb318-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">50</span>),</span>
<span id="cb318-22"><a href="#cb318-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="at">by=</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb318-23"><a href="#cb318-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb318-24"><a href="#cb318-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb318-25"><a href="#cb318-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">linetype=</span><span class="dv">3</span>),</span>
<span id="cb318-26"><a href="#cb318-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb318-27"><a href="#cb318-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb318-28"><a href="#cb318-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb318-29"><a href="#cb318-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb318-30"><a href="#cb318-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb318-31"><a href="#cb318-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb318-32"><a href="#cb318-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb318-33"><a href="#cb318-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb318-34"><a href="#cb318-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb318-35"><a href="#cb318-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>, </span>
<span id="cb318-36"><a href="#cb318-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb318-37"><a href="#cb318-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.75</span>,<span class="fl">0.79</span>),</span>
<span id="cb318-38"><a href="#cb318-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb318-39"><a href="#cb318-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb318-40"><a href="#cb318-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb318-41"><a href="#cb318-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb318-42"><a href="#cb318-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb318-43"><a href="#cb318-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>, <span class="at">colour =</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb318-44"><a href="#cb318-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&quot;cm&quot;</span>))<span class="sc">+</span></span>
<span id="cb318-45"><a href="#cb318-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;pH3&quot;</span> <span class="sc">^</span> <span class="st">&quot;+&quot;</span>, <span class="st">&quot; cells&quot;</span>)), <span class="at">size =</span> <span class="st">&quot;Calories</span></span>
<span id="cb318-46"><a href="#cb318-46" aria-hidden="true" tabindex="-1"></a><span class="st">ingested&quot;</span>, <span class="at">vjust=</span><span class="st">&quot;center&quot;</span> )</span>
<span id="cb318-47"><a href="#cb318-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-48"><a href="#cb318-48" aria-hidden="true" tabindex="-1"></a>Plot_Fig4S1G</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204S1G-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>##Export Figure 4S1</p>
</div>
</div>
<div id="figure-4---supplementary-2" class="section level2" number="4.3">
<h2 number="4.3"><span class="header-section-number">4.3</span> Figure 4 - supplementary 2</h2>
<div id="figure-4s2a" class="section level3" number="4.3.1">
<h3 number="4.3.1"><span class="header-section-number">4.3.1</span> Figure 4S2A</h3>
<div class="blue">
<p>Illustration of the cell loss assay (Figure 4G - L). A pulse of RU486 for 3 days marks all ECs and EBs through 5966GS&gt;His-2BRFP. Flies were dissected at 2 and 16-days after cessation of hormone pulse.</p>
</div>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>img4S2A <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/4 - S2A.jpg&quot;</span>) </span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig4S2A <span class="ot">=</span> <span class="fu">rasterGrob</span>(img4S2A)</span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig4S2A)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204S2A-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-4s2b" class="section level3" number="4.3.2">
<h3 number="4.3.2"><span class="header-section-number">4.3.2</span> Figure 4S2B</h3>
<div class="blue">
<p>His2B-RFP is highly stable on both HS and HY diets on tissues not undergoing turnover in a manner similar to the midgut. We assayed the stability of the His2B-RFP by driving it through an ActGS driver, in the crop and hindgut in the same timeline as the experiment presented in Figure 4K. In both organs, we found a high degree of cells marked by His2B-RFP, and on both diets, at both the initial timepoint and after 14 days from the start of the chase. Day of dissection at the bottom of the chart are relative to start of pulse chase.</p>
</div>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a>tab_Hisstab_rev <span class="ot">=</span> </span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;4S2B&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;RFP&quot;</span>)),as.factor)</span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-6"><a href="#cb320-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-7"><a href="#cb320-7" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb320-8"><a href="#cb320-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-9"><a href="#cb320-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Crop</span></span>
<span id="cb320-10"><a href="#cb320-10" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_Hisstab_rev , Tissue<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Crop&quot;</span>))</span>
<span id="cb320-11"><a href="#cb320-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-12"><a href="#cb320-12" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>((RFP.Dapi) <span class="sc">~</span>  Day <span class="sc">*</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb320-13"><a href="#cb320-13" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.97787, p-value = 0.3043</code></pre>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>((RFP.Dapi) <span class="sc">~</span>  Day <span class="sc">*</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  (RFP.Dapi) ~ Day * Diet + (1/Repeat)
BP = 11.797, df = 3, p-value = 0.008111</code></pre>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>((RFP.Dapi) <span class="sc">~</span>  Day <span class="sc">+</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a>test</span></code></pre></div>
<pre><code>      chi2_LR df   p_value
p_v 0.3811947  1 0.5369646</code></pre>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Tissue =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Crop&quot;</span>)),</span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb326-7"><a href="#cb326-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb326-8"><a href="#cb326-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb326-9"><a href="#cb326-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb326-10"><a href="#cb326-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">1</span>,<span class="at">scientific=</span>F)))</span>
<span id="cb326-11"><a href="#cb326-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-12"><a href="#cb326-12" aria-hidden="true" tabindex="-1"></a>tab_stat_Crop<span class="ot">=</span>tab_stat</span>
<span id="cb326-13"><a href="#cb326-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-14"><a href="#cb326-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Hindgut</span></span>
<span id="cb326-15"><a href="#cb326-15" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_Hisstab_rev , Tissue<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Hindgut&quot;</span>))</span>
<span id="cb326-16"><a href="#cb326-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-17"><a href="#cb326-17" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>((RFP.Dapi) <span class="sc">~</span>  Day <span class="sc">*</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb326-18"><a href="#cb326-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.63759, p-value = 2.106e-12</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>((RFP.Dapi) <span class="sc">~</span>  Day <span class="sc">*</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  (RFP.Dapi) ~ Day * Diet + (1/Repeat)
BP = 1.526, df = 3, p-value = 0.6763</code></pre>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>((RFP.Dapi) <span class="sc">~</span>  Day <span class="sc">+</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true" tabindex="-1"></a>test</span></code></pre></div>
<pre><code>        chi2_LR df   p_value
p_v 0.008096241  1 0.9283038</code></pre>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Tissue =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Hindgut&quot;</span>)),</span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb332-8"><a href="#cb332-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb332-9"><a href="#cb332-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb332-10"><a href="#cb332-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">1</span>,<span class="at">scientific=</span>F)))</span>
<span id="cb332-11"><a href="#cb332-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-12"><a href="#cb332-12" aria-hidden="true" tabindex="-1"></a>tab_stat_Hindgut<span class="ot">=</span>tab_stat</span>
<span id="cb332-13"><a href="#cb332-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-14"><a href="#cb332-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-15"><a href="#cb332-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Table</span></span>
<span id="cb332-16"><a href="#cb332-16" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_Crop,tab_stat_Hindgut)</span>
<span id="cb332-17"><a href="#cb332-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>padj <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">p.adjust</span>(tab_stat<span class="sc">$</span>Pvalue, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>),<span class="at">digits=</span><span class="dv">2</span>,<span class="at">scientific =</span>F))</span>
<span id="cb332-18"><a href="#cb332-18" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb332-19"><a href="#cb332-19" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb332-20"><a href="#cb332-20" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb332-21"><a href="#cb332-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-22"><a href="#cb332-22" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb332-23"><a href="#cb332-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;p-value adjusted&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb332-24"><a href="#cb332-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;(RFP/Dapi) ~  Diet + Genotype + Diet : Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb332-25"><a href="#cb332-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
(RFP/Dapi) ~ Diet + Genotype + Diet : Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:right;">
p-value adjusted
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Crop
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:left;">
84.4
</td>
<td style="text-align:left;">
4.21
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Hindgut
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:left;">
99.1
</td>
<td style="text-align:left;">
-0.00928
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_Hisstab<span class="ot">=</span>tab_stat</span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_Hisstab<span class="sc">$</span>Diet <span class="ot">=</span> <span class="st">&quot;HY&quot;</span></span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb333-6"><a href="#cb333-6" aria-hidden="true" tabindex="-1"></a>  tab_Hisstab_rev<span class="sc">%&gt;%</span></span>
<span id="cb333-7"><a href="#cb333-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet, Day, Tissue)<span class="sc">%&gt;%</span></span>
<span id="cb333-8"><a href="#cb333-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb333-9"><a href="#cb333-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-10"><a href="#cb333-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-11"><a href="#cb333-11" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb333-12"><a href="#cb333-12" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>,<span class="st">&quot;14&quot;</span>)</span>
<span id="cb333-13"><a href="#cb333-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-14"><a href="#cb333-14" aria-hidden="true" tabindex="-1"></a>Plot_Fig4S2B<span class="ot">=</span></span>
<span id="cb333-15"><a href="#cb333-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_Hisstab_rev, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> RFP.Dapi))<span class="sc">+</span> </span>
<span id="cb333-16"><a href="#cb333-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb333-17"><a href="#cb333-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb333-18"><a href="#cb333-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Tissue <span class="sc">~</span> Diet,<span class="at">labeller=</span>label_parsed)<span class="sc">+</span></span>
<span id="cb333-19"><a href="#cb333-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> <span class="dv">10</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb333-20"><a href="#cb333-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb333-21"><a href="#cb333-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#FFB4B4&quot;</span>,<span class="st">&quot;#C3E6FC&quot;</span>))<span class="sc">+</span></span>
<span id="cb333-22"><a href="#cb333-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;Day of dissection post RU486 pulse&quot;</span>,</span>
<span id="cb333-23"><a href="#cb333-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span>Limits,</span>
<span id="cb333-24"><a href="#cb333-24" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;0&quot;</span>,<span class="st">&quot;14&quot;</span>))<span class="sc">+</span></span>
<span id="cb333-25"><a href="#cb333-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;RFP pos. cells / Total cells %&quot;</span>)),</span>
<span id="cb333-26"><a href="#cb333-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">110</span>),</span>
<span id="cb333-27"><a href="#cb333-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="at">by=</span><span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb333-28"><a href="#cb333-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb333-29"><a href="#cb333-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb333-30"><a href="#cb333-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb333-31"><a href="#cb333-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb333-32"><a href="#cb333-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb333-33"><a href="#cb333-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb333-34"><a href="#cb333-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb333-35"><a href="#cb333-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>) ), </span>
<span id="cb333-36"><a href="#cb333-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb333-37"><a href="#cb333-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb333-38"><a href="#cb333-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb333-39"><a href="#cb333-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb333-40"><a href="#cb333-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb333-41"><a href="#cb333-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb333-42"><a href="#cb333-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb333-43"><a href="#cb333-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb333-44"><a href="#cb333-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb333-45"><a href="#cb333-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb333-46"><a href="#cb333-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb333-47"><a href="#cb333-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb333-48"><a href="#cb333-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb333-49"><a href="#cb333-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb333-50"><a href="#cb333-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb333-51"><a href="#cb333-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb333-52"><a href="#cb333-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont<span class="dv">-2</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">1</span>)),</span>
<span id="cb333-53"><a href="#cb333-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb333-54"><a href="#cb333-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb333-55"><a href="#cb333-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-56"><a href="#cb333-56" aria-hidden="true" tabindex="-1"></a>Plot_Fig4S2B</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204S2B-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-4s2c" class="section level3" number="4.3.3">
<h3 number="4.3.3"><span class="header-section-number">4.3.3</span> Figure 4S2C</h3>
<div class="blue">
<p>Cell loss assay performed at 5 days post start of chase shows limited cell loss in HY to HY condition. Number of ECs in the posterior midgut, both marked (Red, old ECs) and unmarked (Blue, new ECs) by RFP, error bars are SE from 3 repeats.</p>
</div>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a>tab_prop_cell_RFP_kin <span class="ot">=</span> </span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;4S2C&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Post.Dapi.Number =</span> (Post.Dapi.Number)<span class="sc">*</span><span class="dv">2</span>)<span class="sc">%&gt;%</span></span>
<span id="cb334-6"><a href="#cb334-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Post.RFP.Number =</span> (Post.RFP.Number)<span class="sc">*</span><span class="dv">2</span>)<span class="sc">%&gt;%</span></span>
<span id="cb334-7"><a href="#cb334-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Post.NonRFP.Number =</span> (Post.Dapi.Number <span class="sc">-</span> Post.RFP.Number))<span class="sc">%&gt;%</span></span>
<span id="cb334-8"><a href="#cb334-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Day, Diet, CG, Experiment)<span class="sc">%&gt;%</span></span>
<span id="cb334-9"><a href="#cb334-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_RFP_positive=</span><span class="fu">mean</span>(Post.RFP.Number,<span class="at">na.rm=</span>T),</span>
<span id="cb334-10"><a href="#cb334-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_RFP_positive=</span><span class="fu">se</span>(Post.RFP.Number),</span>
<span id="cb334-11"><a href="#cb334-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_RFP_negative=</span><span class="fu">mean</span>(Post.NonRFP.Number,<span class="at">na.rm=</span>T),</span>
<span id="cb334-12"><a href="#cb334-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_RFP_negative=</span><span class="fu">se</span>(Post.NonRFP.Number))<span class="sc">%&gt;%</span></span>
<span id="cb334-13"><a href="#cb334-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group=</span><span class="fu">paste</span>(Diet,Experiment,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb334-14"><a href="#cb334-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb334-15"><a href="#cb334-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-16"><a href="#cb334-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-17"><a href="#cb334-17" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(tab_prop_cell_RFP_kin)</span>
<span id="cb334-18"><a href="#cb334-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Experiment)){</span>
<span id="cb334-19"><a href="#cb334-19" aria-hidden="true" tabindex="-1"></a>    tab_prop_cell_RFP_kin<span class="sc">$</span>se_proportionGraphPlus_pos[i] <span class="ot">=</span> mean_RFP_positive[i]<span class="sc">+</span>se_RFP_positive[i]</span>
<span id="cb334-20"><a href="#cb334-20" aria-hidden="true" tabindex="-1"></a>    tab_prop_cell_RFP_kin<span class="sc">$</span>se_proportionGraphMinus_pos[i] <span class="ot">=</span> mean_RFP_positive[i]<span class="sc">-</span>se_RFP_positive[i]</span>
<span id="cb334-21"><a href="#cb334-21" aria-hidden="true" tabindex="-1"></a>    tab_prop_cell_RFP_kin<span class="sc">$</span>se_proportionGraphPlus_neg[i] <span class="ot">=</span> mean_RFP_positive[i]<span class="sc">+</span>mean_RFP_negative[i]<span class="sc">+</span>se_RFP_negative[i]</span>
<span id="cb334-22"><a href="#cb334-22" aria-hidden="true" tabindex="-1"></a>    tab_prop_cell_RFP_kin<span class="sc">$</span>se_proportionGraphMinus_neg[i] <span class="ot">=</span> mean_RFP_positive[i]<span class="sc">+</span>mean_RFP_negative[i]<span class="sc">-</span>se_RFP_negative[i]</span>
<span id="cb334-23"><a href="#cb334-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb334-24"><a href="#cb334-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-25"><a href="#cb334-25" aria-hidden="true" tabindex="-1"></a>tmp1 <span class="ot">=</span> tab_prop_cell_RFP_kin[,<span class="fu">c</span>(<span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Diet&quot;</span>, <span class="st">&quot;CG&quot;</span>, <span class="st">&quot;Experiment&quot;</span>,<span class="st">&quot;mean_RFP_positive&quot;</span>, <span class="st">&quot;se_RFP_positive&quot;</span>,<span class="st">&quot;se_proportionGraphPlus_pos&quot;</span>, <span class="st">&quot;se_proportionGraphMinus_pos&quot;</span>)]</span>
<span id="cb334-26"><a href="#cb334-26" aria-hidden="true" tabindex="-1"></a>tmp1<span class="sc">$</span>RFP<span class="ot">=</span><span class="st">&quot;Positive&quot;</span></span>
<span id="cb334-27"><a href="#cb334-27" aria-hidden="true" tabindex="-1"></a>tmp1<span class="ot">=</span>dplyr<span class="sc">::</span><span class="fu">rename</span>(tmp1,<span class="at">mean_RFP =</span> mean_RFP_positive,</span>
<span id="cb334-28"><a href="#cb334-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_RFP =</span> se_RFP_positive,</span>
<span id="cb334-29"><a href="#cb334-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_proportionGraphPlus =</span>se_proportionGraphPlus_pos,</span>
<span id="cb334-30"><a href="#cb334-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_proportionGraphMinus=</span> se_proportionGraphMinus_pos)</span>
<span id="cb334-31"><a href="#cb334-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-32"><a href="#cb334-32" aria-hidden="true" tabindex="-1"></a>tmp2 <span class="ot">=</span> tab_prop_cell_RFP_kin[,<span class="fu">c</span>(<span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Diet&quot;</span>, <span class="st">&quot;CG&quot;</span>, <span class="st">&quot;Experiment&quot;</span>,<span class="st">&quot;mean_RFP_negative&quot;</span>, <span class="st">&quot;se_RFP_negative&quot;</span>, <span class="st">&quot;se_proportionGraphMinus_neg&quot;</span> ,<span class="st">&quot;se_proportionGraphPlus_neg&quot;</span>)]</span>
<span id="cb334-33"><a href="#cb334-33" aria-hidden="true" tabindex="-1"></a>tmp2<span class="sc">$</span>RFP<span class="ot">=</span><span class="st">&quot;Negative&quot;</span></span>
<span id="cb334-34"><a href="#cb334-34" aria-hidden="true" tabindex="-1"></a>tmp2<span class="ot">=</span>dplyr<span class="sc">::</span><span class="fu">rename</span>(tmp2,<span class="at">mean_RFP =</span> mean_RFP_negative, </span>
<span id="cb334-35"><a href="#cb334-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_RFP =</span> se_RFP_negative,</span>
<span id="cb334-36"><a href="#cb334-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_proportionGraphPlus =</span>se_proportionGraphPlus_neg,</span>
<span id="cb334-37"><a href="#cb334-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_proportionGraphMinus=</span> se_proportionGraphMinus_neg)</span>
<span id="cb334-38"><a href="#cb334-38" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb334-39"><a href="#cb334-39" aria-hidden="true" tabindex="-1"></a>tab_prop_cell_RFP_kin <span class="ot">=</span> <span class="fu">rbind</span>(tmp1,tmp2)</span>
<span id="cb334-40"><a href="#cb334-40" aria-hidden="true" tabindex="-1"></a>tab_prop_cell_RFP_kin <span class="ot">=</span> </span>
<span id="cb334-41"><a href="#cb334-41" aria-hidden="true" tabindex="-1"></a>  tab_prop_cell_RFP_kin<span class="sc">%&gt;%</span></span>
<span id="cb334-42"><a href="#cb334-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric,round,<span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb334-43"><a href="#cb334-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)</span>
<span id="cb334-44"><a href="#cb334-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-45"><a href="#cb334-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-46"><a href="#cb334-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-47"><a href="#cb334-47" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(tab_prop_cell_RFP_kin<span class="sc">$</span>Diet) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HS to HS&quot;</span> , <span class="st">&quot;HS to HY&quot;</span>, <span class="st">&quot;HY&quot;</span>, <span class="st">&quot;HY to HS&quot;</span>, <span class="st">&quot;HY to HY&quot;</span>)</span>
<span id="cb334-48"><a href="#cb334-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-49"><a href="#cb334-49" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb334-50"><a href="#cb334-50" aria-hidden="true" tabindex="-1"></a>    d[[<span class="st">&quot;4S2C&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb334-51"><a href="#cb334-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb334-52"><a href="#cb334-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb334-53"><a href="#cb334-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb334-54"><a href="#cb334-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb334-55"><a href="#cb334-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-56"><a href="#cb334-56" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="sc">$</span>Experiment <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;G&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;S&quot;</span>)</span>
<span id="cb334-57"><a href="#cb334-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-58"><a href="#cb334-58" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(Sample_size<span class="sc">$</span>Diet) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HS to HS&quot;</span> , <span class="st">&quot;HS to HY&quot;</span>, <span class="st">&quot;HY&quot;</span>, <span class="st">&quot;HY to HS&quot;</span>, <span class="st">&quot;HY to HY&quot;</span>)</span>
<span id="cb334-59"><a href="#cb334-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-60"><a href="#cb334-60" aria-hidden="true" tabindex="-1"></a>                                  </span>
<span id="cb334-61"><a href="#cb334-61" aria-hidden="true" tabindex="-1"></a>Plot_Fig4S2C <span class="ot">=</span></span>
<span id="cb334-62"><a href="#cb334-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_prop_cell_RFP_kin, <span class="fu">aes</span>(<span class="at">x=</span>Diet, <span class="at">y=</span>mean_RFP))<span class="sc">+</span> </span>
<span id="cb334-63"><a href="#cb334-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>RFP),<span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">width=</span>.<span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb334-64"><a href="#cb334-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span> se_proportionGraphMinus, <span class="at">ymax=</span> se_proportionGraphPlus),<span class="at">width=</span><span class="fl">0.25</span>)<span class="sc">+</span></span>
<span id="cb334-65"><a href="#cb334-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="dv">200</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb334-66"><a href="#cb334-66" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(.~Experiment,scales=&quot;free_x&quot;)+</span></span>
<span id="cb334-67"><a href="#cb334-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;RFP labelling&quot;</span>, </span>
<span id="cb334-68"><a href="#cb334-68" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#3a5ecc&quot;</span>,<span class="st">&quot;#cc0000&quot;</span>),</span>
<span id="cb334-69"><a href="#cb334-69" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Negative&quot;</span>, <span class="st">&quot;Positive&quot;</span>))<span class="sc">+</span></span>
<span id="cb334-70"><a href="#cb334-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Number of cells (mean \u00B1se)&quot;</span>,</span>
<span id="cb334-71"><a href="#cb334-71" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5800</span>),</span>
<span id="cb334-72"><a href="#cb334-72" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5000</span>,<span class="at">by=</span><span class="dv">500</span>))<span class="sc">+</span></span>
<span id="cb334-73"><a href="#cb334-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb334-74"><a href="#cb334-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb334-75"><a href="#cb334-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb334-76"><a href="#cb334-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb334-77"><a href="#cb334-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb334-78"><a href="#cb334-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb334-79"><a href="#cb334-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb334-80"><a href="#cb334-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb334-81"><a href="#cb334-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb334-82"><a href="#cb334-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb334-83"><a href="#cb334-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb334-84"><a href="#cb334-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb334-85"><a href="#cb334-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb334-86"><a href="#cb334-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb334-87"><a href="#cb334-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.87</span>),</span>
<span id="cb334-88"><a href="#cb334-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb334-89"><a href="#cb334-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb334-90"><a href="#cb334-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb334-91"><a href="#cb334-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb334-92"><a href="#cb334-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont),</span>
<span id="cb334-93"><a href="#cb334-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb334-94"><a href="#cb334-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>())</span>
<span id="cb334-95"><a href="#cb334-95" aria-hidden="true" tabindex="-1"></a>    <span class="co">#strip.background = element_rect(fill=NA, colour=&quot;black&quot;),</span></span>
<span id="cb334-96"><a href="#cb334-96" aria-hidden="true" tabindex="-1"></a>    <span class="co">#strip.placement=&quot;outside&quot;)</span></span>
<span id="cb334-97"><a href="#cb334-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-98"><a href="#cb334-98" aria-hidden="true" tabindex="-1"></a>Plot_Fig4S2C</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204S2C-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-4s2d" class="section level3" number="4.3.4">
<h3 number="4.3.4"><span class="header-section-number">4.3.4</span> Figure 4S2D</h3>
<div class="blue">
<p>Diet composition modulates cell replacement rate (cell/day). Bar chart was made using the same data as in Figure 4 K, L.</p>
</div>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a>tab_relative_cell_rate_supp <span class="ot">=</span> </span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;4L, 4S2D&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">&quot;X&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()<span class="sc">%&gt;%</span></span>
<span id="cb335-5"><a href="#cb335-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb335-6"><a href="#cb335-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet1, Experiment, Experiment2, GL)<span class="sc">%&gt;%</span></span>
<span id="cb335-7"><a href="#cb335-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_Daily=</span><span class="fu">mean</span>(Daily,<span class="at">na.rm=</span>T))<span class="sc">%&gt;%</span></span>
<span id="cb335-8"><a href="#cb335-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">group=</span><span class="fu">paste</span>(Diet1,Experiment,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb335-9"><a href="#cb335-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb335-10"><a href="#cb335-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-11"><a href="#cb335-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-12"><a href="#cb335-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-13"><a href="#cb335-13" aria-hidden="true" tabindex="-1"></a>tab_relative_cell_rate_ratio <span class="ot">=</span> </span>
<span id="cb335-14"><a href="#cb335-14" aria-hidden="true" tabindex="-1"></a>  tab_relative_cell_rate_supp<span class="sc">%&gt;%</span></span>
<span id="cb335-15"><a href="#cb335-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet1,Experiment2)<span class="sc">%&gt;%</span></span>
<span id="cb335-16"><a href="#cb335-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Ratio =</span> <span class="fu">round</span>(mean_Daily[GL <span class="sc">==</span> <span class="st">&quot;Gain&quot;</span>] <span class="sc">/</span> (<span class="sc">-</span>mean_Daily[GL <span class="sc">==</span> <span class="st">&quot;Loss&quot;</span>]),<span class="dv">2</span>))<span class="sc">%&gt;%</span></span>
<span id="cb335-17"><a href="#cb335-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GL=</span><span class="st">&quot;Loss&quot;</span>)</span>
<span id="cb335-18"><a href="#cb335-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-19"><a href="#cb335-19" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(tab_relative_cell_rate_supp<span class="sc">$</span>Diet1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HS to HS&quot;</span> , <span class="st">&quot;HS to HY&quot;</span>, <span class="st">&quot;HY to HS&quot;</span>, <span class="st">&quot;HY to HY&quot;</span>)</span>
<span id="cb335-20"><a href="#cb335-20" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(tab_relative_cell_rate_ratio<span class="sc">$</span>Diet1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HS to HS&quot;</span> , <span class="st">&quot;HS to HY&quot;</span>, <span class="st">&quot;HY to HS&quot;</span>, <span class="st">&quot;HY to HY&quot;</span>)</span>
<span id="cb335-21"><a href="#cb335-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-22"><a href="#cb335-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-23"><a href="#cb335-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-24"><a href="#cb335-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-25"><a href="#cb335-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-26"><a href="#cb335-26" aria-hidden="true" tabindex="-1"></a>Plot_Fig4S2D <span class="ot">=</span></span>
<span id="cb335-27"><a href="#cb335-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_relative_cell_rate_supp, <span class="fu">aes</span>(<span class="at">x =</span> Diet1, <span class="at">y =</span> mean_Daily, <span class="at">fill =</span> GL))<span class="sc">+</span> </span>
<span id="cb335-28"><a href="#cb335-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="fu">aes</span>(<span class="at">fill=</span>GL),<span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">width=</span>.<span class="dv">90</span>)<span class="sc">+</span></span>
<span id="cb335-29"><a href="#cb335-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb335-30"><a href="#cb335-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span>tab_relative_cell_rate_ratio,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>Diet1,<span class="at">y=</span><span class="sc">-</span><span class="dv">20</span>,<span class="at">label=</span>Ratio), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb335-31"><a href="#cb335-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Experiment2,<span class="at">scales=</span><span class="st">&quot;free_x&quot;</span>)<span class="sc">+</span></span>
<span id="cb335-32"><a href="#cb335-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-33"><a href="#cb335-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;Enterocyte&quot;</span>, </span>
<span id="cb335-34"><a href="#cb335-34" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;palegreen&quot;</span>, <span class="st">&quot;moccasin&quot;</span>),</span>
<span id="cb335-35"><a href="#cb335-35" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Gain&quot;</span>, <span class="st">&quot;Loss&quot;</span>))<span class="sc">+</span></span>
<span id="cb335-36"><a href="#cb335-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Cell rate (cell/ day)&quot;</span>,</span>
<span id="cb335-37"><a href="#cb335-37" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">220</span>,<span class="dv">220</span>),</span>
<span id="cb335-38"><a href="#cb335-38" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">200</span>,<span class="dv">200</span>,<span class="at">by=</span><span class="dv">50</span>))<span class="sc">+</span></span>
<span id="cb335-39"><a href="#cb335-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb335-40"><a href="#cb335-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb335-41"><a href="#cb335-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb335-42"><a href="#cb335-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb335-43"><a href="#cb335-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb335-44"><a href="#cb335-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb335-45"><a href="#cb335-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb335-46"><a href="#cb335-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb335-47"><a href="#cb335-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb335-48"><a href="#cb335-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb335-49"><a href="#cb335-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb335-50"><a href="#cb335-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb335-51"><a href="#cb335-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb335-52"><a href="#cb335-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb335-53"><a href="#cb335-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.18</span>,<span class="fl">0.88</span>),</span>
<span id="cb335-54"><a href="#cb335-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb335-55"><a href="#cb335-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb335-56"><a href="#cb335-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb335-57"><a href="#cb335-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb335-58"><a href="#cb335-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont),</span>
<span id="cb335-59"><a href="#cb335-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb335-60"><a href="#cb335-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb335-61"><a href="#cb335-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb335-62"><a href="#cb335-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb335-63"><a href="#cb335-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb335-64"><a href="#cb335-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-65"><a href="#cb335-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-66"><a href="#cb335-66" aria-hidden="true" tabindex="-1"></a>Plot_Fig4S2D</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%204S2D-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>##Export Figure 4S2</p>
</div>
</div>
</div>
<div id="figure-5.-sugar-uncouples-isc-proliferation-from-niche-signal-expression-by-inducing-translational-stress" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Figure 5. Sugar uncouples ISC proliferation from niche signal expression by inducing translational stress</h1>
<div id="figure-5---main" class="section level2" number="5.1">
<h2 number="5.1"><span class="header-section-number">5.1</span> Figure 5 - main</h2>
<div id="figure-5a" class="section level3" number="5.1.1">
<h3 number="5.1.1"><span class="header-section-number">5.1.1</span> Figure 5A</h3>
<div class="blue">
<p>Diet influences midgut transcriptomes after an initial programmed developmental transition. The plot shows a PCA of the whole transcriptome, with means per diet per day ± standard error (3 repeats). Numbers on the plot represent the day of dissection from eclosion. Lines connect the datapoints sequentially (Day 0 to day 1, day 1 to day 2, and so on), and show the divergent transcriptomic trajectory followed by midguts on the two different diets from eclosion.</p>
</div>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a>dataInd <span class="ot">=</span></span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;gutGrowthDataIndex&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)</span>
<span id="cb336-5"><a href="#cb336-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#add string to direct to enumerated reads</span></span>
<span id="cb336-6"><a href="#cb336-6" aria-hidden="true" tabindex="-1"></a>dataInd<span class="sc">$</span>countFile <span class="ot">=</span> <span class="fu">gsub</span>(<span class="st">&quot;.fastq&quot;</span>, <span class="st">&quot;_sn.sam.count&quot;</span>, dataInd<span class="sc">$</span>library)</span>
<span id="cb336-7"><a href="#cb336-7" aria-hidden="true" tabindex="-1"></a>dataInd<span class="sc">$</span>samp <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">&quot;day&quot;</span>,dataInd<span class="sc">$</span>day,<span class="st">&quot;_diet&quot;</span>,dataInd<span class="sc">$</span>diet,<span class="st">&quot;_rep&quot;</span>,dataInd<span class="sc">$</span>rep,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb336-8"><a href="#cb336-8" aria-hidden="true" tabindex="-1"></a>dataInd<span class="sc">$</span>expCond <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">paste</span>(dataInd<span class="sc">$</span>day, dataInd<span class="sc">$</span>diet, <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb336-9"><a href="#cb336-9" aria-hidden="true" tabindex="-1"></a>dataInd<span class="sc">$</span>dietCol <span class="ot">=</span> <span class="fu">with</span>( dataInd, <span class="fu">ifelse</span>(diet<span class="sc">==</span><span class="st">&quot;x&quot;</span>, <span class="st">&quot;#ff9595&quot;</span>, <span class="fu">ifelse</span>(diet<span class="sc">==</span><span class="st">&quot;y&quot;</span>, <span class="st">&quot;#abefff&quot;</span>, <span class="st">&quot;#67ff67&quot;</span>))  )</span>
<span id="cb336-10"><a href="#cb336-10" aria-hidden="true" tabindex="-1"></a>tab_read_RNAseq <span class="ot">=</span> d[[<span class="st">&quot;readTable&quot;</span>]]</span>
<span id="cb336-11"><a href="#cb336-11" aria-hidden="true" tabindex="-1"></a>geneID <span class="ot">=</span> <span class="fu">rownames</span>(tab_read_RNAseq) <span class="ot">=</span> tab_read_RNAseq<span class="sc">$</span>FBid</span>
<span id="cb336-12"><a href="#cb336-12" aria-hidden="true" tabindex="-1"></a>tab_read_RNAseq <span class="ot">=</span> tab_read_RNAseq[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(tab_read_RNAseq)]</span>
<span id="cb336-13"><a href="#cb336-13" aria-hidden="true" tabindex="-1"></a>normCounts <span class="ot">=</span> d[[<span class="st">&quot;normCounts&quot;</span>]]</span>
<span id="cb336-14"><a href="#cb336-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(normCounts) <span class="ot">=</span> geneID</span>
<span id="cb336-15"><a href="#cb336-15" aria-hidden="true" tabindex="-1"></a>normCounts <span class="ot">=</span> normCounts[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(normCounts)]</span>
<span id="cb336-16"><a href="#cb336-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#pca without day 4</span></span>
<span id="cb336-17"><a href="#cb336-17" aria-hidden="true" tabindex="-1"></a>dataInd2 <span class="ot">=</span> <span class="fu">droplevels</span>(<span class="fu">subset</span>(dataInd, day<span class="sc">!=</span><span class="dv">4</span>))</span>
<span id="cb336-18"><a href="#cb336-18" aria-hidden="true" tabindex="-1"></a>normCounts2 <span class="ot">=</span> normCounts[,dataInd<span class="sc">$</span>day<span class="sc">!=</span><span class="dv">4</span>]</span>
<span id="cb336-19"><a href="#cb336-19" aria-hidden="true" tabindex="-1"></a>pca2 <span class="ot">=</span> <span class="fu">prcomp</span>(<span class="fu">t</span>(normCounts2))   </span>
<span id="cb336-20"><a href="#cb336-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca2)</span></code></pre></div>
<pre><code>Importance of components:
                           PC1     PC2      PC3      PC4      PC5     PC6
Standard deviation     27.1902 19.9723 14.67551 13.46729 10.71975 9.34310
Proportion of Variance  0.2674  0.1443  0.07789  0.06559  0.04156 0.03157
Cumulative Proportion   0.2674  0.4116  0.48951  0.55510  0.59666 0.62823
                           PC7     PC8     PC9    PC10    PC11   PC12    PC13
Standard deviation     8.98836 8.74368 8.35311 8.18187 8.02046 7.7286 7.69699
Proportion of Variance 0.02922 0.02765 0.02523 0.02421 0.02326 0.0216 0.02143
Cumulative Proportion  0.65745 0.68510 0.71033 0.73454 0.75780 0.7794 0.80083
                          PC14    PC15    PC16    PC17    PC18  PC19    PC20
Standard deviation     7.55465 7.32756 7.21305 6.84985 6.72589 6.651 6.33040
Proportion of Variance 0.02064 0.01942 0.01882 0.01697 0.01636 0.016 0.01449
Cumulative Proportion  0.82147 0.84089 0.85970 0.87667 0.89303 0.909 0.92352
                          PC21    PC22   PC23   PC24    PC25    PC26      PC27
Standard deviation     6.22794 6.14888 6.0655 5.9721 5.81879 5.34384 6.139e-14
Proportion of Variance 0.01403 0.01367 0.0133 0.0129 0.01224 0.01033 0.000e+00
Cumulative Proportion  0.93755 0.95122 0.9645 0.9774 0.98967 1.00000 1.000e+00</code></pre>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">#calculate means and SEs of the PCs</span></span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a>        <span class="co">#without day 4</span></span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a>pcMns <span class="ot">=</span> <span class="fu">aggregate</span>(pca2<span class="sc">$</span>x <span class="sc">~</span> day <span class="sc">*</span> diet <span class="sc">+</span> dietCol, <span class="at">data=</span>dataInd2, mean)</span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a>pcSEs <span class="ot">=</span> <span class="fu">aggregate</span>(pca2<span class="sc">$</span>x <span class="sc">~</span> day <span class="sc">*</span> diet <span class="sc">+</span> dietCol, <span class="at">data=</span>dataInd2, <span class="cf">function</span>(x){<span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(x))})</span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true" tabindex="-1"></a>pcMns <span class="ot">=</span> <span class="fu">droplevels</span>(<span class="fu">subset</span>(pcMns, day<span class="sc">!=</span><span class="dv">4</span>))</span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true" tabindex="-1"></a>pcSEs <span class="ot">=</span> <span class="fu">droplevels</span>(<span class="fu">subset</span>(pcSEs, day<span class="sc">!=</span><span class="dv">4</span>))</span>
<span id="cb338-7"><a href="#cb338-7" aria-hidden="true" tabindex="-1"></a>pcMns <span class="ot">=</span> pcMns[<span class="fu">order</span>(pcMns<span class="sc">$</span>day),]</span>
<span id="cb338-8"><a href="#cb338-8" aria-hidden="true" tabindex="-1"></a>pcSEs <span class="ot">=</span> pcSEs[<span class="fu">order</span>(pcSEs<span class="sc">$</span>day),]</span>
<span id="cb338-9"><a href="#cb338-9" aria-hidden="true" tabindex="-1"></a>pcMns <span class="ot">=</span> pcMns<span class="sc">%&gt;%</span></span>
<span id="cb338-10"><a href="#cb338-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb338-11"><a href="#cb338-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(day,diet,dietCol,PC1,PC2)<span class="sc">%&gt;%</span></span>
<span id="cb338-12"><a href="#cb338-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb338-13"><a href="#cb338-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PC1_mean=</span>PC1,</span>
<span id="cb338-14"><a href="#cb338-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC2_mean=</span>PC2)</span>
<span id="cb338-15"><a href="#cb338-15" aria-hidden="true" tabindex="-1"></a>pcSEs <span class="ot">=</span> pcSEs<span class="sc">%&gt;%</span></span>
<span id="cb338-16"><a href="#cb338-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb338-17"><a href="#cb338-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(day,diet,dietCol,PC1,PC2)<span class="sc">%&gt;%</span></span>
<span id="cb338-18"><a href="#cb338-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PC1_se=</span>PC1,</span>
<span id="cb338-19"><a href="#cb338-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC2_se=</span>PC2)</span>
<span id="cb338-20"><a href="#cb338-20" aria-hidden="true" tabindex="-1"></a>tab_PCA <span class="ot">=</span> <span class="fu">left_join</span>(pcMns,pcSEs)</span>
<span id="cb338-21"><a href="#cb338-21" aria-hidden="true" tabindex="-1"></a>tab_PCA<span class="sc">$</span>diet1 <span class="ot">=</span><span class="fu">ifelse</span>(tab_PCA<span class="sc">$</span>diet<span class="sc">==</span><span class="st">&quot;x&quot;</span>,<span class="st">&quot;#ff9595&quot;</span>,<span class="st">&quot;#abefff&quot;</span>)</span>
<span id="cb338-22"><a href="#cb338-22" aria-hidden="true" tabindex="-1"></a>tab_PCA<span class="sc">$</span>diet1[<span class="dv">1</span>]<span class="ot">=</span><span class="st">&quot;#ff9595&quot;</span></span>
<span id="cb338-23"><a href="#cb338-23" aria-hidden="true" tabindex="-1"></a>tab_PCA<span class="sc">$</span>diet2<span class="ot">=</span><span class="fu">ifelse</span>(tab_PCA<span class="sc">$</span>diet<span class="sc">==</span><span class="st">&quot;y&quot;</span>,<span class="st">&quot;#abefff&quot;</span>,<span class="st">&quot;#ff9595&quot;</span>)</span>
<span id="cb338-24"><a href="#cb338-24" aria-hidden="true" tabindex="-1"></a>tab_PCA<span class="sc">$</span>diet2[<span class="dv">1</span>]<span class="ot">=</span><span class="st">&quot;#abefff&quot;</span></span>
<span id="cb338-25"><a href="#cb338-25" aria-hidden="true" tabindex="-1"></a>tab_PCA<span class="ot">=</span><span class="fu">mutate_if</span>(tab_PCA,is.character,as.factor)</span>
<span id="cb338-26"><a href="#cb338-26" aria-hidden="true" tabindex="-1"></a>tab_PCA<span class="sc">$</span>diet1<span class="ot">=</span> <span class="fu">factor</span>(tab_PCA<span class="sc">$</span>diet1,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;#67ff67&quot;</span>,<span class="st">&quot;#abefff&quot;</span>,<span class="st">&quot;#ff9595&quot;</span>))</span>
<span id="cb338-27"><a href="#cb338-27" aria-hidden="true" tabindex="-1"></a>tab_PCA<span class="sc">$</span>diet2<span class="ot">=</span> <span class="fu">factor</span>(tab_PCA<span class="sc">$</span>diet2,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;#67ff67&quot;</span>,<span class="st">&quot;#abefff&quot;</span>,<span class="st">&quot;#ff9595&quot;</span>))</span>
<span id="cb338-28"><a href="#cb338-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-29"><a href="#cb338-29" aria-hidden="true" tabindex="-1"></a>Plot_Fig5A<span class="ot">=</span></span>
<span id="cb338-30"><a href="#cb338-30" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(tab_PCA,<span class="fu">aes</span>(<span class="at">x=</span>PC1_mean, <span class="at">y=</span>PC2_mean))<span class="sc">+</span></span>
<span id="cb338-31"><a href="#cb338-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>dietCol),<span class="at">size=</span><span class="dv">2</span> ,<span class="at">shape=</span><span class="dv">19</span>)<span class="sc">+</span></span>
<span id="cb338-32"><a href="#cb338-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmax =</span> PC1_mean<span class="sc">+</span>PC1_se, <span class="at">xmin =</span>PC1_mean<span class="sc">-</span>PC1_se,<span class="at">color=</span>dietCol ),<span class="at">height=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb338-33"><a href="#cb338-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> PC2_mean<span class="sc">+</span>PC2_se, <span class="at">ymin =</span>PC2_mean<span class="sc">-</span>PC2_se,<span class="at">color=</span>dietCol ),<span class="at">width =</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb338-34"><a href="#cb338-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size=</span><span class="fl">0.8</span>,<span class="fu">aes</span>(<span class="at">group=</span>diet1,<span class="at">color=</span>diet1))<span class="sc">+</span></span>
<span id="cb338-35"><a href="#cb338-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size=</span><span class="fl">0.8</span>,<span class="fu">aes</span>(<span class="at">group=</span>diet2,<span class="at">color=</span>diet2))<span class="sc">+</span></span>
<span id="cb338-36"><a href="#cb338-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>day),<span class="at">size=</span><span class="dv">4</span>,<span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">nudge_y =</span> <span class="sc">-</span><span class="fl">2.5</span>)<span class="sc">+</span></span>
<span id="cb338-37"><a href="#cb338-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#67ff67&quot;</span>,<span class="st">&quot;#abefff&quot;</span>,<span class="st">&quot;#ff9595&quot;</span>))<span class="sc">+</span></span>
<span id="cb338-38"><a href="#cb338-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">paste</span>(<span class="st">&quot;PC1 (&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(pca2)<span class="sc">$</span>importance[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">*</span><span class="dv">100</span>), <span class="st">&quot;%)&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>),</span>
<span id="cb338-39"><a href="#cb338-39" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">60</span>),</span>
<span id="cb338-40"><a href="#cb338-40" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">60</span>,<span class="at">by=</span><span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb338-41"><a href="#cb338-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">paste</span>(<span class="st">&quot;PC2 (&quot;</span>, <span class="fu">round</span>(<span class="fu">summary</span>(pca2)<span class="sc">$</span>importance[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span>), <span class="st">&quot;%)&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>),</span>
<span id="cb338-42"><a href="#cb338-42" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>,<span class="dv">45</span>),</span>
<span id="cb338-43"><a href="#cb338-43" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">30</span>,<span class="dv">40</span>,<span class="at">by=</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb338-44"><a href="#cb338-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb338-45"><a href="#cb338-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb338-46"><a href="#cb338-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb338-47"><a href="#cb338-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb338-48"><a href="#cb338-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb338-49"><a href="#cb338-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb338-50"><a href="#cb338-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb338-51"><a href="#cb338-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb338-52"><a href="#cb338-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb338-53"><a href="#cb338-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb338-54"><a href="#cb338-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb338-55"><a href="#cb338-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb338-56"><a href="#cb338-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb338-57"><a href="#cb338-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb338-58"><a href="#cb338-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb338-59"><a href="#cb338-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb338-60"><a href="#cb338-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont),</span>
<span id="cb338-61"><a href="#cb338-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb338-62"><a href="#cb338-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb338-63"><a href="#cb338-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb338-64"><a href="#cb338-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb338-65"><a href="#cb338-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb338-66"><a href="#cb338-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb338-67"><a href="#cb338-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb338-68"><a href="#cb338-68" aria-hidden="true" tabindex="-1"></a>Plot_Fig5A</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205A-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-5b" class="section level3" number="5.1.2">
<h3 number="5.1.2"><span class="header-section-number">5.1.2</span> Figure 5B</h3>
<div class="blue">
<p><strong>Diet modulates expression of functionally distinct gene classes.</strong> Midguts of flies fed HY diet show higher expression of genes with digestive functions, while HS diet involves mainly genes attributed to stress response and growth. X-axis represents the statistical significance of the gene ontology (GO) categories (y-axis) after adjustment for multiple testing. Size of the dot is proportional to number of genes in the given GO category</p>
</div>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a>tab_GO_results <span class="ot">=</span> </span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;5B&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb339-4"><a href="#cb339-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Padj=</span><span class="sc">-</span><span class="fu">log</span>(p.value,<span class="dv">10</span>),</span>
<span id="cb339-5"><a href="#cb339-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Term =</span> <span class="fu">str_to_sentence</span>(Term))<span class="sc">%&gt;%</span></span>
<span id="cb339-6"><a href="#cb339-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb339-7"><a href="#cb339-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb339-8"><a href="#cb339-8" aria-hidden="true" tabindex="-1"></a>tab_GO_results<span class="sc">$</span>Term <span class="ot">&lt;-</span> <span class="fu">factor</span>(tab_GO_results<span class="sc">$</span>Term, <span class="at">levels =</span> tab_GO_results<span class="sc">$</span>Term[<span class="fu">order</span>(tab_GO_results<span class="sc">$</span>Diet, tab_GO_results<span class="sc">$</span>Padj, tab_GO_results<span class="sc">$</span>Significant)])</span>
<span id="cb339-9"><a href="#cb339-9" aria-hidden="true" tabindex="-1"></a><span class="co">#order GO categories based on size of Padj</span></span>
<span id="cb339-10"><a href="#cb339-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-11"><a href="#cb339-11" aria-hidden="true" tabindex="-1"></a>tab_GO_results<span class="sc">$</span>Diet <span class="ot">&lt;-</span> <span class="fu">factor</span>(tab_GO_results<span class="sc">$</span>Diet, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>, <span class="st">&quot;HS&quot;</span>))</span>
<span id="cb339-12"><a href="#cb339-12" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb339-13"><a href="#cb339-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-14"><a href="#cb339-14" aria-hidden="true" tabindex="-1"></a>Plot_Fig5B<span class="ot">=</span></span>
<span id="cb339-15"><a href="#cb339-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_GO_results, <span class="fu">aes</span>(<span class="at">x =</span> Padj, <span class="at">y =</span> Term))<span class="sc">+</span> </span>
<span id="cb339-16"><a href="#cb339-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>Significant,<span class="at">fill=</span>Diet),<span class="at">shape=</span><span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb339-17"><a href="#cb339-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Diet<span class="sc">~</span>.,<span class="at">scales=</span><span class="st">&quot;free_y&quot;</span>,<span class="at">space=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb339-18"><a href="#cb339-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb339-19"><a href="#cb339-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#FFB4B4&quot;</span>,<span class="st">&quot;#C3E6FC&quot;</span>))<span class="sc">+</span></span>
<span id="cb339-20"><a href="#cb339-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">1.3</span>,<span class="at">linetype=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb339-21"><a href="#cb339-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="st">&quot;GO categories&quot;</span>)<span class="sc">+</span></span>
<span id="cb339-22"><a href="#cb339-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;-P-value adjusted (&quot;</span>, log[<span class="dv">10</span>],<span class="st">&quot;)&quot;</span>)),</span>
<span id="cb339-23"><a href="#cb339-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">31</span>),</span>
<span id="cb339-24"><a href="#cb339-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">30</span>,<span class="at">by=</span><span class="dv">10</span>)))<span class="sc">+</span></span>
<span id="cb339-25"><a href="#cb339-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="st">&quot;Nbr genes&quot;</span>, <span class="at">range =</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>) )<span class="sc">+</span></span>
<span id="cb339-26"><a href="#cb339-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb339-27"><a href="#cb339-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb339-28"><a href="#cb339-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb339-29"><a href="#cb339-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb339-30"><a href="#cb339-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb339-31"><a href="#cb339-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb339-32"><a href="#cb339-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb339-33"><a href="#cb339-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb339-34"><a href="#cb339-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb339-35"><a href="#cb339-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont<span class="dv">-2</span>,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb339-36"><a href="#cb339-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb339-37"><a href="#cb339-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>, </span>
<span id="cb339-38"><a href="#cb339-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb339-39"><a href="#cb339-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb339-40"><a href="#cb339-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb339-41"><a href="#cb339-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb339-42"><a href="#cb339-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.margin=</span><span class="fu">margin</span>(<span class="at">b=</span><span class="dv">0</span>, <span class="at">unit=</span><span class="st">&#39;cm&#39;</span>),</span>
<span id="cb339-43"><a href="#cb339-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb339-44"><a href="#cb339-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb339-45"><a href="#cb339-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont<span class="dv">-2</span>),</span>
<span id="cb339-46"><a href="#cb339-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb339-47"><a href="#cb339-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb339-48"><a href="#cb339-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">r =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">3</span>, <span class="at">l =</span> <span class="dv">1</span>)),</span>
<span id="cb339-49"><a href="#cb339-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb339-50"><a href="#cb339-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)<span class="sc">+</span></span>
<span id="cb339-51"><a href="#cb339-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span>F)</span>
<span id="cb339-52"><a href="#cb339-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-53"><a href="#cb339-53" aria-hidden="true" tabindex="-1"></a>Plot_Fig5B</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205B-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-5c" class="section level3" number="5.1.3">
<h3 number="5.1.3"><span class="header-section-number">5.1.3</span> Figure 5C</h3>
<div class="blue">
<p>Table of genes significantly differently expressed, between HS and HY, as a ratio of HS/HY, representing midgut response to HS and HY diets; additional information on the statistics is found in material and methods; asterisks denote genes significantly different for p-value but not for adjusted p-value</p>
</div>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5C.jpg&quot;</span>) </span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5C <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5C)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205C-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-5d" class="section level3" number="5.1.4">
<h3 number="5.1.4"><span class="header-section-number">5.1.4</span> Figure 5D</h3>
<div class="blue">
<p>Cell proliferation is possible on HS diet when genetically induced. Progenitor-specific (EsgTS) overexpression of a constitutively active form of Ras (UAS-RasV12) and of UAS-Tor-DER (EGFR Active), both known proliferative inducers, allows for increased proliferation on HS diet. P-values on top of the chart refer to comparison vs control, P-values at the bottom refer to comparison between HS and HY for each sample. <em>Complete statistical annotation on image can be fund in the manuscript’s figures.</em></p>
</div>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a>Tab_Ras_PH3_Rev <span class="ot">=</span> </span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;5D&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">ends_with</span>(<span class="st">&quot;.L&quot;</span>)),<span class="sc">~</span>.<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb341-5"><a href="#cb341-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PH3_positive_cell=</span>Total.PH3,</span>
<span id="cb341-6"><a href="#cb341-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">Diet=</span>Treatment,</span>
<span id="cb341-7"><a href="#cb341-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">Male_Line=</span>Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb341-8"><a href="#cb341-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cross=</span><span class="fu">fct_relevel</span>(Cross,<span class="st">&quot;EsgTsXControl&quot;</span>,<span class="st">&quot;EsgTsX64195&quot;</span>, <span class="st">&quot;EsgTsXTorDER&quot;</span> ))</span>
<span id="cb341-9"><a href="#cb341-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-10"><a href="#cb341-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-11"><a href="#cb341-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-12"><a href="#cb341-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-13"><a href="#cb341-13" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb341-14"><a href="#cb341-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-15"><a href="#cb341-15" aria-hidden="true" tabindex="-1"></a><span class="do">##Control</span></span>
<span id="cb341-16"><a href="#cb341-16" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Tab_Ras_PH3_Rev , Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>))</span>
<span id="cb341-17"><a href="#cb341-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-18"><a href="#cb341-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-19"><a href="#cb341-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb341-20"><a href="#cb341-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98547, p-value = 0.4099</code></pre>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Diet + (1/Repeat)
BP = 0.10949, df = 1, p-value = 0.7407</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-5"><a href="#cb345-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY Control&quot;</span>)),</span>
<span id="cb345-6"><a href="#cb345-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Tab_Ras_PH3_Rev<span class="sc">$</span>Repeat),</span>
<span id="cb345-7"><a href="#cb345-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb345-8"><a href="#cb345-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb345-9"><a href="#cb345-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb345-10"><a href="#cb345-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb345-11"><a href="#cb345-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb345-12"><a href="#cb345-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-13"><a href="#cb345-13" aria-hidden="true" tabindex="-1"></a>tab_stat_Control<span class="ot">=</span>tab_stat</span>
<span id="cb345-14"><a href="#cb345-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-15"><a href="#cb345-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-16"><a href="#cb345-16" aria-hidden="true" tabindex="-1"></a><span class="do">##Ras85DV12 (64195)</span></span>
<span id="cb345-17"><a href="#cb345-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-18"><a href="#cb345-18" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Tab_Ras_PH3_Rev , Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Ras85DV12&quot;</span>))</span>
<span id="cb345-19"><a href="#cb345-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-20"><a href="#cb345-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb345-21"><a href="#cb345-21" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb345-22"><a href="#cb345-22" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98728, p-value = 0.5179</code></pre>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Diet + (1/Repeat)
BP = 0.16649, df = 1, p-value = 0.6832</code></pre>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY Ras85DV12&quot;</span>)),</span>
<span id="cb349-6"><a href="#cb349-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Tab_Ras_PH3_Rev<span class="sc">$</span>Repeat),</span>
<span id="cb349-7"><a href="#cb349-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb349-8"><a href="#cb349-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb349-9"><a href="#cb349-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb349-10"><a href="#cb349-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb349-11"><a href="#cb349-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb349-12"><a href="#cb349-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-13"><a href="#cb349-13" aria-hidden="true" tabindex="-1"></a>tab_stat_Ras85DV12<span class="ot">=</span>tab_stat</span>
<span id="cb349-14"><a href="#cb349-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-15"><a href="#cb349-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-16"><a href="#cb349-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-17"><a href="#cb349-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-18"><a href="#cb349-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-19"><a href="#cb349-19" aria-hidden="true" tabindex="-1"></a><span class="do">##Ras85DV12_2 (TorDER)</span></span>
<span id="cb349-20"><a href="#cb349-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-21"><a href="#cb349-21" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(Tab_Ras_PH3_Rev , Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;TorDER&quot;</span>))</span>
<span id="cb349-22"><a href="#cb349-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-23"><a href="#cb349-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-24"><a href="#cb349-24" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb349-25"><a href="#cb349-25" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96675, p-value = 0.1456</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Diet + (1/Repeat)
BP = 0.77051, df = 1, p-value = 0.3801</code></pre>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-5"><a href="#cb353-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY TorDER&quot;</span>)),</span>
<span id="cb353-6"><a href="#cb353-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Tab_Ras_PH3_Rev<span class="sc">$</span>Repeat),</span>
<span id="cb353-7"><a href="#cb353-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb353-8"><a href="#cb353-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb353-9"><a href="#cb353-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb353-10"><a href="#cb353-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb353-11"><a href="#cb353-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb353-12"><a href="#cb353-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-13"><a href="#cb353-13" aria-hidden="true" tabindex="-1"></a>tab_stat_TorDER<span class="ot">=</span>tab_stat</span>
<span id="cb353-14"><a href="#cb353-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-15"><a href="#cb353-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-16"><a href="#cb353-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-17"><a href="#cb353-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_Control, tab_stat_Ras85DV12, tab_stat_TorDER)</span>
<span id="cb353-18"><a href="#cb353-18" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>padj <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">p.adjust</span>(tab_stat<span class="sc">$</span>Pvalue, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>),<span class="at">digits=</span><span class="dv">2</span>,<span class="at">scientific =</span>F))</span>
<span id="cb353-19"><a href="#cb353-19" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb353-20"><a href="#cb353-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb353-21"><a href="#cb353-21" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb353-22"><a href="#cb353-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-23"><a href="#cb353-23" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb353-24"><a href="#cb353-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;p-value adjusted&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb353-25"><a href="#cb353-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(PH3_positive_cell+1) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb353-26"><a href="#cb353-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(PH3_positive_cell+1) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:right;">
p-value adjusted
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS vs HY Control
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:left;">
1.22
</td>
<td style="text-align:left;">
-0.0117
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
HS vs HY Ras85DV12
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1.39
</td>
<td style="text-align:left;">
3.87
</td>
<td style="text-align:left;">
0.0679
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
HS vs HY TorDER
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2.56
</td>
<td style="text-align:left;">
3.58
</td>
<td style="text-align:left;">
0.168
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_RasPH3<span class="ot">=</span>tab_stat</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_RasPH3<span class="sc">$</span>Male_Line<span class="ot">=</span> tab_stat_rev_RasPH3<span class="sc">$</span>Variable</span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats HS vs control</span></span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a>tmpd <span class="ot">=</span> <span class="fu">subset</span>(Tab_Ras_PH3_Rev , Diet<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>))</span>
<span id="cb354-9"><a href="#cb354-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-10"><a href="#cb354-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-11"><a href="#cb354-11" aria-hidden="true" tabindex="-1"></a><span class="do">##Ras85DV12</span></span>
<span id="cb354-12"><a href="#cb354-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-13"><a href="#cb354-13" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tmpd , Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Ras85DV12&quot;</span>))</span>
<span id="cb354-14"><a href="#cb354-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-15"><a href="#cb354-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-16"><a href="#cb354-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-17"><a href="#cb354-17" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>((PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb354-18"><a href="#cb354-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96712, p-value = 0.01814</code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>((PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  (PH3_positive_cell + 1) ~ Male_Line + (1/Repeat)
BP = 10.691, df = 1, p-value = 0.001077</code></pre>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>((PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb358-4"><a href="#cb358-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-5"><a href="#cb358-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS Ras85DV12 vs HS Control&quot;</span>)),</span>
<span id="cb358-6"><a href="#cb358-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Tab_Ras_PH3_Rev<span class="sc">$</span>Repeat),</span>
<span id="cb358-7"><a href="#cb358-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb358-8"><a href="#cb358-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb358-9"><a href="#cb358-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb358-10"><a href="#cb358-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb358-11"><a href="#cb358-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb358-12"><a href="#cb358-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-13"><a href="#cb358-13" aria-hidden="true" tabindex="-1"></a>tab_stat_HS_Ras85DV12<span class="ot">=</span>tab_stat</span>
<span id="cb358-14"><a href="#cb358-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-15"><a href="#cb358-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-16"><a href="#cb358-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-17"><a href="#cb358-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-18"><a href="#cb358-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-19"><a href="#cb358-19" aria-hidden="true" tabindex="-1"></a><span class="do">##TorDER</span></span>
<span id="cb358-20"><a href="#cb358-20" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tmpd , Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;TorDER&quot;</span>))</span>
<span id="cb358-21"><a href="#cb358-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-22"><a href="#cb358-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-23"><a href="#cb358-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-24"><a href="#cb358-24" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb358-25"><a href="#cb358-25" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98961, p-value = 0.8224</code></pre>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Male_Line + (1/Repeat)
BP = 10.017, df = 1, p-value = 0.001551</code></pre>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb362-4"><a href="#cb362-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-5"><a href="#cb362-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS TorDER vs HS Control&quot;</span>)),</span>
<span id="cb362-6"><a href="#cb362-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Tab_Ras_PH3_Rev<span class="sc">$</span>Repeat),</span>
<span id="cb362-7"><a href="#cb362-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb362-8"><a href="#cb362-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb362-9"><a href="#cb362-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb362-10"><a href="#cb362-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb362-11"><a href="#cb362-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb362-12"><a href="#cb362-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-13"><a href="#cb362-13" aria-hidden="true" tabindex="-1"></a>tab_stat_HS_TorDER<span class="ot">=</span>tab_stat</span>
<span id="cb362-14"><a href="#cb362-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Table</span></span>
<span id="cb362-15"><a href="#cb362-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-16"><a href="#cb362-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-17"><a href="#cb362-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_HS_Ras85DV12, tab_stat_HS_TorDER)</span>
<span id="cb362-18"><a href="#cb362-18" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>padj <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">p.adjust</span>(tab_stat<span class="sc">$</span>Pvalue, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>),<span class="at">digits=</span><span class="dv">2</span>,<span class="at">scientific =</span>F))</span>
<span id="cb362-19"><a href="#cb362-19" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb362-20"><a href="#cb362-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb362-21"><a href="#cb362-21" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb362-22"><a href="#cb362-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-23"><a href="#cb362-23" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb362-24"><a href="#cb362-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;p-value adjusted&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb362-25"><a href="#cb362-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(PH3_positive_cell+1) ~  Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb362-26"><a href="#cb362-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(PH3_positive_cell+1) ~ Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:right;">
p-value adjusted
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS Ras85DV12 vs HS Control
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
138.73
</td>
<td style="text-align:left;">
6.28
</td>
<td style="text-align:left;">
45.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
HS TorDER vs HS Control
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
71.82
</td>
<td style="text-align:left;">
1.23
</td>
<td style="text-align:left;">
2.46
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_RasPH3_HS<span class="ot">=</span>tab_stat</span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_RasPH3_HS<span class="sc">$</span>Male_Line<span class="ot">=</span> tab_stat_rev_RasPH3_HS<span class="sc">$</span>Variable</span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-7"><a href="#cb363-7" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats HY vs control</span></span>
<span id="cb363-8"><a href="#cb363-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-9"><a href="#cb363-9" aria-hidden="true" tabindex="-1"></a>tmpd <span class="ot">=</span> <span class="fu">subset</span>(Tab_Ras_PH3_Rev , Diet<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>))</span>
<span id="cb363-10"><a href="#cb363-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-11"><a href="#cb363-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-12"><a href="#cb363-12" aria-hidden="true" tabindex="-1"></a><span class="do">##Ras85DV12</span></span>
<span id="cb363-13"><a href="#cb363-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-14"><a href="#cb363-14" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tmpd , Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Ras85DV12&quot;</span>))</span>
<span id="cb363-15"><a href="#cb363-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-16"><a href="#cb363-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-17"><a href="#cb363-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-18"><a href="#cb363-18" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>((PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb363-19"><a href="#cb363-19" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96149, p-value = 0.009738</code></pre>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>((PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  (PH3_positive_cell + 1) ~ Male_Line + (1/Repeat)
BP = 13.223, df = 1, p-value = 0.0002765</code></pre>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>((PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HY Ras85DV12 vs HY Control&quot;</span>)),</span>
<span id="cb367-6"><a href="#cb367-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Tab_Ras_PH3_Rev<span class="sc">$</span>Repeat),</span>
<span id="cb367-7"><a href="#cb367-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb367-8"><a href="#cb367-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb367-9"><a href="#cb367-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb367-10"><a href="#cb367-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb367-11"><a href="#cb367-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb367-12"><a href="#cb367-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-13"><a href="#cb367-13" aria-hidden="true" tabindex="-1"></a>tab_stat_HY_Ras85DV12<span class="ot">=</span>tab_stat</span>
<span id="cb367-14"><a href="#cb367-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-15"><a href="#cb367-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-16"><a href="#cb367-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-17"><a href="#cb367-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-18"><a href="#cb367-18" aria-hidden="true" tabindex="-1"></a><span class="do">##TorDER</span></span>
<span id="cb367-19"><a href="#cb367-19" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tmpd , Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;TorDER&quot;</span>))</span>
<span id="cb367-20"><a href="#cb367-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-21"><a href="#cb367-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-22"><a href="#cb367-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-23"><a href="#cb367-23" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb367-24"><a href="#cb367-24" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.9602, p-value = 0.02268</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Male_Line + (1/Repeat)
BP = 13.229, df = 1, p-value = 0.0002757</code></pre>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-5"><a href="#cb371-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HY TorDER vs HY Control&quot;</span>)),</span>
<span id="cb371-6"><a href="#cb371-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Tab_Ras_PH3_Rev<span class="sc">$</span>Repeat),</span>
<span id="cb371-7"><a href="#cb371-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb371-8"><a href="#cb371-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb371-9"><a href="#cb371-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb371-10"><a href="#cb371-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb371-11"><a href="#cb371-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb371-12"><a href="#cb371-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-13"><a href="#cb371-13" aria-hidden="true" tabindex="-1"></a>tab_stat_HY_TorDER<span class="ot">=</span>tab_stat</span>
<span id="cb371-14"><a href="#cb371-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Table</span></span>
<span id="cb371-15"><a href="#cb371-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-16"><a href="#cb371-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-17"><a href="#cb371-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_HY_Ras85DV12, tab_stat_HY_TorDER)</span>
<span id="cb371-18"><a href="#cb371-18" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>padj <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">p.adjust</span>(tab_stat<span class="sc">$</span>Pvalue, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>),<span class="at">digits=</span><span class="dv">2</span>,<span class="at">scientific =</span>F))</span>
<span id="cb371-19"><a href="#cb371-19" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb371-20"><a href="#cb371-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb371-21"><a href="#cb371-21" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb371-22"><a href="#cb371-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-23"><a href="#cb371-23" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb371-24"><a href="#cb371-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;p-value adjusted&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb371-25"><a href="#cb371-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(PH3_positive_cell+1) ~  Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb371-26"><a href="#cb371-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(PH3_positive_cell+1) ~ Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:right;">
p-value adjusted
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HY Ras85DV12 vs HY Control
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
141.81
</td>
<td style="text-align:left;">
5.89
</td>
<td style="text-align:left;">
47.7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
HY TorDER vs HY Control
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
102.66
</td>
<td style="text-align:left;">
1.2
</td>
<td style="text-align:left;">
2.67
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_RasPH3_HY<span class="ot">=</span>tab_stat</span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_RasPH3_HY<span class="sc">$</span>Male_Line<span class="ot">=</span> tab_stat_rev_RasPH3_HY<span class="sc">$</span>Variable</span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Samplesize</span></span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb372-7"><a href="#cb372-7" aria-hidden="true" tabindex="-1"></a> Tab_Ras_PH3_Rev<span class="sc">%&gt;%</span></span>
<span id="cb372-8"><a href="#cb372-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Male_Line,Diet)<span class="sc">%&gt;%</span></span>
<span id="cb372-9"><a href="#cb372-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb372-10"><a href="#cb372-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-11"><a href="#cb372-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-12"><a href="#cb372-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-13"><a href="#cb372-13" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb372-14"><a href="#cb372-14" aria-hidden="true" tabindex="-1"></a>Tab_Ras_PH3_Rev<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="fu">factor</span>(Tab_Ras_PH3_Rev<span class="sc">$</span>Male_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Control&quot;</span>))), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Ra&quot;</span>,s<span class="sc">^</span>{V12},<span class="at">sep=</span><span class="st">&quot;&quot;</span>))), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Tor-DER&quot;</span>)))))</span>
<span id="cb372-15"><a href="#cb372-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-16"><a href="#cb372-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-17"><a href="#cb372-17" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="fu">factor</span>(Sample_size<span class="sc">$</span>Male_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Control&quot;</span>))), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Ra&quot;</span>,s<span class="sc">^</span>{V12},<span class="at">sep=</span><span class="st">&quot;&quot;</span>))), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Tor-DER&quot;</span>)))))</span>
<span id="cb372-18"><a href="#cb372-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-19"><a href="#cb372-19" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_RasPH3<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="fu">factor</span>(tab_stat_rev_RasPH3<span class="sc">$</span>Male_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Control&quot;</span>))), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Ra&quot;</span>,s<span class="sc">^</span>{V12},<span class="at">sep=</span><span class="st">&quot;&quot;</span>))), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Tor-DER&quot;</span>)))))</span>
<span id="cb372-20"><a href="#cb372-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-21"><a href="#cb372-21" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_RasPH3_HS<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="fu">factor</span>(tab_stat_rev_RasPH3_HS<span class="sc">$</span>Male_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Ra&quot;</span>,s<span class="sc">^</span>{V12},<span class="at">sep=</span><span class="st">&quot;&quot;</span>))), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Tor-DER&quot;</span>)))))</span>
<span id="cb372-22"><a href="#cb372-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-23"><a href="#cb372-23" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_RasPH3_HY<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="fu">factor</span>(tab_stat_rev_RasPH3_HY<span class="sc">$</span>Male_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Ra&quot;</span>,s<span class="sc">^</span>{V12},<span class="at">sep=</span><span class="st">&quot;&quot;</span>))), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Tor-DER&quot;</span>)))))</span>
<span id="cb372-24"><a href="#cb372-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-25"><a href="#cb372-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-26"><a href="#cb372-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Annotation in the plot</span></span>
<span id="cb372-27"><a href="#cb372-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-28"><a href="#cb372-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-29"><a href="#cb372-29" aria-hidden="true" tabindex="-1"></a>ann_textHS <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Male_Line =</span> <span class="st">&quot;Control&quot;</span>, <span class="at">anot =</span> <span class="st">&quot;Vs Ctrl HS&quot;</span>)</span>
<span id="cb372-30"><a href="#cb372-30" aria-hidden="true" tabindex="-1"></a>ann_textHS<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="fu">factor</span>(ann_textHS<span class="sc">$</span>Male_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Control&quot;</span>)))))</span>
<span id="cb372-31"><a href="#cb372-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-32"><a href="#cb372-32" aria-hidden="true" tabindex="-1"></a>ann_textHY <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Male_Line =</span> <span class="st">&quot;Control&quot;</span>, <span class="at">anot =</span> <span class="st">&quot;Vs Ctrl HY&quot;</span>)</span>
<span id="cb372-33"><a href="#cb372-33" aria-hidden="true" tabindex="-1"></a>ann_textHY<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="fu">factor</span>(ann_textHY<span class="sc">$</span>Male_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Control&quot;</span>)))))</span>
<span id="cb372-34"><a href="#cb372-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-35"><a href="#cb372-35" aria-hidden="true" tabindex="-1"></a>ann_text <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Male_Line =</span> <span class="st">&quot;Ras85DV12&quot;</span>, <span class="at">anot =</span> <span class="st">&quot;HS vs HY&quot;</span>)</span>
<span id="cb372-36"><a href="#cb372-36" aria-hidden="true" tabindex="-1"></a>ann_text<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="fu">factor</span>(ann_text<span class="sc">$</span>Male_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Ra&quot;</span>,s<span class="sc">^</span>{V12},<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))))</span>
<span id="cb372-37"><a href="#cb372-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-38"><a href="#cb372-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-39"><a href="#cb372-39" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot</span></span>
<span id="cb372-40"><a href="#cb372-40" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>)</span>
<span id="cb372-41"><a href="#cb372-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-42"><a href="#cb372-42" aria-hidden="true" tabindex="-1"></a>Plot_Fig5D<span class="ot">=</span></span>
<span id="cb372-43"><a href="#cb372-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Tab_Ras_PH3_Rev, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> PH3_positive_cell))<span class="sc">+</span> </span>
<span id="cb372-44"><a href="#cb372-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb372-45"><a href="#cb372-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb372-46"><a href="#cb372-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Male_Line,<span class="at">labeller=</span>label_parsed)<span class="sc">+</span></span>
<span id="cb372-47"><a href="#cb372-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb372-48"><a href="#cb372-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">data =</span> tab_stat_rev_RasPH3, <span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">annotations =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">y_position =</span> <span class="dv">105</span>), <span class="at">textsize =</span> <span class="fl">2.5</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">manual =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb372-49"><a href="#cb372-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb372-50"><a href="#cb372-50" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#FFB4B4&quot;</span>,<span class="st">&quot;#C3E6FC&quot;</span>))<span class="sc">+</span></span>
<span id="cb372-51"><a href="#cb372-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb372-52"><a href="#cb372-52" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span>Limits,</span>
<span id="cb372-53"><a href="#cb372-53" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb372-54"><a href="#cb372-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;pH3&quot;</span> <span class="sc">^</span> <span class="st">&quot;+&quot;</span>, <span class="st">&quot; cells&quot;</span>)),</span>
<span id="cb372-55"><a href="#cb372-55" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">175</span>),</span>
<span id="cb372-56"><a href="#cb372-56" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">110</span>,<span class="at">by=</span><span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb372-57"><a href="#cb372-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb372-58"><a href="#cb372-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb372-59"><a href="#cb372-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb372-60"><a href="#cb372-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb372-61"><a href="#cb372-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb372-62"><a href="#cb372-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb372-63"><a href="#cb372-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>) ), </span>
<span id="cb372-64"><a href="#cb372-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb372-65"><a href="#cb372-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb372-66"><a href="#cb372-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb372-67"><a href="#cb372-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb372-68"><a href="#cb372-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb372-69"><a href="#cb372-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb372-70"><a href="#cb372-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb372-71"><a href="#cb372-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb372-72"><a href="#cb372-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb372-73"><a href="#cb372-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb372-74"><a href="#cb372-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb372-75"><a href="#cb372-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb372-76"><a href="#cb372-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb372-77"><a href="#cb372-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb372-78"><a href="#cb372-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb372-79"><a href="#cb372-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb372-80"><a href="#cb372-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont<span class="dv">-2</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">1</span>)),</span>
<span id="cb372-81"><a href="#cb372-81" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb372-82"><a href="#cb372-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb372-83"><a href="#cb372-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-84"><a href="#cb372-84" aria-hidden="true" tabindex="-1"></a>Plot_Fig5D</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205D-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-5e" class="section level3" number="5.1.5">
<h3 number="5.1.5"><span class="header-section-number">5.1.5</span> Figure 5E</h3>
<div class="blue">
<p>Enterocyte specific over expression (MyoTS) of UAS-upd3-OE and UAS-spi-SEC elicit increased proliferation, strongly only on HY diet, and weakly on HS with UAS-upd3-OE. P-values on top of the chart refer to comparisons with the control, p-values at the bottom refer to comparison between HS and HY for each sample. Flies were 9 days old when dissected. <em>Complete statistical annotation on image can be fund in the manuscript’s figures.</em></p>
</div>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a>tab_Myo_PH3_Rev <span class="ot">=</span> </span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;5E&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">ends_with</span>(<span class="st">&quot;.L&quot;</span>)),<span class="sc">~</span>.<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PH3_positive_cell=</span>Total.PH3,</span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">Diet=</span>Treatment,</span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">Male_Line=</span>Male.Line)</span>
<span id="cb373-8"><a href="#cb373-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-9"><a href="#cb373-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-10"><a href="#cb373-10" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats HS vs HY</span></span>
<span id="cb373-11"><a href="#cb373-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-12"><a href="#cb373-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-13"><a href="#cb373-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-14"><a href="#cb373-14" aria-hidden="true" tabindex="-1"></a><span class="do">##Control</span></span>
<span id="cb373-15"><a href="#cb373-15" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_Myo_PH3_Rev, Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>))</span>
<span id="cb373-16"><a href="#cb373-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-17"><a href="#cb373-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-18"><a href="#cb373-18" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb373-19"><a href="#cb373-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-20"><a href="#cb373-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.94719, p-value = 0.04711</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Diet + (1/Repeat)
BP = 2.986, df = 1, p-value = 0.08399</code></pre>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb377-6"><a href="#cb377-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-7"><a href="#cb377-7" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control HS vs HY&quot;</span>)),</span>
<span id="cb377-8"><a href="#cb377-8" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb377-9"><a href="#cb377-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_Myo_PH3_Rev<span class="sc">$</span>Repeat),</span>
<span id="cb377-10"><a href="#cb377-10" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb377-11"><a href="#cb377-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb377-12"><a href="#cb377-12" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb377-13"><a href="#cb377-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb377-14"><a href="#cb377-14" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb377-15"><a href="#cb377-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb377-16"><a href="#cb377-16" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb377-17"><a href="#cb377-17" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb377-18"><a href="#cb377-18" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb377-19"><a href="#cb377-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb377-20"><a href="#cb377-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-21"><a href="#cb377-21" aria-hidden="true" tabindex="-1"></a>tab_stat_Control<span class="ot">=</span>tab_stat</span>
<span id="cb377-22"><a href="#cb377-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-23"><a href="#cb377-23" aria-hidden="true" tabindex="-1"></a>tab_stat_Control<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="st">&quot;Control&quot;</span></span>
<span id="cb377-24"><a href="#cb377-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-25"><a href="#cb377-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-26"><a href="#cb377-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-27"><a href="#cb377-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-28"><a href="#cb377-28" aria-hidden="true" tabindex="-1"></a><span class="do">##spi-sec</span></span>
<span id="cb377-29"><a href="#cb377-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-30"><a href="#cb377-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-31"><a href="#cb377-31" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_Myo_PH3_Rev , Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;spi-SEC&quot;</span>))</span>
<span id="cb377-32"><a href="#cb377-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-33"><a href="#cb377-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-34"><a href="#cb377-34" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb377-35"><a href="#cb377-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-36"><a href="#cb377-36" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98552, p-value = 0.8119</code></pre>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Diet + (1/Repeat)
BP = 0.079412, df = 1, p-value = 0.7781</code></pre>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb381-4"><a href="#cb381-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-5"><a href="#cb381-5" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb381-6"><a href="#cb381-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-7"><a href="#cb381-7" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;spi-SEC HS vs HY&quot;</span>)),</span>
<span id="cb381-8"><a href="#cb381-8" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb381-9"><a href="#cb381-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb381-10"><a href="#cb381-10" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb381-11"><a href="#cb381-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb381-12"><a href="#cb381-12" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb381-13"><a href="#cb381-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb381-14"><a href="#cb381-14" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb381-15"><a href="#cb381-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb381-16"><a href="#cb381-16" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb381-17"><a href="#cb381-17" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb381-18"><a href="#cb381-18" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb381-19"><a href="#cb381-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb381-20"><a href="#cb381-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-21"><a href="#cb381-21" aria-hidden="true" tabindex="-1"></a>tab_stat_spi_sec<span class="ot">=</span>tab_stat</span>
<span id="cb381-22"><a href="#cb381-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-23"><a href="#cb381-23" aria-hidden="true" tabindex="-1"></a>tab_stat_spi_sec<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="st">&quot;spi-SEC&quot;</span></span>
<span id="cb381-24"><a href="#cb381-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-25"><a href="#cb381-25" aria-hidden="true" tabindex="-1"></a><span class="do">##upd3-OE</span></span>
<span id="cb381-26"><a href="#cb381-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-27"><a href="#cb381-27" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_Myo_PH3_Rev , Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;upd3-OE&quot;</span>))</span>
<span id="cb381-28"><a href="#cb381-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-29"><a href="#cb381-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-30"><a href="#cb381-30" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb381-31"><a href="#cb381-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-32"><a href="#cb381-32" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98739, p-value = 0.8533</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Diet + (1/Repeat)
BP = 1.9695, df = 1, p-value = 0.1605</code></pre>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-5"><a href="#cb385-5" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb385-6"><a href="#cb385-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-7"><a href="#cb385-7" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;upd3-OE HS vs HY&quot;</span>)),</span>
<span id="cb385-8"><a href="#cb385-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb385-9"><a href="#cb385-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb385-10"><a href="#cb385-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb385-11"><a href="#cb385-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb385-12"><a href="#cb385-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb385-13"><a href="#cb385-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb385-14"><a href="#cb385-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-15"><a href="#cb385-15" aria-hidden="true" tabindex="-1"></a>tab_stat_upd3_OE<span class="ot">=</span>tab_stat</span>
<span id="cb385-16"><a href="#cb385-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-17"><a href="#cb385-17" aria-hidden="true" tabindex="-1"></a>tab_stat_upd3_OE<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="st">&quot;upd3-OE&quot;</span></span>
<span id="cb385-18"><a href="#cb385-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-19"><a href="#cb385-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-20"><a href="#cb385-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-21"><a href="#cb385-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-22"><a href="#cb385-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-23"><a href="#cb385-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-24"><a href="#cb385-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-25"><a href="#cb385-25" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_Control,tab_stat_spi_sec, tab_stat_upd3_OE)</span>
<span id="cb385-26"><a href="#cb385-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-27"><a href="#cb385-27" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>padj <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">p.adjust</span>(tab_stat<span class="sc">$</span>Pvalue, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>),<span class="at">digits=</span><span class="dv">2</span>,<span class="at">scientific =</span>F))</span>
<span id="cb385-28"><a href="#cb385-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-29"><a href="#cb385-29" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb385-30"><a href="#cb385-30" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb385-31"><a href="#cb385-31" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb385-32"><a href="#cb385-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-33"><a href="#cb385-33" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb385-34"><a href="#cb385-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>, <span class="st">&quot;Genotype Male_line&quot;</span> ,<span class="st">&quot;p-value adjusted&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb385-35"><a href="#cb385-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(PH3_positive_cell+1) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">10</span>))<span class="sc">%&gt;%</span></span>
<span id="cb385-36"><a href="#cb385-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="10">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(PH3_positive_cell+1) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Genotype Male_line
</th>
<th style="text-align:right;">
p-value adjusted
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Control HS vs HY
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:left;">
2.34
</td>
<td style="text-align:left;">
0.161
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4.2e-01
</td>
<td style="text-align:left;">
Control
</td>
<td style="text-align:right;">
4.2e-01
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
spi-SEC HS vs HY
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
21.14
</td>
<td style="text-align:left;">
2.1
</td>
<td style="text-align:left;">
1.2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4.3e-06
</td>
<td style="text-align:left;">
spi-SEC
</td>
<td style="text-align:right;">
6.5e-06
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
upd3-OE HS vs HY
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
77.92
</td>
<td style="text-align:left;">
3.18
</td>
<td style="text-align:left;">
1.22
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:left;">
upd3-OE
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_MyoPH3<span class="ot">=</span>tab_stat</span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-5"><a href="#cb386-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-6"><a href="#cb386-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-7"><a href="#cb386-7" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats HS vs control</span></span>
<span id="cb386-8"><a href="#cb386-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-9"><a href="#cb386-9" aria-hidden="true" tabindex="-1"></a>tmpd <span class="ot">=</span> <span class="fu">subset</span>(tab_Myo_PH3_Rev , Diet<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>))</span>
<span id="cb386-10"><a href="#cb386-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-11"><a href="#cb386-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-12"><a href="#cb386-12" aria-hidden="true" tabindex="-1"></a><span class="do">##spi-sec</span></span>
<span id="cb386-13"><a href="#cb386-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-14"><a href="#cb386-14" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tmpd , Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;spi-SEC&quot;</span>))</span>
<span id="cb386-15"><a href="#cb386-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-16"><a href="#cb386-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-17"><a href="#cb386-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-18"><a href="#cb386-18" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb386-19"><a href="#cb386-19" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96085, p-value = 0.14</code></pre>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Male_Line + (1/Repeat)
BP = 0.14417, df = 1, p-value = 0.7042</code></pre>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb390-4"><a href="#cb390-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-5"><a href="#cb390-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control vs spi-SEC (HS)&quot;</span>)),</span>
<span id="cb390-6"><a href="#cb390-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb390-7"><a href="#cb390-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb390-8"><a href="#cb390-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb390-9"><a href="#cb390-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb390-10"><a href="#cb390-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb390-11"><a href="#cb390-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb390-12"><a href="#cb390-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-13"><a href="#cb390-13" aria-hidden="true" tabindex="-1"></a>tab_stat_HS_spi_sec<span class="ot">=</span>tab_stat</span>
<span id="cb390-14"><a href="#cb390-14" aria-hidden="true" tabindex="-1"></a>tab_stat_HS_spi_sec<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="st">&quot;spi-SEC&quot;</span></span>
<span id="cb390-15"><a href="#cb390-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-16"><a href="#cb390-16" aria-hidden="true" tabindex="-1"></a><span class="do">##upd3-OE</span></span>
<span id="cb390-17"><a href="#cb390-17" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tmpd , Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;upd3-OE&quot;</span>))</span>
<span id="cb390-18"><a href="#cb390-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-19"><a href="#cb390-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-20"><a href="#cb390-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-21"><a href="#cb390-21" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb390-22"><a href="#cb390-22" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.93704, p-value = 0.01251</code></pre>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Male_Line + (1/Repeat)
BP = 4.4353, df = 1, p-value = 0.0352</code></pre>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-5"><a href="#cb394-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control vs upd3-OE (HS)&quot;</span>)),</span>
<span id="cb394-6"><a href="#cb394-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb394-7"><a href="#cb394-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb394-8"><a href="#cb394-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb394-9"><a href="#cb394-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb394-10"><a href="#cb394-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb394-11"><a href="#cb394-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb394-12"><a href="#cb394-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-13"><a href="#cb394-13" aria-hidden="true" tabindex="-1"></a>tab_stat_HS_upd3_OE<span class="ot">=</span>tab_stat</span>
<span id="cb394-14"><a href="#cb394-14" aria-hidden="true" tabindex="-1"></a>tab_stat_HS_upd3_OE<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="st">&quot;upd3-OE&quot;</span></span>
<span id="cb394-15"><a href="#cb394-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-16"><a href="#cb394-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-17"><a href="#cb394-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-18"><a href="#cb394-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-19"><a href="#cb394-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-20"><a href="#cb394-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-21"><a href="#cb394-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Table</span></span>
<span id="cb394-22"><a href="#cb394-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-23"><a href="#cb394-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-24"><a href="#cb394-24" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_HS_spi_sec, tab_stat_HS_upd3_OE)</span>
<span id="cb394-25"><a href="#cb394-25" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>padj <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">p.adjust</span>(tab_stat<span class="sc">$</span>Pvalue, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>),<span class="at">digits=</span><span class="dv">2</span>,<span class="at">scientific =</span>F))</span>
<span id="cb394-26"><a href="#cb394-26" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb394-27"><a href="#cb394-27" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb394-28"><a href="#cb394-28" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb394-29"><a href="#cb394-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-30"><a href="#cb394-30" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb394-31"><a href="#cb394-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Genotype Male_Line&quot;</span> ,<span class="st">&quot;p-value adjusted&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb394-32"><a href="#cb394-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(PH3_positive_cell+1) ~  Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">10</span>))<span class="sc">%&gt;%</span></span>
<span id="cb394-33"><a href="#cb394-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="10">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(PH3_positive_cell+1) ~ Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Genotype Male_Line
</th>
<th style="text-align:right;">
p-value adjusted
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Control vs spi-SEC (HS)
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.42
</td>
<td style="text-align:left;">
2.38
</td>
<td style="text-align:left;">
-0.295
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.3e-01
</td>
<td style="text-align:left;">
spi-SEC
</td>
<td style="text-align:right;">
2.3e-01
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Control vs upd3-OE (HS)
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
18.54
</td>
<td style="text-align:left;">
2.34
</td>
<td style="text-align:left;">
0.836
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.7e-05
</td>
<td style="text-align:left;">
upd3-OE
</td>
<td style="text-align:right;">
3.4e-05
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_MyoPH3_HS<span class="ot">=</span>tab_stat</span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-5"><a href="#cb395-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-6"><a href="#cb395-6" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats HY vs control</span></span>
<span id="cb395-7"><a href="#cb395-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-8"><a href="#cb395-8" aria-hidden="true" tabindex="-1"></a>tmpd <span class="ot">=</span> <span class="fu">subset</span>(tab_Myo_PH3_Rev , Diet<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>))</span>
<span id="cb395-9"><a href="#cb395-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-10"><a href="#cb395-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-11"><a href="#cb395-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-12"><a href="#cb395-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-13"><a href="#cb395-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-14"><a href="#cb395-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-15"><a href="#cb395-15" aria-hidden="true" tabindex="-1"></a><span class="do">##spi-sec</span></span>
<span id="cb395-16"><a href="#cb395-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-17"><a href="#cb395-17" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tmpd , Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;spi-SEC&quot;</span>))</span>
<span id="cb395-18"><a href="#cb395-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-19"><a href="#cb395-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-20"><a href="#cb395-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-21"><a href="#cb395-21" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb395-22"><a href="#cb395-22" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96573, p-value = 0.1812</code></pre>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Male_Line + (1/Repeat)
BP = 6.342, df = 1, p-value = 0.01179</code></pre>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-5"><a href="#cb399-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control vs spi-SEC (HY)&quot;</span>)),</span>
<span id="cb399-6"><a href="#cb399-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb399-7"><a href="#cb399-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb399-8"><a href="#cb399-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb399-9"><a href="#cb399-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb399-10"><a href="#cb399-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb399-11"><a href="#cb399-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb399-12"><a href="#cb399-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-13"><a href="#cb399-13" aria-hidden="true" tabindex="-1"></a>tab_stat_HY_spi_sec<span class="ot">=</span>tab_stat</span>
<span id="cb399-14"><a href="#cb399-14" aria-hidden="true" tabindex="-1"></a>tab_stat_HY_spi_sec<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="st">&quot;spi-SEC&quot;</span></span>
<span id="cb399-15"><a href="#cb399-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-16"><a href="#cb399-16" aria-hidden="true" tabindex="-1"></a><span class="do">##upd3-OE</span></span>
<span id="cb399-17"><a href="#cb399-17" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tmpd , Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;upd3-OE&quot;</span>))</span>
<span id="cb399-18"><a href="#cb399-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-19"><a href="#cb399-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-20"><a href="#cb399-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-21"><a href="#cb399-21" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb399-22"><a href="#cb399-22" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.9556, p-value = 0.07199</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Male_Line + (1/Repeat)
BP = 4.3033, df = 1, p-value = 0.03804</code></pre>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb403-3"><a href="#cb403-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb403-4"><a href="#cb403-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-5"><a href="#cb403-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control vs upd3-OE (HY)&quot;</span>)),</span>
<span id="cb403-6"><a href="#cb403-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb403-7"><a href="#cb403-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb403-8"><a href="#cb403-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb403-9"><a href="#cb403-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb403-10"><a href="#cb403-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb403-11"><a href="#cb403-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb403-12"><a href="#cb403-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-13"><a href="#cb403-13" aria-hidden="true" tabindex="-1"></a>tab_stat_HY_upd3_OE<span class="ot">=</span>tab_stat</span>
<span id="cb403-14"><a href="#cb403-14" aria-hidden="true" tabindex="-1"></a>tab_stat_HY_upd3_OE<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="st">&quot;upd3-OE&quot;</span></span>
<span id="cb403-15"><a href="#cb403-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-16"><a href="#cb403-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-17"><a href="#cb403-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-18"><a href="#cb403-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-19"><a href="#cb403-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-20"><a href="#cb403-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Table</span></span>
<span id="cb403-21"><a href="#cb403-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-22"><a href="#cb403-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-23"><a href="#cb403-23" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_HY_spi_sec, tab_stat_HY_upd3_OE)</span>
<span id="cb403-24"><a href="#cb403-24" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>padj <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">p.adjust</span>(tab_stat<span class="sc">$</span>Pvalue, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>),<span class="at">digits=</span><span class="dv">2</span>,<span class="at">scientific =</span>F))</span>
<span id="cb403-25"><a href="#cb403-25" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb403-26"><a href="#cb403-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb403-27"><a href="#cb403-27" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb403-28"><a href="#cb403-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-29"><a href="#cb403-29" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb403-30"><a href="#cb403-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>, <span class="st">&quot;Genotype Male_Line&quot;</span> ,<span class="st">&quot;p-value adjusted&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb403-31"><a href="#cb403-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(PH3_positive_cell+1) ~  Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">10</span>))<span class="sc">%&gt;%</span></span>
<span id="cb403-32"><a href="#cb403-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="10">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(PH3_positive_cell+1) ~ Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Genotype Male_Line
</th>
<th style="text-align:right;">
p-value adjusted
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Control vs spi-SEC (HY)
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
13.05
</td>
<td style="text-align:left;">
2.5
</td>
<td style="text-align:left;">
0.774
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3e-04
</td>
<td style="text-align:left;">
spi-SEC
</td>
<td style="text-align:right;">
3e-04
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Control vs upd3-OE (HY)
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
112.62
</td>
<td style="text-align:left;">
2.41
</td>
<td style="text-align:left;">
1.98
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0e+00
</td>
<td style="text-align:left;">
upd3-OE
</td>
<td style="text-align:right;">
0e+00
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_MyoPH3_HY<span class="ot">=</span>tab_stat</span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-4"><a href="#cb404-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-5"><a href="#cb404-5" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb404-6"><a href="#cb404-6" aria-hidden="true" tabindex="-1"></a> tab_Myo_PH3_Rev<span class="sc">%&gt;%</span></span>
<span id="cb404-7"><a href="#cb404-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Male_Line,Diet)<span class="sc">%&gt;%</span></span>
<span id="cb404-8"><a href="#cb404-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb404-9"><a href="#cb404-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-10"><a href="#cb404-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-11"><a href="#cb404-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-12"><a href="#cb404-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Annotation in the plot</span></span>
<span id="cb404-13"><a href="#cb404-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-14"><a href="#cb404-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-15"><a href="#cb404-15" aria-hidden="true" tabindex="-1"></a>ann_textHS <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Male_Line =</span> <span class="st">&quot;Control&quot;</span>, <span class="at">anot =</span> <span class="st">&quot;Vs Ctrl HS&quot;</span>)</span>
<span id="cb404-16"><a href="#cb404-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-17"><a href="#cb404-17" aria-hidden="true" tabindex="-1"></a>ann_textHY <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Male_Line =</span> <span class="st">&quot;Control&quot;</span>, <span class="at">anot =</span> <span class="st">&quot;Vs Ctrl HY&quot;</span>)</span>
<span id="cb404-18"><a href="#cb404-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-19"><a href="#cb404-19" aria-hidden="true" tabindex="-1"></a>ann_text <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Male_Line =</span> <span class="st">&quot;spi-SEC&quot;</span>, <span class="at">anot =</span> <span class="st">&quot;HS vs HY&quot;</span>)</span>
<span id="cb404-20"><a href="#cb404-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-21"><a href="#cb404-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-22"><a href="#cb404-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-23"><a href="#cb404-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-24"><a href="#cb404-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-25"><a href="#cb404-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-26"><a href="#cb404-26" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb404-27"><a href="#cb404-27" aria-hidden="true" tabindex="-1"></a>Limits <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>)</span>
<span id="cb404-28"><a href="#cb404-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-29"><a href="#cb404-29" aria-hidden="true" tabindex="-1"></a>Plot_Fig5E<span class="ot">=</span></span>
<span id="cb404-30"><a href="#cb404-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_Myo_PH3_Rev, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> PH3_positive_cell))<span class="sc">+</span> </span>
<span id="cb404-31"><a href="#cb404-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb404-32"><a href="#cb404-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb404-33"><a href="#cb404-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb404-34"><a href="#cb404-34" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_signif</span>(<span class="at">data =</span> tab_stat_rev_MyoPH3, <span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">annotations =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">y_position =</span> <span class="dv">135</span>), <span class="at">textsize =</span> <span class="fl">2.5</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">manual =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb404-35"><a href="#cb404-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Male_Line)<span class="sc">+</span></span>
<span id="cb404-36"><a href="#cb404-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb404-37"><a href="#cb404-37" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#FFB4B4&quot;</span>,<span class="st">&quot;#C3E6FC&quot;</span>))<span class="sc">+</span></span>
<span id="cb404-38"><a href="#cb404-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb404-39"><a href="#cb404-39" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span>Limits,</span>
<span id="cb404-40"><a href="#cb404-40" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb404-41"><a href="#cb404-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;pH3&quot;</span> <span class="sc">^</span> <span class="st">&quot;+&quot;</span>, <span class="st">&quot; cells&quot;</span>)),</span>
<span id="cb404-42"><a href="#cb404-42" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">225</span>),</span>
<span id="cb404-43"><a href="#cb404-43" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">130</span>,<span class="at">by=</span><span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb404-44"><a href="#cb404-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb404-45"><a href="#cb404-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb404-46"><a href="#cb404-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb404-47"><a href="#cb404-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb404-48"><a href="#cb404-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb404-49"><a href="#cb404-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb404-50"><a href="#cb404-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>) ), </span>
<span id="cb404-51"><a href="#cb404-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb404-52"><a href="#cb404-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb404-53"><a href="#cb404-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb404-54"><a href="#cb404-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb404-55"><a href="#cb404-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb404-56"><a href="#cb404-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb404-57"><a href="#cb404-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb404-58"><a href="#cb404-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb404-59"><a href="#cb404-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb404-60"><a href="#cb404-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb404-61"><a href="#cb404-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb404-62"><a href="#cb404-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb404-63"><a href="#cb404-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb404-64"><a href="#cb404-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb404-65"><a href="#cb404-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb404-66"><a href="#cb404-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb404-67"><a href="#cb404-67" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> xSmallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">angle=</span><span class="dv">0</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb404-68"><a href="#cb404-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> xSmallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">angle=</span><span class="dv">0</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb404-69"><a href="#cb404-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb404-70"><a href="#cb404-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb404-71"><a href="#cb404-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-72"><a href="#cb404-72" aria-hidden="true" tabindex="-1"></a>Plot_Fig5E</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205E-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-5f-g" class="section level3" number="5.1.6">
<h3 number="5.1.6"><span class="header-section-number">5.1.6</span> Figure 5F-G</h3>
<div class="blue">
<p>General translation is lower on HS than HY, shown by puromycin incorporation assay. Images show lower incorporation on HS (F, F’, top row) than HY (G, G’, bottom row) in region 4 of the midgut.<em>Complete graphical annotation can be found in manuscript figures</em></p>
</div>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5F.jpg&quot;</span>) </span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5F <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5F)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205F1-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5F&#39;.jpg&quot;</span>) </span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5F2 <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5F2)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205F2-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
</div>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5G.jpg&quot;</span>) </span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5G <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5G)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205G1-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5G&#39;.jpg&quot;</span>) </span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5G2 <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb408-3"><a href="#cb408-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5G2)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205G2-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="figure-5h" class="section level3" number="5.1.7">
<h3 number="5.1.7"><span class="header-section-number">5.1.7</span> Figure 5H</h3>
<div class="blue">
<p>Quantification of mean pixel intensity of puromycin stain.</p>
</div>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a>Length_Puromycin <span class="ot">=</span> </span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;5H&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb409-4"><a href="#cb409-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb409-5"><a href="#cb409-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Puromycin_int=</span>Mean)</span>
<span id="cb409-6"><a href="#cb409-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-7"><a href="#cb409-7" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb409-8"><a href="#cb409-8" aria-hidden="true" tabindex="-1"></a>  Length_Puromycin<span class="sc">%&gt;%</span></span>
<span id="cb409-9"><a href="#cb409-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb409-10"><a href="#cb409-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb409-11"><a href="#cb409-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-12"><a href="#cb409-12" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb409-13"><a href="#cb409-13" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Puromycin_int) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> Length_Puromycin)</span>
<span id="cb409-14"><a href="#cb409-14" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.95472, p-value = 0.1274</code></pre>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Puromycin_int) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> Length_Puromycin)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Puromycin_int) ~ Diet + (1/Repeat)
BP = 4.3831, df = 1, p-value = 0.0363</code></pre>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Puromycin_int) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> Length_Puromycin)</span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb413-4"><a href="#cb413-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-5"><a href="#cb413-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY&quot;</span>)),</span>
<span id="cb413-6"><a href="#cb413-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(Length_Puromycin<span class="sc">$</span>Repeat),</span>
<span id="cb413-7"><a href="#cb413-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb413-8"><a href="#cb413-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb413-9"><a href="#cb413-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb413-10"><a href="#cb413-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb413-11"><a href="#cb413-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb413-12"><a href="#cb413-12" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb413-13"><a href="#cb413-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb413-14"><a href="#cb413-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb413-15"><a href="#cb413-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-16"><a href="#cb413-16" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb413-17"><a href="#cb413-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Puromycin intensity) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb413-18"><a href="#cb413-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Puromycin intensity) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS vs HY
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
17.81
</td>
<td style="text-align:left;">
1.86
</td>
<td style="text-align:left;">
0.911
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.4e-05
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true" tabindex="-1"></a>Plot_Fig5H<span class="ot">=</span></span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Length_Puromycin, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Puromycin_int))<span class="sc">+</span> </span>
<span id="cb414-5"><a href="#cb414-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb414-6"><a href="#cb414-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb414-7"><a href="#cb414-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb414-8"><a href="#cb414-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_signif</span>(<span class="at">annotation =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,tab_stat<span class="sc">$</span>Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">y_position =</span> <span class="dv">47</span>, <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">tip_length =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.02</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb414-9"><a href="#cb414-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb414-10"><a href="#cb414-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb414-11"><a href="#cb414-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#FFB4B4&quot;</span>,<span class="st">&quot;#C3E6FC&quot;</span>))<span class="sc">+</span></span>
<span id="cb414-12"><a href="#cb414-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb414-13"><a href="#cb414-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb414-14"><a href="#cb414-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb414-15"><a href="#cb414-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Mean pixel intensity</span></span>
<span id="cb414-16"><a href="#cb414-16" aria-hidden="true" tabindex="-1"></a><span class="st">puromycin (a.u.)&quot;</span>,</span>
<span id="cb414-17"><a href="#cb414-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>),</span>
<span id="cb414-18"><a href="#cb414-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="at">by=</span><span class="dv">10</span>))<span class="sc">+</span> </span>
<span id="cb414-19"><a href="#cb414-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb414-20"><a href="#cb414-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb414-21"><a href="#cb414-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb414-22"><a href="#cb414-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb414-23"><a href="#cb414-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb414-24"><a href="#cb414-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb414-25"><a href="#cb414-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb414-26"><a href="#cb414-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb414-27"><a href="#cb414-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb414-28"><a href="#cb414-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb414-29"><a href="#cb414-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb414-30"><a href="#cb414-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb414-31"><a href="#cb414-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb414-32"><a href="#cb414-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb414-33"><a href="#cb414-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb414-34"><a href="#cb414-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb414-35"><a href="#cb414-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb414-36"><a href="#cb414-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb414-37"><a href="#cb414-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb414-38"><a href="#cb414-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb414-39"><a href="#cb414-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb414-40"><a href="#cb414-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb414-41"><a href="#cb414-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb414-42"><a href="#cb414-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont<span class="dv">-2</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb414-43"><a href="#cb414-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb414-44"><a href="#cb414-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb414-45"><a href="#cb414-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb414-46"><a href="#cb414-46" aria-hidden="true" tabindex="-1"></a>Plot_Fig5H</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205H-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-5i-j" class="section level3" number="5.1.8">
<h3 number="5.1.8"><span class="header-section-number">5.1.8</span> Figure 5I-J</h3>
<div class="blue">
<p>p-eIF2α stain is elevated on HS (I, I’, top row) compared to HY (J, J’, bottom row). <em>Complete graphical annotation can be found in manuscript figures</em></p>
</div>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5I.jpg&quot;</span>) </span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5I <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5I)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205I1-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5I&#39;.jpg&quot;</span>) </span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5I2 <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5I2)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205I2-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
</div>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5J.jpg&quot;</span>) </span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5J <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5J)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205J1-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5J&#39;.jpg&quot;</span>) </span>
<span id="cb418-2"><a href="#cb418-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5J2 <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb418-3"><a href="#cb418-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5J2)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205J2-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="figure-5k" class="section level3" number="5.1.9">
<h3 number="5.1.9"><span class="header-section-number">5.1.9</span> Figure 5K</h3>
<div class="blue">
<p>Quantification of mean pixel intensity of p-eIF2α stain.</p>
</div>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a>Length_EIF2 <span class="ot">=</span> </span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;5K&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb419-3"><a href="#cb419-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb419-4"><a href="#cb419-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb419-5"><a href="#cb419-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">EIF2_int=</span>Mean)</span>
<span id="cb419-6"><a href="#cb419-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-7"><a href="#cb419-7" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb419-8"><a href="#cb419-8" aria-hidden="true" tabindex="-1"></a>  Length_EIF2<span class="sc">%&gt;%</span></span>
<span id="cb419-9"><a href="#cb419-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb419-10"><a href="#cb419-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb419-11"><a href="#cb419-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-12"><a href="#cb419-12" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb419-13"><a href="#cb419-13" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(EIF2_int) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> Length_EIF2)</span>
<span id="cb419-14"><a href="#cb419-14" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.88642, p-value = 0.004706</code></pre>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(EIF2_int) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> Length_EIF2)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(EIF2_int) ~ Diet + (1/Repeat)
BP = 0.097825, df = 1, p-value = 0.7545</code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(EIF2_int) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> Length_EIF2)</span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb423-4"><a href="#cb423-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-5"><a href="#cb423-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY&quot;</span>)),</span>
<span id="cb423-6"><a href="#cb423-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(Length_EIF2<span class="sc">$</span>Repeat),</span>
<span id="cb423-7"><a href="#cb423-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb423-8"><a href="#cb423-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb423-9"><a href="#cb423-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb423-10"><a href="#cb423-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb423-11"><a href="#cb423-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb423-12"><a href="#cb423-12" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb423-13"><a href="#cb423-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb423-14"><a href="#cb423-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb423-15"><a href="#cb423-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-16"><a href="#cb423-16" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb423-17"><a href="#cb423-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(EIF2 intensity) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb423-18"><a href="#cb423-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(EIF2 intensity) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS vs HY
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
15.54
</td>
<td style="text-align:left;">
4.34
</td>
<td style="text-align:left;">
-0.781
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8.1e-05
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb424-3"><a href="#cb424-3" aria-hidden="true" tabindex="-1"></a>Plot_Fig5K<span class="ot">=</span></span>
<span id="cb424-4"><a href="#cb424-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(Length_EIF2, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> EIF2_int))<span class="sc">+</span> </span>
<span id="cb424-5"><a href="#cb424-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb424-6"><a href="#cb424-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb424-7"><a href="#cb424-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="dv">3</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb424-8"><a href="#cb424-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_signif</span>(<span class="at">annotation =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,tab_stat<span class="sc">$</span>Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">y_position =</span> <span class="dv">135</span>, <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">tip_length =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.02</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb424-9"><a href="#cb424-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb424-10"><a href="#cb424-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb424-11"><a href="#cb424-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#FFB4B4&quot;</span>,<span class="st">&quot;#C3E6FC&quot;</span>))<span class="sc">+</span></span>
<span id="cb424-12"><a href="#cb424-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb424-13"><a href="#cb424-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb424-14"><a href="#cb424-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb424-15"><a href="#cb424-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean pixel intensity p-eIF2&quot;</span>,alpha,<span class="st">&quot; (a.u.)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb424-16"><a href="#cb424-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">140</span>),</span>
<span id="cb424-17"><a href="#cb424-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">125</span>,<span class="at">by=</span><span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb424-18"><a href="#cb424-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb424-19"><a href="#cb424-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb424-20"><a href="#cb424-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb424-21"><a href="#cb424-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb424-22"><a href="#cb424-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb424-23"><a href="#cb424-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb424-24"><a href="#cb424-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb424-25"><a href="#cb424-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb424-26"><a href="#cb424-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb424-27"><a href="#cb424-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb424-28"><a href="#cb424-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb424-29"><a href="#cb424-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb424-30"><a href="#cb424-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb424-31"><a href="#cb424-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb424-32"><a href="#cb424-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb424-33"><a href="#cb424-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb424-34"><a href="#cb424-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb424-35"><a href="#cb424-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb424-36"><a href="#cb424-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb424-37"><a href="#cb424-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb424-38"><a href="#cb424-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb424-39"><a href="#cb424-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb424-40"><a href="#cb424-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb424-41"><a href="#cb424-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont<span class="dv">-2</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb424-42"><a href="#cb424-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb424-43"><a href="#cb424-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb424-44"><a href="#cb424-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb424-45"><a href="#cb424-45" aria-hidden="true" tabindex="-1"></a>Plot_Fig5K</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205K-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-5l" class="section level3" number="5.1.10">
<h3 number="5.1.10"><span class="header-section-number">5.1.10</span> Figure 5L</h3>
<div class="blue">
<p>Re-enabling translation can restore mitosis in midguts shrinking after being shifted from HY to HS diet for 7 days. Blocking translational inhibition with ActTS&gt;Gcn2-IR or ActTS&gt;LK6-IR is sufficient to increase pH3+ cells in midguts of flies on HS diet. However, ActTS&gt;PEK-IR and ActTS&gt;AMPKα-IR had no effect on the number of pH3+ cells. Statistical comparisons are vs control. <em>Full statistical annotation on chart in pubblication</em></p>
</div>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a>tab_PH3_Translation <span class="ot">=</span> </span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;5L&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb425-3"><a href="#cb425-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb425-4"><a href="#cb425-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PH3_positive_cell=</span>Total.PH3,</span>
<span id="cb425-5"><a href="#cb425-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Day_of_treatment=</span>Day)<span class="sc">%&gt;%</span></span>
<span id="cb425-6"><a href="#cb425-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Male.Line=</span><span class="fu">fct_relevel</span>(Male.Line,<span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Ampk-IR&quot;</span>,<span class="st">&quot;PEK-IR&quot;</span>, <span class="st">&quot;Gcn2-IR&quot;</span>, <span class="st">&quot;Lk6-IR&quot;</span>)))</span>
<span id="cb425-7"><a href="#cb425-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-8"><a href="#cb425-8" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb425-9"><a href="#cb425-9" aria-hidden="true" tabindex="-1"></a>  tab_PH3_Translation<span class="sc">%&gt;%</span></span>
<span id="cb425-10"><a href="#cb425-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb425-11"><a href="#cb425-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb425-12"><a href="#cb425-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-13"><a href="#cb425-13" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb425-14"><a href="#cb425-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Gcn2-IR</span></span>
<span id="cb425-15"><a href="#cb425-15" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_PH3_Translation,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell) <span class="sc">&amp;</span> Male.Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Gcn2-IR&quot;</span>))</span>
<span id="cb425-16"><a href="#cb425-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb425-17"><a href="#cb425-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.9651, p-value = 0.1908</code></pre>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Male.Line + (1/Repeat)
BP = 0.68353, df = 1, p-value = 0.4084</code></pre>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb429-2"><a href="#cb429-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb429-3"><a href="#cb429-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb429-4"><a href="#cb429-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-5"><a href="#cb429-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Male.Line =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Gcn2-IR&quot;</span>)),</span>
<span id="cb429-6"><a href="#cb429-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb429-7"><a href="#cb429-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb429-8"><a href="#cb429-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb429-9"><a href="#cb429-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb429-10"><a href="#cb429-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb429-11"><a href="#cb429-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb429-12"><a href="#cb429-12" aria-hidden="true" tabindex="-1"></a>tab_stat_GCN<span class="ot">=</span>tab_stat</span>
<span id="cb429-13"><a href="#cb429-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-14"><a href="#cb429-14" aria-hidden="true" tabindex="-1"></a><span class="co">#PEK-IR</span></span>
<span id="cb429-15"><a href="#cb429-15" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_PH3_Translation,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell) <span class="sc">&amp;</span> Male.Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;PEK-IR&quot;</span>))</span>
<span id="cb429-16"><a href="#cb429-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb429-17"><a href="#cb429-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.95637, p-value = 0.1094</code></pre>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Male.Line + (1/Repeat)
BP = 1.0797, df = 1, p-value = 0.2988</code></pre>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb433-2"><a href="#cb433-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb433-3"><a href="#cb433-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb433-4"><a href="#cb433-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-5"><a href="#cb433-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Male.Line =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;PEK-IR&quot;</span>)),</span>
<span id="cb433-6"><a href="#cb433-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb433-7"><a href="#cb433-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb433-8"><a href="#cb433-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb433-9"><a href="#cb433-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb433-10"><a href="#cb433-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb433-11"><a href="#cb433-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span>  <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">1</span>,<span class="at">scientific=</span>F)))</span>
<span id="cb433-12"><a href="#cb433-12" aria-hidden="true" tabindex="-1"></a>tab_stat_PEK<span class="ot">=</span>tab_stat</span>
<span id="cb433-13"><a href="#cb433-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-14"><a href="#cb433-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Lk6-IR</span></span>
<span id="cb433-15"><a href="#cb433-15" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_PH3_Translation,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell) <span class="sc">&amp;</span> Male.Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Lk6-IR&quot;</span>))</span>
<span id="cb433-16"><a href="#cb433-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb433-17"><a href="#cb433-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.97495, p-value = 0.4461</code></pre>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Male.Line + (1/Repeat)
BP = 0.0018974, df = 1, p-value = 0.9653</code></pre>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb437-2"><a href="#cb437-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb437-3"><a href="#cb437-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb437-4"><a href="#cb437-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-5"><a href="#cb437-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Male.Line =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Lk6-IR&quot;</span>)),</span>
<span id="cb437-6"><a href="#cb437-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb437-7"><a href="#cb437-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb437-8"><a href="#cb437-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb437-9"><a href="#cb437-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb437-10"><a href="#cb437-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb437-11"><a href="#cb437-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">5</span>)))</span>
<span id="cb437-12"><a href="#cb437-12" aria-hidden="true" tabindex="-1"></a>tab_stat_Lk6<span class="ot">=</span>tab_stat</span>
<span id="cb437-13"><a href="#cb437-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-14"><a href="#cb437-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Ampk-IR</span></span>
<span id="cb437-15"><a href="#cb437-15" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_PH3_Translation,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell) <span class="sc">&amp;</span> Male.Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Ampk-IR&quot;</span>))</span>
<span id="cb437-16"><a href="#cb437-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb437-17"><a href="#cb437-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.95512, p-value = 0.09866</code></pre>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Male.Line + (1/Repeat)
BP = 2.3767, df = 1, p-value = 0.1232</code></pre>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb441-3"><a href="#cb441-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb441-4"><a href="#cb441-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-5"><a href="#cb441-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Male.Line =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Ampk-IR&quot;</span>)),</span>
<span id="cb441-6"><a href="#cb441-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb441-7"><a href="#cb441-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb441-8"><a href="#cb441-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb441-9"><a href="#cb441-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb441-10"><a href="#cb441-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb441-11"><a href="#cb441-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>,<span class="at">scientific=</span>F)))</span>
<span id="cb441-12"><a href="#cb441-12" aria-hidden="true" tabindex="-1"></a>tab_stat_Ampk<span class="ot">=</span>tab_stat</span>
<span id="cb441-13"><a href="#cb441-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-14"><a href="#cb441-14" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_PEK,tab_stat_Ampk,tab_stat_Lk6,tab_stat_GCN)</span>
<span id="cb441-15"><a href="#cb441-15" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>padj <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">p.adjust</span>(tab_stat<span class="sc">$</span>Pvalue, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>),<span class="at">digits=</span><span class="dv">2</span>,<span class="at">scientific =</span>T))</span>
<span id="cb441-16"><a href="#cb441-16" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb441-17"><a href="#cb441-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb441-18"><a href="#cb441-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb441-19"><a href="#cb441-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-20"><a href="#cb441-20" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb441-21"><a href="#cb441-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Difference in Diet&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;p-value adjusted&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb441-22"><a href="#cb441-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(PH3_positive_cell+1) ~  Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb441-23"><a href="#cb441-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(PH3_positive_cell+1) ~ Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Difference in Diet
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:right;">
p-value adjusted
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PEK-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2.77
</td>
<td style="text-align:left;">
1.74
</td>
<td style="text-align:left;">
0.301
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.0e-01
</td>
<td style="text-align:right;">
1.3e-01
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Ampk-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:left;">
1.76
</td>
<td style="text-align:left;">
0.13
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5.3e-01
</td>
<td style="text-align:right;">
5.3e-01
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Lk6-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
38.20
</td>
<td style="text-align:left;">
1.75
</td>
<td style="text-align:left;">
1.39
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Gcn2-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
23.61
</td>
<td style="text-align:left;">
1.74
</td>
<td style="text-align:left;">
0.926
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.2e-06
</td>
<td style="text-align:right;">
2.4e-06
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a>letter_position <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span>tab_PH3_Translation,PH3_positive_cell <span class="sc">~</span> Male.Line, max)</span>
<span id="cb442-2"><a href="#cb442-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-3"><a href="#cb442-3" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">left_join</span>(tab_stat,letter_position)</span>
<span id="cb442-4"><a href="#cb442-4" aria-hidden="true" tabindex="-1"></a>tab_stat5L <span class="ot">=</span> tab_stat</span>
<span id="cb442-5"><a href="#cb442-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-6"><a href="#cb442-6" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb442-7"><a href="#cb442-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-8"><a href="#cb442-8" aria-hidden="true" tabindex="-1"></a>tab_PH3_Translation<span class="sc">$</span>Female.Line <span class="ot">=</span> <span class="fu">factor</span>(tab_PH3_Translation<span class="sc">$</span>Female.Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Ac&quot;</span>,t<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))))</span>
<span id="cb442-9"><a href="#cb442-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-10"><a href="#cb442-10" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">max</span>(tab_PH3_Translation<span class="sc">$</span>PH3_positive_cell, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb442-11"><a href="#cb442-11" aria-hidden="true" tabindex="-1"></a>Plot_Fig5L<span class="ot">=</span></span>
<span id="cb442-12"><a href="#cb442-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_PH3_Translation, <span class="fu">aes</span>(<span class="at">x =</span> Male.Line, <span class="at">y =</span> PH3_positive_cell))<span class="sc">+</span> </span>
<span id="cb442-13"><a href="#cb442-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb442-14"><a href="#cb442-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb442-15"><a href="#cb442-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Male.Line, <span class="at">y =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb442-16"><a href="#cb442-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_grid</span>(.<span class="sc">~</span>Female.Line, <span class="at">labeller =</span> label_parsed)<span class="sc">+</span></span>
<span id="cb442-17"><a href="#cb442-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="st">&quot;#FFB4B4&quot;</span>)<span class="sc">+</span></span>
<span id="cb442-18"><a href="#cb442-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb442-19"><a href="#cb442-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Ampk-IR&quot;</span>,<span class="st">&quot;PEK-IR&quot;</span>,<span class="st">&quot;Gcn2-IR&quot;</span>,<span class="st">&quot;Lk6-IR&quot;</span>),</span>
<span id="cb442-20"><a href="#cb442-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">&quot;Control&quot;</span>), <span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;AMPK&quot;</span>, alpha, <span class="st">&quot;-IR&quot;</span>)), <span class="fu">italic</span>(<span class="st">&quot;PEK-IR&quot;</span>),<span class="fu">italic</span>(<span class="st">&quot;Gcn2-IR&quot;</span>),<span class="fu">italic</span>(<span class="st">&quot;Lk6-IR&quot;</span>))))<span class="sc">+</span></span>
<span id="cb442-21"><a href="#cb442-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;pH3&quot;</span> <span class="sc">^</span> <span class="st">&quot;+&quot;</span>, <span class="st">&quot; cells&quot;</span>)),</span>
<span id="cb442-22"><a href="#cb442-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">64</span>),</span>
<span id="cb442-23"><a href="#cb442-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">62</span>,<span class="at">by=</span><span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb442-24"><a href="#cb442-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb442-25"><a href="#cb442-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb442-26"><a href="#cb442-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb442-27"><a href="#cb442-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb442-28"><a href="#cb442-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb442-29"><a href="#cb442-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb442-30"><a href="#cb442-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb442-31"><a href="#cb442-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb442-32"><a href="#cb442-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb442-33"><a href="#cb442-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb442-34"><a href="#cb442-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb442-35"><a href="#cb442-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb442-36"><a href="#cb442-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb442-37"><a href="#cb442-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb442-38"><a href="#cb442-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb442-39"><a href="#cb442-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb442-40"><a href="#cb442-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb442-41"><a href="#cb442-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb442-42"><a href="#cb442-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb442-43"><a href="#cb442-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb442-44"><a href="#cb442-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb442-45"><a href="#cb442-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb442-46"><a href="#cb442-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb442-47"><a href="#cb442-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb442-48"><a href="#cb442-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb442-49"><a href="#cb442-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb442-50"><a href="#cb442-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb442-51"><a href="#cb442-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-52"><a href="#cb442-52" aria-hidden="true" tabindex="-1"></a>Plot_Fig5L</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205L-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-5m" class="section level3" number="5.1.11">
<h3 number="5.1.11"><span class="header-section-number">5.1.11</span> Figure 5M</h3>
<div class="blue">
<p>Despite increased mitotic activity following repression of translational inhibition in ActTS&gt;Gcn2-IR or ActTS&gt;LK6-IR, midgut size was still reduced on flies kept on HS diet. The statistical comparison is comparing interaction between diet and fly lines. <em>Full statistical annotation on chart in pubblication</em></p>
</div>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a>tab_length_Translation <span class="ot">=</span> </span>
<span id="cb443-2"><a href="#cb443-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;5M&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb443-3"><a href="#cb443-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb443-4"><a href="#cb443-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm=</span>Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb443-5"><a href="#cb443-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_treatment=</span>Day,</span>
<span id="cb443-6"><a href="#cb443-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Female_Line=</span>Female.Line,</span>
<span id="cb443-7"><a href="#cb443-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Male_Line=</span>Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb443-8"><a href="#cb443-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb443-9"><a href="#cb443-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Male_Line=</span><span class="fu">fct_relevel</span>(Male_Line,<span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Gcn2-IR&quot;</span>,<span class="st">&quot;Lk6-IR&quot;</span>)))</span>
<span id="cb443-10"><a href="#cb443-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-11"><a href="#cb443-11" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb443-12"><a href="#cb443-12" aria-hidden="true" tabindex="-1"></a>  tab_length_Translation<span class="sc">%&gt;%</span></span>
<span id="cb443-13"><a href="#cb443-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Male_Line)<span class="sc">%&gt;%</span></span>
<span id="cb443-14"><a href="#cb443-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb443-15"><a href="#cb443-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-16"><a href="#cb443-16" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb443-17"><a href="#cb443-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-18"><a href="#cb443-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Gcn2-IR</span></span>
<span id="cb443-19"><a href="#cb443-19" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_length_Translation,<span class="sc">!</span><span class="fu">is.na</span>(Total_Length_mm) <span class="sc">&amp;</span> Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Gcn2-IR&quot;</span>))</span>
<span id="cb443-20"><a href="#cb443-20" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb443-21"><a href="#cb443-21" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96927, p-value = 0.2601</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Male_Line + (1/Repeat)
BP = 2.3152, df = 1, p-value = 0.1281</code></pre>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb447-2"><a href="#cb447-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb447-3"><a href="#cb447-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb447-4"><a href="#cb447-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-5"><a href="#cb447-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Male_Line =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Gcn2-IR&quot;</span>)),</span>
<span id="cb447-6"><a href="#cb447-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb447-7"><a href="#cb447-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb447-8"><a href="#cb447-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb447-9"><a href="#cb447-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb447-10"><a href="#cb447-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb447-11"><a href="#cb447-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb447-12"><a href="#cb447-12" aria-hidden="true" tabindex="-1"></a>tab_stat_GCN<span class="ot">=</span>tab_stat</span>
<span id="cb447-13"><a href="#cb447-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-14"><a href="#cb447-14" aria-hidden="true" tabindex="-1"></a><span class="co">#lk6-IR</span></span>
<span id="cb447-15"><a href="#cb447-15" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_length_Translation,<span class="sc">!</span><span class="fu">is.na</span>(Total_Length_mm) <span class="sc">&amp;</span> Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Lk6-IR&quot;</span>))</span>
<span id="cb447-16"><a href="#cb447-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb447-17"><a href="#cb447-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.95702, p-value = 0.08776</code></pre>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Male_Line + (1/Repeat)
BP = 5.5789, df = 1, p-value = 0.01818</code></pre>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb451-3"><a href="#cb451-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb451-4"><a href="#cb451-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-5"><a href="#cb451-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Male_Line =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Lk6-IR&quot;</span>)),</span>
<span id="cb451-6"><a href="#cb451-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb451-7"><a href="#cb451-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb451-8"><a href="#cb451-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb451-9"><a href="#cb451-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb451-10"><a href="#cb451-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb451-11"><a href="#cb451-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb451-12"><a href="#cb451-12" aria-hidden="true" tabindex="-1"></a>tab_stat_Lk6<span class="ot">=</span>tab_stat</span>
<span id="cb451-13"><a href="#cb451-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-14"><a href="#cb451-14" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_Lk6,tab_stat_GCN)</span>
<span id="cb451-15"><a href="#cb451-15" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>padj <span class="ot">=</span> <span class="fu">format</span>(<span class="fu">p.adjust</span>(tab_stat<span class="sc">$</span>Pvalue, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>),<span class="at">digits=</span><span class="dv">2</span>,<span class="at">scientific =</span>F)</span>
<span id="cb451-16"><a href="#cb451-16" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb451-17"><a href="#cb451-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb451-18"><a href="#cb451-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb451-19"><a href="#cb451-19" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb451-20"><a href="#cb451-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Difference in Diet&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;p-value adjusted&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb451-21"><a href="#cb451-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb451-22"><a href="#cb451-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Difference in Diet
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
p-value adjusted
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Lk6-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:left;">
1.44
</td>
<td style="text-align:left;">
-0.0104
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.81
</td>
<td style="text-align:left;">
0.81
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Gcn2-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:left;">
1.44
</td>
<td style="text-align:left;">
0.0099
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:left;">
0.81
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a>letter_position <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span>tab_length_Translation,Total_Length_mm <span class="sc">~</span> Male_Line, max)</span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-3"><a href="#cb452-3" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">left_join</span>(tab_stat,letter_position)</span>
<span id="cb452-4"><a href="#cb452-4" aria-hidden="true" tabindex="-1"></a>tab_stat5M <span class="ot">=</span> tab_stat</span>
<span id="cb452-5"><a href="#cb452-5" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb452-6"><a href="#cb452-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-7"><a href="#cb452-7" aria-hidden="true" tabindex="-1"></a>tab_length_Translation<span class="sc">$</span>Female_Line <span class="ot">=</span> <span class="fu">factor</span>(tab_length_Translation<span class="sc">$</span>Female_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Ac&quot;</span>,t<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))))</span>
<span id="cb452-8"><a href="#cb452-8" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">max</span>(tab_length_Translation<span class="sc">$</span>Total_Length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb452-9"><a href="#cb452-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-10"><a href="#cb452-10" aria-hidden="true" tabindex="-1"></a>Plot_Fig5M<span class="ot">=</span></span>
<span id="cb452-11"><a href="#cb452-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_length_Translation, <span class="fu">aes</span>(<span class="at">x =</span> Male_Line, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb452-12"><a href="#cb452-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb452-13"><a href="#cb452-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">50</span>) <span class="sc">+</span> </span>
<span id="cb452-14"><a href="#cb452-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Male_Line, <span class="at">y =</span> <span class="fl">2.6</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb452-15"><a href="#cb452-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Female_Line,<span class="at">labeller=</span>label_parsed )<span class="sc">+</span></span>
<span id="cb452-16"><a href="#cb452-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#FFB4B4&quot;</span>))<span class="sc">+</span></span>
<span id="cb452-17"><a href="#cb452-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb452-18"><a href="#cb452-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Gcn2-IR&quot;</span>, <span class="st">&quot;Lk6-IR&quot;</span>),</span>
<span id="cb452-19"><a href="#cb452-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Gcn2-IR&quot;</span>, <span class="st">&quot;Lk6-IR&quot;</span>))<span class="sc">+</span></span>
<span id="cb452-20"><a href="#cb452-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb452-21"><a href="#cb452-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">2.5</span>,<span class="fl">6.1</span>),</span>
<span id="cb452-22"><a href="#cb452-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">3</span>,<span class="dv">6</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb452-23"><a href="#cb452-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb452-24"><a href="#cb452-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb452-25"><a href="#cb452-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb452-26"><a href="#cb452-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb452-27"><a href="#cb452-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb452-28"><a href="#cb452-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb452-29"><a href="#cb452-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb452-30"><a href="#cb452-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb452-31"><a href="#cb452-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb452-32"><a href="#cb452-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb452-33"><a href="#cb452-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb452-34"><a href="#cb452-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb452-35"><a href="#cb452-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb452-36"><a href="#cb452-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb452-37"><a href="#cb452-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb452-38"><a href="#cb452-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb452-39"><a href="#cb452-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb452-40"><a href="#cb452-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb452-41"><a href="#cb452-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb452-42"><a href="#cb452-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb452-43"><a href="#cb452-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb452-44"><a href="#cb452-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb452-45"><a href="#cb452-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb452-46"><a href="#cb452-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb452-47"><a href="#cb452-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb452-48"><a href="#cb452-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb452-49"><a href="#cb452-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb452-50"><a href="#cb452-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-51"><a href="#cb452-51" aria-hidden="true" tabindex="-1"></a>Plot_Fig5M</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205M-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>##Export Figure 5</p>
</div>
</div>
<div id="figure-5---supplementary-1" class="section level2" number="5.2">
<h2 number="5.2"><span class="header-section-number">5.2</span> Figure 5 - supplementary 1</h2>
<div id="figure-5s1a" class="section level3" number="5.2.1">
<h3 number="5.2.1"><span class="header-section-number">5.2.1</span> Figure 5S1A</h3>
<div class="blue">
<p>Survival assay shows lower survival on HS vs HY. Additional information on the statistics can be found in R markdown. Triangles represent the day when survival was recorded.</p>
</div>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a>tab_survival <span class="ot">=</span> </span>
<span id="cb453-2"><a href="#cb453-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(d[[<span class="st">&quot;5 - S1A&quot;</span>]],Treatment<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb453-3"><a href="#cb453-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TimeToDeath=</span><span class="fu">as.numeric</span>(TimeToDeath),</span>
<span id="cb453-4"><a href="#cb453-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Censor=</span><span class="fu">as.numeric</span>(Censor),</span>
<span id="cb453-5"><a href="#cb453-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Sex=</span><span class="st">&quot;Male&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb453-6"><a href="#cb453-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb453-7"><a href="#cb453-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)</span>
<span id="cb453-8"><a href="#cb453-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb453-9"><a href="#cb453-9" aria-hidden="true" tabindex="-1"></a><span class="co"># analysis</span></span>
<span id="cb453-10"><a href="#cb453-10" aria-hidden="true" tabindex="-1"></a>model_Surv<span class="ot">=</span> <span class="fu">coxme</span>(<span class="fu">Surv</span>(TimeToDeath,Censor) <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Repeat) , <span class="at">data=</span> tab_survival)</span>
<span id="cb453-11"><a href="#cb453-11" aria-hidden="true" tabindex="-1"></a>model_Surv1<span class="ot">=</span> <span class="fu">coxme</span>(<span class="fu">Surv</span>(TimeToDeath,Censor) <span class="sc">~</span> <span class="dv">1</span>  <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Repeat) , <span class="at">data=</span> tab_survival)</span>
<span id="cb453-12"><a href="#cb453-12" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(model_Surv1,model_Surv)</span>
<span id="cb453-13"><a href="#cb453-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-14"><a href="#cb453-14" aria-hidden="true" tabindex="-1"></a>test[<span class="dv">2</span>,<span class="dv">4</span>] <span class="ot">=</span> <span class="fu">pchisq</span>(test<span class="sc">$</span>Chisq[<span class="dv">2</span>],<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F)</span>
<span id="cb453-15"><a href="#cb453-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-16"><a href="#cb453-16" aria-hidden="true" tabindex="-1"></a>tab_test <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable=</span><span class="fu">c</span>(<span class="st">&quot;Full model&quot;</span>,<span class="st">&quot;(-) Diet&quot;</span>),</span>
<span id="cb453-17"><a href="#cb453-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">logLik=</span><span class="fu">as.numeric</span>(test[,<span class="dv">1</span>]),</span>
<span id="cb453-18"><a href="#cb453-18" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Chisq=</span><span class="fu">as.numeric</span>(test[,<span class="dv">2</span>]),</span>
<span id="cb453-19"><a href="#cb453-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df=</span><span class="fu">as.numeric</span>(test[,<span class="dv">3</span>]),</span>
<span id="cb453-20"><a href="#cb453-20" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue=</span><span class="fu">as.numeric</span>(test[,<span class="dv">4</span>]))</span>
<span id="cb453-21"><a href="#cb453-21" aria-hidden="true" tabindex="-1"></a>tab_test<span class="sc">%&gt;%</span></span>
<span id="cb453-22"><a href="#cb453-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Variable&quot;</span>,<span class="st">&quot;logLik&quot;</span> ,<span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>),<span class="at">row.names=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb453-23"><a href="#cb453-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;coxme(Surv(Time To Death,Censor) ~ Treatment + (1|Repeat))&quot;</span> <span class="ot">=</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb453-24"><a href="#cb453-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
coxme(Surv(Time To Death,Censor) ~ Treatment + (1|Repeat))
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
logLik
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Full model
</td>
<td style="text-align:right;">
-1466.334
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
(-) Diet
</td>
<td style="text-align:right;">
-1417.961
</td>
<td style="text-align:right;">
96.74613
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="do">## plot</span></span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a>survdata <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(TimeToDeath,Censor)<span class="sc">~</span>Treatment, <span class="at">data=</span>tab_survival)</span>
<span id="cb454-3"><a href="#cb454-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-4"><a href="#cb454-4" aria-hidden="true" tabindex="-1"></a>toplot <span class="ot">&lt;-</span> <span class="fu">ggplotprep2</span>(survdata, <span class="at">times=</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">75</span>,<span class="at">by=</span><span class="dv">3</span>)))</span>
<span id="cb454-5"><a href="#cb454-5" aria-hidden="true" tabindex="-1"></a>Limits<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>)</span>
<span id="cb454-6"><a href="#cb454-6" aria-hidden="true" tabindex="-1"></a>Name<span class="ot">=</span><span class="st">&quot;Diet&quot;</span></span>
<span id="cb454-7"><a href="#cb454-7" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">=</span> survdata<span class="sc">$</span>n[<span class="dv">1</span>]</span>
<span id="cb454-8"><a href="#cb454-8" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">=</span> survdata<span class="sc">$</span>n[<span class="dv">2</span>]</span>
<span id="cb454-9"><a href="#cb454-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-10"><a href="#cb454-10" aria-hidden="true" tabindex="-1"></a>Labels <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;HS (n=&quot;</span>,n1,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>),</span>
<span id="cb454-11"><a href="#cb454-11" aria-hidden="true" tabindex="-1"></a>           <span class="fu">paste</span>(<span class="st">&quot;HY (n=&quot;</span>,n2,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb454-12"><a href="#cb454-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-13"><a href="#cb454-13" aria-hidden="true" tabindex="-1"></a>Plot_Fig5S1A<span class="ot">=</span></span>
<span id="cb454-14"><a href="#cb454-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(toplot, <span class="fu">aes</span>(<span class="at">x=</span>Time,<span class="at">y=</span>Survival))<span class="sc">+</span></span>
<span id="cb454-15"><a href="#cb454-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Condition,<span class="at">colour=</span>Condition),<span class="at">size=</span><span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb454-16"><a href="#cb454-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape=</span>Condition,<span class="at">fill=</span>Condition,<span class="at">colour=</span>Condition),<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb454-17"><a href="#cb454-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">subset</span>(tab_test, Variable<span class="sc">==</span><span class="st">&quot;(-) Diet&quot;</span>), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,<span class="fu">format</span>(Pvalue,<span class="at">digits=</span><span class="dv">2</span>))),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb454-18"><a href="#cb454-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data=</span><span class="fu">subset</span>(toplot,Time<span class="sc">==</span><span class="dv">27</span>),<span class="fu">aes</span>(<span class="at">ymin=</span>lower, <span class="at">ymax=</span>upper,<span class="at">colour=</span>Condition), <span class="at">width=</span>.<span class="dv">1</span>, <span class="at">alpha=</span><span class="dv">01</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">show.legend=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb454-19"><a href="#cb454-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(Name,</span>
<span id="cb454-20"><a href="#cb454-20" aria-hidden="true" tabindex="-1"></a>                      <span class="at">limits=</span>Limits,</span>
<span id="cb454-21"><a href="#cb454-21" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#ff9595&quot;</span>, <span class="st">&quot;#abefff&quot;</span>),</span>
<span id="cb454-22"><a href="#cb454-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span>Labels)<span class="sc">+</span></span>
<span id="cb454-23"><a href="#cb454-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(Name,</span>
<span id="cb454-24"><a href="#cb454-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">limits=</span>Limits,</span>
<span id="cb454-25"><a href="#cb454-25" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>,<span class="st">&quot;solid&quot;</span>),</span>
<span id="cb454-26"><a href="#cb454-26" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels=</span>Labels)<span class="sc">+</span></span>
<span id="cb454-27"><a href="#cb454-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(Name,</span>
<span id="cb454-28"><a href="#cb454-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits=</span>Limits,</span>
<span id="cb454-29"><a href="#cb454-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="fu">c</span>(<span class="st">&quot;#ff9595&quot;</span>, <span class="st">&quot;#abefff&quot;</span>)),</span>
<span id="cb454-30"><a href="#cb454-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>Labels)<span class="sc">+</span></span>
<span id="cb454-31"><a href="#cb454-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(Name,</span>
<span id="cb454-32"><a href="#cb454-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span>Limits,</span>
<span id="cb454-33"><a href="#cb454-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="dv">24</span>,<span class="dv">25</span>),</span>
<span id="cb454-34"><a href="#cb454-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span>Labels)<span class="sc">+</span></span>
<span id="cb454-35"><a href="#cb454-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;Days post-eclosion&quot;</span>,</span>
<span id="cb454-36"><a href="#cb454-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">75</span>),</span>
<span id="cb454-37"><a href="#cb454-37" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">75</span>,<span class="at">by=</span><span class="dv">10</span>)))<span class="sc">+</span></span>
<span id="cb454-38"><a href="#cb454-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Proportion of survivors&quot;</span>,</span>
<span id="cb454-39"><a href="#cb454-39" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),<span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb454-40"><a href="#cb454-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb454-41"><a href="#cb454-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb454-42"><a href="#cb454-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb454-43"><a href="#cb454-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb454-44"><a href="#cb454-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb454-45"><a href="#cb454-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb454-46"><a href="#cb454-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb454-47"><a href="#cb454-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb454-48"><a href="#cb454-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb454-49"><a href="#cb454-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb454-50"><a href="#cb454-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb454-51"><a href="#cb454-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb454-52"><a href="#cb454-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb454-53"><a href="#cb454-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb454-54"><a href="#cb454-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.2</span>),</span>
<span id="cb454-55"><a href="#cb454-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb454-56"><a href="#cb454-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb454-57"><a href="#cb454-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb454-58"><a href="#cb454-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb454-59"><a href="#cb454-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont<span class="dv">-2</span>),</span>
<span id="cb454-60"><a href="#cb454-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb454-61"><a href="#cb454-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb454-62"><a href="#cb454-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb454-63"><a href="#cb454-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb454-64"><a href="#cb454-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb454-65"><a href="#cb454-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-66"><a href="#cb454-66" aria-hidden="true" tabindex="-1"></a>Plot_Fig5S1A</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205S1A-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>##Export Figure 5S1</p>
</div>
</div>
<div id="figure-5---supplementary-2" class="section level2" number="5.3">
<h2 number="5.3"><span class="header-section-number">5.3</span> Figure 5 - supplementary 2</h2>
<div id="figure-5s2a-d" class="section level3" number="5.3.1">
<h3 number="5.3.1"><span class="header-section-number">5.3.1</span> Figure 5S2A-D’</h3>
<div class="blue">
<p>p-eIF2α stain is elevated in all cells of the epithelium on HS (A, A’, first row) diet compared to HY (B,B’, second row) diet, and less strongly in visceral muscle (C-D’, third row HS, fourth row HY). In red anti p-eIF2α stain together with EsgTS&gt;UAS-GFP in green (progenitor cells marker) in A, B, or alone in A’, B’. A to B’ are maximum intensity projection of z-stack. In red anti p-eIF2α stain together with HowTS&gt;UAS-GFP in green (Visceral muscle marker) in C, D, or alone in C’, D’ (Single z-stack). <em>Complete graphical annotation can be found in manuscript figures</em></p>
</div>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5 - S2A.jpg&quot;</span>) </span>
<span id="cb455-2"><a href="#cb455-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5S2A <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb455-3"><a href="#cb455-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5S2A)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205S2A-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5 - S2A&#39;.jpg&quot;</span>) </span>
<span id="cb456-2"><a href="#cb456-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5S2A1 <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb456-3"><a href="#cb456-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5S2A1)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205S2A1-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5 - S2B.jpg&quot;</span>) </span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5S2B <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb457-3"><a href="#cb457-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5S2B)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205S2B-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5 - S2B&#39;.jpg&quot;</span>) </span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5S2B1 <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5S2B1)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205S2B1-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5 - S2C.jpg&quot;</span>) </span>
<span id="cb459-2"><a href="#cb459-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5S2C <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb459-3"><a href="#cb459-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5S2C)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205S2C-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5 - S2C&#39;.jpg&quot;</span>) </span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5S2C1 <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb460-3"><a href="#cb460-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5S2C1)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205S2C1-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5 - S2D.jpg&quot;</span>) </span>
<span id="cb461-2"><a href="#cb461-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5S2D <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb461-3"><a href="#cb461-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5S2D)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205S2D-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/5 - S2D&#39;.jpg&quot;</span>) </span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig5S2D1 <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb462-3"><a href="#cb462-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig5S2D1)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205S2D1-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="figure-5s2e" class="section level3" number="5.3.2">
<h3 number="5.3.2"><span class="header-section-number">5.3.2</span> Figure 5S2E</h3>
<div class="blue">
<p>Blocking translational inhibition with ActTS&gt;Gcn2-IR or ActTS&gt;LK6-IR is sufficient to increase pH3+ cells in midguts of flies shifted from HY to HS diet. However, ActTS&gt;PEK-IR and ActTS&gt;AMPKα-IR had no effect on the number of pH3+ cells. Statistical comparisons are vs control.</p>
</div>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a>tab_PH3_Translation <span class="ot">=</span> </span>
<span id="cb463-2"><a href="#cb463-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;5 - S2E&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb463-3"><a href="#cb463-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb463-4"><a href="#cb463-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PH3_positive_cell=</span>Total.PH3,</span>
<span id="cb463-5"><a href="#cb463-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Day_of_treatment=</span>Day)</span>
<span id="cb463-6"><a href="#cb463-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-7"><a href="#cb463-7" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb463-8"><a href="#cb463-8" aria-hidden="true" tabindex="-1"></a>  tab_PH3_Translation<span class="sc">%&gt;%</span></span>
<span id="cb463-9"><a href="#cb463-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb463-10"><a href="#cb463-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb463-11"><a href="#cb463-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-12"><a href="#cb463-12" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb463-13"><a href="#cb463-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Gcn2-IR</span></span>
<span id="cb463-14"><a href="#cb463-14" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_PH3_Translation,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell) <span class="sc">&amp;</span> Male.Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Gcn2-IR&quot;</span>))</span>
<span id="cb463-15"><a href="#cb463-15" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb463-16"><a href="#cb463-16" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.95985, p-value = 0.1131</code></pre>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Male.Line + (1/Repeat)
BP = 3.0597, df = 1, p-value = 0.08026</code></pre>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb467-2"><a href="#cb467-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb467-3"><a href="#cb467-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb467-4"><a href="#cb467-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-5"><a href="#cb467-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Male.Line =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control vs Gcn2-IR&quot;</span>)),</span>
<span id="cb467-6"><a href="#cb467-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb467-7"><a href="#cb467-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb467-8"><a href="#cb467-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb467-9"><a href="#cb467-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb467-10"><a href="#cb467-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb467-11"><a href="#cb467-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb467-12"><a href="#cb467-12" aria-hidden="true" tabindex="-1"></a>tab_stat_GCN<span class="ot">=</span>tab_stat</span>
<span id="cb467-13"><a href="#cb467-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-14"><a href="#cb467-14" aria-hidden="true" tabindex="-1"></a><span class="co">#PEK-IR</span></span>
<span id="cb467-15"><a href="#cb467-15" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_PH3_Translation,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell) <span class="sc">&amp;</span> Male.Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;PEK-IR&quot;</span>))</span>
<span id="cb467-16"><a href="#cb467-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb467-17"><a href="#cb467-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96541, p-value = 0.2422</code></pre>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Male.Line + (1/Repeat)
BP = 0.28498, df = 1, p-value = 0.5935</code></pre>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb471-3"><a href="#cb471-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb471-4"><a href="#cb471-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb471-5"><a href="#cb471-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Male.Line =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control vs PEK-IR&quot;</span>)),</span>
<span id="cb471-6"><a href="#cb471-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb471-7"><a href="#cb471-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb471-8"><a href="#cb471-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb471-9"><a href="#cb471-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb471-10"><a href="#cb471-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb471-11"><a href="#cb471-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">1</span>,<span class="at">scientific=</span>F)))</span>
<span id="cb471-12"><a href="#cb471-12" aria-hidden="true" tabindex="-1"></a>tab_stat_PEK<span class="ot">=</span>tab_stat</span>
<span id="cb471-13"><a href="#cb471-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb471-14"><a href="#cb471-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Lk6-IR</span></span>
<span id="cb471-15"><a href="#cb471-15" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_PH3_Translation,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell) <span class="sc">&amp;</span> Male.Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Lk6-IR&quot;</span>))</span>
<span id="cb471-16"><a href="#cb471-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb471-17"><a href="#cb471-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98726, p-value = 0.8899</code></pre>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Male.Line + (1/Repeat)
BP = 1.2795, df = 1, p-value = 0.258</code></pre>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb475-2"><a href="#cb475-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb475-3"><a href="#cb475-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb475-4"><a href="#cb475-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-5"><a href="#cb475-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Male.Line =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control vs Lk6-IR&quot;</span>)),</span>
<span id="cb475-6"><a href="#cb475-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb475-7"><a href="#cb475-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb475-8"><a href="#cb475-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb475-9"><a href="#cb475-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb475-10"><a href="#cb475-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb475-11"><a href="#cb475-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb475-12"><a href="#cb475-12" aria-hidden="true" tabindex="-1"></a>tab_stat_Lk6<span class="ot">=</span>tab_stat</span>
<span id="cb475-13"><a href="#cb475-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-14"><a href="#cb475-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Ampk-IR</span></span>
<span id="cb475-15"><a href="#cb475-15" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_PH3_Translation,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell) <span class="sc">&amp;</span> Male.Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Ampk-IR&quot;</span>))</span>
<span id="cb475-16"><a href="#cb475-16" aria-hidden="true" tabindex="-1"></a>tmp<span class="sc">$</span>Male.Line <span class="ot">=</span> <span class="fu">factor</span>(tmp<span class="sc">$</span>Male.Line,<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Ampk-IR&quot;</span>))</span>
<span id="cb475-17"><a href="#cb475-17" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb475-18"><a href="#cb475-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.9837, p-value = 0.7479</code></pre>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Male.Line + (1/Repeat)
BP = 0.13265, df = 1, p-value = 0.7157</code></pre>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb479-3"><a href="#cb479-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb479-4"><a href="#cb479-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-5"><a href="#cb479-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Male.Line =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control vs Ampk-IR&quot;</span>)),</span>
<span id="cb479-6"><a href="#cb479-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb479-7"><a href="#cb479-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb479-8"><a href="#cb479-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb479-9"><a href="#cb479-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb479-10"><a href="#cb479-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb479-11"><a href="#cb479-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">1</span>,<span class="at">scientific=</span>F)))</span>
<span id="cb479-12"><a href="#cb479-12" aria-hidden="true" tabindex="-1"></a>tab_stat_Ampk<span class="ot">=</span>tab_stat</span>
<span id="cb479-13"><a href="#cb479-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-14"><a href="#cb479-14" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_PEK,tab_stat_Ampk,tab_stat_Lk6,tab_stat_GCN)</span>
<span id="cb479-15"><a href="#cb479-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-16"><a href="#cb479-16" aria-hidden="true" tabindex="-1"></a>letter_position <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span>tab_PH3_Translation,PH3_positive_cell <span class="sc">~</span> Male.Line, max)</span>
<span id="cb479-17"><a href="#cb479-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-18"><a href="#cb479-18" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">left_join</span>(tab_stat,letter_position)</span>
<span id="cb479-19"><a href="#cb479-19" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>padj <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">p.adjust</span>(tab_stat<span class="sc">$</span>Pvalue, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>),<span class="at">digits=</span><span class="dv">2</span>,<span class="at">scientific =</span>T))</span>
<span id="cb479-20"><a href="#cb479-20" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb479-21"><a href="#cb479-21" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb479-22"><a href="#cb479-22" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb479-23"><a href="#cb479-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-24"><a href="#cb479-24" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb479-25"><a href="#cb479-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;letter position&quot;</span>,<span class="st">&quot;p-value adjusted&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb479-26"><a href="#cb479-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(PH3_positive_cell+1) ~  Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">10</span>))<span class="sc">%&gt;%</span></span>
<span id="cb479-27"><a href="#cb479-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="10">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(PH3_positive_cell+1) ~ Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:right;">
letter position
</th>
<th style="text-align:right;">
p-value adjusted
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Control vs PEK-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:left;">
2.08
</td>
<td style="text-align:left;">
0.188
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4e-01
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
5.3e-01
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Control vs Ampk-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:left;">
2.07
</td>
<td style="text-align:left;">
-0.0243
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9e-01
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
9.0e-01
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Control vs Lk6-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
26.82
</td>
<td style="text-align:left;">
2.07
</td>
<td style="text-align:left;">
1.06
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2e-07
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
4.0e-07
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Control vs Gcn2-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
29.80
</td>
<td style="text-align:left;">
2.09
</td>
<td style="text-align:left;">
1.17
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0e+00
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
2.0e-07
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a>tab_stat5S2E <span class="ot">=</span> tab_stat</span>
<span id="cb480-2"><a href="#cb480-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-3"><a href="#cb480-3" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb480-4"><a href="#cb480-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-5"><a href="#cb480-5" aria-hidden="true" tabindex="-1"></a>tab_PH3_Translation<span class="sc">$</span>Female.Line <span class="ot">=</span> <span class="fu">factor</span>(tab_PH3_Translation<span class="sc">$</span>Female.Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Ac&quot;</span>,t<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))))</span>
<span id="cb480-6"><a href="#cb480-6" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">max</span>(tab_PH3_Translation<span class="sc">$</span>PH3_positive_cell, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb480-7"><a href="#cb480-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-8"><a href="#cb480-8" aria-hidden="true" tabindex="-1"></a>Plot_Fig5S2E<span class="ot">=</span></span>
<span id="cb480-9"><a href="#cb480-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_PH3_Translation, <span class="fu">aes</span>(<span class="at">x =</span> Male.Line, <span class="at">y =</span> PH3_positive_cell))<span class="sc">+</span> </span>
<span id="cb480-10"><a href="#cb480-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb480-11"><a href="#cb480-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb480-12"><a href="#cb480-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Male.Line, <span class="at">y =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb480-13"><a href="#cb480-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Female.Line, <span class="at">labeller =</span> label_parsed)<span class="sc">+</span></span>
<span id="cb480-14"><a href="#cb480-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="st">&quot;#FFE5E5&quot;</span>)<span class="sc">+</span></span>
<span id="cb480-15"><a href="#cb480-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb480-16"><a href="#cb480-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Ampk-IR&quot;</span>, <span class="st">&quot;PEK-IR&quot;</span>, <span class="st">&quot;Gcn2-IR&quot;</span>,<span class="st">&quot;Lk6-IR&quot;</span>),</span>
<span id="cb480-17"><a href="#cb480-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">&quot;Control&quot;</span>), <span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;AMPK&quot;</span>, alpha, <span class="st">&quot;-IR&quot;</span>)), <span class="fu">italic</span>(<span class="st">&quot;PEK-IR&quot;</span>), <span class="fu">italic</span>(<span class="st">&quot;Gcn2-IR&quot;</span>),  <span class="fu">italic</span>(<span class="st">&quot;Lk6-IR&quot;</span>))))<span class="sc">+</span></span>
<span id="cb480-18"><a href="#cb480-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;pH3&quot;</span> <span class="sc">^</span> <span class="st">&quot;+&quot;</span>, <span class="st">&quot; cells&quot;</span>)),</span>
<span id="cb480-19"><a href="#cb480-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">64</span>),</span>
<span id="cb480-20"><a href="#cb480-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">62</span>,<span class="at">by=</span><span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb480-21"><a href="#cb480-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb480-22"><a href="#cb480-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb480-23"><a href="#cb480-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb480-24"><a href="#cb480-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb480-25"><a href="#cb480-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb480-26"><a href="#cb480-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb480-27"><a href="#cb480-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb480-28"><a href="#cb480-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb480-29"><a href="#cb480-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb480-30"><a href="#cb480-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb480-31"><a href="#cb480-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb480-32"><a href="#cb480-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb480-33"><a href="#cb480-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb480-34"><a href="#cb480-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb480-35"><a href="#cb480-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb480-36"><a href="#cb480-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb480-37"><a href="#cb480-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb480-38"><a href="#cb480-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb480-39"><a href="#cb480-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb480-40"><a href="#cb480-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb480-41"><a href="#cb480-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb480-42"><a href="#cb480-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb480-43"><a href="#cb480-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb480-44"><a href="#cb480-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb480-45"><a href="#cb480-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb480-46"><a href="#cb480-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb480-47"><a href="#cb480-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb480-48"><a href="#cb480-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-49"><a href="#cb480-49" aria-hidden="true" tabindex="-1"></a>Plot_Fig5S2E</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205S2E-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-5s2f" class="section level3" number="5.3.3">
<h3 number="5.3.3"><span class="header-section-number">5.3.3</span> Figure 5S2F</h3>
<div class="blue">
<p>Despite increased mitotic activity following repression of translational inhibition in ActTS&gt;Gcn2-IR or ActTS&gt;LK6-IR, midgut size was still shrinking on flies shifted from HY to HS diet for 7 days. The statistical comparison is comparing interaction between diet and fly lines. <em>Complete statistical annotation on image can be found in the manuscript’s figure.</em></p>
</div>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true" tabindex="-1"></a>tab_length_Translation <span class="ot">=</span> </span>
<span id="cb481-2"><a href="#cb481-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;5 - S2F&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb481-3"><a href="#cb481-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb481-4"><a href="#cb481-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm=</span>Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb481-5"><a href="#cb481-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_treatment=</span>Day,</span>
<span id="cb481-6"><a href="#cb481-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Female_Line=</span>Female.Line,</span>
<span id="cb481-7"><a href="#cb481-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Male_Line=</span>Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb481-8"><a href="#cb481-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb481-9"><a href="#cb481-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Male_Line=</span><span class="fu">fct_relevel</span>(Male_Line,<span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Gcn2-IR&quot;</span>,<span class="st">&quot;Lk6-IR&quot;</span>)))</span>
<span id="cb481-10"><a href="#cb481-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-11"><a href="#cb481-11" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb481-12"><a href="#cb481-12" aria-hidden="true" tabindex="-1"></a>  tab_length_Translation<span class="sc">%&gt;%</span></span>
<span id="cb481-13"><a href="#cb481-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Male_Line)<span class="sc">%&gt;%</span></span>
<span id="cb481-14"><a href="#cb481-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb481-15"><a href="#cb481-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-16"><a href="#cb481-16" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb481-17"><a href="#cb481-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Gcn2-IR</span></span>
<span id="cb481-18"><a href="#cb481-18" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_length_Translation, Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Gcn2-IR&quot;</span>))</span>
<span id="cb481-19"><a href="#cb481-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">*</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb481-20"><a href="#cb481-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.99166, p-value = 0.8546</code></pre>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + Male_Line + (1/Repeat)
BP = 4.3162, df = 2, p-value = 0.1155</code></pre>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb485-3"><a href="#cb485-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb485-4"><a href="#cb485-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-5"><a href="#cb485-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Male_Line =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control interaction vs Gcn2-IR interaction&quot;</span>)),</span>
<span id="cb485-6"><a href="#cb485-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb485-7"><a href="#cb485-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb485-8"><a href="#cb485-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb485-9"><a href="#cb485-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb485-10"><a href="#cb485-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb485-11"><a href="#cb485-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">1</span>,<span class="at">scientific=</span>F)))</span>
<span id="cb485-12"><a href="#cb485-12" aria-hidden="true" tabindex="-1"></a>tab_stat_Gcn2<span class="ot">=</span>tab_stat</span>
<span id="cb485-13"><a href="#cb485-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-14"><a href="#cb485-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Lk6-IR</span></span>
<span id="cb485-15"><a href="#cb485-15" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_length_Translation, Male_Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Lk6-IR&quot;</span>))</span>
<span id="cb485-16"><a href="#cb485-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">*</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb485-17"><a href="#cb485-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.99083, p-value = 0.8181</code></pre>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + Male_Line + (1/Repeat)
BP = 0.69052, df = 2, p-value = 0.708</code></pre>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb489-2"><a href="#cb489-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb489-3"><a href="#cb489-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb489-4"><a href="#cb489-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb489-5"><a href="#cb489-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Male_Line =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control interaction vs Lk6-IR interaction&quot;</span>)),</span>
<span id="cb489-6"><a href="#cb489-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb489-7"><a href="#cb489-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb489-8"><a href="#cb489-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb489-9"><a href="#cb489-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb489-10"><a href="#cb489-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb489-11"><a href="#cb489-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">1</span>,<span class="at">scientific=</span>F)))</span>
<span id="cb489-12"><a href="#cb489-12" aria-hidden="true" tabindex="-1"></a>tab_stat_Lk6<span class="ot">=</span>tab_stat</span>
<span id="cb489-13"><a href="#cb489-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb489-14"><a href="#cb489-14" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_Lk6,tab_stat_Gcn2)</span>
<span id="cb489-15"><a href="#cb489-15" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>padj <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">p.adjust</span>(tab_stat<span class="sc">$</span>Pvalue, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>),<span class="at">digits=</span><span class="dv">2</span>,<span class="at">scientific =</span>F))</span>
<span id="cb489-16"><a href="#cb489-16" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb489-17"><a href="#cb489-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb489-18"><a href="#cb489-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb489-19"><a href="#cb489-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb489-20"><a href="#cb489-20" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb489-21"><a href="#cb489-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Copparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;p-value adjusted&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb489-22"><a href="#cb489-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + Genotype + Diet : Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb489-23"><a href="#cb489-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + Genotype + Diet : Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Copparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:right;">
p-value adjusted
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Control interaction vs Lk6-IR interaction
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3.71
</td>
<td style="text-align:left;">
1.78
</td>
<td style="text-align:left;">
-0.23
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Control interaction vs Gcn2-IR interaction
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3.61
</td>
<td style="text-align:left;">
1.78
</td>
<td style="text-align:left;">
-0.224
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a>tab_stat5S2F <span class="ot">=</span> tab_stat</span>
<span id="cb490-2"><a href="#cb490-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-3"><a href="#cb490-3" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb490-4"><a href="#cb490-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-5"><a href="#cb490-5" aria-hidden="true" tabindex="-1"></a>tab_length_Translation<span class="sc">$</span>Female_Line <span class="ot">=</span> <span class="fu">factor</span>(tab_length_Translation<span class="sc">$</span>Female_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Ac&quot;</span>,t<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))))</span>
<span id="cb490-6"><a href="#cb490-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-7"><a href="#cb490-7" aria-hidden="true" tabindex="-1"></a>Plot_Fig5S2F<span class="ot">=</span></span>
<span id="cb490-8"><a href="#cb490-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_length_Translation, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb490-9"><a href="#cb490-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb490-10"><a href="#cb490-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb490-11"><a href="#cb490-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">2.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb490-12"><a href="#cb490-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Male_Line)<span class="sc">+</span></span>
<span id="cb490-13"><a href="#cb490-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#C3E6FC&quot;</span>, <span class="st">&quot;#FFE5E5&quot;</span>))<span class="sc">+</span></span>
<span id="cb490-14"><a href="#cb490-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb490-15"><a href="#cb490-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HY D0&quot;</span>,<span class="st">&quot;HYtoHS D7&quot;</span>),</span>
<span id="cb490-16"><a href="#cb490-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>,<span class="st">&quot;HY to HS&quot;</span>))<span class="sc">+</span></span>
<span id="cb490-17"><a href="#cb490-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb490-18"><a href="#cb490-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">9</span>),</span>
<span id="cb490-19"><a href="#cb490-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb490-20"><a href="#cb490-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb490-21"><a href="#cb490-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb490-22"><a href="#cb490-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb490-23"><a href="#cb490-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb490-24"><a href="#cb490-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb490-25"><a href="#cb490-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb490-26"><a href="#cb490-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb490-27"><a href="#cb490-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb490-28"><a href="#cb490-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb490-29"><a href="#cb490-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb490-30"><a href="#cb490-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb490-31"><a href="#cb490-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb490-32"><a href="#cb490-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb490-33"><a href="#cb490-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb490-34"><a href="#cb490-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb490-35"><a href="#cb490-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb490-36"><a href="#cb490-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb490-37"><a href="#cb490-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb490-38"><a href="#cb490-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb490-39"><a href="#cb490-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb490-40"><a href="#cb490-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb490-41"><a href="#cb490-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb490-42"><a href="#cb490-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb490-43"><a href="#cb490-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb490-44"><a href="#cb490-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>),<span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb490-45"><a href="#cb490-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>), <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb490-46"><a href="#cb490-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb490-47"><a href="#cb490-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb490-48"><a href="#cb490-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-49"><a href="#cb490-49" aria-hidden="true" tabindex="-1"></a>Plot_Fig5S2F</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%2055S2F-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-5s2g" class="section level3" number="5.3.4">
<h3 number="5.3.4"><span class="header-section-number">5.3.4</span> Figure 5S2G</h3>
<div class="blue">
<p>Knockdown of Gcn2 in ECs (MyoTS&gt;Gcn2-IR), but not in progenitor cells (EsgTS&gt;Gcn2-IR), is sufficient to increase pH3+ cells in midguts of flies shifted after 12 days from eclosion on HY to HS diet for additional 7 days. Statistical comparisons are vs respective controls.</p>
</div>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="#cb491-1" aria-hidden="true" tabindex="-1"></a>tab_PH3_Translation1 <span class="ot">=</span> </span>
<span id="cb491-2"><a href="#cb491-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;5 - S2G&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb491-3"><a href="#cb491-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb491-4"><a href="#cb491-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PH3_positive_cell=</span>Total.PH3,</span>
<span id="cb491-5"><a href="#cb491-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Day_of_treatment=</span>Day)</span>
<span id="cb491-6"><a href="#cb491-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-7"><a href="#cb491-7" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb491-8"><a href="#cb491-8" aria-hidden="true" tabindex="-1"></a>  tab_PH3_Translation1<span class="sc">%&gt;%</span></span>
<span id="cb491-9"><a href="#cb491-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Female.Line, Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb491-10"><a href="#cb491-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb491-11"><a href="#cb491-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-12"><a href="#cb491-12" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb491-13"><a href="#cb491-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Esg</span></span>
<span id="cb491-14"><a href="#cb491-14" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_PH3_Translation1,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell) <span class="sc">&amp;</span> Female.Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Esg&quot;</span>))</span>
<span id="cb491-15"><a href="#cb491-15" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb491-16"><a href="#cb491-16" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96868, p-value = 0.1948</code></pre>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Male.Line + (1/Repeat)
BP = 0.76503, df = 1, p-value = 0.3818</code></pre>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb495-2"><a href="#cb495-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb495-3"><a href="#cb495-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb495-4"><a href="#cb495-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb495-5"><a href="#cb495-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control vs Gcn2-IR EsgTS&quot;</span>)),</span>
<span id="cb495-6"><a href="#cb495-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Male.Line =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;EsgTS x Gcn2-IR&quot;</span>)),</span>
<span id="cb495-7"><a href="#cb495-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb495-8"><a href="#cb495-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb495-9"><a href="#cb495-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb495-10"><a href="#cb495-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb495-11"><a href="#cb495-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb495-12"><a href="#cb495-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)),</span>
<span id="cb495-13"><a href="#cb495-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Female.Line =</span> <span class="st">&quot;Esg&quot;</span>,</span>
<span id="cb495-14"><a href="#cb495-14" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Male.line =</span><span class="st">&quot;Gcn2-IR&quot;</span>)</span>
<span id="cb495-15"><a href="#cb495-15" aria-hidden="true" tabindex="-1"></a>tab_stat_esg<span class="ot">=</span>tab_stat</span>
<span id="cb495-16"><a href="#cb495-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb495-17"><a href="#cb495-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb495-18"><a href="#cb495-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Myo</span></span>
<span id="cb495-19"><a href="#cb495-19" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">subset</span>(tab_PH3_Translation1,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell) <span class="sc">&amp;</span> Female.Line<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;Myo&quot;</span>))</span>
<span id="cb495-20"><a href="#cb495-20" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb495-21"><a href="#cb495-21" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96482, p-value = 0.1495</code></pre>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tmp)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(PH3_positive_cell + 1) ~ Male.Line + (1/Repeat)
BP = 1.4773, df = 1, p-value = 0.2242</code></pre>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="#cb499-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(PH3_positive_cell<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tmp)</span>
<span id="cb499-2"><a href="#cb499-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb499-3"><a href="#cb499-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb499-4"><a href="#cb499-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-5"><a href="#cb499-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control vs Gcn2-IR EsgTS&quot;</span>)),</span>
<span id="cb499-6"><a href="#cb499-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Male.Line =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;MyoTS x Gcn2-IR&quot;</span>)),</span>
<span id="cb499-7"><a href="#cb499-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb499-8"><a href="#cb499-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb499-9"><a href="#cb499-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb499-10"><a href="#cb499-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb499-11"><a href="#cb499-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb499-12"><a href="#cb499-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)),</span>
<span id="cb499-13"><a href="#cb499-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Female.Line =</span> <span class="st">&quot;Myo&quot;</span>,</span>
<span id="cb499-14"><a href="#cb499-14" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Male.line =</span><span class="st">&quot;Gcn2-IR&quot;</span>)</span>
<span id="cb499-15"><a href="#cb499-15" aria-hidden="true" tabindex="-1"></a>tab_stat_myo<span class="ot">=</span>tab_stat</span>
<span id="cb499-16"><a href="#cb499-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-17"><a href="#cb499-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-18"><a href="#cb499-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-19"><a href="#cb499-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-20"><a href="#cb499-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-21"><a href="#cb499-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-22"><a href="#cb499-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-23"><a href="#cb499-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-24"><a href="#cb499-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Table making</span></span>
<span id="cb499-25"><a href="#cb499-25" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_esg,tab_stat_myo)</span>
<span id="cb499-26"><a href="#cb499-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-27"><a href="#cb499-27" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb499-28"><a href="#cb499-28" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb499-29"><a href="#cb499-29" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb499-30"><a href="#cb499-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-31"><a href="#cb499-31" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb499-32"><a href="#cb499-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Female.Line&quot;</span>,<span class="st">&quot;Male.Line&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb499-33"><a href="#cb499-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(PH3_positive_cell+1) ~  Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">11</span>))<span class="sc">%&gt;%</span></span>
<span id="cb499-34"><a href="#cb499-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="11">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(PH3_positive_cell+1) ~ Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Female.Line
</th>
<th style="text-align:left;">
Male.Line
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Control vs Gcn2-IR EsgTS
</td>
<td style="text-align:left;">
EsgTS x Gcn2-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2.45
</td>
<td style="text-align:left;">
2.04
</td>
<td style="text-align:left;">
0.354
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.2e-01
</td>
<td style="text-align:left;">
Esg
</td>
<td style="text-align:left;">
Gcn2-IR
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Control vs Gcn2-IR EsgTS
</td>
<td style="text-align:left;">
MyoTS x Gcn2-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
20.73
</td>
<td style="text-align:left;">
2.59
</td>
<td style="text-align:left;">
0.828
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5.3e-06
</td>
<td style="text-align:left;">
Myo
</td>
<td style="text-align:left;">
Gcn2-IR
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true" tabindex="-1"></a>tab_stat5S2G <span class="ot">=</span> tab_stat</span>
<span id="cb500-2"><a href="#cb500-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-3"><a href="#cb500-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-4"><a href="#cb500-4" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb500-5"><a href="#cb500-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-6"><a href="#cb500-6" aria-hidden="true" tabindex="-1"></a>tab_PH3_Translation1<span class="sc">$</span>Female.Line <span class="ot">=</span> <span class="fu">factor</span>(tab_PH3_Translation1<span class="sc">$</span>Female.Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Es&quot;</span>,g<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;My&quot;</span>,o<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))))</span>
<span id="cb500-7"><a href="#cb500-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-8"><a href="#cb500-8" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>Female.Line <span class="ot">=</span> tab_stat<span class="sc">$</span>Female.Line <span class="ot">=</span> <span class="fu">factor</span>(tab_stat<span class="sc">$</span>Female.Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Es&quot;</span>,g<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;My&quot;</span>,o<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))))</span>
<span id="cb500-9"><a href="#cb500-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-10"><a href="#cb500-10" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="sc">$</span>Female.Line <span class="ot">=</span> Sample_size<span class="sc">$</span>Female.Line <span class="ot">=</span> <span class="fu">factor</span>(Sample_size<span class="sc">$</span>Female.Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Es&quot;</span>,g<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))), <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;My&quot;</span>,o<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))))</span>
<span id="cb500-11"><a href="#cb500-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-12"><a href="#cb500-12" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">max</span>(tab_PH3_Translation1<span class="sc">$</span>PH3_positive_cell, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb500-13"><a href="#cb500-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-14"><a href="#cb500-14" aria-hidden="true" tabindex="-1"></a>Plot_Fig5S2G<span class="ot">=</span></span>
<span id="cb500-15"><a href="#cb500-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_PH3_Translation1, <span class="fu">aes</span>(<span class="at">x =</span> Male.Line, <span class="at">y =</span> PH3_positive_cell))<span class="sc">+</span> </span>
<span id="cb500-16"><a href="#cb500-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb500-17"><a href="#cb500-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb500-18"><a href="#cb500-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Male.Line, <span class="at">y =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb500-19"><a href="#cb500-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Female.Line, <span class="at">labeller =</span> label_parsed)<span class="sc">+</span></span>
<span id="cb500-20"><a href="#cb500-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="st">&quot;#FFE5E5&quot;</span>)<span class="sc">+</span></span>
<span id="cb500-21"><a href="#cb500-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb500-22"><a href="#cb500-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Gcn2-IR&quot;</span>),</span>
<span id="cb500-23"><a href="#cb500-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">&quot;Control&quot;</span>),<span class="fu">italic</span>(<span class="st">&quot;Gcn2-IR&quot;</span>))))<span class="sc">+</span></span>
<span id="cb500-24"><a href="#cb500-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;pH3&quot;</span> <span class="sc">^</span> <span class="st">&quot;+&quot;</span>, <span class="st">&quot; cells&quot;</span>)),</span>
<span id="cb500-25"><a href="#cb500-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">90</span>),</span>
<span id="cb500-26"><a href="#cb500-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">80</span>,<span class="at">by=</span><span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb500-27"><a href="#cb500-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb500-28"><a href="#cb500-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb500-29"><a href="#cb500-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb500-30"><a href="#cb500-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb500-31"><a href="#cb500-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb500-32"><a href="#cb500-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb500-33"><a href="#cb500-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb500-34"><a href="#cb500-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb500-35"><a href="#cb500-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb500-36"><a href="#cb500-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb500-37"><a href="#cb500-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb500-38"><a href="#cb500-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb500-39"><a href="#cb500-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb500-40"><a href="#cb500-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb500-41"><a href="#cb500-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb500-42"><a href="#cb500-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb500-43"><a href="#cb500-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb500-44"><a href="#cb500-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb500-45"><a href="#cb500-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb500-46"><a href="#cb500-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb500-47"><a href="#cb500-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb500-48"><a href="#cb500-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb500-49"><a href="#cb500-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb500-50"><a href="#cb500-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb500-51"><a href="#cb500-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb500-52"><a href="#cb500-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb500-53"><a href="#cb500-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb500-54"><a href="#cb500-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-55"><a href="#cb500-55" aria-hidden="true" tabindex="-1"></a>Plot_Fig5S2G</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%205S2G-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>##Export Figure 5S2</p>
</div>
</div>
</div>
<div id="figure-6.-the-midgut-can-resize-independently-of-stem-cell-proliferation" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> Figure 6. The midgut can resize independently of stem cell proliferation</h1>
<div id="figure-6---main" class="section level2" number="6.1">
<h2 number="6.1"><span class="header-section-number">6.1</span> Figure 6 - main</h2>
<div id="figure-6a" class="section level3" number="6.1.1">
<h3 number="6.1.1"><span class="header-section-number">6.1.1</span> Figure 6A</h3>
<div class="blue">
<p>Mitotic index does not correlate with midgut length. Quantification of pH3+ cells across a selected panel of high and low responder DGRP lines shows that midgut length does not correlate with cell proliferation.</p>
</div>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="#cb501-1" aria-hidden="true" tabindex="-1"></a>wolb <span class="ot">=</span> d[[<span class="st">&quot;DGRP_wolbachia_DFD&quot;</span>]]</span>
<span id="cb501-2"><a href="#cb501-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(wolb) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;dgrp.id&quot;</span>, <span class="st">&quot;wolbachia&quot;</span>)</span>
<span id="cb501-3"><a href="#cb501-3" aria-hidden="true" tabindex="-1"></a>wolb<span class="sc">$</span>dgrp.id <span class="ot">=</span> <span class="fu">gsub</span>(<span class="st">&quot;line_&quot;</span>, <span class="st">&quot;&quot;</span>, wolb<span class="sc">$</span>dgrp.id)</span>
<span id="cb501-4"><a href="#cb501-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-5"><a href="#cb501-5" aria-hidden="true" tabindex="-1"></a>tab_corr_length_cell_DGRP <span class="ot">=</span> <span class="fu">subset</span>(d[[<span class="st">&quot;6A - 7A&quot;</span>]]) </span>
<span id="cb501-6"><a href="#cb501-6" aria-hidden="true" tabindex="-1"></a>tab_corr_length_cell_DGRP <span class="ot">=</span> <span class="fu">merge</span>(tab_corr_length_cell_DGRP, wolb, <span class="at">by.x=</span><span class="st">&quot;DGRP.number&quot;</span>, <span class="at">by.y=</span><span class="st">&quot;dgrp.id&quot;</span>, <span class="at">all.x=</span>T, <span class="at">all.y=</span>F)</span>
<span id="cb501-7"><a href="#cb501-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_corr_length_cell_DGRP) <span class="ot">=</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(tab_corr_length_cell_DGRP))</span>
<span id="cb501-8"><a href="#cb501-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_corr_length_cell_DGRP)[<span class="dv">3</span>] <span class="ot">=</span> <span class="st">&quot;repl&quot;</span></span>
<span id="cb501-9"><a href="#cb501-9" aria-hidden="true" tabindex="-1"></a>tab_corr_length_cell_DGRP<span class="sc">$</span>dgrp.number <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(tab_corr_length_cell_DGRP<span class="sc">$</span>dgrp.number)</span>
<span id="cb501-10"><a href="#cb501-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-11"><a href="#cb501-11" aria-hidden="true" tabindex="-1"></a>tab_corr_length_cell_DGRP<span class="ot">=</span></span>
<span id="cb501-12"><a href="#cb501-12" aria-hidden="true" tabindex="-1"></a>  tab_corr_length_cell_DGRP<span class="sc">%&gt;%</span></span>
<span id="cb501-13"><a href="#cb501-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">ral=</span>dgrp.number,</span>
<span id="cb501-14"><a href="#cb501-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">len=</span>total.l,</span>
<span id="cb501-15"><a href="#cb501-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">ph3=</span>total.ph3,</span>
<span id="cb501-16"><a href="#cb501-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">ec.area=</span>area)<span class="sc">%&gt;%</span></span>
<span id="cb501-17"><a href="#cb501-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ral=</span><span class="fu">paste</span>(<span class="st">&quot;Ral&quot;</span>,ral,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb501-18"><a href="#cb501-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)</span>
<span id="cb501-19"><a href="#cb501-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-20"><a href="#cb501-20" aria-hidden="true" tabindex="-1"></a>gut_mean<span class="ot">=</span></span>
<span id="cb501-21"><a href="#cb501-21" aria-hidden="true" tabindex="-1"></a>  tab_corr_length_cell_DGRP <span class="sc">%&gt;%</span></span>
<span id="cb501-22"><a href="#cb501-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ral, diet,cross,gutnumber)<span class="sc">%&gt;%</span></span>
<span id="cb501-23"><a href="#cb501-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_gut_len=</span><span class="fu">mean</span>(len,<span class="at">na.rm=</span>T),</span>
<span id="cb501-24"><a href="#cb501-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_cell_size=</span><span class="fu">mean</span>(ec.area,<span class="at">na.rm=</span>T),</span>
<span id="cb501-25"><a href="#cb501-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_cell_size=</span><span class="fu">sd</span>(ec.area)<span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(ec.area[<span class="sc">!</span><span class="fu">is.na</span>(ec.area)])),</span>
<span id="cb501-26"><a href="#cb501-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_PH3=</span><span class="fu">mean</span>(ph3,<span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span></span>
<span id="cb501-27"><a href="#cb501-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Group=</span><span class="fu">paste</span>(cross,gutnumber,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>))</span>
<span id="cb501-28"><a href="#cb501-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-29"><a href="#cb501-29" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(gut_mean<span class="sc">$</span>ral) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Ral 356&quot;</span>, <span class="st">&quot;Ral 362&quot;</span>, <span class="st">&quot;Ral 370&quot;</span>, <span class="st">&quot;Ral 502&quot;</span>, <span class="st">&quot;Ral 765&quot;</span>, <span class="st">&quot;Ral 853&quot;</span>, <span class="st">&quot;Ral 911&quot;</span>)</span>
<span id="cb501-30"><a href="#cb501-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-31"><a href="#cb501-31" aria-hidden="true" tabindex="-1"></a>gut_mean<span class="sc">$</span>ral <span class="ot">&lt;-</span> <span class="fu">factor</span>(gut_mean<span class="sc">$</span>ral, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Ral 356&quot;</span>, <span class="st">&quot;Ral 502&quot;</span>, <span class="st">&quot;Ral 765&quot;</span>, <span class="st">&quot;Ral 853&quot;</span>, <span class="st">&quot;Ral 911&quot;</span>, <span class="st">&quot;Ral 362&quot;</span>, <span class="st">&quot;Ral 370&quot;</span>))</span>
<span id="cb501-32"><a href="#cb501-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-33"><a href="#cb501-33" aria-hidden="true" tabindex="-1"></a><span class="co"># stat over all</span></span>
<span id="cb501-34"><a href="#cb501-34" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log10</span>(<span class="fu">I</span>(mean_gut_len<span class="sc">/</span><span class="dv">1000</span>)) <span class="sc">~</span>  mean_PH3 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ral),<span class="at">data =</span> gut_mean)</span>
<span id="cb501-35"><a href="#cb501-35" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98787, p-value = 0.02606</code></pre>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log10</span>(<span class="fu">I</span>(mean_gut_len<span class="sc">/</span><span class="dv">1000</span>)) <span class="sc">~</span>  mean_PH3 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> ral),<span class="at">data =</span> gut_mean)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log10(I(mean_gut_len/1000)) ~ mean_PH3 + (1/ral)
BP = 0.085137, df = 1, p-value = 0.7705</code></pre>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="#cb505-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log10</span>(<span class="fu">I</span>(mean_gut_len<span class="sc">/</span><span class="dv">1000</span>)) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ral),<span class="at">data =</span>gut_mean)</span>
<span id="cb505-2"><a href="#cb505-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb505-3"><a href="#cb505-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb505-4"><a href="#cb505-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-5"><a href="#cb505-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;PH3 cell&quot;</span>)),</span>
<span id="cb505-6"><a href="#cb505-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Number_genotypes =</span> <span class="fu">nlevels</span>(gut_mean<span class="sc">$</span>ral),</span>
<span id="cb505-7"><a href="#cb505-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb505-8"><a href="#cb505-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb505-9"><a href="#cb505-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb505-10"><a href="#cb505-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb505-11"><a href="#cb505-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb505-12"><a href="#cb505-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-13"><a href="#cb505-13" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb505-14"><a href="#cb505-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb505-15"><a href="#cb505-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb505-16"><a href="#cb505-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-17"><a href="#cb505-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb505-18"><a href="#cb505-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log10(I(mean_gut_len/1000)) ~  mean_PH3 + (1 | Genotype)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb505-19"><a href="#cb505-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log10(I(mean_gut_len/1000)) ~ mean_PH3 + (1 | Genotype)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PH3 cell
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
12.04
</td>
<td style="text-align:left;">
0.715
</td>
<td style="text-align:left;">
-0.00121
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.00052
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="co">#stat per line</span></span>
<span id="cb506-2"><a href="#cb506-2" aria-hidden="true" tabindex="-1"></a>Cor_PH3<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb506-3"><a href="#cb506-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">unique</span>(gut_mean<span class="sc">$</span>ral)){</span>
<span id="cb506-4"><a href="#cb506-4" aria-hidden="true" tabindex="-1"></a>   <span class="co">#print(i)</span></span>
<span id="cb506-5"><a href="#cb506-5" aria-hidden="true" tabindex="-1"></a>cor_PH3_HS<span class="ot">=</span></span>
<span id="cb506-6"><a href="#cb506-6" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(<span class="fu">subset</span>(gut_mean,ral<span class="sc">==</span>i<span class="sc">&amp;</span> diet<span class="sc">==</span><span class="st">&quot;HS&quot;</span>),</span>
<span id="cb506-7"><a href="#cb506-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="fu">log</span>(mean_gut_len,<span class="dv">10</span>),mean_PH3))</span>
<span id="cb506-8"><a href="#cb506-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-9"><a href="#cb506-9" aria-hidden="true" tabindex="-1"></a>cor_PH3_HY<span class="ot">=</span></span>
<span id="cb506-10"><a href="#cb506-10" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(<span class="fu">subset</span>(gut_mean,ral<span class="sc">==</span>i<span class="sc">&amp;</span> diet<span class="sc">==</span><span class="st">&quot;HY&quot;</span>),</span>
<span id="cb506-11"><a href="#cb506-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">cor.test</span>(<span class="fu">log</span>(mean_gut_len,<span class="dv">10</span>),mean_PH3))</span>
<span id="cb506-12"><a href="#cb506-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-13"><a href="#cb506-13" aria-hidden="true" tabindex="-1"></a>Cor_PH3_tmp <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">ral =</span> <span class="fu">as.character</span>(i),</span>
<span id="cb506-14"><a href="#cb506-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">diet=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb506-15"><a href="#cb506-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Cor =</span> <span class="fu">c</span>(<span class="fu">format</span>(<span class="fu">as.numeric</span>(cor_PH3_HS<span class="sc">$</span>estimate), <span class="at">digits =</span> <span class="dv">2</span>),<span class="fu">format</span>(<span class="fu">as.numeric</span>(cor_PH3_HY<span class="sc">$</span>estimate), <span class="at">digits =</span> <span class="dv">2</span>)),</span>
<span id="cb506-16"><a href="#cb506-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">c</span>(<span class="fu">format</span>(<span class="fu">as.numeric</span>(cor_PH3_HS<span class="sc">$</span>p.value), <span class="at">digits =</span> <span class="dv">2</span>),<span class="fu">format</span>(<span class="fu">as.numeric</span>(cor_PH3_HY<span class="sc">$</span>p.value), <span class="at">digits =</span> <span class="dv">2</span>)))</span>
<span id="cb506-17"><a href="#cb506-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-18"><a href="#cb506-18" aria-hidden="true" tabindex="-1"></a>Cor_PH3<span class="ot">=</span> <span class="fu">rbind</span>(Cor_PH3,Cor_PH3_tmp)</span>
<span id="cb506-19"><a href="#cb506-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb506-20"><a href="#cb506-20" aria-hidden="true" tabindex="-1"></a>Cor_PH3<span class="sc">$</span>padj<span class="ot">=</span><span class="fu">p.adjust</span>(Cor_PH3<span class="sc">$</span>Pvalue,<span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb506-21"><a href="#cb506-21" aria-hidden="true" tabindex="-1"></a>Cor_PH3<span class="sc">$</span>sig<span class="ot">=</span> <span class="fu">ifelse</span>(Cor_PH3<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> Cor_PH3<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb506-22"><a href="#cb506-22" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(Cor_PH3<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> Cor_PH3<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb506-23"><a href="#cb506-23" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(Cor_PH3<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;ns&quot;</span>)))</span>
<span id="cb506-24"><a href="#cb506-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-25"><a href="#cb506-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-26"><a href="#cb506-26" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">=</span><span class="fu">subset</span>(gut_mean,diet<span class="sc">==</span><span class="st">&quot;HS&quot;</span>)</span>
<span id="cb506-27"><a href="#cb506-27" aria-hidden="true" tabindex="-1"></a>stat_position_HS <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span>tmp,mean_gut_len<span class="sc">/</span><span class="dv">1000</span> <span class="sc">~</span>  ral, max)</span>
<span id="cb506-28"><a href="#cb506-28" aria-hidden="true" tabindex="-1"></a>stat_position_HS<span class="sc">$</span>diet<span class="ot">=</span><span class="st">&quot;HS&quot;</span></span>
<span id="cb506-29"><a href="#cb506-29" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">=</span><span class="fu">subset</span>(gut_mean,diet<span class="sc">==</span><span class="st">&quot;HY&quot;</span>)</span>
<span id="cb506-30"><a href="#cb506-30" aria-hidden="true" tabindex="-1"></a>stat_position_HY <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span>tmp,mean_gut_len<span class="sc">/</span><span class="dv">1000</span> <span class="sc">~</span>  ral, max)</span>
<span id="cb506-31"><a href="#cb506-31" aria-hidden="true" tabindex="-1"></a>stat_position_HY<span class="sc">$</span>diet<span class="ot">=</span><span class="st">&quot;HY&quot;</span></span>
<span id="cb506-32"><a href="#cb506-32" aria-hidden="true" tabindex="-1"></a>stat_position<span class="ot">=</span><span class="fu">rbind</span>(stat_position_HS,stat_position_HY)</span>
<span id="cb506-33"><a href="#cb506-33" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(stat_position)[<span class="dv">2</span>]<span class="ot">=</span><span class="st">&quot;Stat_position&quot;</span></span>
<span id="cb506-34"><a href="#cb506-34" aria-hidden="true" tabindex="-1"></a>Cor_PH3 <span class="ot">=</span> <span class="fu">left_join</span>(Cor_PH3,stat_position)</span>
<span id="cb506-35"><a href="#cb506-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-36"><a href="#cb506-36" aria-hidden="true" tabindex="-1"></a>gut_mean<span class="sc">$</span>ral <span class="ot">&lt;-</span> <span class="fu">factor</span>(gut_mean<span class="sc">$</span>ral, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Ral 356&quot;</span>, <span class="st">&quot;Ral 502&quot;</span>, <span class="st">&quot;Ral 765&quot;</span>, <span class="st">&quot;Ral 853&quot;</span>, <span class="st">&quot;Ral 911&quot;</span>, <span class="st">&quot;Ral 362&quot;</span>, <span class="st">&quot;Ral 370&quot;</span>))</span>
<span id="cb506-37"><a href="#cb506-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-38"><a href="#cb506-38" aria-hidden="true" tabindex="-1"></a>Cor_PH3<span class="sc">$</span>ral <span class="ot">&lt;-</span> <span class="fu">factor</span>(Cor_PH3<span class="sc">$</span>ral, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Ral 356&quot;</span>, <span class="st">&quot;Ral 502&quot;</span>, <span class="st">&quot;Ral 765&quot;</span>, <span class="st">&quot;Ral 853&quot;</span>, <span class="st">&quot;Ral 911&quot;</span>, <span class="st">&quot;Ral 362&quot;</span>, <span class="st">&quot;Ral 370&quot;</span>))</span>
<span id="cb506-39"><a href="#cb506-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-40"><a href="#cb506-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-41"><a href="#cb506-41" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb506-42"><a href="#cb506-42" aria-hidden="true" tabindex="-1"></a>  gut_mean<span class="sc">%&gt;%</span></span>
<span id="cb506-43"><a href="#cb506-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(diet, ral)<span class="sc">%&gt;%</span></span>
<span id="cb506-44"><a href="#cb506-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb506-45"><a href="#cb506-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb506-46"><a href="#cb506-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ral=</span><span class="fu">fct_relevel</span>(ral,<span class="st">&quot;Ral 356&quot;</span>, <span class="st">&quot;Ral 502&quot;</span>, <span class="st">&quot;Ral 765&quot;</span>, <span class="st">&quot;Ral 853&quot;</span>, <span class="st">&quot;Ral 911&quot;</span>, <span class="st">&quot;Ral 362&quot;</span>, <span class="st">&quot;Ral 370&quot;</span>))</span>
<span id="cb506-47"><a href="#cb506-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-48"><a href="#cb506-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-49"><a href="#cb506-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-50"><a href="#cb506-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-51"><a href="#cb506-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-52"><a href="#cb506-52" aria-hidden="true" tabindex="-1"></a>cor_gut_PH3<span class="ot">=</span></span>
<span id="cb506-53"><a href="#cb506-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(gut_mean,<span class="fu">aes</span>(<span class="at">x=</span>mean_PH3, <span class="at">y=</span>mean_gut_len<span class="sc">/</span><span class="dv">1000</span>,<span class="at">group=</span>ral))<span class="sc">+</span> </span>
<span id="cb506-54"><a href="#cb506-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>diet,<span class="at">fill=</span>diet),<span class="at">shape=</span><span class="dv">21</span>,<span class="at">size=</span><span class="fl">0.9</span>)<span class="sc">+</span></span>
<span id="cb506-55"><a href="#cb506-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">35</span>, <span class="at">y =</span> <span class="fl">2.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb506-56"><a href="#cb506-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Cor_PH3, <span class="at">mapping =</span> <span class="fu">aes</span>( <span class="at">x=</span><span class="dv">60</span>,<span class="at">y=</span><span class="dv">7</span>,<span class="at">label =</span> sig),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb506-57"><a href="#cb506-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ral<span class="sc">~</span>diet)<span class="sc">+</span></span>
<span id="cb506-58"><a href="#cb506-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>)<span class="sc">+</span></span>
<span id="cb506-59"><a href="#cb506-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;pH3&quot;</span> <span class="sc">^</span> <span class="st">&quot;+&quot;</span>, <span class="st">&quot; cells&quot;</span>)))<span class="sc">+</span></span>
<span id="cb506-60"><a href="#cb506-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb506-61"><a href="#cb506-61" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb506-62"><a href="#cb506-62" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span>palette_diet_2)<span class="sc">+</span></span>
<span id="cb506-63"><a href="#cb506-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb506-64"><a href="#cb506-64" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb506-65"><a href="#cb506-65" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>palette_diet_2)<span class="sc">+</span></span>
<span id="cb506-66"><a href="#cb506-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb506-67"><a href="#cb506-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb506-68"><a href="#cb506-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Mediumfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb506-69"><a href="#cb506-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Mediumfont),</span>
<span id="cb506-70"><a href="#cb506-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb506-71"><a href="#cb506-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb506-72"><a href="#cb506-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(),</span>
<span id="cb506-73"><a href="#cb506-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(),</span>
<span id="cb506-74"><a href="#cb506-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb506-75"><a href="#cb506-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb506-76"><a href="#cb506-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb506-77"><a href="#cb506-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb506-78"><a href="#cb506-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb506-79"><a href="#cb506-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb506-80"><a href="#cb506-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb506-81"><a href="#cb506-81" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb506-82"><a href="#cb506-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb506-83"><a href="#cb506-83" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb506-84"><a href="#cb506-84" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb506-85"><a href="#cb506-85" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb506-86"><a href="#cb506-86" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>,</span>
<span id="cb506-87"><a href="#cb506-87" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb506-88"><a href="#cb506-88" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb506-89"><a href="#cb506-89" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont),</span>
<span id="cb506-90"><a href="#cb506-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb506-91"><a href="#cb506-91" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;transparent&quot;</span>))<span class="sc">+</span></span>
<span id="cb506-92"><a href="#cb506-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">1</span>),</span>
<span id="cb506-93"><a href="#cb506-93" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">1</span>),</span>
<span id="cb506-94"><a href="#cb506-94" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb506-95"><a href="#cb506-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-96"><a href="#cb506-96" aria-hidden="true" tabindex="-1"></a>cor_gut_PH3</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%206A-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-6b-c" class="section level3" number="6.1.2">
<h3 number="6.1.2"><span class="header-section-number">6.1.2</span> Figure 6B-C</h3>
<div class="blue">
<p>Blocking EGF signaling with UAS-Egfr-IR in progenitor cells (B, right) results in progenitor cells being almost wiped out compared to control (C, left).<em>Complete graphical annotation can be found in manuscript figures</em></p>
</div>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="#cb507-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/6B.jpg&quot;</span>) </span>
<span id="cb507-2"><a href="#cb507-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig6B <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb507-3"><a href="#cb507-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig6B)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%206B-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/6C.jpg&quot;</span>) </span>
<span id="cb508-2"><a href="#cb508-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig6C <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb508-3"><a href="#cb508-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig6C)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%206C-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="figure-6d" class="section level3" number="6.1.3">
<h3 number="6.1.3"><span class="header-section-number">6.1.3</span> Figure 6D</h3>
<div class="blue">
<p>pH3+ counts for EsgTS&gt;Control vs EsgTS&gt; EGFR-IR</p>
</div>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="#cb509-1" aria-hidden="true" tabindex="-1"></a>tab_PH3_esg <span class="ot">=</span> </span>
<span id="cb509-2"><a href="#cb509-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;6D&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb509-3"><a href="#cb509-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb509-4"><a href="#cb509-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PH3_positive_cell=</span>Total.PH3,</span>
<span id="cb509-5"><a href="#cb509-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Day_of_treatment=</span>Day)</span>
<span id="cb509-6"><a href="#cb509-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-7"><a href="#cb509-7" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb509-8"><a href="#cb509-8" aria-hidden="true" tabindex="-1"></a>  tab_PH3_esg<span class="sc">%&gt;%</span></span>
<span id="cb509-9"><a href="#cb509-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb509-10"><a href="#cb509-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb509-11"><a href="#cb509-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-12"><a href="#cb509-12" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb509-13"><a href="#cb509-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-14"><a href="#cb509-14" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(PH3_positive_cell <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(tab_PH3_esg,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell)))</span>
<span id="cb509-15"><a href="#cb509-15" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.90554, p-value = 0.006445</code></pre>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(PH3_positive_cell <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(tab_PH3_esg,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell)))</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  PH3_positive_cell ~ Male.Line + (1/Repeat)
BP = 8.6215, df = 1, p-value = 0.003322</code></pre>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="#cb513-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(PH3_positive_cell <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(tab_PH3_esg,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell)))</span>
<span id="cb513-2"><a href="#cb513-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb513-3"><a href="#cb513-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb513-4"><a href="#cb513-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-5"><a href="#cb513-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control vs Egfr-IR&quot;</span>)),</span>
<span id="cb513-6"><a href="#cb513-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_PH3_esg<span class="sc">$</span>Repeat),</span>
<span id="cb513-7"><a href="#cb513-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb513-8"><a href="#cb513-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb513-9"><a href="#cb513-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb513-10"><a href="#cb513-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb513-11"><a href="#cb513-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb513-12"><a href="#cb513-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-13"><a href="#cb513-13" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb513-14"><a href="#cb513-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb513-15"><a href="#cb513-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb513-16"><a href="#cb513-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-17"><a href="#cb513-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb513-18"><a href="#cb513-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;PH3_positive_cell ~  Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb513-19"><a href="#cb513-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
PH3_positive_cell ~ Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Control vs Egfr-IR
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
20.45
</td>
<td style="text-align:left;">
7.21
</td>
<td style="text-align:left;">
-6.63
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6.1e-06
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb514-2"><a href="#cb514-2" aria-hidden="true" tabindex="-1"></a>tab_PH3_esg<span class="sc">$</span>Female.Line <span class="ot">=</span> <span class="fu">factor</span>(tab_PH3_esg<span class="sc">$</span>Female.Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Es&quot;</span>,g<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))))</span>
<span id="cb514-3"><a href="#cb514-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb514-4"><a href="#cb514-4" aria-hidden="true" tabindex="-1"></a>Plot_Fig6D<span class="ot">=</span></span>
<span id="cb514-5"><a href="#cb514-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_PH3_esg, <span class="fu">aes</span>(<span class="at">x =</span> Male.Line, <span class="at">y =</span> PH3_positive_cell))<span class="sc">+</span> </span>
<span id="cb514-6"><a href="#cb514-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb514-7"><a href="#cb514-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb514-8"><a href="#cb514-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Male.Line, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.8</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb514-9"><a href="#cb514-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_signif</span>(<span class="at">data =</span> tab_stat,<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">annotations =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">y_position =</span> <span class="fl">8.5</span>), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">manual =</span> <span class="cn">TRUE</span>, <span class="at">tip_length =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>))<span class="sc">+</span></span>
<span id="cb514-10"><a href="#cb514-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb514-11"><a href="#cb514-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Female.Line, <span class="at">labeller =</span> label_parsed)<span class="sc">+</span></span>
<span id="cb514-12"><a href="#cb514-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="st">&quot;#E5E5FF&quot;</span>)<span class="sc">+</span></span>
<span id="cb514-13"><a href="#cb514-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb514-14"><a href="#cb514-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;Cs&quot;</span>,<span class="st">&quot;Egfr-IR&quot;</span>),</span>
<span id="cb514-15"><a href="#cb514-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Egfr-IR&quot;</span>))<span class="sc">+</span></span>
<span id="cb514-16"><a href="#cb514-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;pH3&quot;</span> <span class="sc">^</span> <span class="st">&quot;+&quot;</span>, <span class="st">&quot; cells&quot;</span>)),</span>
<span id="cb514-17"><a href="#cb514-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">9</span>),</span>
<span id="cb514-18"><a href="#cb514-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb514-19"><a href="#cb514-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb514-20"><a href="#cb514-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb514-21"><a href="#cb514-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb514-22"><a href="#cb514-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb514-23"><a href="#cb514-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb514-24"><a href="#cb514-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb514-25"><a href="#cb514-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb514-26"><a href="#cb514-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb514-27"><a href="#cb514-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb514-28"><a href="#cb514-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb514-29"><a href="#cb514-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb514-30"><a href="#cb514-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb514-31"><a href="#cb514-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb514-32"><a href="#cb514-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb514-33"><a href="#cb514-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb514-34"><a href="#cb514-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb514-35"><a href="#cb514-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb514-36"><a href="#cb514-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb514-37"><a href="#cb514-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb514-38"><a href="#cb514-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb514-39"><a href="#cb514-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb514-40"><a href="#cb514-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb514-41"><a href="#cb514-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb514-42"><a href="#cb514-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb514-43"><a href="#cb514-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb514-44"><a href="#cb514-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb514-45"><a href="#cb514-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb514-46"><a href="#cb514-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb514-47"><a href="#cb514-47" aria-hidden="true" tabindex="-1"></a>Plot_Fig6D</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%206D-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-6e" class="section level3" number="6.1.4">
<h3 number="6.1.4"><span class="header-section-number">6.1.4</span> Figure 6E</h3>
<div class="blue">
<p>EsgTS&gt;UAS-Egfr-IR midguts are still able to reach a similar length to controls.</p>
</div>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="#cb515-1" aria-hidden="true" tabindex="-1"></a>tab_length_esg <span class="ot">=</span> </span>
<span id="cb515-2"><a href="#cb515-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;6E&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb515-3"><a href="#cb515-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb515-4"><a href="#cb515-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm=</span>Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb515-5"><a href="#cb515-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_treatment=</span>Day,</span>
<span id="cb515-6"><a href="#cb515-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Female_Line=</span>Female.Line,</span>
<span id="cb515-7"><a href="#cb515-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Male_Line=</span>Male.Line)</span>
<span id="cb515-8"><a href="#cb515-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb515-9"><a href="#cb515-9" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb515-10"><a href="#cb515-10" aria-hidden="true" tabindex="-1"></a>  tab_length_esg<span class="sc">%&gt;%</span></span>
<span id="cb515-11"><a href="#cb515-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Male_Line)<span class="sc">%&gt;%</span></span>
<span id="cb515-12"><a href="#cb515-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb515-13"><a href="#cb515-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb515-14"><a href="#cb515-14" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb515-15"><a href="#cb515-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb515-16"><a href="#cb515-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">*</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tab_length_esg)</span>
<span id="cb515-17"><a href="#cb515-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98514, p-value = 0.2025</code></pre>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tab_length_esg)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + Male_Line + (1/Repeat)
BP = 8.7188, df = 2, p-value = 0.01279</code></pre>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="#cb519-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tab_length_esg)</span>
<span id="cb519-2"><a href="#cb519-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb519-3"><a href="#cb519-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb519-4"><a href="#cb519-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-5"><a href="#cb519-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-6"><a href="#cb519-6" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control vs Egfr-IR&quot;</span>)),</span>
<span id="cb519-7"><a href="#cb519-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_length_esg<span class="sc">$</span>Repeat),</span>
<span id="cb519-8"><a href="#cb519-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb519-9"><a href="#cb519-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb519-10"><a href="#cb519-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb519-11"><a href="#cb519-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb519-12"><a href="#cb519-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb519-13"><a href="#cb519-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-14"><a href="#cb519-14" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb519-15"><a href="#cb519-15" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb519-16"><a href="#cb519-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb519-17"><a href="#cb519-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-18"><a href="#cb519-18" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb519-19"><a href="#cb519-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + Genotype + Diet : Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb519-20"><a href="#cb519-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + Genotype + Diet : Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Control vs Egfr-IR
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:left;">
1.51
</td>
<td style="text-align:left;">
0.375
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true" tabindex="-1"></a>tab_stat_6E<span class="ot">=</span>tab_stat</span>
<span id="cb520-2"><a href="#cb520-2" aria-hidden="true" tabindex="-1"></a>tab_stat_6E<span class="sc">$</span>Male_Line<span class="ot">=</span><span class="st">&quot;Egfr-IR&quot;</span></span>
<span id="cb520-3"><a href="#cb520-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-4"><a href="#cb520-4" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb520-5"><a href="#cb520-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-6"><a href="#cb520-6" aria-hidden="true" tabindex="-1"></a>tab_length_esg<span class="sc">$</span>Female_Line <span class="ot">=</span> <span class="fu">factor</span>(tab_length_esg<span class="sc">$</span>Female_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Es&quot;</span>,g<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))))</span>
<span id="cb520-7"><a href="#cb520-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-8"><a href="#cb520-8" aria-hidden="true" tabindex="-1"></a>Plot_Fig6E<span class="ot">=</span></span>
<span id="cb520-9"><a href="#cb520-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_length_esg, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb520-10"><a href="#cb520-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb520-11"><a href="#cb520-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb520-12"><a href="#cb520-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">2.4</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb520-13"><a href="#cb520-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>,<span class="fu">aes</span>(<span class="at">group=</span>Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb520-14"><a href="#cb520-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb520-15"><a href="#cb520-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb520-16"><a href="#cb520-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb520-17"><a href="#cb520-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb520-18"><a href="#cb520-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Male_Line)<span class="sc">+</span></span>
<span id="cb520-19"><a href="#cb520-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>cbbHS_HStoHY)<span class="sc">+</span></span>
<span id="cb520-20"><a href="#cb520-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb520-21"><a href="#cb520-21" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS D0&quot;</span>,<span class="st">&quot;HStoHY D7&quot;</span>),</span>
<span id="cb520-22"><a href="#cb520-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HS to HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb520-23"><a href="#cb520-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb520-24"><a href="#cb520-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">9</span>),</span>
<span id="cb520-25"><a href="#cb520-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb520-26"><a href="#cb520-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb520-27"><a href="#cb520-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb520-28"><a href="#cb520-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb520-29"><a href="#cb520-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb520-30"><a href="#cb520-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb520-31"><a href="#cb520-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb520-32"><a href="#cb520-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb520-33"><a href="#cb520-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb520-34"><a href="#cb520-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb520-35"><a href="#cb520-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb520-36"><a href="#cb520-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb520-37"><a href="#cb520-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb520-38"><a href="#cb520-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb520-39"><a href="#cb520-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb520-40"><a href="#cb520-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb520-41"><a href="#cb520-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb520-42"><a href="#cb520-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb520-43"><a href="#cb520-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb520-44"><a href="#cb520-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb520-45"><a href="#cb520-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb520-46"><a href="#cb520-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb520-47"><a href="#cb520-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb520-48"><a href="#cb520-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb520-49"><a href="#cb520-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb520-50"><a href="#cb520-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb520-51"><a href="#cb520-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-52"><a href="#cb520-52" aria-hidden="true" tabindex="-1"></a>Plot_Fig6E</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%206E-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-6f" class="section level3" number="6.1.5">
<h3 number="6.1.5"><span class="header-section-number">6.1.5</span> Figure 6F</h3>
<div class="blue">
<p>Insulin signaling with a dominant negative construct in progenitor cells results in less proliferation</p>
</div>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="#cb521-1" aria-hidden="true" tabindex="-1"></a>tab_PH3_InR <span class="ot">=</span> </span>
<span id="cb521-2"><a href="#cb521-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;6F&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb521-3"><a href="#cb521-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb521-4"><a href="#cb521-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">PH3_positive_cell=</span>Total.PH3,</span>
<span id="cb521-5"><a href="#cb521-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Day_of_treatment=</span>Day)<span class="sc">%&gt;%</span></span>
<span id="cb521-6"><a href="#cb521-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb521-7"><a href="#cb521-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Male.Line=</span><span class="fu">fct_relevel</span>(Male.Line,<span class="fu">c</span>(<span class="st">&quot;wdah&quot;</span>,<span class="st">&quot;InR-DN&quot;</span>)))</span>
<span id="cb521-8"><a href="#cb521-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-9"><a href="#cb521-9" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb521-10"><a href="#cb521-10" aria-hidden="true" tabindex="-1"></a>  tab_PH3_InR<span class="sc">%&gt;%</span></span>
<span id="cb521-11"><a href="#cb521-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb521-12"><a href="#cb521-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb521-13"><a href="#cb521-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-14"><a href="#cb521-14" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb521-15"><a href="#cb521-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-16"><a href="#cb521-16" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(PH3_positive_cell <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(tab_PH3_InR,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell)))</span>
<span id="cb521-17"><a href="#cb521-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.87431, p-value = 0.002092</code></pre>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(PH3_positive_cell <span class="sc">~</span>  Male.Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(tab_PH3_InR,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell)))</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  PH3_positive_cell ~ Male.Line + (1/Repeat)
BP = 5.6857, df = 1, p-value = 0.0171</code></pre>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="#cb525-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(PH3_positive_cell <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> <span class="fu">subset</span>(tab_PH3_InR,<span class="sc">!</span><span class="fu">is.na</span>(PH3_positive_cell)))</span>
<span id="cb525-2"><a href="#cb525-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb525-3"><a href="#cb525-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb525-4"><a href="#cb525-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-5"><a href="#cb525-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control vs InR-DN&quot;</span>)),</span>
<span id="cb525-6"><a href="#cb525-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_PH3_InR<span class="sc">$</span>Repeat),</span>
<span id="cb525-7"><a href="#cb525-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb525-8"><a href="#cb525-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb525-9"><a href="#cb525-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb525-10"><a href="#cb525-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb525-11"><a href="#cb525-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb525-12"><a href="#cb525-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-13"><a href="#cb525-13" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb525-14"><a href="#cb525-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb525-15"><a href="#cb525-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb525-16"><a href="#cb525-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-17"><a href="#cb525-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb525-18"><a href="#cb525-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;PH3_positive_cell ~  Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb525-19"><a href="#cb525-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
PH3_positive_cell ~ Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Control vs InR-DN
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
6.79
</td>
<td style="text-align:left;">
-5.85
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.00018
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb526-2"><a href="#cb526-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-3"><a href="#cb526-3" aria-hidden="true" tabindex="-1"></a>tab_PH3_InR<span class="sc">$</span>Female.Line <span class="ot">=</span> <span class="fu">factor</span>(tab_PH3_InR<span class="sc">$</span>Female.Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;Es&quot;</span>,g<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))))</span>
<span id="cb526-4"><a href="#cb526-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-5"><a href="#cb526-5" aria-hidden="true" tabindex="-1"></a>Plot_Fig6F<span class="ot">=</span></span>
<span id="cb526-6"><a href="#cb526-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_PH3_InR, <span class="fu">aes</span>(<span class="at">x =</span> Male.Line, <span class="at">y =</span> PH3_positive_cell))<span class="sc">+</span> </span>
<span id="cb526-7"><a href="#cb526-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb526-8"><a href="#cb526-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb526-9"><a href="#cb526-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Male.Line, <span class="at">y =</span> <span class="sc">-</span><span class="fl">1.2</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb526-10"><a href="#cb526-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_signif</span>(<span class="at">data =</span> tab_stat,<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">annotations =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">y_position =</span> <span class="dv">16</span>), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">manual =</span> <span class="cn">TRUE</span>, <span class="at">tip_length =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>))<span class="sc">+</span></span>
<span id="cb526-11"><a href="#cb526-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-12"><a href="#cb526-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Female.Line, <span class="at">labeller =</span> label_parsed)<span class="sc">+</span></span>
<span id="cb526-13"><a href="#cb526-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="st">&quot;#E5E5FF&quot;</span>)<span class="sc">+</span></span>
<span id="cb526-14"><a href="#cb526-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb526-15"><a href="#cb526-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;wdah&quot;</span>,<span class="st">&quot;InR-DN&quot;</span>),</span>
<span id="cb526-16"><a href="#cb526-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;InR-DN&quot;</span>))<span class="sc">+</span></span>
<span id="cb526-17"><a href="#cb526-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;pH3&quot;</span> <span class="sc">^</span> <span class="st">&quot;+&quot;</span>, <span class="st">&quot; cells&quot;</span>)),</span>
<span id="cb526-18"><a href="#cb526-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.4</span>,<span class="dv">21</span>),</span>
<span id="cb526-19"><a href="#cb526-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="at">by=</span><span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb526-20"><a href="#cb526-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb526-21"><a href="#cb526-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb526-22"><a href="#cb526-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb526-23"><a href="#cb526-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb526-24"><a href="#cb526-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb526-25"><a href="#cb526-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb526-26"><a href="#cb526-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="sc">-</span><span class="fl">0.15</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>)), </span>
<span id="cb526-27"><a href="#cb526-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb526-28"><a href="#cb526-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb526-29"><a href="#cb526-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb526-30"><a href="#cb526-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb526-31"><a href="#cb526-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>, <span class="at">face=</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb526-32"><a href="#cb526-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb526-33"><a href="#cb526-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb526-34"><a href="#cb526-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb526-35"><a href="#cb526-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb526-36"><a href="#cb526-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb526-37"><a href="#cb526-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb526-38"><a href="#cb526-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb526-39"><a href="#cb526-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb526-40"><a href="#cb526-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb526-41"><a href="#cb526-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb526-42"><a href="#cb526-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb526-43"><a href="#cb526-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb526-44"><a href="#cb526-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb526-45"><a href="#cb526-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb526-46"><a href="#cb526-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb526-47"><a href="#cb526-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-48"><a href="#cb526-48" aria-hidden="true" tabindex="-1"></a>Plot_Fig6F</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%206F-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-6g" class="section level3" number="6.1.6">
<h3 number="6.1.6"><span class="header-section-number">6.1.6</span> Figure 6G</h3>
<div class="blue">
<p>EsgTS&gt;UAS-InR-DN resulting in the same midgut length growth as the control. Statistical comparison for G is for the interaction between diet and genotype.</p>
</div>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="#cb527-1" aria-hidden="true" tabindex="-1"></a>tab_length_InDN <span class="ot">=</span> </span>
<span id="cb527-2"><a href="#cb527-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(d[[<span class="st">&quot;6G&quot;</span>]],Diet<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">&quot;HS D0&quot;</span>,<span class="st">&quot;HStoHY D7&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb527-3"><a href="#cb527-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb527-4"><a href="#cb527-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm=</span>Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb527-5"><a href="#cb527-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_treatment=</span>Day,</span>
<span id="cb527-6"><a href="#cb527-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Female_Line=</span>Female.Line,</span>
<span id="cb527-7"><a href="#cb527-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Male_Line=</span>Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb527-8"><a href="#cb527-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb527-9"><a href="#cb527-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Male_Line=</span><span class="fu">fct_relevel</span>(Male_Line,<span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;InR-DN&quot;</span>)))</span>
<span id="cb527-10"><a href="#cb527-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-11"><a href="#cb527-11" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb527-12"><a href="#cb527-12" aria-hidden="true" tabindex="-1"></a>  tab_length_InDN<span class="sc">%&gt;%</span></span>
<span id="cb527-13"><a href="#cb527-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Male_Line)<span class="sc">%&gt;%</span></span>
<span id="cb527-14"><a href="#cb527-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb527-15"><a href="#cb527-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-16"><a href="#cb527-16" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb527-17"><a href="#cb527-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-18"><a href="#cb527-18" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">*</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> PhaseRep),<span class="at">data =</span> tab_length_InDN)</span>
<span id="cb527-19"><a href="#cb527-19" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.9894, p-value = 0.1608</code></pre>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="#cb529-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> PhaseRep),<span class="at">data =</span> tab_length_InDN)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + Male_Line + (1/PhaseRep)
BP = 3.8117, df = 2, p-value = 0.1487</code></pre>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="#cb531-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> PhaseRep),<span class="at">data =</span> tab_length_InDN)</span>
<span id="cb531-2"><a href="#cb531-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb531-3"><a href="#cb531-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb531-4"><a href="#cb531-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-5"><a href="#cb531-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Control vs InR-DN&quot;</span>)),</span>
<span id="cb531-6"><a href="#cb531-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_PH3_esg<span class="sc">$</span>Repeat),</span>
<span id="cb531-7"><a href="#cb531-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb531-8"><a href="#cb531-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb531-9"><a href="#cb531-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb531-10"><a href="#cb531-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb531-11"><a href="#cb531-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb531-12"><a href="#cb531-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-13"><a href="#cb531-13" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb531-14"><a href="#cb531-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb531-15"><a href="#cb531-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb531-16"><a href="#cb531-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-17"><a href="#cb531-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb531-18"><a href="#cb531-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_length_mm) ~  Diet + Genotype + Diet : Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb531-19"><a href="#cb531-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_length_mm) ~ Diet + Genotype + Diet : Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Control vs InR-DN
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:left;">
1.53
</td>
<td style="text-align:left;">
0.249
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>Male_Line<span class="ot">=</span><span class="st">&quot;InR-DN&quot;</span></span>
<span id="cb532-2"><a href="#cb532-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-3"><a href="#cb532-3" aria-hidden="true" tabindex="-1"></a>tab_stat6G <span class="ot">=</span> tab_stat</span>
<span id="cb532-4"><a href="#cb532-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-5"><a href="#cb532-5" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb532-6"><a href="#cb532-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-7"><a href="#cb532-7" aria-hidden="true" tabindex="-1"></a>tab_length_InDN<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="fu">factor</span>(tab_length_InDN<span class="sc">$</span>Male_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;InR-DN&quot;</span>))</span>
<span id="cb532-8"><a href="#cb532-8" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="fu">factor</span>(Sample_size<span class="sc">$</span>Male_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;InR-DN&quot;</span>))</span>
<span id="cb532-9"><a href="#cb532-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-10"><a href="#cb532-10" aria-hidden="true" tabindex="-1"></a>Plot_Fig6G<span class="ot">=</span></span>
<span id="cb532-11"><a href="#cb532-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_length_InDN, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb532-12"><a href="#cb532-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb532-13"><a href="#cb532-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb532-14"><a href="#cb532-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">2.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb532-15"><a href="#cb532-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Male_Line)<span class="sc">+</span></span>
<span id="cb532-16"><a href="#cb532-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>cbbHS_HStoHY)<span class="sc">+</span></span>
<span id="cb532-17"><a href="#cb532-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb532-18"><a href="#cb532-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS D0&quot;</span>,<span class="st">&quot;HStoHY D7&quot;</span>),</span>
<span id="cb532-19"><a href="#cb532-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HS to HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb532-20"><a href="#cb532-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb532-21"><a href="#cb532-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">9</span>),</span>
<span id="cb532-22"><a href="#cb532-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb532-23"><a href="#cb532-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb532-24"><a href="#cb532-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb532-25"><a href="#cb532-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb532-26"><a href="#cb532-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb532-27"><a href="#cb532-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb532-28"><a href="#cb532-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb532-29"><a href="#cb532-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb532-30"><a href="#cb532-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb532-31"><a href="#cb532-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb532-32"><a href="#cb532-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb532-33"><a href="#cb532-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb532-34"><a href="#cb532-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb532-35"><a href="#cb532-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb532-36"><a href="#cb532-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb532-37"><a href="#cb532-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb532-38"><a href="#cb532-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb532-39"><a href="#cb532-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb532-40"><a href="#cb532-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb532-41"><a href="#cb532-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb532-42"><a href="#cb532-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb532-43"><a href="#cb532-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb532-44"><a href="#cb532-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb532-45"><a href="#cb532-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb532-46"><a href="#cb532-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb532-47"><a href="#cb532-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face=</span><span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb532-48"><a href="#cb532-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb532-49"><a href="#cb532-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb532-50"><a href="#cb532-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb532-51"><a href="#cb532-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-52"><a href="#cb532-52" aria-hidden="true" tabindex="-1"></a>Plot_Fig6G</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%206G-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-6h-i" class="section level3" number="6.1.7">
<h3 number="6.1.7"><span class="header-section-number">6.1.7</span> Figure 6H-I</h3>
<div class="blue">
<p>Increase in midgut length despite proliferation blockage is accompanied with compensatory area increase of EC. Representative pictures of midguts stained with membrane marker Mesh (white), shifted from HS to HY for 7 days show bigger cells on EsgTS&gt;UAS-Egfr-IR (I, right) compared to control (H, left). <em>Complete graphical annotation can be found in manuscript figures</em></p>
</div>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="#cb533-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/6H.jpg&quot;</span>) </span>
<span id="cb533-2"><a href="#cb533-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig6H <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb533-3"><a href="#cb533-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig6H)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%206H-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/6I.jpg&quot;</span>) </span>
<span id="cb534-2"><a href="#cb534-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig6I <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb534-3"><a href="#cb534-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig6I)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%206I-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="figure-6j" class="section level3" number="6.1.8">
<h3 number="6.1.8"><span class="header-section-number">6.1.8</span> Figure 6J</h3>
<div class="blue">
<p>Quantification of EC cell size shows compensatory effect in ECs of EsgTS&gt;Egfr-IR.Statistical comparison is for the interaction between diet and genotype.</p>
</div>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="#cb535-1" aria-hidden="true" tabindex="-1"></a>tab_area_esg <span class="ot">=</span> </span>
<span id="cb535-2"><a href="#cb535-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(d[[<span class="st">&quot;6J&quot;</span>]],Area<span class="sc">&lt;=</span><span class="dv">1300</span>)<span class="sc">%&gt;%</span></span>
<span id="cb535-3"><a href="#cb535-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Area&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb535-4"><a href="#cb535-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_treatment=</span>Day,</span>
<span id="cb535-5"><a href="#cb535-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Female_Line=</span>Female.Line,</span>
<span id="cb535-6"><a href="#cb535-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Male_Line=</span>Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb535-7"><a href="#cb535-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb535-8"><a href="#cb535-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Diet=</span><span class="fu">fct_relevel</span>(Diet,<span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HStoHY&quot;</span>)))</span>
<span id="cb535-9"><a href="#cb535-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-10"><a href="#cb535-10" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb535-11"><a href="#cb535-11" aria-hidden="true" tabindex="-1"></a>  tab_area_esg<span class="sc">%&gt;%</span></span>
<span id="cb535-12"><a href="#cb535-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Male_Line)<span class="sc">%&gt;%</span></span>
<span id="cb535-13"><a href="#cb535-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb535-14"><a href="#cb535-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-15"><a href="#cb535-15" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb535-16"><a href="#cb535-16" aria-hidden="true" tabindex="-1"></a><span class="co"># D7</span></span>
<span id="cb535-17"><a href="#cb535-17" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Area) <span class="sc">~</span>  Diet <span class="sc">*</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat) ,<span class="at">data =</span> tab_area_esg)</span>
<span id="cb535-18"><a href="#cb535-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.99806, p-value = 0.06875</code></pre>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Area) <span class="sc">~</span>  Diet <span class="sc">*</span> Male_Line<span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat) ,<span class="at">data =</span> tab_area_esg)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Area) ~ Diet * Male_Line + (1/Repeat)
BP = 6.8989, df = 3, p-value = 0.07519</code></pre>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="#cb539-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Area) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tab_area_esg)</span>
<span id="cb539-2"><a href="#cb539-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb539-3"><a href="#cb539-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb539-4"><a href="#cb539-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-5"><a href="#cb539-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Response Control vs Egfr&quot;</span>)),</span>
<span id="cb539-6"><a href="#cb539-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_area_esg<span class="sc">$</span>Repeat),</span>
<span id="cb539-7"><a href="#cb539-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb539-8"><a href="#cb539-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb539-9"><a href="#cb539-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">4</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb539-10"><a href="#cb539-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb539-11"><a href="#cb539-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb539-12"><a href="#cb539-12" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb539-13"><a href="#cb539-13" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb539-14"><a href="#cb539-14" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb539-15"><a href="#cb539-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-16"><a href="#cb539-16" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb539-17"><a href="#cb539-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Cell area) ~  Diet + Genotype + Diet : Genotype  + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb539-18"><a href="#cb539-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Cell area) ~ Diet + Genotype + Diet : Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Response Control vs Egfr
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
10.51
</td>
<td style="text-align:left;">
4.49
</td>
<td style="text-align:left;">
0.132
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0012
</td>
<td style="text-align:left;">
**
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true" tabindex="-1"></a>tab_stat_6J<span class="ot">=</span>tab_stat</span>
<span id="cb540-2"><a href="#cb540-2" aria-hidden="true" tabindex="-1"></a>tab_stat_6J<span class="sc">$</span>Male_Line<span class="ot">=</span><span class="st">&quot;Egfr-IR&quot;</span></span>
<span id="cb540-3"><a href="#cb540-3" aria-hidden="true" tabindex="-1"></a>tab_stat_6J<span class="sc">$</span>Diet<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;HStoHY&quot;</span>)</span>
<span id="cb540-4"><a href="#cb540-4" aria-hidden="true" tabindex="-1"></a>tab_stat_6J<span class="sc">$</span>yposition <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.6</span>)</span>
<span id="cb540-5"><a href="#cb540-5" aria-hidden="true" tabindex="-1"></a>tab_stat_6J<span class="sc">$</span>xposition <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.5</span>)</span>
<span id="cb540-6"><a href="#cb540-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb540-7"><a href="#cb540-7" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb540-8"><a href="#cb540-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb540-9"><a href="#cb540-9" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(tab_area_esg<span class="sc">$</span>Area<span class="sc">/</span><span class="dv">1000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb540-10"><a href="#cb540-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb540-11"><a href="#cb540-11" aria-hidden="true" tabindex="-1"></a>Plot_Fig6J<span class="ot">=</span></span>
<span id="cb540-12"><a href="#cb540-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_area_esg, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Area<span class="sc">/</span><span class="dv">1000</span>))<span class="sc">+</span> </span>
<span id="cb540-13"><a href="#cb540-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> C.G), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb540-14"><a href="#cb540-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">120</span>) <span class="sc">+</span> </span>
<span id="cb540-15"><a href="#cb540-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb540-16"><a href="#cb540-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Male_Line)<span class="sc">+</span></span>
<span id="cb540-17"><a href="#cb540-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>cbbHS_HStoHY)<span class="sc">+</span></span>
<span id="cb540-18"><a href="#cb540-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb540-19"><a href="#cb540-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HStoHY&quot;</span>),</span>
<span id="cb540-20"><a href="#cb540-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HS to HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb540-21"><a href="#cb540-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;EC area (10&quot;</span><span class="sc">^</span><span class="dv">3</span>, <span class="st">&quot;mm&quot;</span><span class="sc">^</span><span class="dv">2</span>,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb540-22"><a href="#cb540-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="fl">1.1</span>),</span>
<span id="cb540-23"><a href="#cb540-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">1.1</span>,<span class="at">by=</span><span class="fl">0.4</span>))<span class="sc">+</span></span>
<span id="cb540-24"><a href="#cb540-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb540-25"><a href="#cb540-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb540-26"><a href="#cb540-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb540-27"><a href="#cb540-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb540-28"><a href="#cb540-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb540-29"><a href="#cb540-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb540-30"><a href="#cb540-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb540-31"><a href="#cb540-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb540-32"><a href="#cb540-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb540-33"><a href="#cb540-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb540-34"><a href="#cb540-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb540-35"><a href="#cb540-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb540-36"><a href="#cb540-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb540-37"><a href="#cb540-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb540-38"><a href="#cb540-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb540-39"><a href="#cb540-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="at">unit =</span> <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb540-40"><a href="#cb540-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb540-41"><a href="#cb540-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb540-42"><a href="#cb540-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb540-43"><a href="#cb540-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb540-44"><a href="#cb540-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb540-45"><a href="#cb540-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb540-46"><a href="#cb540-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb540-47"><a href="#cb540-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb540-48"><a href="#cb540-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb540-49"><a href="#cb540-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb540-50"><a href="#cb540-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb540-51"><a href="#cb540-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb540-52"><a href="#cb540-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb540-53"><a href="#cb540-53" aria-hidden="true" tabindex="-1"></a>Plot_Fig6J</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%206J-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>##Export Figure 6</p>
</div>
</div>
<div id="figure-6---supplementary-1" class="section level2" number="6.2">
<h2 number="6.2"><span class="header-section-number">6.2</span> Figure 6 - supplementary 1</h2>
<div id="figure-6s1a" class="section level3" number="6.2.1">
<h3 number="6.2.1"><span class="header-section-number">6.2.1</span> Figure 6S1A</h3>
<div class="blue">
<p>Changes in the number of pH3+ cells between HS and HY (ratio HY/HS of mean pH3+ cells) does not correlate with changes in midgut size between HS and HY (ratio HY/HS of mean midgut length) across selected DGRP lines.</p>
</div>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="#cb541-1" aria-hidden="true" tabindex="-1"></a>tab_corr_length_cell_DGRP_mean_ph3 <span class="ot">=</span></span>
<span id="cb541-2"><a href="#cb541-2" aria-hidden="true" tabindex="-1"></a>  tab_corr_length_cell_DGRP<span class="sc">%&gt;%</span></span>
<span id="cb541-3"><a href="#cb541-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ral,diet)<span class="sc">%&gt;%</span></span>
<span id="cb541-4"><a href="#cb541-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_ph3=</span><span class="fu">mean</span>(ph3,<span class="at">na.rm=</span>T))<span class="sc">%&gt;%</span></span>
<span id="cb541-5"><a href="#cb541-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(diet,mean_ph3)<span class="sc">%&gt;%</span></span>
<span id="cb541-6"><a href="#cb541-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Mean_ph3_HS=</span>HS,</span>
<span id="cb541-7"><a href="#cb541-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">Mean_ph3_HY=</span>HY)<span class="sc">%&gt;%</span></span>
<span id="cb541-8"><a href="#cb541-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio_ph3 =</span> Mean_ph3_HY<span class="sc">/</span>Mean_ph3_HS)</span>
<span id="cb541-9"><a href="#cb541-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-10"><a href="#cb541-10" aria-hidden="true" tabindex="-1"></a>tab_corr_length_cell_DGRP_mean_length <span class="ot">=</span></span>
<span id="cb541-11"><a href="#cb541-11" aria-hidden="true" tabindex="-1"></a>  tab_corr_length_cell_DGRP<span class="sc">%&gt;%</span></span>
<span id="cb541-12"><a href="#cb541-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ral,diet)<span class="sc">%&gt;%</span></span>
<span id="cb541-13"><a href="#cb541-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_length=</span><span class="fu">mean</span>(len,<span class="at">na.rm=</span>T))<span class="sc">%&gt;%</span></span>
<span id="cb541-14"><a href="#cb541-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(diet,mean_length)<span class="sc">%&gt;%</span></span>
<span id="cb541-15"><a href="#cb541-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">mean_length_HS=</span>HS,</span>
<span id="cb541-16"><a href="#cb541-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">mean_length_HY=</span>HY)<span class="sc">%&gt;%</span></span>
<span id="cb541-17"><a href="#cb541-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio_length =</span> mean_length_HY<span class="sc">/</span>mean_length_HS)</span>
<span id="cb541-18"><a href="#cb541-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-19"><a href="#cb541-19" aria-hidden="true" tabindex="-1"></a>tab_corr_length_cell_DGRP_mean<span class="ot">=</span> <span class="fu">left_join</span>(tab_corr_length_cell_DGRP_mean_length,tab_corr_length_cell_DGRP_mean_ph3)</span>
<span id="cb541-20"><a href="#cb541-20" aria-hidden="true" tabindex="-1"></a>tab_corr_length_cell_DGRP_mean<span class="ot">=</span><span class="fu">as.data.frame</span>(tab_corr_length_cell_DGRP_mean)</span>
<span id="cb541-21"><a href="#cb541-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-22"><a href="#cb541-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-23"><a href="#cb541-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-24"><a href="#cb541-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-25"><a href="#cb541-25" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span></span>
<span id="cb541-26"><a href="#cb541-26" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(tab_corr_length_cell_DGRP_mean,</span>
<span id="cb541-27"><a href="#cb541-27" aria-hidden="true" tabindex="-1"></a>     <span class="fu">cor.test</span>(Ratio_ph3,Ratio_length,<span class="at">method=</span><span class="st">&quot;pearson&quot;</span>))</span>
<span id="cb541-28"><a href="#cb541-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-29"><a href="#cb541-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-30"><a href="#cb541-30" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Statistic =</span> test<span class="sc">$</span>statistic,</span>
<span id="cb541-31"><a href="#cb541-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">cor =</span> test<span class="sc">$</span>estimate,</span>
<span id="cb541-32"><a href="#cb541-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">Pvalue =</span> test<span class="sc">$</span>p.value)</span>
<span id="cb541-33"><a href="#cb541-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-34"><a href="#cb541-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-35"><a href="#cb541-35" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(tab_corr_length_cell_DGRP_mean<span class="sc">$</span>ral) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Ral 356&quot;</span>, <span class="st">&quot;Ral 362&quot;</span>, <span class="st">&quot;Ral 370&quot;</span>, <span class="st">&quot;Ral 502&quot;</span>, <span class="st">&quot;Ral 765&quot;</span>, <span class="st">&quot;Ral 853&quot;</span>, <span class="st">&quot;Ral 911&quot;</span> )</span>
<span id="cb541-36"><a href="#cb541-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-37"><a href="#cb541-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-38"><a href="#cb541-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-39"><a href="#cb541-39" aria-hidden="true" tabindex="-1"></a>Plot_Fig6S1A <span class="ot">=</span> </span>
<span id="cb541-40"><a href="#cb541-40" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tab_corr_length_cell_DGRP_mean,<span class="fu">aes</span>(<span class="at">x=</span>Ratio_ph3,<span class="at">y=</span>Ratio_length,<span class="at">label=</span>ral))<span class="sc">+</span></span>
<span id="cb541-41"><a href="#cb541-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb541-42"><a href="#cb541-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Ratio HY/HS (mean pH3&quot;</span> <span class="sc">^</span> <span class="st">&quot;+&quot;</span>, <span class="st">&quot; cells)&quot;</span>)),</span>
<span id="cb541-43"><a href="#cb541-43" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">1.8</span>),</span>
<span id="cb541-44"><a href="#cb541-44" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="fl">0.8</span>,<span class="fl">2.8</span>,<span class="at">by=</span><span class="fl">0.1</span>)))<span class="sc">+</span></span>
<span id="cb541-45"><a href="#cb541-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Ratio HY/HS (mean midgut length)&quot;</span>,</span>
<span id="cb541-46"><a href="#cb541-46" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">1.8</span>),</span>
<span id="cb541-47"><a href="#cb541-47" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="fl">0.8</span>,<span class="fl">2.8</span>,<span class="at">by=</span><span class="fl">0.2</span>)))<span class="sc">+</span></span>
<span id="cb541-48"><a href="#cb541-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data=</span>tab_corr_length_cell_DGRP_mean,<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb541-49"><a href="#cb541-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)<span class="sc">+</span></span>
<span id="cb541-50"><a href="#cb541-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_stat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.6</span>, <span class="at">y =</span> <span class="fl">1.7</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;cor=&quot;</span>, <span class="fu">format</span>(cor, <span class="at">digits=</span><span class="dv">2</span>),                                       <span class="st">&quot;p=&quot;</span>,<span class="fu">format</span>(Pvalue,<span class="at">digits=</span><span class="dv">2</span>))),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span>   <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb541-51"><a href="#cb541-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb541-52"><a href="#cb541-52" aria-hidden="true" tabindex="-1"></a>        (<span class="at">panel.border =</span> <span class="fu">element_blank</span>()),</span>
<span id="cb541-53"><a href="#cb541-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb541-54"><a href="#cb541-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb541-55"><a href="#cb541-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb541-56"><a href="#cb541-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb541-57"><a href="#cb541-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb541-58"><a href="#cb541-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb541-59"><a href="#cb541-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb541-60"><a href="#cb541-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb541-61"><a href="#cb541-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb541-62"><a href="#cb541-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb541-63"><a href="#cb541-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb541-64"><a href="#cb541-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.98</span>),</span>
<span id="cb541-65"><a href="#cb541-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb541-66"><a href="#cb541-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb541-67"><a href="#cb541-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb541-68"><a href="#cb541-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb541-69"><a href="#cb541-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont),</span>
<span id="cb541-70"><a href="#cb541-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))<span class="sc">+</span></span>
<span id="cb541-71"><a href="#cb541-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb541-72"><a href="#cb541-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-73"><a href="#cb541-73" aria-hidden="true" tabindex="-1"></a>Plot_Fig6S1A</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%206S1A-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-6s1b-e" class="section level3" number="6.2.2">
<h3 number="6.2.2"><span class="header-section-number">6.2.2</span> Figure 6S1B-E</h3>
<div class="blue">
<p>Overexpression of reaper in progenitor cells (marked in red) via EsgTS&gt;rpr-OE results in loss of marked progenitor cells (C) compared to control (B) in region 4 of midguts, after 12 days post eclosion on HS diet (7 days at 29°C with TARGET system active). Shifting the flies on HY for additional 7 days results in a change in morphology on midguts overexpressing reaper, reminiscent of EsgTS&gt;UAS-Egfr-IR midguts .<em>Complete graphical annotation can be found in manuscript figures</em></p>
</div>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/6 - S1B.jpg&quot;</span>) </span>
<span id="cb542-2"><a href="#cb542-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig6S1B <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb542-3"><a href="#cb542-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig6S1B)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%206S1B-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="#cb543-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/6 - S1C.jpg&quot;</span>) </span>
<span id="cb543-2"><a href="#cb543-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig6S1C <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb543-3"><a href="#cb543-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig6S1C)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%206S1C-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/6 - S1D.jpg&quot;</span>) </span>
<span id="cb544-2"><a href="#cb544-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig6S1D <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb544-3"><a href="#cb544-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig6S1D)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%206S1D-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="#cb545-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/6 - S1E.jpg&quot;</span>) </span>
<span id="cb545-2"><a href="#cb545-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig6S1E <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb545-3"><a href="#cb545-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig6S1E)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%206S1E-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="figure-6s1f" class="section level3" number="6.2.3">
<h3 number="6.2.3"><span class="header-section-number">6.2.3</span> Figure 6S1F</h3>
<div class="blue">
<p>EsgTS&gt; rpr-OE midguts are still able to reach a similar length to controls .<em>Complete graphical annotation can be found in manuscript figures</em></p>
</div>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a>tab_length_rpr <span class="ot">=</span> </span>
<span id="cb546-2"><a href="#cb546-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;6 - S1F&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb546-3"><a href="#cb546-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb546-4"><a href="#cb546-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm=</span>Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb546-5"><a href="#cb546-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_treatment=</span>Day,</span>
<span id="cb546-6"><a href="#cb546-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Female_Line=</span>Female.Line,</span>
<span id="cb546-7"><a href="#cb546-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Male_Line=</span>Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb546-8"><a href="#cb546-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb546-9"><a href="#cb546-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Male_Line=</span><span class="fu">fct_relevel</span>(Male_Line, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;rpr-OE&quot;</span>))</span>
<span id="cb546-10"><a href="#cb546-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-11"><a href="#cb546-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-12"><a href="#cb546-12" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb546-13"><a href="#cb546-13" aria-hidden="true" tabindex="-1"></a>  tab_length_rpr<span class="sc">%&gt;%</span></span>
<span id="cb546-14"><a href="#cb546-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet, Male_Line)<span class="sc">%&gt;%</span></span>
<span id="cb546-15"><a href="#cb546-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb546-16"><a href="#cb546-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-17"><a href="#cb546-17" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb546-18"><a href="#cb546-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-19"><a href="#cb546-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">*</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tab_length_rpr)</span>
<span id="cb546-20"><a href="#cb546-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.97478, p-value = 0.08696</code></pre>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tab_length_rpr)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + Male_Line + (1/Repeat)
BP = 5.6339, df = 2, p-value = 0.05979</code></pre>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="#cb550-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tab_length_rpr)</span>
<span id="cb550-2"><a href="#cb550-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb550-3"><a href="#cb550-3" aria-hidden="true" tabindex="-1"></a>test</span></code></pre></div>
<pre><code>     chi2_LR df   p_value
p_v 1.128544  1 0.2880861</code></pre>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="#cb552-1" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb552-2"><a href="#cb552-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-3"><a href="#cb552-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-4"><a href="#cb552-4" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Interaction Control vs Interaction Rpr-OE&quot;</span>)),</span>
<span id="cb552-5"><a href="#cb552-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Male_Line =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;rpr-OE&quot;</span>)),</span>
<span id="cb552-6"><a href="#cb552-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>Repeat),</span>
<span id="cb552-7"><a href="#cb552-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb552-8"><a href="#cb552-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb552-9"><a href="#cb552-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb552-10"><a href="#cb552-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb552-11"><a href="#cb552-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">1</span>,<span class="at">scientific=</span>F)))</span>
<span id="cb552-12"><a href="#cb552-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-13"><a href="#cb552-13" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb552-14"><a href="#cb552-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb552-15"><a href="#cb552-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb552-16"><a href="#cb552-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-17"><a href="#cb552-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-18"><a href="#cb552-18" aria-hidden="true" tabindex="-1"></a>tab_stat_rpr<span class="ot">=</span>tab_stat</span>
<span id="cb552-19"><a href="#cb552-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-20"><a href="#cb552-20" aria-hidden="true" tabindex="-1"></a>tab_stat_rpr<span class="sc">%&gt;%</span></span>
<span id="cb552-21"><a href="#cb552-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb552-22"><a href="#cb552-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + Genotype + Diet : Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb552-23"><a href="#cb552-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + Genotype + Diet : Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Interaction Control vs Interaction Rpr-OE
</td>
<td style="text-align:left;">
rpr-OE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.13
</td>
<td style="text-align:left;">
1.53
</td>
<td style="text-align:left;">
0.278
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="#cb553-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb553-2"><a href="#cb553-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-3"><a href="#cb553-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(tab_length_rpr<span class="sc">$</span>Total_Length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb553-4"><a href="#cb553-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-5"><a href="#cb553-5" aria-hidden="true" tabindex="-1"></a>Plot_Fig6S1F<span class="ot">=</span></span>
<span id="cb553-6"><a href="#cb553-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_length_rpr, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb553-7"><a href="#cb553-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb553-8"><a href="#cb553-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb553-9"><a href="#cb553-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">2.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb553-10"><a href="#cb553-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Male_Line )<span class="sc">+</span></span>
<span id="cb553-11"><a href="#cb553-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>cbbHS_HStoHY)<span class="sc">+</span></span>
<span id="cb553-12"><a href="#cb553-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb553-13"><a href="#cb553-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HStoHY&quot;</span>),</span>
<span id="cb553-14"><a href="#cb553-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HS to HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb553-15"><a href="#cb553-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb553-16"><a href="#cb553-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">9</span>),</span>
<span id="cb553-17"><a href="#cb553-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb553-18"><a href="#cb553-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb553-19"><a href="#cb553-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb553-20"><a href="#cb553-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb553-21"><a href="#cb553-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb553-22"><a href="#cb553-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb553-23"><a href="#cb553-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb553-24"><a href="#cb553-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb553-25"><a href="#cb553-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb553-26"><a href="#cb553-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb553-27"><a href="#cb553-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb553-28"><a href="#cb553-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb553-29"><a href="#cb553-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb553-30"><a href="#cb553-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb553-31"><a href="#cb553-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb553-32"><a href="#cb553-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb553-33"><a href="#cb553-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb553-34"><a href="#cb553-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb553-35"><a href="#cb553-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb553-36"><a href="#cb553-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb553-37"><a href="#cb553-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb553-38"><a href="#cb553-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb553-39"><a href="#cb553-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb553-40"><a href="#cb553-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb553-41"><a href="#cb553-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb553-42"><a href="#cb553-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> xSmallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">angle=</span><span class="dv">0</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb553-43"><a href="#cb553-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> xSmallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">angle=</span><span class="dv">0</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb553-44"><a href="#cb553-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb553-45"><a href="#cb553-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb553-46"><a href="#cb553-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb553-47"><a href="#cb553-47" aria-hidden="true" tabindex="-1"></a>Plot_Fig6S1F</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%206S1F-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>##Export Figure 6 - supplementary 1</p>
</div>
</div>
</div>
<div id="figure-7.-enterocyte-resizing-is-required-for-midgut-plasticity" class="section level1" number="7">
<h1 number="7"><span class="header-section-number">7</span> Figure 7. Enterocyte resizing is required for midgut plasticity</h1>
<div id="figure-7---main" class="section level2" number="7.1">
<h2 number="7.1"><span class="header-section-number">7.1</span> Figure 7 - main</h2>
<div id="figure-7a" class="section level3" number="7.1.1">
<h3 number="7.1.1"><span class="header-section-number">7.1.1</span> Figure 7A</h3>
<div class="blue">
<p>Enterocyte size mostly correlates with midgut length. Quantification of EC area across a selected panel of DGRP lines comprising high and low responder shows that midgut length mostly correlates with EC cell area. Lines on plot show smoothed splines.</p>
</div>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="#cb554-1" aria-hidden="true" tabindex="-1"></a>wolb <span class="ot">=</span> d[[<span class="st">&quot;DGRP_wolbachia_DFD&quot;</span>]]</span>
<span id="cb554-2"><a href="#cb554-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(wolb) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;dgrp.id&quot;</span>, <span class="st">&quot;wolbachia&quot;</span>)</span>
<span id="cb554-3"><a href="#cb554-3" aria-hidden="true" tabindex="-1"></a>wolb<span class="sc">$</span>dgrp.id <span class="ot">=</span> <span class="fu">gsub</span>(<span class="st">&quot;line_&quot;</span>, <span class="st">&quot;&quot;</span>, wolb<span class="sc">$</span>dgrp.id)</span>
<span id="cb554-4"><a href="#cb554-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb554-5"><a href="#cb554-5" aria-hidden="true" tabindex="-1"></a>tab_corr_length_cell_DGRP <span class="ot">=</span> <span class="fu">subset</span>(d[[<span class="st">&quot;6A - 7A&quot;</span>]]) </span>
<span id="cb554-6"><a href="#cb554-6" aria-hidden="true" tabindex="-1"></a>tab_corr_length_cell_DGRP <span class="ot">=</span> <span class="fu">merge</span>(tab_corr_length_cell_DGRP, wolb, <span class="at">by.x=</span><span class="st">&quot;DGRP.number&quot;</span>, <span class="at">by.y=</span><span class="st">&quot;dgrp.id&quot;</span>, <span class="at">all.x=</span>T, <span class="at">all.y=</span>F)</span>
<span id="cb554-7"><a href="#cb554-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_corr_length_cell_DGRP) <span class="ot">=</span> <span class="fu">tolower</span>(<span class="fu">colnames</span>(tab_corr_length_cell_DGRP))</span>
<span id="cb554-8"><a href="#cb554-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_corr_length_cell_DGRP)[<span class="dv">3</span>] <span class="ot">=</span> <span class="st">&quot;repl&quot;</span></span>
<span id="cb554-9"><a href="#cb554-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb554-10"><a href="#cb554-10" aria-hidden="true" tabindex="-1"></a>tab_corr_length_cell_DGRP<span class="ot">=</span></span>
<span id="cb554-11"><a href="#cb554-11" aria-hidden="true" tabindex="-1"></a>  tab_corr_length_cell_DGRP<span class="sc">%&gt;%</span></span>
<span id="cb554-12"><a href="#cb554-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">ral=</span>dgrp.number,</span>
<span id="cb554-13"><a href="#cb554-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">len=</span>total.l,</span>
<span id="cb554-14"><a href="#cb554-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">ph3=</span>total.ph3,</span>
<span id="cb554-15"><a href="#cb554-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">ec.area=</span>area)<span class="sc">%&gt;%</span></span>
<span id="cb554-16"><a href="#cb554-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ral=</span><span class="fu">paste</span>(<span class="st">&quot;Ral&quot;</span>,ral,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb554-17"><a href="#cb554-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)</span>
<span id="cb554-18"><a href="#cb554-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb554-19"><a href="#cb554-19" aria-hidden="true" tabindex="-1"></a>gut_mean<span class="ot">=</span></span>
<span id="cb554-20"><a href="#cb554-20" aria-hidden="true" tabindex="-1"></a>  tab_corr_length_cell_DGRP <span class="sc">%&gt;%</span></span>
<span id="cb554-21"><a href="#cb554-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ral, diet,cross,gutnumber)<span class="sc">%&gt;%</span></span>
<span id="cb554-22"><a href="#cb554-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_gut_len=</span><span class="fu">mean</span>(len,<span class="at">na.rm=</span>T),</span>
<span id="cb554-23"><a href="#cb554-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_cell_size=</span><span class="fu">mean</span>(ec.area,<span class="at">na.rm=</span>T),</span>
<span id="cb554-24"><a href="#cb554-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_cell_size=</span><span class="fu">sd</span>(ec.area,<span class="at">na.rm=</span>T)<span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(ec.area[<span class="sc">!</span><span class="fu">is.na</span>(ec.area)])),</span>
<span id="cb554-25"><a href="#cb554-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_PH3=</span><span class="fu">mean</span>(ph3,<span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span></span>
<span id="cb554-26"><a href="#cb554-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Group=</span><span class="fu">paste</span>(cross,gutnumber,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>))</span></code></pre></div>
<pre><code>Error: Problem with `summarise()` column `se_cell_size`.
i `se_cell_size = sd(ec.area, na.rm = T)/sqrt(length(ec.area[!is.na(ec.area)]))`.
x argument inutilisé (na.rm = T)
i The error occurred in group 1: ral = Ral_356, diet = HS, cross = 4 R1, gutnumber = 1.</code></pre>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(gut_mean<span class="sc">$</span>ral) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Ral 356&quot;</span>, <span class="st">&quot;Ral 362&quot;</span>, <span class="st">&quot;Ral 370&quot;</span>, <span class="st">&quot;Ral 502&quot;</span>, <span class="st">&quot;Ral 765&quot;</span>, <span class="st">&quot;Ral 853&quot;</span>, <span class="st">&quot;Ral 911&quot;</span> )</span>
<span id="cb556-2"><a href="#cb556-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-3"><a href="#cb556-3" aria-hidden="true" tabindex="-1"></a>gut_mean<span class="sc">$</span>ral <span class="ot">&lt;-</span> <span class="fu">factor</span>(gut_mean<span class="sc">$</span>ral, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Ral 356&quot;</span>, <span class="st">&quot;Ral 502&quot;</span>, <span class="st">&quot;Ral 765&quot;</span>, <span class="st">&quot;Ral 853&quot;</span>, <span class="st">&quot;Ral 911&quot;</span>, <span class="st">&quot;Ral 362&quot;</span>, <span class="st">&quot;Ral 370&quot;</span>))</span>
<span id="cb556-4"><a href="#cb556-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-5"><a href="#cb556-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-6"><a href="#cb556-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-7"><a href="#cb556-7" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb556-8"><a href="#cb556-8" aria-hidden="true" tabindex="-1"></a>  gut_mean<span class="sc">%&gt;%</span></span>
<span id="cb556-9"><a href="#cb556-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(diet, ral)<span class="sc">%&gt;%</span></span>
<span id="cb556-10"><a href="#cb556-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb556-11"><a href="#cb556-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb556-12"><a href="#cb556-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ral=</span><span class="fu">fct_relevel</span>(ral,<span class="st">&quot;Ral 356&quot;</span>, <span class="st">&quot;Ral 502&quot;</span>, <span class="st">&quot;Ral 765&quot;</span>, <span class="st">&quot;Ral 853&quot;</span>, <span class="st">&quot;Ral 911&quot;</span>, <span class="st">&quot;Ral 362&quot;</span>, <span class="st">&quot;Ral 370&quot;</span>))</span>
<span id="cb556-13"><a href="#cb556-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-14"><a href="#cb556-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-15"><a href="#cb556-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-16"><a href="#cb556-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-17"><a href="#cb556-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-18"><a href="#cb556-18" aria-hidden="true" tabindex="-1"></a><span class="co"># stat over all</span></span>
<span id="cb556-19"><a href="#cb556-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log10</span>(<span class="fu">I</span>(mean_gut_len<span class="sc">/</span><span class="dv">1000</span>)) <span class="sc">~</span>  mean_cell_size <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ral),<span class="at">data =</span> gut_mean)</span>
<span id="cb556-20"><a href="#cb556-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.99351, p-value = 0.3142</code></pre>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="#cb558-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log10</span>(<span class="fu">I</span>(mean_gut_len<span class="sc">/</span><span class="dv">1000</span>)) <span class="sc">~</span>  mean_cell_size <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> ral),<span class="at">data =</span> gut_mean)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log10(I(mean_gut_len/1000)) ~ mean_cell_size + (1/ral)
BP = 0.26958, df = 1, p-value = 0.6036</code></pre>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="#cb560-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log10</span>(<span class="fu">I</span>(mean_gut_len<span class="sc">/</span><span class="dv">1000</span>)) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ral),<span class="at">data =</span>gut_mean)</span>
<span id="cb560-2"><a href="#cb560-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb560-3"><a href="#cb560-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb560-4"><a href="#cb560-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb560-5"><a href="#cb560-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Cell area&quot;</span>)),</span>
<span id="cb560-6"><a href="#cb560-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Number_genotypes =</span> <span class="fu">nlevels</span>(gut_mean<span class="sc">$</span>ral),</span>
<span id="cb560-7"><a href="#cb560-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb560-8"><a href="#cb560-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb560-9"><a href="#cb560-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb560-10"><a href="#cb560-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb560-11"><a href="#cb560-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb560-12"><a href="#cb560-12" aria-hidden="true" tabindex="-1"></a><span class="co">#stat per line</span></span>
<span id="cb560-13"><a href="#cb560-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb560-14"><a href="#cb560-14" aria-hidden="true" tabindex="-1"></a>Cor_area<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb560-15"><a href="#cb560-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">unique</span>(gut_mean<span class="sc">$</span>ral)){</span>
<span id="cb560-16"><a href="#cb560-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   print(i)</span></span>
<span id="cb560-17"><a href="#cb560-17" aria-hidden="true" tabindex="-1"></a>Cor_area_HS<span class="ot">=</span></span>
<span id="cb560-18"><a href="#cb560-18" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(<span class="fu">subset</span>(gut_mean,ral<span class="sc">==</span>i<span class="sc">&amp;</span> diet<span class="sc">==</span><span class="st">&quot;HS&quot;</span>),</span>
<span id="cb560-19"><a href="#cb560-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="fu">log</span>(mean_gut_len,<span class="dv">2</span>),mean_cell_size))</span>
<span id="cb560-20"><a href="#cb560-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb560-21"><a href="#cb560-21" aria-hidden="true" tabindex="-1"></a>Cor_area_HY<span class="ot">=</span></span>
<span id="cb560-22"><a href="#cb560-22" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(<span class="fu">subset</span>(gut_mean,ral<span class="sc">==</span>i<span class="sc">&amp;</span> diet<span class="sc">==</span><span class="st">&quot;HY&quot;</span>),</span>
<span id="cb560-23"><a href="#cb560-23" aria-hidden="true" tabindex="-1"></a>     <span class="fu">cor.test</span>(<span class="fu">log</span>(mean_gut_len,<span class="dv">2</span>),mean_cell_size))</span>
<span id="cb560-24"><a href="#cb560-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb560-25"><a href="#cb560-25" aria-hidden="true" tabindex="-1"></a>Cor_area_tmp <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">ral =</span> <span class="fu">as.character</span>(i),</span>
<span id="cb560-26"><a href="#cb560-26" aria-hidden="true" tabindex="-1"></a>                         <span class="at">diet=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb560-27"><a href="#cb560-27" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Cor =</span> <span class="fu">c</span>(<span class="fu">format</span>(<span class="fu">as.numeric</span>(Cor_area_HS<span class="sc">$</span>estimate), <span class="at">digits =</span> <span class="dv">2</span>),<span class="fu">format</span>(<span class="fu">as.numeric</span>(Cor_area_HY<span class="sc">$</span>estimate), <span class="at">digits =</span> <span class="dv">2</span>)),</span>
<span id="cb560-28"><a href="#cb560-28" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">c</span>(<span class="fu">format</span>(<span class="fu">as.numeric</span>(Cor_area_HS<span class="sc">$</span>p.value), <span class="at">digits =</span> <span class="dv">2</span>),<span class="fu">format</span>(<span class="fu">as.numeric</span>(Cor_area_HY<span class="sc">$</span>p.value), <span class="at">digits =</span> <span class="dv">2</span>)))</span>
<span id="cb560-29"><a href="#cb560-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb560-30"><a href="#cb560-30" aria-hidden="true" tabindex="-1"></a>Cor_area<span class="ot">=</span> <span class="fu">rbind</span>(Cor_area,Cor_area_tmp)</span>
<span id="cb560-31"><a href="#cb560-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb560-32"><a href="#cb560-32" aria-hidden="true" tabindex="-1"></a>Cor_area<span class="sc">$</span>padj<span class="ot">=</span><span class="fu">p.adjust</span>(Cor_area<span class="sc">$</span>Pvalue,<span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb560-33"><a href="#cb560-33" aria-hidden="true" tabindex="-1"></a>Cor_area<span class="sc">$</span>sig<span class="ot">=</span> <span class="fu">ifelse</span>(Cor_area<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> Cor_area<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb560-34"><a href="#cb560-34" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(Cor_area<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> Cor_area<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb560-35"><a href="#cb560-35" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(Cor_area<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;ns&quot;</span>)))</span>
<span id="cb560-36"><a href="#cb560-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb560-37"><a href="#cb560-37" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">=</span><span class="fu">subset</span>(gut_mean,diet<span class="sc">==</span><span class="st">&quot;HS&quot;</span>)</span>
<span id="cb560-38"><a href="#cb560-38" aria-hidden="true" tabindex="-1"></a>stat_position_HS <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span>tmp,mean_gut_len<span class="sc">/</span><span class="dv">1000</span> <span class="sc">~</span>  ral, max)</span>
<span id="cb560-39"><a href="#cb560-39" aria-hidden="true" tabindex="-1"></a>stat_position_HS<span class="sc">$</span>diet<span class="ot">=</span><span class="st">&quot;HS&quot;</span></span>
<span id="cb560-40"><a href="#cb560-40" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">=</span><span class="fu">subset</span>(gut_mean,diet<span class="sc">==</span><span class="st">&quot;HY&quot;</span>)</span>
<span id="cb560-41"><a href="#cb560-41" aria-hidden="true" tabindex="-1"></a>stat_position_HY <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span>tmp,mean_gut_len<span class="sc">/</span><span class="dv">1000</span> <span class="sc">~</span>  ral, max)</span>
<span id="cb560-42"><a href="#cb560-42" aria-hidden="true" tabindex="-1"></a>stat_position_HY<span class="sc">$</span>diet<span class="ot">=</span><span class="st">&quot;HY&quot;</span></span>
<span id="cb560-43"><a href="#cb560-43" aria-hidden="true" tabindex="-1"></a>stat_position<span class="ot">=</span><span class="fu">rbind</span>(stat_position_HS,stat_position_HY)</span>
<span id="cb560-44"><a href="#cb560-44" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(stat_position)[<span class="dv">2</span>]<span class="ot">=</span><span class="st">&quot;Stat_position&quot;</span></span>
<span id="cb560-45"><a href="#cb560-45" aria-hidden="true" tabindex="-1"></a>Cor_area <span class="ot">=</span> <span class="fu">left_join</span>(Cor_area,stat_position)</span>
<span id="cb560-46"><a href="#cb560-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb560-47"><a href="#cb560-47" aria-hidden="true" tabindex="-1"></a>gut_mean<span class="sc">$</span>ral <span class="ot">&lt;-</span> <span class="fu">factor</span>(gut_mean<span class="sc">$</span>ral, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Ral 356&quot;</span>, <span class="st">&quot;Ral 502&quot;</span>, <span class="st">&quot;Ral 765&quot;</span>, <span class="st">&quot;Ral 853&quot;</span>, <span class="st">&quot;Ral 911&quot;</span>, <span class="st">&quot;Ral 362&quot;</span>, <span class="st">&quot;Ral 370&quot;</span>))</span>
<span id="cb560-48"><a href="#cb560-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb560-49"><a href="#cb560-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb560-50"><a href="#cb560-50" aria-hidden="true" tabindex="-1"></a>Cor_area<span class="sc">$</span>ral <span class="ot">&lt;-</span> <span class="fu">factor</span>(Cor_area<span class="sc">$</span>ral, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Ral 356&quot;</span>, <span class="st">&quot;Ral 502&quot;</span>, <span class="st">&quot;Ral 765&quot;</span>, <span class="st">&quot;Ral 853&quot;</span>, <span class="st">&quot;Ral 911&quot;</span>, <span class="st">&quot;Ral 362&quot;</span>, <span class="st">&quot;Ral 370&quot;</span>))</span>
<span id="cb560-51"><a href="#cb560-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb560-52"><a href="#cb560-52" aria-hidden="true" tabindex="-1"></a>Plot_Fig7A<span class="ot">=</span></span>
<span id="cb560-53"><a href="#cb560-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(gut_mean,<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log2</span>(mean_cell_size), <span class="at">y=</span>mean_gut_len<span class="sc">/</span><span class="dv">1000</span>,<span class="at">group=</span>ral))<span class="sc">+</span> </span>
<span id="cb560-54"><a href="#cb560-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="fu">aes</span>(<span class="at">color=</span>diet,<span class="at">fill=</span>diet),<span class="at">shape=</span><span class="dv">21</span>,<span class="at">size=</span><span class="fl">0.9</span>)<span class="sc">+</span></span>
<span id="cb560-55"><a href="#cb560-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">8</span>, <span class="at">y =</span> <span class="fl">2.5</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb560-56"><a href="#cb560-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Cor_area, <span class="at">mapping =</span> <span class="fu">aes</span>( <span class="at">x=</span><span class="dv">7</span>,<span class="at">y=</span><span class="dv">7</span>,<span class="at">label =</span> sig),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb560-57"><a href="#cb560-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(ral<span class="sc">~</span>diet)<span class="sc">+</span></span>
<span id="cb560-58"><a href="#cb560-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>)<span class="sc">+</span></span>
<span id="cb560-59"><a href="#cb560-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Cell size (&quot;</span>, log[<span class="dv">2</span>],<span class="st">&quot;(mean\u00B1se))&quot;</span>)))<span class="sc">+</span></span>
<span id="cb560-60"><a href="#cb560-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb560-61"><a href="#cb560-61" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb560-62"><a href="#cb560-62" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span>palette_diet_2)<span class="sc">+</span></span>
<span id="cb560-63"><a href="#cb560-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb560-64"><a href="#cb560-64" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb560-65"><a href="#cb560-65" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span>palette_diet_2)<span class="sc">+</span></span>
<span id="cb560-66"><a href="#cb560-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb560-67"><a href="#cb560-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb560-68"><a href="#cb560-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb560-69"><a href="#cb560-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb560-70"><a href="#cb560-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb560-71"><a href="#cb560-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb560-72"><a href="#cb560-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb560-73"><a href="#cb560-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb560-74"><a href="#cb560-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb560-75"><a href="#cb560-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb560-76"><a href="#cb560-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb560-77"><a href="#cb560-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb560-78"><a href="#cb560-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb560-79"><a href="#cb560-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb560-80"><a href="#cb560-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb560-81"><a href="#cb560-81" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb560-82"><a href="#cb560-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb560-83"><a href="#cb560-83" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb560-84"><a href="#cb560-84" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb560-85"><a href="#cb560-85" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb560-86"><a href="#cb560-86" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb560-87"><a href="#cb560-87" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb560-88"><a href="#cb560-88" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb560-89"><a href="#cb560-89" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb560-90"><a href="#cb560-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb560-91"><a href="#cb560-91" aria-hidden="true" tabindex="-1"></a>Plot_Fig7A</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207A-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-7b-c-d" class="section level3" number="7.1.2">
<h3 number="7.1.2"><span class="header-section-number">7.1.2</span> Figure 7B-C-D</h3>
<div class="blue">
<p>Representative pictures of single cell clones (hsFlp; Act&gt;STOP&gt;Gal4, UAS-GFP) suggest that compared to GFP- cells, TOR downregulation (UAS-Tor-IR, GFP+) results in smaller cells, while TOR hyperactivity (UAS-Rheb-OE, C) increases cell size. Quantification of clone size in D. Single cell clones are marked with GFP (green). <em>Complete graphical annotation can be found in manuscript figures</em></p>
</div>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="#cb561-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/7B.jpg&quot;</span>) </span>
<span id="cb561-2"><a href="#cb561-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig7B <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb561-3"><a href="#cb561-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig7B)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207B-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="#cb562-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/7C.jpg&quot;</span>) </span>
<span id="cb562-2"><a href="#cb562-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig7C <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb562-3"><a href="#cb562-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig7C)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207C-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="#cb563-1" aria-hidden="true" tabindex="-1"></a>tab_ECclone_quant <span class="ot">=</span> </span>
<span id="cb563-2"><a href="#cb563-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;7D&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb563-3"><a href="#cb563-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Area&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb563-4"><a href="#cb563-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb563-5"><a href="#cb563-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Male_Line=</span>Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb563-6"><a href="#cb563-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb563-7"><a href="#cb563-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Male_Line=</span><span class="fu">fct_relevel</span>(Male_Line,<span class="st">&quot;Tor-IR&quot;</span>,<span class="st">&quot;Rheb-OE&quot;</span>))</span>
<span id="cb563-8"><a href="#cb563-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-9"><a href="#cb563-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-10"><a href="#cb563-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-11"><a href="#cb563-11" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb563-12"><a href="#cb563-12" aria-hidden="true" tabindex="-1"></a>  tab_ECclone_quant<span class="sc">%&gt;%</span></span>
<span id="cb563-13"><a href="#cb563-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Male_Line, GFP)<span class="sc">%&gt;%</span></span>
<span id="cb563-14"><a href="#cb563-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb563-15"><a href="#cb563-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb563-16"><a href="#cb563-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Male_Line=</span><span class="fu">fct_relevel</span>(Male_Line,<span class="st">&quot;Tor-IR&quot;</span>,<span class="st">&quot;Rheb-OE&quot;</span>))</span>
<span id="cb563-17"><a href="#cb563-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-18"><a href="#cb563-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-19"><a href="#cb563-19" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb563-20"><a href="#cb563-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-21"><a href="#cb563-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Tor-IR stats</span></span>
<span id="cb563-22"><a href="#cb563-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-23"><a href="#cb563-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-24"><a href="#cb563-24" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Area) <span class="sc">~</span>  GFP,<span class="at">data =</span> <span class="fu">subset</span>(tab_ECclone_quant, Male_Line<span class="sc">==</span><span class="st">&quot;Tor-IR&quot;</span>))</span>
<span id="cb563-25"><a href="#cb563-25" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.9451, p-value = 1.023e-07</code></pre>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="#cb565-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Area) <span class="sc">~</span>  GFP ,<span class="at">data =</span> <span class="fu">subset</span>(tab_ECclone_quant, Male_Line<span class="sc">==</span><span class="st">&quot;Tor-IR&quot;</span>))</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Area) ~ GFP
BP = 0.17945, df = 1, p-value = 0.6718</code></pre>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="#cb567-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Area) <span class="sc">~</span> <span class="dv">1</span> ,<span class="at">data =</span> <span class="fu">subset</span>(tab_ECclone_quant, Male_Line<span class="sc">==</span><span class="st">&quot;Tor-IR&quot;</span>))</span>
<span id="cb567-2"><a href="#cb567-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb567-3"><a href="#cb567-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb567-4"><a href="#cb567-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-5"><a href="#cb567-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;GFP Negative vs Positive (Tor-IR)&quot;</span>)),</span>
<span id="cb567-6"><a href="#cb567-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb567-7"><a href="#cb567-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb567-8"><a href="#cb567-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb567-9"><a href="#cb567-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb567-10"><a href="#cb567-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb567-11"><a href="#cb567-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-12"><a href="#cb567-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-13"><a href="#cb567-13" aria-hidden="true" tabindex="-1"></a>tab_stat_TorEC <span class="ot">=</span> tab_stat</span>
<span id="cb567-14"><a href="#cb567-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-15"><a href="#cb567-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-16"><a href="#cb567-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-17"><a href="#cb567-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-18"><a href="#cb567-18" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Area) <span class="sc">~</span>  GFP,<span class="at">data =</span> <span class="fu">subset</span>(tab_ECclone_quant, Male_Line<span class="sc">==</span><span class="st">&quot;Rheb-OE&quot;</span>))</span>
<span id="cb567-19"><a href="#cb567-19" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98578, p-value = 0.01348</code></pre>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="#cb569-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Area) <span class="sc">~</span>  GFP ,<span class="at">data =</span> <span class="fu">subset</span>(tab_ECclone_quant, Male_Line<span class="sc">==</span><span class="st">&quot;Rheb-OE&quot;</span>))</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Area) ~ GFP
BP = 0.5099, df = 1, p-value = 0.4752</code></pre>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="#cb571-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Area) <span class="sc">~</span> <span class="dv">1</span> ,<span class="at">data =</span> <span class="fu">subset</span>(tab_ECclone_quant, Male_Line<span class="sc">==</span><span class="st">&quot;Rheb-OE&quot;</span>))</span>
<span id="cb571-2"><a href="#cb571-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb571-3"><a href="#cb571-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb571-4"><a href="#cb571-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-5"><a href="#cb571-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;GFP Negative vs Positive (Rheb-OE)&quot;</span>)),</span>
<span id="cb571-6"><a href="#cb571-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb571-7"><a href="#cb571-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb571-8"><a href="#cb571-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb571-9"><a href="#cb571-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb571-10"><a href="#cb571-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb571-11"><a href="#cb571-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-12"><a href="#cb571-12" aria-hidden="true" tabindex="-1"></a>tab_stat_RhebOEEC <span class="ot">=</span> tab_stat</span>
<span id="cb571-13"><a href="#cb571-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-14"><a href="#cb571-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-15"><a href="#cb571-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-16"><a href="#cb571-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-17"><a href="#cb571-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-18"><a href="#cb571-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-19"><a href="#cb571-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-20"><a href="#cb571-20" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="ot">=</span><span class="fu">rbind</span>(tab_stat_TorEC,tab_stat_RhebOEEC)</span>
<span id="cb571-21"><a href="#cb571-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-22"><a href="#cb571-22" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb571-23"><a href="#cb571-23" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb571-24"><a href="#cb571-24" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb571-25"><a href="#cb571-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-26"><a href="#cb571-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-27"><a href="#cb571-27" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">&quot;Tor-IR&quot;</span>,<span class="st">&quot;Rheb-OE&quot;</span>))</span>
<span id="cb571-28"><a href="#cb571-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-29"><a href="#cb571-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-30"><a href="#cb571-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-31"><a href="#cb571-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-32"><a href="#cb571-32" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb571-33"><a href="#cb571-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Chi2&quot;</span>, <span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>, <span class="st">&quot;Signif.&quot;</span>, <span class="st">&quot;RNAi line&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Cell area) ~  GFP&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb571-34"><a href="#cb571-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Cell area) ~ GFP
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
<th style="text-align:left;">
RNAi line
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
GFP Negative vs Positive (Tor-IR)
</td>
<td style="text-align:right;">
165.86
</td>
<td style="text-align:left;">
5.98
</td>
<td style="text-align:left;">
-1.19
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
<td style="text-align:left;">
Tor-IR
</td>
</tr>
<tr>
<td style="text-align:left;">
GFP Negative vs Positive (Rheb-OE)
</td>
<td style="text-align:right;">
94.61
</td>
<td style="text-align:left;">
5.85
</td>
<td style="text-align:left;">
0.826
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
<td style="text-align:left;">
Rheb-OE
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="#cb572-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb572-2"><a href="#cb572-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-3"><a href="#cb572-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-4"><a href="#cb572-4" aria-hidden="true" tabindex="-1"></a>Plot_Fig7D<span class="ot">=</span></span>
<span id="cb572-5"><a href="#cb572-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_ECclone_quant, <span class="fu">aes</span>(<span class="at">x =</span> GFP, <span class="at">y =</span> Area<span class="sc">/</span><span class="dv">1000</span>))<span class="sc">+</span> </span>
<span id="cb572-6"><a href="#cb572-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> GFP), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb572-7"><a href="#cb572-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.04</span>) <span class="sc">+</span> </span>
<span id="cb572-8"><a href="#cb572-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> GFP, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb572-9"><a href="#cb572-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">data =</span> tab_stat,<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">annotations =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">y_position =</span> <span class="dv">2</span>), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">manual =</span> <span class="cn">TRUE</span>, <span class="at">tip_length =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>))<span class="sc">+</span></span>
<span id="cb572-10"><a href="#cb572-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-11"><a href="#cb572-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Male_Line)<span class="sc">+</span></span>
<span id="cb572-12"><a href="#cb572-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb572-13"><a href="#cb572-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#e4e4e4&quot;</span>,<span class="st">&quot;#8ee53f&quot;</span>))<span class="sc">+</span></span>
<span id="cb572-14"><a href="#cb572-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;GFP&quot;</span>,</span>
<span id="cb572-15"><a href="#cb572-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb572-16"><a href="#cb572-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;-&quot;</span>,<span class="st">&quot;+&quot;</span>))<span class="sc">+</span></span>
<span id="cb572-17"><a href="#cb572-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;EC area (10&quot;</span><span class="sc">^</span><span class="dv">3</span>, <span class="st">&quot;mm&quot;</span><span class="sc">^</span><span class="dv">2</span>,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb572-18"><a href="#cb572-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>,<span class="fl">2.3</span>),</span>
<span id="cb572-19"><a href="#cb572-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="at">by=</span><span class="fl">0.4</span>))<span class="sc">+</span></span>
<span id="cb572-20"><a href="#cb572-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;yellow&quot;</span>) <span class="sc">+</span></span>
<span id="cb572-21"><a href="#cb572-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb572-22"><a href="#cb572-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb572-23"><a href="#cb572-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">vjust =</span> <span class="dv">6</span>),</span>
<span id="cb572-24"><a href="#cb572-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb572-25"><a href="#cb572-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb572-26"><a href="#cb572-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb572-27"><a href="#cb572-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb572-28"><a href="#cb572-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb572-29"><a href="#cb572-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb572-30"><a href="#cb572-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb572-31"><a href="#cb572-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb572-32"><a href="#cb572-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb572-33"><a href="#cb572-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb572-34"><a href="#cb572-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb572-35"><a href="#cb572-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb572-36"><a href="#cb572-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb572-37"><a href="#cb572-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb572-38"><a href="#cb572-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb572-39"><a href="#cb572-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb572-40"><a href="#cb572-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb572-41"><a href="#cb572-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face=</span><span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb572-42"><a href="#cb572-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face=</span><span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb572-43"><a href="#cb572-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb572-44"><a href="#cb572-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb572-45"><a href="#cb572-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-46"><a href="#cb572-46" aria-hidden="true" tabindex="-1"></a>Plot_Fig7D</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207D-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-7e-f" class="section level3" number="7.1.3">
<h3 number="7.1.3"><span class="header-section-number">7.1.3</span> Figure 7E-F</h3>
<div class="blue">
<p>Knockdown of TOR with MyoTS, an EC-specific driver, leads to the increased number of small ECs (F, right) compared to control (E, left); EC-specific GFP is indeed visible in small cells.<em>Complete graphical annotation can be found in manuscript figures</em></p>
</div>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="#cb573-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/7E.jpg&quot;</span>) </span>
<span id="cb573-2"><a href="#cb573-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig7E <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb573-3"><a href="#cb573-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig7E)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207E-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="#cb574-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/7F.jpg&quot;</span>) </span>
<span id="cb574-2"><a href="#cb574-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig7F <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb574-3"><a href="#cb574-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig7F)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207F-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="figure-7g" class="section level3" number="7.1.4">
<h3 number="7.1.4"><span class="header-section-number">7.1.4</span> Figure 7G</h3>
<div class="blue">
<p>Quantification of EC area. <em>Statistic annotation on panel present in manuscript’s figure.</em></p>
</div>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="#cb575-1" aria-hidden="true" tabindex="-1"></a>tab_area_Tor_IR <span class="ot">=</span> </span>
<span id="cb575-2"><a href="#cb575-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;7G&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb575-3"><a href="#cb575-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Area&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb575-4"><a href="#cb575-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_treatment=</span>Day,</span>
<span id="cb575-5"><a href="#cb575-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Female_Line=</span>Female.Line,</span>
<span id="cb575-6"><a href="#cb575-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Male_Line=</span>Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb575-7"><a href="#cb575-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb575-8"><a href="#cb575-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Diet=</span><span class="fu">fct_relevel</span>(Diet,<span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>, <span class="st">&quot;HStoHY&quot;</span>)),</span>
<span id="cb575-9"><a href="#cb575-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">Male_Line=</span><span class="fu">fct_relevel</span>(Male_Line,<span class="fu">c</span>(<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Tor-IR&quot;</span>)))</span>
<span id="cb575-10"><a href="#cb575-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb575-11"><a href="#cb575-11" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb575-12"><a href="#cb575-12" aria-hidden="true" tabindex="-1"></a>  tab_area_Tor_IR<span class="sc">%&gt;%</span></span>
<span id="cb575-13"><a href="#cb575-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Male_Line)<span class="sc">%&gt;%</span></span>
<span id="cb575-14"><a href="#cb575-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb575-15"><a href="#cb575-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb575-16"><a href="#cb575-16" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats Tor</span></span>
<span id="cb575-17"><a href="#cb575-17" aria-hidden="true" tabindex="-1"></a><span class="co"># D7</span></span>
<span id="cb575-18"><a href="#cb575-18" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Area) <span class="sc">~</span>  Diet <span class="sc">*</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat ) ,<span class="at">data =</span> tab_area_Tor_IR)</span>
<span id="cb575-19"><a href="#cb575-19" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.99748, p-value = 0.0005718</code></pre>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="#cb577-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Area) <span class="sc">~</span>  Diet <span class="sc">*</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat ) ,<span class="at">data =</span> tab_area_Tor_IR)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Area) ~ Diet * Male_Line + (1/Repeat)
BP = 37.175, df = 3, p-value = 4.225e-08</code></pre>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="#cb579-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Area) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat ),<span class="at">data =</span> tab_area_Tor_IR)</span>
<span id="cb579-2"><a href="#cb579-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb579-3"><a href="#cb579-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb579-4"><a href="#cb579-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb579-5"><a href="#cb579-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="st">&quot;Control vs Tor-IR&quot;</span>),</span>
<span id="cb579-6"><a href="#cb579-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_area_Tor_IR<span class="sc">$</span>Repeat),</span>
<span id="cb579-7"><a href="#cb579-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb579-8"><a href="#cb579-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb579-9"><a href="#cb579-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">4</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb579-10"><a href="#cb579-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb579-11"><a href="#cb579-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb579-12"><a href="#cb579-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb579-13"><a href="#cb579-13" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb579-14"><a href="#cb579-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb579-15"><a href="#cb579-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb579-16"><a href="#cb579-16" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb579-17"><a href="#cb579-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Response to diet&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Cell area) ~  Diet + Genotype + Diet : Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb579-18"><a href="#cb579-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Cell area) ~ Diet + Genotype + Diet : Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Response to diet
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Control vs Tor-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
178.09
</td>
<td style="text-align:left;">
4.61
</td>
<td style="text-align:left;">
-0.491
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="#cb580-1" aria-hidden="true" tabindex="-1"></a>tab_stat_7E<span class="ot">=</span>tab_stat</span>
<span id="cb580-2"><a href="#cb580-2" aria-hidden="true" tabindex="-1"></a>tab_stat_7E<span class="sc">$</span>Male_Line<span class="ot">=</span><span class="fu">factor</span>(<span class="st">&quot;Tor-IR&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">&quot;Tor-IR&quot;</span>))))</span>
<span id="cb580-3"><a href="#cb580-3" aria-hidden="true" tabindex="-1"></a>tab_stat_7E<span class="sc">$</span>Diet<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;HStoHY&quot;</span>)</span>
<span id="cb580-4"><a href="#cb580-4" aria-hidden="true" tabindex="-1"></a>tab_stat_7E<span class="sc">$</span>yposition <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.7</span>)</span>
<span id="cb580-5"><a href="#cb580-5" aria-hidden="true" tabindex="-1"></a>tab_stat_7E<span class="sc">$</span>xposition <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.5</span>)</span>
<span id="cb580-6"><a href="#cb580-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-7"><a href="#cb580-7" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb580-8"><a href="#cb580-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-9"><a href="#cb580-9" aria-hidden="true" tabindex="-1"></a>tab_area_Tor_IR<span class="sc">$</span>Female_Line <span class="ot">=</span> <span class="fu">factor</span>(tab_area_Tor_IR<span class="sc">$</span>Female_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;My&quot;</span>,o<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))))</span>
<span id="cb580-10"><a href="#cb580-10" aria-hidden="true" tabindex="-1"></a>tab_area_Tor_IR<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="fu">factor</span>(tab_area_Tor_IR<span class="sc">$</span>Male_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">&quot;Control&quot;</span>),<span class="fu">italic</span>(<span class="st">&quot;Tor-IR&quot;</span>))))</span>
<span id="cb580-11"><a href="#cb580-11" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="fu">factor</span>(Sample_size<span class="sc">$</span>Male_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">&quot;Control&quot;</span>),<span class="fu">italic</span>(<span class="st">&quot;Tor-IR&quot;</span>))))</span>
<span id="cb580-12"><a href="#cb580-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-13"><a href="#cb580-13" aria-hidden="true" tabindex="-1"></a>Plot_Fig7G<span class="ot">=</span></span>
<span id="cb580-14"><a href="#cb580-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_area_Tor_IR, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Area<span class="sc">/</span><span class="dv">1000</span>))<span class="sc">+</span> </span>
<span id="cb580-15"><a href="#cb580-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> C.G), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb580-16"><a href="#cb580-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.008</span>) <span class="sc">+</span> </span>
<span id="cb580-17"><a href="#cb580-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb580-18"><a href="#cb580-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Male_Line,<span class="at">labeller=</span>label_parsed )<span class="sc">+</span></span>
<span id="cb580-19"><a href="#cb580-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#FFB4B4&quot;</span>, <span class="st">&quot;#CCCCFF&quot;</span>))<span class="sc">+</span></span>
<span id="cb580-20"><a href="#cb580-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb580-21"><a href="#cb580-21" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HStoHY&quot;</span>),</span>
<span id="cb580-22"><a href="#cb580-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HS to HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb580-23"><a href="#cb580-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;EC area (10&quot;</span><span class="sc">^</span><span class="dv">3</span>, <span class="st">&quot;mm&quot;</span><span class="sc">^</span><span class="dv">2</span>,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb580-24"><a href="#cb580-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.12</span>,<span class="dv">1</span>),            </span>
<span id="cb580-25"><a href="#cb580-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.8</span>,<span class="at">by=</span><span class="fl">0.2</span>))<span class="sc">+</span> </span>
<span id="cb580-26"><a href="#cb580-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb580-27"><a href="#cb580-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb580-28"><a href="#cb580-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb580-29"><a href="#cb580-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb580-30"><a href="#cb580-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb580-31"><a href="#cb580-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb580-32"><a href="#cb580-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb580-33"><a href="#cb580-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb580-34"><a href="#cb580-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb580-35"><a href="#cb580-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb580-36"><a href="#cb580-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb580-37"><a href="#cb580-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb580-38"><a href="#cb580-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb580-39"><a href="#cb580-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb580-40"><a href="#cb580-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb580-41"><a href="#cb580-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb580-42"><a href="#cb580-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb580-43"><a href="#cb580-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb580-44"><a href="#cb580-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb580-45"><a href="#cb580-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb580-46"><a href="#cb580-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb580-47"><a href="#cb580-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb580-48"><a href="#cb580-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb580-49"><a href="#cb580-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb580-50"><a href="#cb580-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb580-51"><a href="#cb580-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb580-52"><a href="#cb580-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb580-53"><a href="#cb580-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb580-54"><a href="#cb580-54" aria-hidden="true" tabindex="-1"></a>Plot_Fig7G</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207G-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-7h" class="section level3" number="7.1.5">
<h3 number="7.1.5"><span class="header-section-number">7.1.5</span> Figure 7H</h3>
<div class="blue">
<p>Blocking TOR pathway components in ECs (MyoTS) inhibits diet induced midgut growth. Control showed in chart is representative of multiple experiments. Statistical analyses were performed only on appropriate repeat/experiment and comparing interaction between diet and fly line.</p>
</div>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="#cb581-1" aria-hidden="true" tabindex="-1"></a>tab_length_Tor <span class="ot">=</span> </span>
<span id="cb581-2"><a href="#cb581-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;7H&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb581-3"><a href="#cb581-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb581-4"><a href="#cb581-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm=</span>Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb581-5"><a href="#cb581-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_treatment=</span>Day,</span>
<span id="cb581-6"><a href="#cb581-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Female_Line=</span>Female.Line,</span>
<span id="cb581-7"><a href="#cb581-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Male_Line=</span>Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb581-8"><a href="#cb581-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb581-9"><a href="#cb581-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Male_Line=</span><span class="fu">fct_relevel</span>(Male_Line, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Tor-IR&quot;</span>,<span class="st">&quot;dMyc-IR&quot;</span>,<span class="st">&quot;S6k-IR&quot;</span>, <span class="st">&quot;SREBP-IR&quot;</span>, <span class="st">&quot;raptor-IR&quot;</span>))</span>
<span id="cb581-10"><a href="#cb581-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb581-11"><a href="#cb581-11" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb581-12"><a href="#cb581-12" aria-hidden="true" tabindex="-1"></a>  tab_length_Tor<span class="sc">%&gt;%</span></span>
<span id="cb581-13"><a href="#cb581-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Male_Line)<span class="sc">%&gt;%</span></span>
<span id="cb581-14"><a href="#cb581-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb581-15"><a href="#cb581-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb581-16"><a href="#cb581-16" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb581-17"><a href="#cb581-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb581-18"><a href="#cb581-18" aria-hidden="true" tabindex="-1"></a>list_genotype<span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Tor-IR&quot;</span>,<span class="st">&quot;dMyc-IR&quot;</span>,<span class="st">&quot;S6k-IR&quot;</span>, <span class="st">&quot;SREBP-IR&quot;</span>, <span class="st">&quot;raptor-IR&quot;</span>)</span>
<span id="cb581-19"><a href="#cb581-19" aria-hidden="true" tabindex="-1"></a>tab_stat_Tor<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb581-20"><a href="#cb581-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb581-21"><a href="#cb581-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> list_genotype){</span>
<span id="cb581-22"><a href="#cb581-22" aria-hidden="true" tabindex="-1"></a>list_control<span class="ot">=</span></span>
<span id="cb581-23"><a href="#cb581-23" aria-hidden="true" tabindex="-1"></a> <span class="fu">subset</span>(tab_length_Tor,Male_Line<span class="sc">%in%</span><span class="fu">c</span>(i)) <span class="sc">%&gt;%</span></span>
<span id="cb581-24"><a href="#cb581-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PhaseRep=</span><span class="fu">factor</span>(PhaseRep))<span class="sc">%&gt;%</span></span>
<span id="cb581-25"><a href="#cb581-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="fu">levels</span>(PhaseRep))</span>
<span id="cb581-26"><a href="#cb581-26" aria-hidden="true" tabindex="-1"></a>list_control <span class="ot">=</span> <span class="fu">as.list</span>(list_control<span class="sc">$</span><span class="st">`</span><span class="at">levels(PhaseRep)</span><span class="st">`</span>)</span>
<span id="cb581-27"><a href="#cb581-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb581-28"><a href="#cb581-28" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">=</span> <span class="fu">subset</span>(tab_length_Tor, Male_Line<span class="sc">%in%</span><span class="fu">c</span>(i, <span class="st">&quot;Control&quot;</span>) <span class="sc">&amp;</span> PhaseRep<span class="sc">%in%</span>list_control)<span class="sc">%&gt;%</span></span>
<span id="cb581-29"><a href="#cb581-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Male_Line=</span><span class="fu">factor</span>(Male_Line),</span>
<span id="cb581-30"><a href="#cb581-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">PhaseRep=</span><span class="fu">factor</span>(PhaseRep))</span>
<span id="cb581-31"><a href="#cb581-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb581-32"><a href="#cb581-32" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log10</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">*</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> PhaseRep),<span class="at">data =</span> tmp)</span>
<span id="cb581-33"><a href="#cb581-33" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span>
<span id="cb581-34"><a href="#cb581-34" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log10</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> PhaseRep),<span class="at">data =</span> tmp)</span>
<span id="cb581-35"><a href="#cb581-35" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log10</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> PhaseRep),<span class="at">data =</span> tmp)</span>
<span id="cb581-36"><a href="#cb581-36" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb581-37"><a href="#cb581-37" aria-hidden="true" tabindex="-1"></a>test</span>
<span id="cb581-38"><a href="#cb581-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb581-39"><a href="#cb581-39" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb581-40"><a href="#cb581-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb581-41"><a href="#cb581-41" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Male_Line =</span> <span class="fu">as.character</span>(i),</span>
<span id="cb581-42"><a href="#cb581-42" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tmp<span class="sc">$</span>PhaseRep),</span>
<span id="cb581-43"><a href="#cb581-43" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb581-44"><a href="#cb581-44" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb581-45"><a href="#cb581-45" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">4</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb581-46"><a href="#cb581-46" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb581-47"><a href="#cb581-47" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb581-48"><a href="#cb581-48" aria-hidden="true" tabindex="-1"></a>tab_stat_Tor <span class="ot">=</span> <span class="fu">rbind</span>(tab_stat_Tor,tab_stat)</span>
<span id="cb581-49"><a href="#cb581-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb581-50"><a href="#cb581-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb581-51"><a href="#cb581-51" aria-hidden="true" tabindex="-1"></a>tab_stat_Tor<span class="sc">$</span>padj<span class="ot">=</span><span class="fu">p.adjust</span>(tab_stat_Tor<span class="sc">$</span>Pvalue,<span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb581-52"><a href="#cb581-52" aria-hidden="true" tabindex="-1"></a>tab_stat_Tor<span class="sc">$</span>sig<span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat_Tor<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat_Tor<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb581-53"><a href="#cb581-53" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat_Tor<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat_Tor<span class="sc">$</span>padj <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb581-54"><a href="#cb581-54" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat_Tor<span class="sc">$</span>padj <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;ns&quot;</span>)))</span>
<span id="cb581-55"><a href="#cb581-55" aria-hidden="true" tabindex="-1"></a>tab_stat_Tor<span class="sc">%&gt;%</span></span>
<span id="cb581-56"><a href="#cb581-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Response to diet&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;p-value adjusted&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log10(Total_Length_mm) ~  Diet + Genotype + Diet : Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb581-57"><a href="#cb581-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log10(Total_Length_mm) ~ Diet + Genotype + Diet : Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Response to diet
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:right;">
p-value adjusted
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Tor-IR
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
36.00
</td>
<td style="text-align:left;">
0.592
</td>
<td style="text-align:left;">
-0.115
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
dMyc-IR
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
8.20
</td>
<td style="text-align:left;">
0.579
</td>
<td style="text-align:left;">
-0.0462
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0042
</td>
<td style="text-align:right;">
0.0088333
</td>
<td style="text-align:left;">
**
</td>
</tr>
<tr>
<td style="text-align:left;">
S6k-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7.77
</td>
<td style="text-align:left;">
0.57
</td>
<td style="text-align:left;">
-0.0478
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0053
</td>
<td style="text-align:right;">
0.0088333
</td>
<td style="text-align:left;">
**
</td>
</tr>
<tr>
<td style="text-align:left;">
SREBP-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5.93
</td>
<td style="text-align:left;">
0.58
</td>
<td style="text-align:left;">
-0.0434
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0150
</td>
<td style="text-align:right;">
0.0187500
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
raptor-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2.77
</td>
<td style="text-align:left;">
0.595
</td>
<td style="text-align:left;">
-0.0303
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0960
</td>
<td style="text-align:right;">
0.0960000
</td>
<td style="text-align:left;">
ns
</td>
</tr>
</tbody>
</table></li>
</ul>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="#cb582-1" aria-hidden="true" tabindex="-1"></a>tab_stat_Tor<span class="ot">=</span></span>
<span id="cb582-2"><a href="#cb582-2" aria-hidden="true" tabindex="-1"></a>  tab_stat_Tor<span class="sc">%&gt;%</span></span>
<span id="cb582-3"><a href="#cb582-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb582-4"><a href="#cb582-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Male_Line=</span><span class="fu">fct_relevel</span>(Male_Line, <span class="st">&quot;Tor-IR&quot;</span>,<span class="st">&quot;dMyc-IR&quot;</span>,<span class="st">&quot;S6k-IR&quot;</span>, <span class="st">&quot;SREBP-IR&quot;</span>, <span class="st">&quot;raptor-IR&quot;</span>))</span>
<span id="cb582-5"><a href="#cb582-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-6"><a href="#cb582-6" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb582-7"><a href="#cb582-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-8"><a href="#cb582-8" aria-hidden="true" tabindex="-1"></a>tab_length_Tor<span class="sc">$</span>Female_Line <span class="ot">=</span> <span class="fu">factor</span>(tab_length_Tor<span class="sc">$</span>Female_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;My&quot;</span>,o<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))))</span>
<span id="cb582-9"><a href="#cb582-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-10"><a href="#cb582-10" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(tab_length_Tor<span class="sc">$</span>Total_Length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb582-11"><a href="#cb582-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-12"><a href="#cb582-12" aria-hidden="true" tabindex="-1"></a>Plot_Fig7H<span class="ot">=</span></span>
<span id="cb582-13"><a href="#cb582-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_length_Tor, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb582-14"><a href="#cb582-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb582-15"><a href="#cb582-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">80</span>) <span class="sc">+</span> </span>
<span id="cb582-16"><a href="#cb582-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">2.4</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb582-17"><a href="#cb582-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_stat_Tor, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">8.3</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,<span class="fu">format</span>(Pvalue,<span class="at">digits=</span><span class="dv">2</span>))),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb582-18"><a href="#cb582-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Male_Line )<span class="sc">+</span></span>
<span id="cb582-19"><a href="#cb582-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>cbbHS_HStoHY)<span class="sc">+</span></span>
<span id="cb582-20"><a href="#cb582-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb582-21"><a href="#cb582-21" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HStoHY&quot;</span>),</span>
<span id="cb582-22"><a href="#cb582-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HS to HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb582-23"><a href="#cb582-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb582-24"><a href="#cb582-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">8.3</span>),</span>
<span id="cb582-25"><a href="#cb582-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb582-26"><a href="#cb582-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> PhaseRep)) <span class="sc">+</span></span>
<span id="cb582-27"><a href="#cb582-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> PhaseRep, <span class="at">colour =</span> PhaseRep)) <span class="sc">+</span></span>
<span id="cb582-28"><a href="#cb582-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> PhaseRep)) <span class="sc">+</span></span>
<span id="cb582-29"><a href="#cb582-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb582-30"><a href="#cb582-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb582-31"><a href="#cb582-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb582-32"><a href="#cb582-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb582-33"><a href="#cb582-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb582-34"><a href="#cb582-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb582-35"><a href="#cb582-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb582-36"><a href="#cb582-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb582-37"><a href="#cb582-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb582-38"><a href="#cb582-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb582-39"><a href="#cb582-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb582-40"><a href="#cb582-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb582-41"><a href="#cb582-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb582-42"><a href="#cb582-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb582-43"><a href="#cb582-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb582-44"><a href="#cb582-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb582-45"><a href="#cb582-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb582-46"><a href="#cb582-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb582-47"><a href="#cb582-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb582-48"><a href="#cb582-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb582-49"><a href="#cb582-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb582-50"><a href="#cb582-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> xSmallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">angle=</span><span class="dv">0</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb582-51"><a href="#cb582-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> xSmallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">angle=</span><span class="dv">0</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb582-52"><a href="#cb582-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb582-53"><a href="#cb582-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb582-54"><a href="#cb582-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb582-55"><a href="#cb582-55" aria-hidden="true" tabindex="-1"></a>Plot_Fig7H</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207H-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-7i-j" class="section level3" number="7.1.6">
<h3 number="7.1.6"><span class="header-section-number">7.1.6</span> Figure 7I-J</h3>
<p>:::</p>
<div class="blue">
<p>Representative picture utilizing single cell clonal system suggests that blocking Atg2 (hsFlp; Act&gt;STOP&gt;Gal4, UAS-GFP &gt;UAS-Atg2-IR, GFP+ cells) results in bigger ECs compared to control GFP- cells, quantified in J <em>Complete graphical annotation can be found in manuscript figures</em></p>
</div>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="#cb583-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/7I.jpg&quot;</span>) </span>
<span id="cb583-2"><a href="#cb583-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig7I <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb583-3"><a href="#cb583-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig7I)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207I-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>:::</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="#cb584-1" aria-hidden="true" tabindex="-1"></a>tab_ECclone_quant1 <span class="ot">=</span> </span>
<span id="cb584-2"><a href="#cb584-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;7J&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb584-3"><a href="#cb584-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Area&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb584-4"><a href="#cb584-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb584-5"><a href="#cb584-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Male_Line=</span>Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb584-6"><a href="#cb584-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb584-7"><a href="#cb584-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-8"><a href="#cb584-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-9"><a href="#cb584-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-10"><a href="#cb584-10" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb584-11"><a href="#cb584-11" aria-hidden="true" tabindex="-1"></a>  tab_ECclone_quant1<span class="sc">%&gt;%</span></span>
<span id="cb584-12"><a href="#cb584-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GFP)<span class="sc">%&gt;%</span></span>
<span id="cb584-13"><a href="#cb584-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb584-14"><a href="#cb584-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb584-15"><a href="#cb584-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb584-16"><a href="#cb584-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-17"><a href="#cb584-17" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb584-18"><a href="#cb584-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb584-19"><a href="#cb584-19" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Area) <span class="sc">~</span>  GFP,<span class="at">data =</span> <span class="fu">subset</span>(tab_ECclone_quant1, Male_Line<span class="sc">==</span><span class="st">&quot;Atg2-IR&quot;</span>))</span>
<span id="cb584-20"><a href="#cb584-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98076, p-value = 0.6105</code></pre>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="#cb586-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Area) <span class="sc">~</span>  GFP ,<span class="at">data =</span> <span class="fu">subset</span>(tab_ECclone_quant1, Male_Line<span class="sc">==</span><span class="st">&quot;Atg2-IR&quot;</span>))</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Area) ~ GFP
BP = 0.43242, df = 1, p-value = 0.5108</code></pre>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="#cb588-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Area) <span class="sc">~</span> <span class="dv">1</span> ,<span class="at">data =</span> <span class="fu">subset</span>(tab_ECclone_quant1, Male_Line<span class="sc">==</span><span class="st">&quot;Atg2-IR&quot;</span>))</span>
<span id="cb588-2"><a href="#cb588-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb588-3"><a href="#cb588-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb588-4"><a href="#cb588-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-5"><a href="#cb588-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;GFP Negative vs Positive (Atg2-IR)&quot;</span>)),</span>
<span id="cb588-6"><a href="#cb588-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb588-7"><a href="#cb588-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb588-8"><a href="#cb588-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb588-9"><a href="#cb588-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb588-10"><a href="#cb588-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb588-11"><a href="#cb588-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-12"><a href="#cb588-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-13"><a href="#cb588-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-14"><a href="#cb588-14" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb588-15"><a href="#cb588-15" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb588-16"><a href="#cb588-16" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb588-17"><a href="#cb588-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-18"><a href="#cb588-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-19"><a href="#cb588-19" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>Male_Line <span class="ot">=</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">&quot;Atg2-IR&quot;</span>))</span>
<span id="cb588-20"><a href="#cb588-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-21"><a href="#cb588-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-22"><a href="#cb588-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-23"><a href="#cb588-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-24"><a href="#cb588-24" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb588-25"><a href="#cb588-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Chi2&quot;</span>, <span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>, <span class="st">&quot;RNAi line&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Cell area) ~  GFP&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb588-26"><a href="#cb588-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Cell area) ~ GFP
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
<th style="text-align:left;">
RNAi line
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
GFP Negative vs Positive (Atg2-IR)
</td>
<td style="text-align:right;">
21.89
</td>
<td style="text-align:left;">
5.18
</td>
<td style="text-align:left;">
0.845
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.9e-06
</td>
<td style="text-align:left;">
***
</td>
<td style="text-align:left;">
Atg2-IR
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="#cb589-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb589-2"><a href="#cb589-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb589-3"><a href="#cb589-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb589-4"><a href="#cb589-4" aria-hidden="true" tabindex="-1"></a>Plot_Fig7J<span class="ot">=</span></span>
<span id="cb589-5"><a href="#cb589-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_ECclone_quant1, <span class="fu">aes</span>(<span class="at">x =</span> GFP, <span class="at">y =</span> Area<span class="sc">/</span><span class="dv">1000</span>))<span class="sc">+</span> </span>
<span id="cb589-6"><a href="#cb589-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> GFP), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb589-7"><a href="#cb589-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.03</span>) <span class="sc">+</span> </span>
<span id="cb589-8"><a href="#cb589-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> GFP, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.08</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb589-9"><a href="#cb589-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">data =</span> tab_stat,<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">annotations =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">y_position =</span> <span class="fl">0.9</span>), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">manual =</span> <span class="cn">TRUE</span>, <span class="at">tip_length =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>))<span class="sc">+</span></span>
<span id="cb589-10"><a href="#cb589-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb589-11"><a href="#cb589-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Male_Line)<span class="sc">+</span></span>
<span id="cb589-12"><a href="#cb589-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb589-13"><a href="#cb589-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#e4e4e4&quot;</span>,<span class="st">&quot;#8ee53f&quot;</span>))<span class="sc">+</span></span>
<span id="cb589-14"><a href="#cb589-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;GFP&quot;</span>,</span>
<span id="cb589-15"><a href="#cb589-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb589-16"><a href="#cb589-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;-&quot;</span>,<span class="st">&quot;+&quot;</span>))<span class="sc">+</span></span>
<span id="cb589-17"><a href="#cb589-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;EC area (10&quot;</span><span class="sc">^</span><span class="dv">3</span>, <span class="st">&quot;mm&quot;</span><span class="sc">^</span><span class="dv">2</span>,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb589-18"><a href="#cb589-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="dv">1</span>),</span>
<span id="cb589-19"><a href="#cb589-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="at">by=</span><span class="fl">0.4</span>))<span class="sc">+</span></span>
<span id="cb589-20"><a href="#cb589-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;yellow&quot;</span>) <span class="sc">+</span></span>
<span id="cb589-21"><a href="#cb589-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb589-22"><a href="#cb589-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb589-23"><a href="#cb589-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb589-24"><a href="#cb589-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb589-25"><a href="#cb589-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb589-26"><a href="#cb589-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb589-27"><a href="#cb589-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb589-28"><a href="#cb589-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb589-29"><a href="#cb589-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb589-30"><a href="#cb589-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb589-31"><a href="#cb589-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb589-32"><a href="#cb589-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb589-33"><a href="#cb589-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb589-34"><a href="#cb589-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb589-35"><a href="#cb589-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb589-36"><a href="#cb589-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb589-37"><a href="#cb589-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb589-38"><a href="#cb589-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb589-39"><a href="#cb589-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb589-40"><a href="#cb589-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb589-41"><a href="#cb589-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face=</span><span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb589-42"><a href="#cb589-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face=</span><span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb589-43"><a href="#cb589-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb589-44"><a href="#cb589-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb589-45"><a href="#cb589-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb589-46"><a href="#cb589-46" aria-hidden="true" tabindex="-1"></a>Plot_Fig7J</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207J-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-7k" class="section level3" number="7.1.7">
<h3 number="7.1.7"><span class="header-section-number">7.1.7</span> Figure 7K</h3>
<div class="blue">
<p>Blocking autophagy reduces midgut resizing upon shrinkage (HY to HS for 7 days). Blocking Atg8a expression with RNAi in ECs (MyoTS&gt; UAS-Atg8a-IR) results in less length shrinkage compared to control midguts.</p>
</div>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="#cb590-1" aria-hidden="true" tabindex="-1"></a>tab_length_Atg8a <span class="ot">=</span> </span>
<span id="cb590-2"><a href="#cb590-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;7K&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb590-3"><a href="#cb590-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb590-4"><a href="#cb590-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm=</span>Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb590-5"><a href="#cb590-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_treatment=</span>Day,</span>
<span id="cb590-6"><a href="#cb590-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Female_Line=</span>Female.Line,</span>
<span id="cb590-7"><a href="#cb590-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Male_Line=</span>Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb590-8"><a href="#cb590-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb590-9"><a href="#cb590-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Male_Line=</span><span class="fu">fct_relevel</span>(Male_Line,<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Atg8a-IR&quot;</span>))</span>
<span id="cb590-10"><a href="#cb590-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb590-11"><a href="#cb590-11" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb590-12"><a href="#cb590-12" aria-hidden="true" tabindex="-1"></a>  tab_length_Atg8a<span class="sc">%&gt;%</span></span>
<span id="cb590-13"><a href="#cb590-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Male_Line)<span class="sc">%&gt;%</span></span>
<span id="cb590-14"><a href="#cb590-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb590-15"><a href="#cb590-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb590-16"><a href="#cb590-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Male_Line=</span><span class="fu">fct_relevel</span>(Male_Line,<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Atg8a-IR&quot;</span>))</span>
<span id="cb590-17"><a href="#cb590-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb590-18"><a href="#cb590-18" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb590-19"><a href="#cb590-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb590-20"><a href="#cb590-20" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log10</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">*</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> PhaseRep),<span class="at">data =</span> tab_length_Atg8a)</span>
<span id="cb590-21"><a href="#cb590-21" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.99618, p-value = 0.9774</code></pre>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="#cb592-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log10</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> PhaseRep),<span class="at">data =</span> tab_length_Atg8a)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log10(Total_Length_mm) ~ Diet + Male_Line + (1/PhaseRep)
BP = 0.46985, df = 2, p-value = 0.7906</code></pre>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="#cb594-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log10</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> PhaseRep),<span class="at">data =</span> tab_length_Atg8a)</span>
<span id="cb594-2"><a href="#cb594-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb594-3"><a href="#cb594-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb594-4"><a href="#cb594-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-5"><a href="#cb594-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Interaction control vs interaction Atg8a-IR&quot;</span>)),</span>
<span id="cb594-6"><a href="#cb594-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Male_Line =</span> <span class="fu">as.character</span>(<span class="st">&quot;Atg8a-IR&quot;</span>),</span>
<span id="cb594-7"><a href="#cb594-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_length_Atg8a<span class="sc">$</span>PhaseRep),</span>
<span id="cb594-8"><a href="#cb594-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb594-9"><a href="#cb594-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb594-10"><a href="#cb594-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">4</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb594-11"><a href="#cb594-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb594-12"><a href="#cb594-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb594-13"><a href="#cb594-13" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">mutate</span>(<span class="at">Male_Line=</span><span class="fu">fct_relevel</span>(Male_Line,<span class="st">&quot;Atg8a-IR&quot;</span>))</span>
<span id="cb594-14"><a href="#cb594-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-15"><a href="#cb594-15" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb594-16"><a href="#cb594-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb594-17"><a href="#cb594-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb594-18"><a href="#cb594-18" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb594-19"><a href="#cb594-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>,<span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log10(Total_Length_mm) ~  Diet + Genotype + Diet : Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb594-20"><a href="#cb594-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log10(Total_Length_mm) ~ Diet + Genotype + Diet : Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Interaction control vs interaction Atg8a-IR
</td>
<td style="text-align:left;">
Atg8a-IR
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
22.8
</td>
<td style="text-align:left;">
0.742
</td>
<td style="text-align:left;">
0.0782
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.8e-06
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="#cb595-1" aria-hidden="true" tabindex="-1"></a>tab_stat7K <span class="ot">=</span> tab_stat</span>
<span id="cb595-2"><a href="#cb595-2" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb595-3"><a href="#cb595-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb595-4"><a href="#cb595-4" aria-hidden="true" tabindex="-1"></a>tab_length_Atg8a<span class="sc">$</span>Female_Line <span class="ot">=</span> <span class="fu">factor</span>(tab_length_Atg8a<span class="sc">$</span>Female_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;My&quot;</span>,o<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))))</span>
<span id="cb595-5"><a href="#cb595-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb595-6"><a href="#cb595-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(tab_length_Atg8a<span class="sc">$</span>Total_Length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb595-7"><a href="#cb595-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb595-8"><a href="#cb595-8" aria-hidden="true" tabindex="-1"></a>Plot_Fig7K<span class="ot">=</span></span>
<span id="cb595-9"><a href="#cb595-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_length_Atg8a, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb595-10"><a href="#cb595-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb595-11"><a href="#cb595-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">60</span>) <span class="sc">+</span> </span>
<span id="cb595-12"><a href="#cb595-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">2.3</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb595-13"><a href="#cb595-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Male_Line)<span class="sc">+</span></span>
<span id="cb595-14"><a href="#cb595-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>cbbHY_HYtoHS)<span class="sc">+</span></span>
<span id="cb595-15"><a href="#cb595-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb595-16"><a href="#cb595-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>,<span class="st">&quot;HYtoHS&quot;</span>),</span>
<span id="cb595-17"><a href="#cb595-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>,<span class="st">&quot;HY to HS&quot;</span>))<span class="sc">+</span></span>
<span id="cb595-18"><a href="#cb595-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb595-19"><a href="#cb595-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">7.5</span>),</span>
<span id="cb595-20"><a href="#cb595-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">7</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb595-21"><a href="#cb595-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb595-22"><a href="#cb595-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb595-23"><a href="#cb595-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb595-24"><a href="#cb595-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb595-25"><a href="#cb595-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb595-26"><a href="#cb595-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb595-27"><a href="#cb595-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb595-28"><a href="#cb595-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb595-29"><a href="#cb595-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb595-30"><a href="#cb595-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb595-31"><a href="#cb595-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb595-32"><a href="#cb595-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb595-33"><a href="#cb595-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb595-34"><a href="#cb595-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb595-35"><a href="#cb595-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb595-36"><a href="#cb595-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb595-37"><a href="#cb595-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb595-38"><a href="#cb595-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb595-39"><a href="#cb595-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb595-40"><a href="#cb595-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb595-41"><a href="#cb595-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb595-42"><a href="#cb595-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb595-43"><a href="#cb595-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb595-44"><a href="#cb595-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face=</span><span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb595-45"><a href="#cb595-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face=</span><span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb595-46"><a href="#cb595-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb595-47"><a href="#cb595-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb595-48"><a href="#cb595-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb595-49"><a href="#cb595-49" aria-hidden="true" tabindex="-1"></a>Plot_Fig7K</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207K-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-7l" class="section level3" number="7.1.8">
<h3 number="7.1.8"><span class="header-section-number">7.1.8</span> Figure 7L</h3>
<div class="blue">
<p>Blocking Atg2 expression with RNAi in ECs (MyoTS&gt; UAS-Atg2-IR) results in less width shrinkage compared to control midguts. <em>Complete statistical annotation in manuscript’s figure.</em></p>
</div>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="#cb596-1" aria-hidden="true" tabindex="-1"></a>tab_length_Atg2 <span class="ot">=</span> </span>
<span id="cb596-2"><a href="#cb596-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;7L&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb596-3"><a href="#cb596-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb596-4"><a href="#cb596-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Width_mm=</span>Total.W<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb596-5"><a href="#cb596-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_treatment=</span>Day,</span>
<span id="cb596-6"><a href="#cb596-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Female_Line=</span>Female.Line,</span>
<span id="cb596-7"><a href="#cb596-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Male_Line=</span>Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb596-8"><a href="#cb596-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb596-9"><a href="#cb596-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Male_Line=</span><span class="fu">fct_relevel</span>(Male_Line,<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Atg2-IR&quot;</span>))</span>
<span id="cb596-10"><a href="#cb596-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb596-11"><a href="#cb596-11" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb596-12"><a href="#cb596-12" aria-hidden="true" tabindex="-1"></a>  tab_length_Atg2<span class="sc">%&gt;%</span></span>
<span id="cb596-13"><a href="#cb596-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Male_Line)<span class="sc">%&gt;%</span></span>
<span id="cb596-14"><a href="#cb596-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb596-15"><a href="#cb596-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb596-16"><a href="#cb596-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Male_Line=</span><span class="fu">fct_relevel</span>(Male_Line,<span class="st">&quot;Control&quot;</span>,<span class="st">&quot;Atg2-IR&quot;</span>))</span>
<span id="cb596-17"><a href="#cb596-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb596-18"><a href="#cb596-18" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb596-19"><a href="#cb596-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb596-20"><a href="#cb596-20" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log10</span>(Total_Width_mm) <span class="sc">~</span>  Diet <span class="sc">*</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> PhaseRep),<span class="at">data =</span> tab_length_Atg2)</span>
<span id="cb596-21"><a href="#cb596-21" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98933, p-value = 0.3713</code></pre>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log10</span>(Total_Width_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> PhaseRep),<span class="at">data =</span> tab_length_Atg2)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log10(Total_Width_mm) ~ Diet + Male_Line + (1/PhaseRep)
BP = 0.49881, df = 2, p-value = 0.7793</code></pre>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="#cb600-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log10</span>(Total_Width_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Male_Line <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> PhaseRep),<span class="at">data =</span> tab_length_Atg2)</span>
<span id="cb600-2"><a href="#cb600-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb600-3"><a href="#cb600-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb600-4"><a href="#cb600-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb600-5"><a href="#cb600-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Interaction control vs interaction Atg2-IR&quot;</span>)),<span class="at">Male_Line =</span> <span class="fu">as.character</span>(<span class="st">&quot;Atg2-IR&quot;</span>),</span>
<span id="cb600-6"><a href="#cb600-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_length_Atg2<span class="sc">$</span>PhaseRep),</span>
<span id="cb600-7"><a href="#cb600-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb600-8"><a href="#cb600-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb600-9"><a href="#cb600-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">4</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb600-10"><a href="#cb600-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb600-11"><a href="#cb600-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb600-12"><a href="#cb600-12" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">mutate</span>(<span class="at">Male_Line=</span><span class="fu">fct_relevel</span>(Male_Line,<span class="st">&quot;Atg2-IR&quot;</span>))</span>
<span id="cb600-13"><a href="#cb600-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb600-14"><a href="#cb600-14" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb600-15"><a href="#cb600-15" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb600-16"><a href="#cb600-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb600-17"><a href="#cb600-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb600-18"><a href="#cb600-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log10(Total_width_mm) ~  Diet + Genotype + Diet : Genotype + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb600-19"><a href="#cb600-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log10(Total_width_mm) ~ Diet + Genotype + Diet : Genotype + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Interaction control vs interaction Atg2-IR
</td>
<td style="text-align:left;">
Atg2-IR
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
10.74
</td>
<td style="text-align:left;">
-0.267
</td>
<td style="text-align:left;">
0.0524
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="#cb601-1" aria-hidden="true" tabindex="-1"></a>tab_stat7L <span class="ot">=</span> tab_stat</span>
<span id="cb601-2"><a href="#cb601-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb601-3"><a href="#cb601-3" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb601-4"><a href="#cb601-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb601-5"><a href="#cb601-5" aria-hidden="true" tabindex="-1"></a>tab_length_Atg2<span class="sc">$</span>Female_Line <span class="ot">=</span> <span class="fu">factor</span>(tab_length_Atg2<span class="sc">$</span>Female_Line, <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(<span class="fu">paste</span>(<span class="st">&quot;My&quot;</span>,o<span class="sc">^</span>{TS},<span class="st">&quot;&gt;&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)))))</span>
<span id="cb601-6"><a href="#cb601-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(tab_length_Atg2<span class="sc">$</span>Total_Width_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb601-7"><a href="#cb601-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb601-8"><a href="#cb601-8" aria-hidden="true" tabindex="-1"></a>Plot_Fig7L<span class="ot">=</span></span>
<span id="cb601-9"><a href="#cb601-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_length_Atg2, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Width_mm))<span class="sc">+</span> </span>
<span id="cb601-10"><a href="#cb601-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb601-11"><a href="#cb601-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">60</span>) <span class="sc">+</span> </span>
<span id="cb601-12"><a href="#cb601-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">0.24</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb601-13"><a href="#cb601-13" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_text(data = tab_stat, mapping = aes(x = 1.5, y =0.88, label = paste(&quot;p=&quot;,Pvalue)),size=3)+</span></span>
<span id="cb601-14"><a href="#cb601-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Male_Line)<span class="sc">+</span></span>
<span id="cb601-15"><a href="#cb601-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>cbbHY_HYtoHS)<span class="sc">+</span></span>
<span id="cb601-16"><a href="#cb601-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb601-17"><a href="#cb601-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>,<span class="st">&quot;HYtoHS&quot;</span>),</span>
<span id="cb601-18"><a href="#cb601-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>,<span class="st">&quot;HY to HS&quot;</span>))<span class="sc">+</span></span>
<span id="cb601-19"><a href="#cb601-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut width (mm)&quot;</span>,</span>
<span id="cb601-20"><a href="#cb601-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.9</span>),</span>
<span id="cb601-21"><a href="#cb601-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="fl">0.2</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb601-22"><a href="#cb601-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb601-23"><a href="#cb601-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb601-24"><a href="#cb601-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb601-25"><a href="#cb601-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb601-26"><a href="#cb601-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb601-27"><a href="#cb601-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb601-28"><a href="#cb601-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb601-29"><a href="#cb601-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb601-30"><a href="#cb601-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb601-31"><a href="#cb601-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb601-32"><a href="#cb601-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb601-33"><a href="#cb601-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb601-34"><a href="#cb601-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb601-35"><a href="#cb601-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb601-36"><a href="#cb601-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb601-37"><a href="#cb601-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb601-38"><a href="#cb601-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb601-39"><a href="#cb601-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb601-40"><a href="#cb601-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb601-41"><a href="#cb601-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb601-42"><a href="#cb601-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb601-43"><a href="#cb601-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb601-44"><a href="#cb601-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb601-45"><a href="#cb601-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face=</span><span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb601-46"><a href="#cb601-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face=</span><span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb601-47"><a href="#cb601-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb601-48"><a href="#cb601-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb601-49"><a href="#cb601-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb601-50"><a href="#cb601-50" aria-hidden="true" tabindex="-1"></a>Plot_Fig7L</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207L-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>##Export Figure 7</p>
</div>
</div>
<div id="figure-7---supplementary-1" class="section level2" number="7.2">
<h2 number="7.2"><span class="header-section-number">7.2</span> Figure 7 - supplementary 1</h2>
<div id="figure-7s1a" class="section level3" number="7.2.1">
<h3 number="7.2.1"><span class="header-section-number">7.2.1</span> Figure 7S1A</h3>
<div class="blue">
<p>The midgut plastically resizes through changes in EC cell size. Quantification of EC area shows that, in addition to total length, the midgut is also able to plastically resize (Figure 4A) its own ECs. ECs scored are derived from midguts measured for length in figure 4A. Letters above violin plots represent grouping by statistical differences (Post hoc Tukey on GLMM).</p>
</div>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="#cb602-1" aria-hidden="true" tabindex="-1"></a>tab_area_plasticity <span class="ot">=</span> </span>
<span id="cb602-2"><a href="#cb602-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;7 - S1A&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb602-3"><a href="#cb602-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb602-4"><a href="#cb602-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)</span>
<span id="cb602-5"><a href="#cb602-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb602-6"><a href="#cb602-6" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb602-7"><a href="#cb602-7" aria-hidden="true" tabindex="-1"></a>  tab_area_plasticity<span class="sc">%&gt;%</span></span>
<span id="cb602-8"><a href="#cb602-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb602-9"><a href="#cb602-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb602-10"><a href="#cb602-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb602-11"><a href="#cb602-11" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb602-12"><a href="#cb602-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb602-13"><a href="#cb602-13" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log10</span>(Area) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_area_plasticity)</span>
<span id="cb602-14"><a href="#cb602-14" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.99946, p-value = 0.6205</code></pre>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="#cb604-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log10</span>(Area) <span class="sc">~</span> Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat), <span class="at">data =</span> tab_area_plasticity) </span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log10(Area) ~ Diet + (1/Repeat)
BP = 66.112, df = 3, p-value = 2.9e-14</code></pre>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="#cb606-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log10</span>(Area) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_area_plasticity) </span>
<span id="cb606-2"><a href="#cb606-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb606-3"><a href="#cb606-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb606-4"><a href="#cb606-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb606-5"><a href="#cb606-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Anova between diets&quot;</span>)),</span>
<span id="cb606-6"><a href="#cb606-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_area_plasticity<span class="sc">$</span>Repeat),</span>
<span id="cb606-7"><a href="#cb606-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb606-8"><a href="#cb606-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">2</span>),  </span>
<span id="cb606-9"><a href="#cb606-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(<span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),<span class="at">digits=</span><span class="dv">2</span>),</span>
<span id="cb606-10"><a href="#cb606-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb606-11"><a href="#cb606-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>,<span class="at">scientific=</span>T)))</span>
<span id="cb606-12"><a href="#cb606-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb606-13"><a href="#cb606-13" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb606-14"><a href="#cb606-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb606-15"><a href="#cb606-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb606-16"><a href="#cb606-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb606-17"><a href="#cb606-17" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb606-18"><a href="#cb606-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log10(Cell area) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb606-19"><a href="#cb606-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log10(Cell area) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Anova between diets
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1514.68
</td>
<td style="text-align:left;">
2.1
</td>
<td style="text-align:left;">
0.395
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="#cb607-1" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">lmer</span>(<span class="fu">log10</span>(Area) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat), <span class="at">data =</span> tab_area_plasticity)</span>
<span id="cb607-2"><a href="#cb607-2" aria-hidden="true" tabindex="-1"></a>multcomp <span class="ot">=</span> <span class="fu">glht</span>(mod.gen, <span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">Diet=</span><span class="st">&quot;Tukey&quot;</span>))</span>
<span id="cb607-3"><a href="#cb607-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb607-4"><a href="#cb607-4" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">cld</span>(multcomp)</span>
<span id="cb607-5"><a href="#cb607-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb607-6"><a href="#cb607-6" aria-hidden="true" tabindex="-1"></a>letter_position <span class="ot">=</span> <span class="fu">aggregate</span>(<span class="at">data=</span>tab_area_plasticity,<span class="fu">I</span>(Area<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">~</span>  Diet, max)</span>
<span id="cb607-7"><a href="#cb607-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb607-8"><a href="#cb607-8" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span>  <span class="fu">as.data.frame</span>(tmp<span class="sc">$</span>mcletters<span class="sc">$</span>Letters)</span>
<span id="cb607-9"><a href="#cb607-9" aria-hidden="true" tabindex="-1"></a>tab_letter<span class="sc">$</span>Diet<span class="ot">=</span><span class="fu">rownames</span>(tab_letter)</span>
<span id="cb607-10"><a href="#cb607-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_letter)[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">&quot;Letter&quot;</span></span>
<span id="cb607-11"><a href="#cb607-11" aria-hidden="true" tabindex="-1"></a>tab_letter <span class="ot">=</span> <span class="fu">left_join</span>(tab_letter,letter_position)</span>
<span id="cb607-12"><a href="#cb607-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_letter)[<span class="dv">3</span>] <span class="ot">=</span> <span class="st">&quot;Area&quot;</span></span>
<span id="cb607-13"><a href="#cb607-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb607-14"><a href="#cb607-14" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb607-15"><a href="#cb607-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb607-16"><a href="#cb607-16" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">max</span>(tab_area_plasticity<span class="sc">$</span>Area<span class="sc">/</span><span class="dv">1000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb607-17"><a href="#cb607-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb607-18"><a href="#cb607-18" aria-hidden="true" tabindex="-1"></a>Plot_Fig7S1A<span class="ot">=</span></span>
<span id="cb607-19"><a href="#cb607-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_area_plasticity, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Area<span class="sc">/</span><span class="dv">1000</span>))<span class="sc">+</span> </span>
<span id="cb607-20"><a href="#cb607-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb607-21"><a href="#cb607-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> z<span class="sc">/</span><span class="dv">300</span>) <span class="sc">+</span> </span>
<span id="cb607-22"><a href="#cb607-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.01</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb607-23"><a href="#cb607-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_stat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span><span class="fl">1.15</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;p&lt; &quot;</span>,<span class="fu">format</span>(.Machine<span class="sc">$</span>double.xmin,<span class="at">digits=</span><span class="dv">2</span>))),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb607-24"><a href="#cb607-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_letter, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Area<span class="fl">+0.05</span>, <span class="at">label =</span> Letter),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb607-25"><a href="#cb607-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;Eclosion&quot;</span>, <span class="st">&quot;HY&quot;</span>, <span class="st">&quot;HYtoHS&quot;</span>, <span class="st">&quot;HYtoHStoHY&quot;</span>),</span>
<span id="cb607-26"><a href="#cb607-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span> cbbPalette_4 )<span class="sc">+</span></span>
<span id="cb607-27"><a href="#cb607-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb607-28"><a href="#cb607-28" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;Eclosion&quot;</span>, <span class="st">&quot;HY&quot;</span>, <span class="st">&quot;HYtoHS&quot;</span>, <span class="st">&quot;HYtoHStoHY&quot;</span>),</span>
<span id="cb607-29"><a href="#cb607-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Eclosion&quot;</span>, <span class="st">&quot;HY&quot;</span>, <span class="st">&quot;HY to HS&quot;</span>, <span class="st">&quot;HY to HS to HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb607-30"><a href="#cb607-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;EC area (10&quot;</span><span class="sc">^</span><span class="dv">3</span>, <span class="st">&quot;mm&quot;</span><span class="sc">^</span><span class="dv">2</span>,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb607-31"><a href="#cb607-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.01</span>,<span class="fl">1.22</span>),</span>
<span id="cb607-32"><a href="#cb607-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">1.2</span>,<span class="at">by=</span><span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb607-33"><a href="#cb607-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb607-34"><a href="#cb607-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb607-35"><a href="#cb607-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb607-36"><a href="#cb607-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb607-37"><a href="#cb607-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb607-38"><a href="#cb607-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb607-39"><a href="#cb607-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb607-40"><a href="#cb607-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb607-41"><a href="#cb607-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb607-42"><a href="#cb607-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb607-43"><a href="#cb607-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb607-44"><a href="#cb607-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">15</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb607-45"><a href="#cb607-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb607-46"><a href="#cb607-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb607-47"><a href="#cb607-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb607-48"><a href="#cb607-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb607-49"><a href="#cb607-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb607-50"><a href="#cb607-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb607-51"><a href="#cb607-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb607-52"><a href="#cb607-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb607-53"><a href="#cb607-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb607-54"><a href="#cb607-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb607-55"><a href="#cb607-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))</span>
<span id="cb607-56"><a href="#cb607-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb607-57"><a href="#cb607-57" aria-hidden="true" tabindex="-1"></a>Plot_Fig7S1A</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207S1A-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-7s1b" class="section level3" number="7.2.2">
<h3 number="7.2.2"><span class="header-section-number">7.2.2</span> Figure 7S1B</h3>
<div class="blue">
<p>Changes in EC area between HS and HY (ratio HY/HS of mean EC area) significantly correlate with changes in midgut size between HS and HY (ratio HY/HS of mean midgut length) across selected DGRP lines.</p>
</div>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="#cb608-1" aria-hidden="true" tabindex="-1"></a>tab_corr_length_cell_DGRP_mean_area <span class="ot">=</span></span>
<span id="cb608-2"><a href="#cb608-2" aria-hidden="true" tabindex="-1"></a>  tab_corr_length_cell_DGRP<span class="sc">%&gt;%</span></span>
<span id="cb608-3"><a href="#cb608-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ral,diet)<span class="sc">%&gt;%</span></span>
<span id="cb608-4"><a href="#cb608-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_area=</span><span class="fu">mean</span>(ec.area,<span class="at">na.rm=</span>T))<span class="sc">%&gt;%</span></span>
<span id="cb608-5"><a href="#cb608-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(diet,mean_area)<span class="sc">%&gt;%</span></span>
<span id="cb608-6"><a href="#cb608-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">mean_area_HS=</span>HS,</span>
<span id="cb608-7"><a href="#cb608-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">mean_area_HY=</span>HY)<span class="sc">%&gt;%</span></span>
<span id="cb608-8"><a href="#cb608-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio_area =</span> mean_area_HY<span class="sc">/</span>mean_area_HS)</span>
<span id="cb608-9"><a href="#cb608-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-10"><a href="#cb608-10" aria-hidden="true" tabindex="-1"></a>tab_corr_length_cell_DGRP_mean_length <span class="ot">=</span></span>
<span id="cb608-11"><a href="#cb608-11" aria-hidden="true" tabindex="-1"></a>  tab_corr_length_cell_DGRP<span class="sc">%&gt;%</span></span>
<span id="cb608-12"><a href="#cb608-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ral,diet)<span class="sc">%&gt;%</span></span>
<span id="cb608-13"><a href="#cb608-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_length=</span><span class="fu">mean</span>(len,<span class="at">na.rm=</span>T))<span class="sc">%&gt;%</span></span>
<span id="cb608-14"><a href="#cb608-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(diet,mean_length)<span class="sc">%&gt;%</span></span>
<span id="cb608-15"><a href="#cb608-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">mean_length_HS=</span>HS,</span>
<span id="cb608-16"><a href="#cb608-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">mean_length_HY=</span>HY)<span class="sc">%&gt;%</span></span>
<span id="cb608-17"><a href="#cb608-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio_length =</span> mean_length_HY<span class="sc">/</span>mean_length_HS)</span>
<span id="cb608-18"><a href="#cb608-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-19"><a href="#cb608-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-20"><a href="#cb608-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-21"><a href="#cb608-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-22"><a href="#cb608-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-23"><a href="#cb608-23" aria-hidden="true" tabindex="-1"></a>tab_corr_length_cell_DGRP_mean<span class="ot">=</span> <span class="fu">left_join</span>(tab_corr_length_cell_DGRP_mean_length,tab_corr_length_cell_DGRP_mean_area)</span>
<span id="cb608-24"><a href="#cb608-24" aria-hidden="true" tabindex="-1"></a>tab_corr_length_cell_DGRP_mean<span class="ot">=</span><span class="fu">as.data.frame</span>(tab_corr_length_cell_DGRP_mean)</span>
<span id="cb608-25"><a href="#cb608-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-26"><a href="#cb608-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-27"><a href="#cb608-27" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(tab_corr_length_cell_DGRP_mean<span class="sc">$</span>ral) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Ral 356&quot;</span>, <span class="st">&quot;Ral 362&quot;</span>, <span class="st">&quot;Ral 370&quot;</span>, <span class="st">&quot;Ral 502&quot;</span>, <span class="st">&quot;Ral 765&quot;</span>, <span class="st">&quot;Ral 853&quot;</span>, <span class="st">&quot;Ral 911&quot;</span> )</span>
<span id="cb608-28"><a href="#cb608-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-29"><a href="#cb608-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-30"><a href="#cb608-30" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span></span>
<span id="cb608-31"><a href="#cb608-31" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(tab_corr_length_cell_DGRP_mean,</span>
<span id="cb608-32"><a href="#cb608-32" aria-hidden="true" tabindex="-1"></a>     <span class="fu">cor.test</span>(Ratio_area,Ratio_length,<span class="at">method=</span><span class="st">&quot;pearson&quot;</span>))</span>
<span id="cb608-33"><a href="#cb608-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-34"><a href="#cb608-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-35"><a href="#cb608-35" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Statistic =</span> test<span class="sc">$</span>statistic,</span>
<span id="cb608-36"><a href="#cb608-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">cor =</span> test<span class="sc">$</span>estimate,</span>
<span id="cb608-37"><a href="#cb608-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">Pvalue =</span> test<span class="sc">$</span>p.value)</span>
<span id="cb608-38"><a href="#cb608-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-39"><a href="#cb608-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-40"><a href="#cb608-40" aria-hidden="true" tabindex="-1"></a><span class="co">#levels(tab_corr_length_cell_DGRP_mean$ral) &lt;- c(&quot;Ral 356&quot;, &quot;Ral 362&quot;, &quot;Ral 370&quot;, &quot;Ral 502&quot;, &quot;Ral 765&quot;, &quot;Ral 853&quot;, &quot;Ral 911&quot; )</span></span>
<span id="cb608-41"><a href="#cb608-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-42"><a href="#cb608-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-43"><a href="#cb608-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-44"><a href="#cb608-44" aria-hidden="true" tabindex="-1"></a>Plot_Fig7S1B <span class="ot">=</span> </span>
<span id="cb608-45"><a href="#cb608-45" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tab_corr_length_cell_DGRP_mean,<span class="fu">aes</span>(<span class="at">x=</span>Ratio_area,<span class="at">y=</span>Ratio_length,<span class="at">label=</span>ral))<span class="sc">+</span></span>
<span id="cb608-46"><a href="#cb608-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb608-47"><a href="#cb608-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Ratio HY/HS (mean EC area)&quot;</span>)),</span>
<span id="cb608-48"><a href="#cb608-48" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">2.6</span>),</span>
<span id="cb608-49"><a href="#cb608-49" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="fl">0.8</span>,<span class="fl">2.8</span>,<span class="at">by=</span><span class="fl">0.2</span>)))<span class="sc">+</span></span>
<span id="cb608-50"><a href="#cb608-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Ratio HY/HS (mean midgut length)&quot;</span>,</span>
<span id="cb608-51"><a href="#cb608-51" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">2.6</span>),</span>
<span id="cb608-52"><a href="#cb608-52" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="fl">0.8</span>,<span class="fl">2.8</span>,<span class="at">by=</span><span class="fl">0.2</span>)))<span class="sc">+</span></span>
<span id="cb608-53"><a href="#cb608-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data=</span>tab_corr_length_cell_DGRP_mean,<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb608-54"><a href="#cb608-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)<span class="sc">+</span></span>
<span id="cb608-55"><a href="#cb608-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tab_stat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.7</span>, <span class="at">y =</span> <span class="fl">1.7</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;cor=&quot;</span>, <span class="fu">format</span>(cor, <span class="at">digits=</span><span class="dv">2</span>),                                       <span class="st">&quot;p=&quot;</span>,<span class="fu">format</span>(Pvalue,<span class="at">digits=</span><span class="dv">2</span>))),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span> </span>
<span id="cb608-56"><a href="#cb608-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb608-57"><a href="#cb608-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb608-58"><a href="#cb608-58" aria-hidden="true" tabindex="-1"></a>        (<span class="at">panel.border =</span> <span class="fu">element_blank</span>()),</span>
<span id="cb608-59"><a href="#cb608-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb608-60"><a href="#cb608-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb608-61"><a href="#cb608-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb608-62"><a href="#cb608-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb608-63"><a href="#cb608-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb608-64"><a href="#cb608-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb608-65"><a href="#cb608-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb608-66"><a href="#cb608-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb608-67"><a href="#cb608-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb608-68"><a href="#cb608-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb608-69"><a href="#cb608-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb608-70"><a href="#cb608-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.98</span>),</span>
<span id="cb608-71"><a href="#cb608-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb608-72"><a href="#cb608-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb608-73"><a href="#cb608-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb608-74"><a href="#cb608-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb608-75"><a href="#cb608-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont),</span>
<span id="cb608-76"><a href="#cb608-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>))<span class="sc">+</span></span>
<span id="cb608-77"><a href="#cb608-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb608-78"><a href="#cb608-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-79"><a href="#cb608-79" aria-hidden="true" tabindex="-1"></a>Plot_Fig7S1B</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207S1B-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>##Export Figure 7S1</p>
</div>
</div>
<div id="figure-7---supplementary-2" class="section level2" number="7.3">
<h2 number="7.3"><span class="header-section-number">7.3</span> Figure 7 - supplementary 2</h2>
<div id="figure-7s2a-b" class="section level3" number="7.3.1">
<h3 number="7.3.1"><span class="header-section-number">7.3.1</span> Figure 7S2A-B</h3>
<div class="blue">
<p>A reporter line for Foxo pathway activity, thor-lacZ, has increased intensity on HS (A, A’) compared to HY (B, B’). Quantification of mean pixel intensity of thor-lacZ stain (C). <em>Complete graphical annotation can be found in manuscript figures</em></p>
</div>
<div class="row">
<div class="col-md-6">
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="#cb609-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/7- S2A.jpg&quot;</span>) </span>
<span id="cb609-2"><a href="#cb609-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig7S2A <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb609-3"><a href="#cb609-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig7S2A)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207S2A-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="#cb610-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/7- S2A1.jpg&quot;</span>) </span>
<span id="cb610-2"><a href="#cb610-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig7S2A1 <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb610-3"><a href="#cb610-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig7S2A1)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207S2A1-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="#cb611-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/7- S2B.jpg&quot;</span>) </span>
<span id="cb611-2"><a href="#cb611-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig7S2B <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb611-3"><a href="#cb611-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig7S2B)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207S2B-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div class="col-md-6">
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="#cb612-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/7- S2B1.jpg&quot;</span>) </span>
<span id="cb612-2"><a href="#cb612-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig7S2B1 <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb612-3"><a href="#cb612-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig7S2B1)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207S2B1-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="figure-7s2c" class="section level3" number="7.3.2">
<h3 number="7.3.2"><span class="header-section-number">7.3.2</span> Figure 7S2C</h3>
<div class="blue">
<p>Quantification thor-lacZ</p>
</div>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="#cb613-1" aria-hidden="true" tabindex="-1"></a>tab_ThorlacZ_rev <span class="ot">=</span> </span>
<span id="cb613-2"><a href="#cb613-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;7 - S2C&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb613-3"><a href="#cb613-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb613-4"><a href="#cb613-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer,as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb613-5"><a href="#cb613-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">ThorlacZ_int=</span>Mean)</span>
<span id="cb613-6"><a href="#cb613-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb613-7"><a href="#cb613-7" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb613-8"><a href="#cb613-8" aria-hidden="true" tabindex="-1"></a>  tab_ThorlacZ_rev<span class="sc">%&gt;%</span></span>
<span id="cb613-9"><a href="#cb613-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet)<span class="sc">%&gt;%</span></span>
<span id="cb613-10"><a href="#cb613-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb613-11"><a href="#cb613-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb613-12"><a href="#cb613-12" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb613-13"><a href="#cb613-13" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(ThorlacZ_int) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tab_ThorlacZ_rev)</span>
<span id="cb613-14"><a href="#cb613-14" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.96119, p-value = 0.1441</code></pre>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="#cb615-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(ThorlacZ_int) <span class="sc">~</span>  Diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tab_ThorlacZ_rev)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(ThorlacZ_int) ~ Diet + (1/Repeat)
BP = 10.584, df = 1, p-value = 0.001141</code></pre>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="#cb617-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(ThorlacZ_int) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tab_ThorlacZ_rev)</span>
<span id="cb617-2"><a href="#cb617-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb617-3"><a href="#cb617-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb617-4"><a href="#cb617-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-5"><a href="#cb617-5" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;HS vs HY&quot;</span>)),</span>
<span id="cb617-6"><a href="#cb617-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_ThorlacZ_rev<span class="sc">$</span>Repeat),</span>
<span id="cb617-7"><a href="#cb617-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb617-8"><a href="#cb617-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb617-9"><a href="#cb617-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb617-10"><a href="#cb617-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb617-11"><a href="#cb617-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb617-12"><a href="#cb617-12" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb617-13"><a href="#cb617-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb617-14"><a href="#cb617-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb617-15"><a href="#cb617-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-16"><a href="#cb617-16" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb617-17"><a href="#cb617-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Thor-lacZ intensity) ~  Diet + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb617-18"><a href="#cb617-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Thor-lacZ intensity) ~ Diet + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
HS vs HY
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
40.09
</td>
<td style="text-align:left;">
2.96
</td>
<td style="text-align:left;">
-1.07
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="#cb618-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb618-2"><a href="#cb618-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb618-3"><a href="#cb618-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb618-4"><a href="#cb618-4" aria-hidden="true" tabindex="-1"></a>Plot_Fig7S2C<span class="ot">=</span></span>
<span id="cb618-5"><a href="#cb618-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_ThorlacZ_rev, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> ThorlacZ_int))<span class="sc">+</span> </span>
<span id="cb618-6"><a href="#cb618-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb618-7"><a href="#cb618-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb618-8"><a href="#cb618-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb618-9"><a href="#cb618-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">annotation =</span> <span class="fu">formatC</span>(<span class="fu">paste</span>(<span class="st">&quot;p=&quot;</span>,tab_stat<span class="sc">$</span>Pvalue), <span class="at">digits =</span> <span class="dv">2</span>), <span class="at">textsize =</span> <span class="dv">3</span>, <span class="at">y_position =</span> <span class="dv">32</span>, <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">tip_length =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.02</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb618-10"><a href="#cb618-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb618-11"><a href="#cb618-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb618-12"><a href="#cb618-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#FFB4B4&quot;</span>,<span class="st">&quot;#C3E6FC&quot;</span>))<span class="sc">+</span></span>
<span id="cb618-13"><a href="#cb618-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb618-14"><a href="#cb618-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>),</span>
<span id="cb618-15"><a href="#cb618-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb618-16"><a href="#cb618-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb618-17"><a href="#cb618-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">bquote</span>(<span class="fu">atop</span>(<span class="st">&quot;Mean pixel intensity&quot;</span> ,<span class="sc">~</span> <span class="fu">italic</span> (Thor<span class="sc">-</span>lacZ) <span class="sc">~</span> <span class="st">&quot;(a.u.)&quot;</span>)),</span>
<span id="cb618-18"><a href="#cb618-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">35</span>),</span>
<span id="cb618-19"><a href="#cb618-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">30</span>,<span class="at">by=</span><span class="dv">10</span>))<span class="sc">+</span> </span>
<span id="cb618-20"><a href="#cb618-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb618-21"><a href="#cb618-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb618-22"><a href="#cb618-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb618-23"><a href="#cb618-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb618-24"><a href="#cb618-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb618-25"><a href="#cb618-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb618-26"><a href="#cb618-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb618-27"><a href="#cb618-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb618-28"><a href="#cb618-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb618-29"><a href="#cb618-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb618-30"><a href="#cb618-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb618-31"><a href="#cb618-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb618-32"><a href="#cb618-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb618-33"><a href="#cb618-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb618-34"><a href="#cb618-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb618-35"><a href="#cb618-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb618-36"><a href="#cb618-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb618-37"><a href="#cb618-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb618-38"><a href="#cb618-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb618-39"><a href="#cb618-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb618-40"><a href="#cb618-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb618-41"><a href="#cb618-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb618-42"><a href="#cb618-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb618-43"><a href="#cb618-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span>Smallfont<span class="dv">-2</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">face=</span><span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb618-44"><a href="#cb618-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb618-45"><a href="#cb618-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb618-46"><a href="#cb618-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb618-47"><a href="#cb618-47" aria-hidden="true" tabindex="-1"></a>Plot_Fig7S2C</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207S2C-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-7s2d" class="section level3" number="7.3.3">
<h3 number="7.3.3"><span class="header-section-number">7.3.3</span> Figure 7S2D</h3>
<div class="blue">
<p>Blocking TOR in ECs (5966GS&gt; UAS-Tor-IR) inhibits diet induced midgut growth. For control we used flies of the same genotype but not exposed to RU486. Statistical analyses were performed by comparing interaction between diet and fly line.</p>
</div>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="#cb619-1" aria-hidden="true" tabindex="-1"></a>tab_5966TOR_rev <span class="ot">=</span> </span>
<span id="cb619-2"><a href="#cb619-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;7 - S2D&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb619-3"><a href="#cb619-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb619-4"><a href="#cb619-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm=</span>Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb619-5"><a href="#cb619-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_treatment=</span>Day,</span>
<span id="cb619-6"><a href="#cb619-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Female_Line=</span>Female.Line,</span>
<span id="cb619-7"><a href="#cb619-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Male_Line=</span>Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb619-8"><a href="#cb619-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment=</span><span class="fu">fct_relevel</span>(Treatment,<span class="st">&quot;Ethanol&quot;</span>,<span class="st">&quot;RU486&quot;</span>))</span>
<span id="cb619-9"><a href="#cb619-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-10"><a href="#cb619-10" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb619-11"><a href="#cb619-11" aria-hidden="true" tabindex="-1"></a> tab_5966TOR_rev<span class="sc">%&gt;%</span></span>
<span id="cb619-12"><a href="#cb619-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diet,Treatment)<span class="sc">%&gt;%</span></span>
<span id="cb619-13"><a href="#cb619-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb619-14"><a href="#cb619-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-15"><a href="#cb619-15" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb619-16"><a href="#cb619-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-17"><a href="#cb619-17" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">*</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span>tab_5966TOR_rev)</span>
<span id="cb619-18"><a href="#cb619-18" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen)) </span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.98854, p-value = 0.4511</code></pre>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="#cb621-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span>tab_5966TOR_rev)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log(Total_Length_mm) ~ Diet + Treatment + (1/Repeat)
BP = 4.1422, df = 2, p-value = 0.126</code></pre>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="#cb623-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span>tab_5966TOR_rev)</span>
<span id="cb623-2"><a href="#cb623-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1) </span>
<span id="cb623-3"><a href="#cb623-3" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb623-4"><a href="#cb623-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-5"><a href="#cb623-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-6"><a href="#cb623-6" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Interaction ethanol vs interaction RU486&quot;</span>)),</span>
<span id="cb623-7"><a href="#cb623-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_5966TOR_rev<span class="sc">$</span>Repeat),</span>
<span id="cb623-8"><a href="#cb623-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb623-9"><a href="#cb623-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb623-10"><a href="#cb623-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb623-11"><a href="#cb623-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb623-12"><a href="#cb623-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">2</span>)))</span>
<span id="cb623-13"><a href="#cb623-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-14"><a href="#cb623-14" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb623-15"><a href="#cb623-15" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb623-16"><a href="#cb623-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb623-17"><a href="#cb623-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-18"><a href="#cb623-18" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb623-19"><a href="#cb623-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>,<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + Treatment + Diet : Treatment + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">8</span>))<span class="sc">%&gt;%</span></span>
<span id="cb623-20"><a href="#cb623-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + Treatment + Diet : Treatment + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Interaction ethanol vs interaction RU486
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
31.29
</td>
<td style="text-align:left;">
1.35
</td>
<td style="text-align:left;">
0.319
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="#cb624-1" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_RU486<span class="ot">=</span>tab_stat</span>
<span id="cb624-2"><a href="#cb624-2" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_RU486<span class="sc">$</span>Treatment<span class="ot">=</span><span class="st">&quot;RU486&quot;</span></span>
<span id="cb624-3"><a href="#cb624-3" aria-hidden="true" tabindex="-1"></a>tab_stat_rev_RU486<span class="sc">$</span>Treatment<span class="ot">=</span><span class="fu">as.factor</span>(tab_stat_rev_RU486<span class="sc">$</span>Treatment)</span>
<span id="cb624-4"><a href="#cb624-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb624-5"><a href="#cb624-5" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb624-6"><a href="#cb624-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb624-7"><a href="#cb624-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb624-8"><a href="#cb624-8" aria-hidden="true" tabindex="-1"></a>Plot_Fig7S2D <span class="ot">=</span></span>
<span id="cb624-9"><a href="#cb624-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_5966TOR_rev, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb624-10"><a href="#cb624-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb624-11"><a href="#cb624-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.11</span>) <span class="sc">+</span> </span>
<span id="cb624-12"><a href="#cb624-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">2.2</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb624-13"><a href="#cb624-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>,<span class="fu">aes</span>(<span class="at">group=</span>Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb624-14"><a href="#cb624-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb624-15"><a href="#cb624-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb624-16"><a href="#cb624-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb624-17"><a href="#cb624-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb624-18"><a href="#cb624-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span> Treatment)<span class="sc">+</span></span>
<span id="cb624-19"><a href="#cb624-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>cbbHS_HStoHY)<span class="sc">+</span></span>
<span id="cb624-20"><a href="#cb624-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb624-21"><a href="#cb624-21" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HS D0&quot;</span>,<span class="st">&quot;HStoHY D7&quot;</span>),</span>
<span id="cb624-22"><a href="#cb624-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;HS to HY&quot;</span>))<span class="sc">+</span></span>
<span id="cb624-23"><a href="#cb624-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb624-24"><a href="#cb624-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">7</span>),</span>
<span id="cb624-25"><a href="#cb624-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">7</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb624-26"><a href="#cb624-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb624-27"><a href="#cb624-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb624-28"><a href="#cb624-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb624-29"><a href="#cb624-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb624-30"><a href="#cb624-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb624-31"><a href="#cb624-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb624-32"><a href="#cb624-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb624-33"><a href="#cb624-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb624-34"><a href="#cb624-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb624-35"><a href="#cb624-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb624-36"><a href="#cb624-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb624-37"><a href="#cb624-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb624-38"><a href="#cb624-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb624-39"><a href="#cb624-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb624-40"><a href="#cb624-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb624-41"><a href="#cb624-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb624-42"><a href="#cb624-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb624-43"><a href="#cb624-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb624-44"><a href="#cb624-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb624-45"><a href="#cb624-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb624-46"><a href="#cb624-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb624-47"><a href="#cb624-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb624-48"><a href="#cb624-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb624-49"><a href="#cb624-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb624-50"><a href="#cb624-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb624-51"><a href="#cb624-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb624-52"><a href="#cb624-52" aria-hidden="true" tabindex="-1"></a>Plot_Fig7S2D</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207S2D-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="figure-7s2e" class="section level3" number="7.3.4">
<h3 number="7.3.4"><span class="header-section-number">7.3.4</span> Figure 7S2E</h3>
<div class="blue">
<p>Blocking autophagy in ECs reduces midgut resizing upon shrinkage (HY to HS for 7 days) using 5966GS&gt; UAS-Atg8a-IR. For control we used flies of the same genotype but not exposed to RU486. Statistical analyses were performed by comparing interaction between diet and fly line. <em>Complete statistical annotation can be found in manuscript’s figure.</em></p>
</div>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="#cb625-1" aria-hidden="true" tabindex="-1"></a>tab_5966atg8a_rev <span class="ot">=</span> </span>
<span id="cb625-2"><a href="#cb625-2" aria-hidden="true" tabindex="-1"></a>  d[[<span class="st">&quot;7 - S2E&quot;</span>]]<span class="sc">%&gt;%</span></span>
<span id="cb625-3"><a href="#cb625-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">&quot;Total&quot;</span>)),as.factor)<span class="sc">%&gt;%</span></span>
<span id="cb625-4"><a href="#cb625-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total_Length_mm=</span>Total.L<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span></span>
<span id="cb625-5"><a href="#cb625-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Day_of_treatment=</span>Day,</span>
<span id="cb625-6"><a href="#cb625-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Female_Line=</span>Female.Line,</span>
<span id="cb625-7"><a href="#cb625-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Male_Line=</span>Male.Line)<span class="sc">%&gt;%</span></span>
<span id="cb625-8"><a href="#cb625-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment=</span><span class="fu">fct_relevel</span>(Treatment,<span class="st">&quot;Ethanol&quot;</span>,<span class="st">&quot;RU486&quot;</span>))</span>
<span id="cb625-9"><a href="#cb625-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb625-10"><a href="#cb625-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb625-11"><a href="#cb625-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb625-12"><a href="#cb625-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb625-13"><a href="#cb625-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb625-14"><a href="#cb625-14" aria-hidden="true" tabindex="-1"></a>Sample_size<span class="ot">=</span></span>
<span id="cb625-15"><a href="#cb625-15" aria-hidden="true" tabindex="-1"></a> tab_5966atg8a_rev<span class="sc">%&gt;%</span></span>
<span id="cb625-16"><a href="#cb625-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Male_Line,Diet,Treatment)<span class="sc">%&gt;%</span></span>
<span id="cb625-17"><a href="#cb625-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Sample_size=</span><span class="fu">n</span>())</span>
<span id="cb625-18"><a href="#cb625-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb625-19"><a href="#cb625-19" aria-hidden="true" tabindex="-1"></a><span class="do">###Stats</span></span>
<span id="cb625-20"><a href="#cb625-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb625-21"><a href="#cb625-21" aria-hidden="true" tabindex="-1"></a>mod.gen <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log10</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">*</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tab_5966atg8a_rev)</span>
<span id="cb625-22"><a href="#cb625-22" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.gen))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(mod.gen)
W = 0.9768, p-value = 0.06449</code></pre>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="#cb627-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">log10</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">*</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> Repeat),<span class="at">data =</span> tab_5966atg8a_rev)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  log10(Total_Length_mm) ~ Diet * Treatment + (1/Repeat)
BP = 5.6695, df = 3, p-value = 0.1288</code></pre>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="#cb629-1" aria-hidden="true" tabindex="-1"></a>mod.gen1 <span class="ot">=</span> <span class="fu">fitme</span>(<span class="fu">log10</span>(Total_Length_mm) <span class="sc">~</span>  Diet <span class="sc">+</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Repeat),<span class="at">data =</span> tab_5966atg8a_rev)</span>
<span id="cb629-2"><a href="#cb629-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">anova</span>(mod.gen, mod.gen1)</span>
<span id="cb629-3"><a href="#cb629-3" aria-hidden="true" tabindex="-1"></a>test</span></code></pre></div>
<pre><code>     chi2_LR df    p_value
p_v 5.112911  1 0.02374845</code></pre>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="#cb631-1" aria-hidden="true" tabindex="-1"></a>Chi2_LRT_growth <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(mod.gen<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]]<span class="sc">-</span>mod.gen1<span class="sc">$</span>APHLs[[<span class="st">&quot;p_v&quot;</span>]])</span>
<span id="cb631-2"><a href="#cb631-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb631-3"><a href="#cb631-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb631-4"><a href="#cb631-4" aria-hidden="true" tabindex="-1"></a>tab_stat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Comparison =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Interaction ethanol vs interaction RU486&quot;</span>)),</span>
<span id="cb631-5"><a href="#cb631-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Male_Line =</span> <span class="fu">as.character</span>(<span class="fu">paste</span>(<span class="st">&quot;Atg8a-IR&quot;</span>)),</span>
<span id="cb631-6"><a href="#cb631-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Rep =</span> <span class="fu">nlevels</span>(tab_5966atg8a_rev<span class="sc">$</span>Repeat),</span>
<span id="cb631-7"><a href="#cb631-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">chi2_LR =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>chi2_LR), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb631-8"><a href="#cb631-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">intercept =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">1</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb631-9"><a href="#cb631-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">estimate =</span> <span class="fu">format</span>(mod.gen<span class="sc">$</span>fixef[<span class="dv">2</span>],<span class="at">digits=</span><span class="dv">3</span>),</span>
<span id="cb631-10"><a href="#cb631-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">df =</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>basicLRT<span class="sc">$</span>df),</span>
<span id="cb631-11"><a href="#cb631-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Pvalue =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">pchisq</span>(Chi2_LRT_growth,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F),<span class="at">digits=</span><span class="dv">1</span>,<span class="at">scientific=</span>F)))</span>
<span id="cb631-12"><a href="#cb631-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb631-13"><a href="#cb631-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb631-14"><a href="#cb631-14" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">$</span>sig <span class="ot">=</span> <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.01</span>, <span class="st">&quot;*&quot;</span>,</span>
<span id="cb631-15"><a href="#cb631-15" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> tab_stat<span class="sc">$</span>Pvalue <span class="sc">&gt;</span> <span class="fl">0.001</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb631-16"><a href="#cb631-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ifelse</span>(tab_stat<span class="sc">$</span>Pvalue <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, <span class="st">&quot;&quot;</span>)))</span>
<span id="cb631-17"><a href="#cb631-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb631-18"><a href="#cb631-18" aria-hidden="true" tabindex="-1"></a>tab_stat<span class="sc">%&gt;%</span></span>
<span id="cb631-19"><a href="#cb631-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Comparison&quot;</span>,<span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Replicates&quot;</span>, <span class="st">&quot;Chi2&quot;</span>, <span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;df&quot;</span> ,<span class="st">&quot;p-value&quot;</span>,<span class="st">&quot;Signif.&quot;</span>),<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb631-20"><a href="#cb631-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;log(Total_Length_mm) ~  Diet + Treatment + Diet : Treatment + (1 | Repeat)&quot;</span> <span class="ot">=</span> <span class="dv">9</span>))<span class="sc">%&gt;%</span></span>
<span id="cb631-21"><a href="#cb631-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>), <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="9">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
log(Total_Length_mm) ~ Diet + Treatment + Diet : Treatment + (1 | Repeat)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Replicates
</th>
<th style="text-align:right;">
Chi2
</th>
<th style="text-align:left;">
Intercept
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p-value
</th>
<th style="text-align:left;">
Signif.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Interaction ethanol vs interaction RU486
</td>
<td style="text-align:left;">
Atg8a-IR
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5.11
</td>
<td style="text-align:left;">
0.767
</td>
<td style="text-align:left;">
-0.118
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
</tbody>
</table></li>
</ul>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="#cb632-1" aria-hidden="true" tabindex="-1"></a>tab_stat_5966atg8a_rev<span class="ot">=</span>tab_stat</span>
<span id="cb632-2"><a href="#cb632-2" aria-hidden="true" tabindex="-1"></a>tab_stat_5966atg8a_rev<span class="sc">$</span>Treatment<span class="ot">=</span><span class="st">&quot;RU486&quot;</span></span>
<span id="cb632-3"><a href="#cb632-3" aria-hidden="true" tabindex="-1"></a>tab_stat_5966atg8a_rev<span class="sc">$</span>Treatment<span class="ot">=</span><span class="fu">as.factor</span>(tab_stat_rev_RU486<span class="sc">$</span>Treatment)</span>
<span id="cb632-4"><a href="#cb632-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-5"><a href="#cb632-5" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot</span></span>
<span id="cb632-6"><a href="#cb632-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-7"><a href="#cb632-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-8"><a href="#cb632-8" aria-hidden="true" tabindex="-1"></a>Plot_Fig7S2E <span class="ot">=</span></span>
<span id="cb632-9"><a href="#cb632-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tab_5966atg8a_rev, <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> Total_Length_mm))<span class="sc">+</span> </span>
<span id="cb632-10"><a href="#cb632-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diet), <span class="at">draw_quantiles =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>,<span class="at">adjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb632-11"><a href="#cb632-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>( <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.11</span>) <span class="sc">+</span> </span>
<span id="cb632-12"><a href="#cb632-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> Sample_size, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Diet, <span class="at">y =</span> <span class="fl">2.2</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;(&quot;</span>,Sample_size,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb632-13"><a href="#cb632-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>,<span class="fu">aes</span>(<span class="at">group=</span>Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb632-14"><a href="#cb632-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb632-15"><a href="#cb632-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat, <span class="at">colour =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb632-16"><a href="#cb632-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> Repeat)) <span class="sc">+</span></span>
<span id="cb632-17"><a href="#cb632-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> palette_mean) <span class="sc">+</span></span>
<span id="cb632-18"><a href="#cb632-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> Treatment)<span class="sc">+</span></span>
<span id="cb632-19"><a href="#cb632-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>cbbHY_HYtoHS)<span class="sc">+</span></span>
<span id="cb632-20"><a href="#cb632-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;&quot;</span>,</span>
<span id="cb632-21"><a href="#cb632-21" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits=</span><span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>,<span class="st">&quot;HYtoHS&quot;</span>),</span>
<span id="cb632-22"><a href="#cb632-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;HY&quot;</span>,<span class="st">&quot;HY to HS&quot;</span>))<span class="sc">+</span></span>
<span id="cb632-23"><a href="#cb632-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Midgut length (mm)&quot;</span>,</span>
<span id="cb632-24"><a href="#cb632-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span>),</span>
<span id="cb632-25"><a href="#cb632-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb632-26"><a href="#cb632-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="fu">grey</span>(<span class="fl">0.45</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb632-27"><a href="#cb632-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb632-28"><a href="#cb632-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb632-29"><a href="#cb632-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>), </span>
<span id="cb632-30"><a href="#cb632-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb632-31"><a href="#cb632-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.75</span>),</span>
<span id="cb632-32"><a href="#cb632-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb632-33"><a href="#cb632-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.75</span>),</span>
<span id="cb632-34"><a href="#cb632-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>,<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb632-35"><a href="#cb632-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span>Smallfont,<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb632-36"><a href="#cb632-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(Margin, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb632-37"><a href="#cb632-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;vertical&quot;</span>, </span>
<span id="cb632-38"><a href="#cb632-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb632-39"><a href="#cb632-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb632-40"><a href="#cb632-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb632-41"><a href="#cb632-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="fl">0.6</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb632-42"><a href="#cb632-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;italic&quot;</span>,<span class="at">size=</span>Smallfont), </span>
<span id="cb632-43"><a href="#cb632-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>),</span>
<span id="cb632-44"><a href="#cb632-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span>SuperSmallfont),</span>
<span id="cb632-45"><a href="#cb632-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb632-46"><a href="#cb632-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb632-47"><a href="#cb632-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> Smallfont, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb632-48"><a href="#cb632-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb632-49"><a href="#cb632-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement=</span><span class="st">&quot;outside&quot;</span>)</span>
<span id="cb632-50"><a href="#cb632-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-51"><a href="#cb632-51" aria-hidden="true" tabindex="-1"></a>Plot_Fig7S2E</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207S2E-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>##Export Figure 7S2</p>
</div>
</div>
<div id="figure-7---supplementary-3" class="section level2" number="7.4">
<h2 number="7.4"><span class="header-section-number">7.4</span> Figure 7 - supplementary 3</h2>
<div id="figure-7s3a" class="section level3" number="7.4.1">
<h3 number="7.4.1"><span class="header-section-number">7.4.1</span> Figure 7S3A</h3>
<div class="blue">
<p>Scheme depicting the regulation of midgut size in response to dietary changes. EC size, together with the balance between cell gain and cell loss, determine midgut size. Diet can influence these three parameters, thus influencing midgut size. Yeast promotes midgut growth, and sugar antagonizes it. Sugar inhibits translation and uncouples ISC proliferation from expression of stress-derived pro-mitotic signals, thus resulting in smaller guts.</p>
</div>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="#cb633-1" aria-hidden="true" tabindex="-1"></a>img <span class="ot">=</span> <span class="fu">readImage</span>(<span class="st">&quot;F:/Dropbox/Github/Bonfini_eLife_2021/data/7 - S3A.jpg&quot;</span>) </span>
<span id="cb633-2"><a href="#cb633-2" aria-hidden="true" tabindex="-1"></a>gob_imageFig7S3A <span class="ot">=</span> <span class="fu">rasterGrob</span>(img)</span>
<span id="cb633-3"><a href="#cb633-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.draw</span>(gob_imageFig7S3A)</span></code></pre></div>
<p><img src="figure/Bonfini_eLife_2021.Rmd/Figure%207S3A-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>##Export Figure 7S3</p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="#cb634-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.1.0 (2021-05-18)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19043)

Matrix products: default

locale:
[1] LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252   
[3] LC_MONETARY=French_France.1252 LC_NUMERIC=C                  
[5] LC_TIME=French_France.1252    

attached base packages:
 [1] parallel  stats4    grid      stats     graphics  grDevices utils    
 [8] datasets  methods   base     

other attached packages:
 [1] ggsignif_0.6.2              plotfunctions_1.4          
 [3] kableExtra_1.3.4            knitr_1.33                 
 [5] ggplotify_0.1.0             coxme_2.2-16               
 [7] bdsmatrix_1.3-4             DESeq2_1.32.0              
 [9] SummarizedExperiment_1.22.0 Biobase_2.52.0             
[11] MatrixGenerics_1.4.3        matrixStats_0.60.1         
[13] GenomicRanges_1.44.0        GenomeInfoDb_1.28.0        
[15] IRanges_2.26.0              S4Vectors_0.30.0           
[17] BiocGenerics_0.38.0         ggh4x_0.2.0                
[19] forcats_0.5.1               metR_0.11.0                
[21] ggrepel_0.9.1               multcomp_1.4-17            
[23] TH.data_1.0-10              mvtnorm_1.1-2              
[25] gridGraphics_0.5-1          RColorBrewer_1.1-2         
[27] gplots_3.1.1                EBImage_4.34.0             
[29] fields_12.5                 viridis_0.6.1              
[31] viridisLite_0.4.0           spam_2.7-0                 
[33] dotCall64_1.0-1             lme4_1.1-27.1              
[35] Matrix_1.3-3                spaMM_3.8.0                
[37] data.table_1.14.0           phia_0.2-1                 
[39] tidyr_1.1.3                 scales_1.1.1               
[41] stringr_1.4.0               dplyr_1.0.7                
[43] xlsx_0.6.5                  xlsxjars_0.6.1             
[45] rJava_1.0-5                 doBy_4.6.10                
[47] psych_2.1.6                 nparLD_2.1                 
[49] agricolae_1.3-5             gridExtra_2.3              
[51] plotrix_3.8-1               survival_3.2-11            
[53] ggplot2_3.3.5               lmtest_0.9-38              
[55] zoo_1.8-9                   car_3.0-10                 
[57] carData_3.0-4               MASS_7.3-54                
[59] lattice_0.20-44             reshape2_1.4.4             
[61] devtools_2.4.2              usethis_2.0.1              
[63] workflowr_1.6.2            

loaded via a namespace (and not attached):
  [1] bit64_4.0.5            DelayedArray_0.18.0    KEGGREST_1.32.0       
  [4] RCurl_1.98-1.3         generics_0.1.0         callr_3.7.0           
  [7] RSQLite_2.2.7          combinat_0.0-8         proxy_0.4-26          
 [10] bit_4.0.4              webshot_0.5.2          xml2_1.3.2            
 [13] lubridate_1.7.10       httpuv_1.6.1           assertthat_0.2.1      
 [16] xfun_0.24              hms_1.1.0              jquerylib_0.1.4       
 [19] evaluate_0.14          promises_1.2.0.1       fansi_0.5.0           
 [22] caTools_1.18.2         readxl_1.3.1           DBI_1.1.1             
 [25] geneplotter_1.70.0     tmvnsim_1.0-2          htmlwidgets_1.5.3     
 [28] purrr_0.3.4            ellipsis_0.3.2         backports_1.2.1       
 [31] annotate_1.70.0        ROI_1.0-0              vctrs_0.3.8           
 [34] remotes_2.4.1          abind_1.4-5            cachem_1.0.5          
 [37] withr_2.4.2            checkmate_2.0.0        prettyunits_1.1.1     
 [40] mnormt_2.0.2           svglite_2.0.0          cluster_2.1.2         
 [43] crayon_1.4.1           genefilter_1.74.0      labeling_0.4.2        
 [46] pkgconfig_2.0.3        slam_0.1-48            nlme_3.1-152          
 [49] pkgload_1.2.2          rlang_0.4.11           questionr_0.7.4       
 [52] lifecycle_1.0.0        miniUI_0.1.1.1         sandwich_3.0-1        
 [55] registry_0.5-1         cellranger_1.1.0       rprojroot_2.0.2       
 [58] tiff_0.1-8             boot_1.3-28            whisker_0.4           
 [61] processx_3.5.2         png_0.1-7              bitops_1.0-7          
 [64] KernSmooth_2.23-20     Biostrings_2.60.1      blob_1.2.1            
 [67] jpeg_0.1-8.1           klaR_0.6-15            memoise_2.0.0         
 [70] magrittr_2.0.1         plyr_1.8.6             zlibbioc_1.38.0       
 [73] compiler_4.1.0         cli_3.0.1              XVector_0.32.0        
 [76] pbapply_1.4-3          ps_1.6.0               mgcv_1.8-35           
 [79] tidyselect_1.1.1       stringi_1.6.2          highr_0.9             
 [82] yaml_2.2.1             locfit_1.5-9.4         sass_0.4.0            
 [85] tools_4.1.0            rio_0.5.27             rstudioapi_0.13       
 [88] foreign_0.8-81         git2r_0.28.0           farver_2.1.0          
 [91] digest_0.6.27          shiny_1.6.0            Rcpp_1.0.7            
 [94] microbenchmark_1.4-7   broom_0.7.8            later_1.2.0           
 [97] httr_1.4.2             AnnotationDbi_1.54.1   Deriv_4.1.3           
[100] colorspace_2.0-2       rvest_1.0.0            XML_3.99-0.6          
[103] fs_1.5.0               splines_4.1.0          yulab.utils_0.0.2     
[106] sessioninfo_1.1.1      systemfonts_1.0.2      xtable_1.8-4          
[109] jsonlite_1.7.2         nloptr_1.2.2.2         AlgDesign_1.2.0       
[112] testthat_3.1.0         R6_2.5.0               pillar_1.6.1          
[115] htmltools_0.5.1.1      mime_0.11              glue_1.4.2            
[118] fastmap_1.1.0          minqa_1.2.4            BiocParallel_1.26.2   
[121] fftwtools_0.9-11       codetools_0.2-18       maps_3.3.0            
[124] pkgbuild_1.2.0         utf8_1.2.1             bslib_0.2.5.1         
[127] tibble_3.1.2           numDeriv_2016.8-1.1    curl_4.3.2            
[130] gtools_3.9.2           zip_2.2.0              openxlsx_4.2.4        
[133] rmarkdown_2.9          desc_1.4.0             curry_0.1.1           
[136] munsell_0.5.0          GenomeInfoDbData_1.2.6 labelled_2.8.0        
[139] haven_2.4.1            gtable_0.3.0          </code></pre>
</div>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
